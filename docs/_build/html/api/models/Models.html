

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>mambular.models &#8212; mambular</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="../../_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'api/models/Models';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="BaseModels" href="../base_models/index.html" />
    <link rel="prev" title="Models" href="index.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
    <meta name="docbuild:last-update" content="2024-12-07"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/mamba_tabular.jpg" class="logo__image only-light" alt="mambular - Home"/>
    <script>document.write(`<img src="../../_static/mamba_tabular.jpg" class="logo__image only-dark" alt="mambular - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Installation</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Examples</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../examples/classification.html">Classification</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/regression.html">Regression</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/distributional.html">Distributional</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="index.html">Models</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2 current active"><a class="current reference internal" href="#">mambular.models</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../base_models/index.html">BaseModels</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../base_models/BaseModels.html">mambular.base_models</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../preprocessing/index.html">Preprocessing</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../preprocessing/Preprocessor.html">mambular.preprocessing</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../data_utils/index.html">Data Utils</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../data_utils/Datautils.html">mambular.data_utils</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../configs/index.html">Configurations</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../configs/Configurations.html">Configurations</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Developer Guide</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../codeofconduct.html">Code of Conduct</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../development.html">Contribute</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../release.html">Build and release</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/api/models/Models.rst" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.rst</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>mambular.models</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambularClassifier"><code class="docutils literal notranslate"><span class="pre">MambularClassifier</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambularClassifier.build_model"><code class="docutils literal notranslate"><span class="pre">MambularClassifier.build_model()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambularClassifier.evaluate"><code class="docutils literal notranslate"><span class="pre">MambularClassifier.evaluate()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambularClassifier.fit"><code class="docutils literal notranslate"><span class="pre">MambularClassifier.fit()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambularClassifier.get_number_of_params"><code class="docutils literal notranslate"><span class="pre">MambularClassifier.get_number_of_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambularClassifier.get_params"><code class="docutils literal notranslate"><span class="pre">MambularClassifier.get_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambularClassifier.optimize_hparams"><code class="docutils literal notranslate"><span class="pre">MambularClassifier.optimize_hparams()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambularClassifier.predict"><code class="docutils literal notranslate"><span class="pre">MambularClassifier.predict()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambularClassifier.predict_proba"><code class="docutils literal notranslate"><span class="pre">MambularClassifier.predict_proba()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambularClassifier.score"><code class="docutils literal notranslate"><span class="pre">MambularClassifier.score()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambularClassifier.set_params"><code class="docutils literal notranslate"><span class="pre">MambularClassifier.set_params()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambularRegressor"><code class="docutils literal notranslate"><span class="pre">MambularRegressor</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambularRegressor.build_model"><code class="docutils literal notranslate"><span class="pre">MambularRegressor.build_model()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambularRegressor.evaluate"><code class="docutils literal notranslate"><span class="pre">MambularRegressor.evaluate()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambularRegressor.fit"><code class="docutils literal notranslate"><span class="pre">MambularRegressor.fit()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambularRegressor.get_number_of_params"><code class="docutils literal notranslate"><span class="pre">MambularRegressor.get_number_of_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambularRegressor.get_params"><code class="docutils literal notranslate"><span class="pre">MambularRegressor.get_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambularRegressor.optimize_hparams"><code class="docutils literal notranslate"><span class="pre">MambularRegressor.optimize_hparams()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambularRegressor.predict"><code class="docutils literal notranslate"><span class="pre">MambularRegressor.predict()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambularRegressor.score"><code class="docutils literal notranslate"><span class="pre">MambularRegressor.score()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambularRegressor.set_params"><code class="docutils literal notranslate"><span class="pre">MambularRegressor.set_params()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambularLSS"><code class="docutils literal notranslate"><span class="pre">MambularLSS</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambularLSS.build_model"><code class="docutils literal notranslate"><span class="pre">MambularLSS.build_model()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambularLSS.evaluate"><code class="docutils literal notranslate"><span class="pre">MambularLSS.evaluate()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambularLSS.fit"><code class="docutils literal notranslate"><span class="pre">MambularLSS.fit()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambularLSS.get_default_metrics"><code class="docutils literal notranslate"><span class="pre">MambularLSS.get_default_metrics()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambularLSS.get_number_of_params"><code class="docutils literal notranslate"><span class="pre">MambularLSS.get_number_of_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambularLSS.get_params"><code class="docutils literal notranslate"><span class="pre">MambularLSS.get_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambularLSS.optimize_hparams"><code class="docutils literal notranslate"><span class="pre">MambularLSS.optimize_hparams()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambularLSS.predict"><code class="docutils literal notranslate"><span class="pre">MambularLSS.predict()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambularLSS.score"><code class="docutils literal notranslate"><span class="pre">MambularLSS.score()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambularLSS.set_params"><code class="docutils literal notranslate"><span class="pre">MambularLSS.set_params()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.FTTransformerClassifier"><code class="docutils literal notranslate"><span class="pre">FTTransformerClassifier</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.FTTransformerClassifier.build_model"><code class="docutils literal notranslate"><span class="pre">FTTransformerClassifier.build_model()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.FTTransformerClassifier.evaluate"><code class="docutils literal notranslate"><span class="pre">FTTransformerClassifier.evaluate()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.FTTransformerClassifier.fit"><code class="docutils literal notranslate"><span class="pre">FTTransformerClassifier.fit()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.FTTransformerClassifier.get_number_of_params"><code class="docutils literal notranslate"><span class="pre">FTTransformerClassifier.get_number_of_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.FTTransformerClassifier.get_params"><code class="docutils literal notranslate"><span class="pre">FTTransformerClassifier.get_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.FTTransformerClassifier.optimize_hparams"><code class="docutils literal notranslate"><span class="pre">FTTransformerClassifier.optimize_hparams()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.FTTransformerClassifier.predict"><code class="docutils literal notranslate"><span class="pre">FTTransformerClassifier.predict()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.FTTransformerClassifier.predict_proba"><code class="docutils literal notranslate"><span class="pre">FTTransformerClassifier.predict_proba()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.FTTransformerClassifier.score"><code class="docutils literal notranslate"><span class="pre">FTTransformerClassifier.score()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.FTTransformerClassifier.set_params"><code class="docutils literal notranslate"><span class="pre">FTTransformerClassifier.set_params()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.FTTransformerRegressor"><code class="docutils literal notranslate"><span class="pre">FTTransformerRegressor</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.FTTransformerRegressor.build_model"><code class="docutils literal notranslate"><span class="pre">FTTransformerRegressor.build_model()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.FTTransformerRegressor.evaluate"><code class="docutils literal notranslate"><span class="pre">FTTransformerRegressor.evaluate()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.FTTransformerRegressor.fit"><code class="docutils literal notranslate"><span class="pre">FTTransformerRegressor.fit()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.FTTransformerRegressor.get_number_of_params"><code class="docutils literal notranslate"><span class="pre">FTTransformerRegressor.get_number_of_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.FTTransformerRegressor.get_params"><code class="docutils literal notranslate"><span class="pre">FTTransformerRegressor.get_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.FTTransformerRegressor.optimize_hparams"><code class="docutils literal notranslate"><span class="pre">FTTransformerRegressor.optimize_hparams()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.FTTransformerRegressor.predict"><code class="docutils literal notranslate"><span class="pre">FTTransformerRegressor.predict()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.FTTransformerRegressor.score"><code class="docutils literal notranslate"><span class="pre">FTTransformerRegressor.score()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.FTTransformerRegressor.set_params"><code class="docutils literal notranslate"><span class="pre">FTTransformerRegressor.set_params()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.FTTransformerLSS"><code class="docutils literal notranslate"><span class="pre">FTTransformerLSS</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.FTTransformerLSS.build_model"><code class="docutils literal notranslate"><span class="pre">FTTransformerLSS.build_model()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.FTTransformerLSS.evaluate"><code class="docutils literal notranslate"><span class="pre">FTTransformerLSS.evaluate()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.FTTransformerLSS.fit"><code class="docutils literal notranslate"><span class="pre">FTTransformerLSS.fit()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.FTTransformerLSS.get_default_metrics"><code class="docutils literal notranslate"><span class="pre">FTTransformerLSS.get_default_metrics()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.FTTransformerLSS.get_number_of_params"><code class="docutils literal notranslate"><span class="pre">FTTransformerLSS.get_number_of_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.FTTransformerLSS.get_params"><code class="docutils literal notranslate"><span class="pre">FTTransformerLSS.get_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.FTTransformerLSS.optimize_hparams"><code class="docutils literal notranslate"><span class="pre">FTTransformerLSS.optimize_hparams()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.FTTransformerLSS.predict"><code class="docutils literal notranslate"><span class="pre">FTTransformerLSS.predict()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.FTTransformerLSS.score"><code class="docutils literal notranslate"><span class="pre">FTTransformerLSS.score()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.FTTransformerLSS.set_params"><code class="docutils literal notranslate"><span class="pre">FTTransformerLSS.set_params()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MLPClassifier"><code class="docutils literal notranslate"><span class="pre">MLPClassifier</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MLPClassifier.build_model"><code class="docutils literal notranslate"><span class="pre">MLPClassifier.build_model()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MLPClassifier.evaluate"><code class="docutils literal notranslate"><span class="pre">MLPClassifier.evaluate()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MLPClassifier.fit"><code class="docutils literal notranslate"><span class="pre">MLPClassifier.fit()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MLPClassifier.get_number_of_params"><code class="docutils literal notranslate"><span class="pre">MLPClassifier.get_number_of_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MLPClassifier.get_params"><code class="docutils literal notranslate"><span class="pre">MLPClassifier.get_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MLPClassifier.optimize_hparams"><code class="docutils literal notranslate"><span class="pre">MLPClassifier.optimize_hparams()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MLPClassifier.predict"><code class="docutils literal notranslate"><span class="pre">MLPClassifier.predict()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MLPClassifier.predict_proba"><code class="docutils literal notranslate"><span class="pre">MLPClassifier.predict_proba()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MLPClassifier.score"><code class="docutils literal notranslate"><span class="pre">MLPClassifier.score()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MLPClassifier.set_params"><code class="docutils literal notranslate"><span class="pre">MLPClassifier.set_params()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MLPRegressor"><code class="docutils literal notranslate"><span class="pre">MLPRegressor</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MLPRegressor.build_model"><code class="docutils literal notranslate"><span class="pre">MLPRegressor.build_model()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MLPRegressor.evaluate"><code class="docutils literal notranslate"><span class="pre">MLPRegressor.evaluate()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MLPRegressor.fit"><code class="docutils literal notranslate"><span class="pre">MLPRegressor.fit()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MLPRegressor.get_number_of_params"><code class="docutils literal notranslate"><span class="pre">MLPRegressor.get_number_of_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MLPRegressor.get_params"><code class="docutils literal notranslate"><span class="pre">MLPRegressor.get_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MLPRegressor.optimize_hparams"><code class="docutils literal notranslate"><span class="pre">MLPRegressor.optimize_hparams()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MLPRegressor.predict"><code class="docutils literal notranslate"><span class="pre">MLPRegressor.predict()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MLPRegressor.score"><code class="docutils literal notranslate"><span class="pre">MLPRegressor.score()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MLPRegressor.set_params"><code class="docutils literal notranslate"><span class="pre">MLPRegressor.set_params()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MLPLSS"><code class="docutils literal notranslate"><span class="pre">MLPLSS</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MLPLSS.build_model"><code class="docutils literal notranslate"><span class="pre">MLPLSS.build_model()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MLPLSS.evaluate"><code class="docutils literal notranslate"><span class="pre">MLPLSS.evaluate()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MLPLSS.fit"><code class="docutils literal notranslate"><span class="pre">MLPLSS.fit()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MLPLSS.get_default_metrics"><code class="docutils literal notranslate"><span class="pre">MLPLSS.get_default_metrics()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MLPLSS.get_number_of_params"><code class="docutils literal notranslate"><span class="pre">MLPLSS.get_number_of_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MLPLSS.get_params"><code class="docutils literal notranslate"><span class="pre">MLPLSS.get_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MLPLSS.optimize_hparams"><code class="docutils literal notranslate"><span class="pre">MLPLSS.optimize_hparams()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MLPLSS.predict"><code class="docutils literal notranslate"><span class="pre">MLPLSS.predict()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MLPLSS.score"><code class="docutils literal notranslate"><span class="pre">MLPLSS.score()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MLPLSS.set_params"><code class="docutils literal notranslate"><span class="pre">MLPLSS.set_params()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabTransformerClassifier"><code class="docutils literal notranslate"><span class="pre">TabTransformerClassifier</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabTransformerClassifier.build_model"><code class="docutils literal notranslate"><span class="pre">TabTransformerClassifier.build_model()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabTransformerClassifier.evaluate"><code class="docutils literal notranslate"><span class="pre">TabTransformerClassifier.evaluate()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabTransformerClassifier.fit"><code class="docutils literal notranslate"><span class="pre">TabTransformerClassifier.fit()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabTransformerClassifier.get_number_of_params"><code class="docutils literal notranslate"><span class="pre">TabTransformerClassifier.get_number_of_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabTransformerClassifier.get_params"><code class="docutils literal notranslate"><span class="pre">TabTransformerClassifier.get_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabTransformerClassifier.optimize_hparams"><code class="docutils literal notranslate"><span class="pre">TabTransformerClassifier.optimize_hparams()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabTransformerClassifier.predict"><code class="docutils literal notranslate"><span class="pre">TabTransformerClassifier.predict()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabTransformerClassifier.predict_proba"><code class="docutils literal notranslate"><span class="pre">TabTransformerClassifier.predict_proba()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabTransformerClassifier.score"><code class="docutils literal notranslate"><span class="pre">TabTransformerClassifier.score()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabTransformerClassifier.set_params"><code class="docutils literal notranslate"><span class="pre">TabTransformerClassifier.set_params()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabTransformerRegressor"><code class="docutils literal notranslate"><span class="pre">TabTransformerRegressor</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabTransformerRegressor.build_model"><code class="docutils literal notranslate"><span class="pre">TabTransformerRegressor.build_model()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabTransformerRegressor.evaluate"><code class="docutils literal notranslate"><span class="pre">TabTransformerRegressor.evaluate()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabTransformerRegressor.fit"><code class="docutils literal notranslate"><span class="pre">TabTransformerRegressor.fit()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabTransformerRegressor.get_number_of_params"><code class="docutils literal notranslate"><span class="pre">TabTransformerRegressor.get_number_of_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabTransformerRegressor.get_params"><code class="docutils literal notranslate"><span class="pre">TabTransformerRegressor.get_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabTransformerRegressor.optimize_hparams"><code class="docutils literal notranslate"><span class="pre">TabTransformerRegressor.optimize_hparams()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabTransformerRegressor.predict"><code class="docutils literal notranslate"><span class="pre">TabTransformerRegressor.predict()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabTransformerRegressor.score"><code class="docutils literal notranslate"><span class="pre">TabTransformerRegressor.score()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabTransformerRegressor.set_params"><code class="docutils literal notranslate"><span class="pre">TabTransformerRegressor.set_params()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabTransformerLSS"><code class="docutils literal notranslate"><span class="pre">TabTransformerLSS</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabTransformerLSS.build_model"><code class="docutils literal notranslate"><span class="pre">TabTransformerLSS.build_model()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabTransformerLSS.evaluate"><code class="docutils literal notranslate"><span class="pre">TabTransformerLSS.evaluate()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabTransformerLSS.fit"><code class="docutils literal notranslate"><span class="pre">TabTransformerLSS.fit()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabTransformerLSS.get_default_metrics"><code class="docutils literal notranslate"><span class="pre">TabTransformerLSS.get_default_metrics()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabTransformerLSS.get_number_of_params"><code class="docutils literal notranslate"><span class="pre">TabTransformerLSS.get_number_of_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabTransformerLSS.get_params"><code class="docutils literal notranslate"><span class="pre">TabTransformerLSS.get_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabTransformerLSS.optimize_hparams"><code class="docutils literal notranslate"><span class="pre">TabTransformerLSS.optimize_hparams()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabTransformerLSS.predict"><code class="docutils literal notranslate"><span class="pre">TabTransformerLSS.predict()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabTransformerLSS.score"><code class="docutils literal notranslate"><span class="pre">TabTransformerLSS.score()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabTransformerLSS.set_params"><code class="docutils literal notranslate"><span class="pre">TabTransformerLSS.set_params()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.ResNetClassifier"><code class="docutils literal notranslate"><span class="pre">ResNetClassifier</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.ResNetClassifier.build_model"><code class="docutils literal notranslate"><span class="pre">ResNetClassifier.build_model()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.ResNetClassifier.evaluate"><code class="docutils literal notranslate"><span class="pre">ResNetClassifier.evaluate()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.ResNetClassifier.fit"><code class="docutils literal notranslate"><span class="pre">ResNetClassifier.fit()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.ResNetClassifier.get_number_of_params"><code class="docutils literal notranslate"><span class="pre">ResNetClassifier.get_number_of_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.ResNetClassifier.get_params"><code class="docutils literal notranslate"><span class="pre">ResNetClassifier.get_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.ResNetClassifier.optimize_hparams"><code class="docutils literal notranslate"><span class="pre">ResNetClassifier.optimize_hparams()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.ResNetClassifier.predict"><code class="docutils literal notranslate"><span class="pre">ResNetClassifier.predict()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.ResNetClassifier.predict_proba"><code class="docutils literal notranslate"><span class="pre">ResNetClassifier.predict_proba()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.ResNetClassifier.score"><code class="docutils literal notranslate"><span class="pre">ResNetClassifier.score()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.ResNetClassifier.set_params"><code class="docutils literal notranslate"><span class="pre">ResNetClassifier.set_params()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.ResNetRegressor"><code class="docutils literal notranslate"><span class="pre">ResNetRegressor</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.ResNetRegressor.build_model"><code class="docutils literal notranslate"><span class="pre">ResNetRegressor.build_model()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.ResNetRegressor.evaluate"><code class="docutils literal notranslate"><span class="pre">ResNetRegressor.evaluate()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.ResNetRegressor.fit"><code class="docutils literal notranslate"><span class="pre">ResNetRegressor.fit()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.ResNetRegressor.get_number_of_params"><code class="docutils literal notranslate"><span class="pre">ResNetRegressor.get_number_of_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.ResNetRegressor.get_params"><code class="docutils literal notranslate"><span class="pre">ResNetRegressor.get_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.ResNetRegressor.optimize_hparams"><code class="docutils literal notranslate"><span class="pre">ResNetRegressor.optimize_hparams()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.ResNetRegressor.predict"><code class="docutils literal notranslate"><span class="pre">ResNetRegressor.predict()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.ResNetRegressor.score"><code class="docutils literal notranslate"><span class="pre">ResNetRegressor.score()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.ResNetRegressor.set_params"><code class="docutils literal notranslate"><span class="pre">ResNetRegressor.set_params()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.ResNetLSS"><code class="docutils literal notranslate"><span class="pre">ResNetLSS</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.ResNetLSS.build_model"><code class="docutils literal notranslate"><span class="pre">ResNetLSS.build_model()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.ResNetLSS.evaluate"><code class="docutils literal notranslate"><span class="pre">ResNetLSS.evaluate()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.ResNetLSS.fit"><code class="docutils literal notranslate"><span class="pre">ResNetLSS.fit()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.ResNetLSS.get_default_metrics"><code class="docutils literal notranslate"><span class="pre">ResNetLSS.get_default_metrics()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.ResNetLSS.get_number_of_params"><code class="docutils literal notranslate"><span class="pre">ResNetLSS.get_number_of_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.ResNetLSS.get_params"><code class="docutils literal notranslate"><span class="pre">ResNetLSS.get_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.ResNetLSS.optimize_hparams"><code class="docutils literal notranslate"><span class="pre">ResNetLSS.optimize_hparams()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.ResNetLSS.predict"><code class="docutils literal notranslate"><span class="pre">ResNetLSS.predict()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.ResNetLSS.score"><code class="docutils literal notranslate"><span class="pre">ResNetLSS.score()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.ResNetLSS.set_params"><code class="docutils literal notranslate"><span class="pre">ResNetLSS.set_params()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambaTabClassifier"><code class="docutils literal notranslate"><span class="pre">MambaTabClassifier</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambaTabClassifier.build_model"><code class="docutils literal notranslate"><span class="pre">MambaTabClassifier.build_model()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambaTabClassifier.evaluate"><code class="docutils literal notranslate"><span class="pre">MambaTabClassifier.evaluate()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambaTabClassifier.fit"><code class="docutils literal notranslate"><span class="pre">MambaTabClassifier.fit()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambaTabClassifier.get_number_of_params"><code class="docutils literal notranslate"><span class="pre">MambaTabClassifier.get_number_of_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambaTabClassifier.get_params"><code class="docutils literal notranslate"><span class="pre">MambaTabClassifier.get_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambaTabClassifier.optimize_hparams"><code class="docutils literal notranslate"><span class="pre">MambaTabClassifier.optimize_hparams()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambaTabClassifier.predict"><code class="docutils literal notranslate"><span class="pre">MambaTabClassifier.predict()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambaTabClassifier.predict_proba"><code class="docutils literal notranslate"><span class="pre">MambaTabClassifier.predict_proba()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambaTabClassifier.score"><code class="docutils literal notranslate"><span class="pre">MambaTabClassifier.score()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambaTabClassifier.set_params"><code class="docutils literal notranslate"><span class="pre">MambaTabClassifier.set_params()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambaTabRegressor"><code class="docutils literal notranslate"><span class="pre">MambaTabRegressor</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambaTabRegressor.build_model"><code class="docutils literal notranslate"><span class="pre">MambaTabRegressor.build_model()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambaTabRegressor.evaluate"><code class="docutils literal notranslate"><span class="pre">MambaTabRegressor.evaluate()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambaTabRegressor.fit"><code class="docutils literal notranslate"><span class="pre">MambaTabRegressor.fit()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambaTabRegressor.get_number_of_params"><code class="docutils literal notranslate"><span class="pre">MambaTabRegressor.get_number_of_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambaTabRegressor.get_params"><code class="docutils literal notranslate"><span class="pre">MambaTabRegressor.get_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambaTabRegressor.optimize_hparams"><code class="docutils literal notranslate"><span class="pre">MambaTabRegressor.optimize_hparams()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambaTabRegressor.predict"><code class="docutils literal notranslate"><span class="pre">MambaTabRegressor.predict()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambaTabRegressor.score"><code class="docutils literal notranslate"><span class="pre">MambaTabRegressor.score()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambaTabRegressor.set_params"><code class="docutils literal notranslate"><span class="pre">MambaTabRegressor.set_params()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambaTabLSS"><code class="docutils literal notranslate"><span class="pre">MambaTabLSS</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambaTabLSS.build_model"><code class="docutils literal notranslate"><span class="pre">MambaTabLSS.build_model()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambaTabLSS.evaluate"><code class="docutils literal notranslate"><span class="pre">MambaTabLSS.evaluate()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambaTabLSS.fit"><code class="docutils literal notranslate"><span class="pre">MambaTabLSS.fit()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambaTabLSS.get_default_metrics"><code class="docutils literal notranslate"><span class="pre">MambaTabLSS.get_default_metrics()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambaTabLSS.get_number_of_params"><code class="docutils literal notranslate"><span class="pre">MambaTabLSS.get_number_of_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambaTabLSS.get_params"><code class="docutils literal notranslate"><span class="pre">MambaTabLSS.get_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambaTabLSS.optimize_hparams"><code class="docutils literal notranslate"><span class="pre">MambaTabLSS.optimize_hparams()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambaTabLSS.predict"><code class="docutils literal notranslate"><span class="pre">MambaTabLSS.predict()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambaTabLSS.score"><code class="docutils literal notranslate"><span class="pre">MambaTabLSS.score()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambaTabLSS.set_params"><code class="docutils literal notranslate"><span class="pre">MambaTabLSS.set_params()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambAttentionClassifier"><code class="docutils literal notranslate"><span class="pre">MambAttentionClassifier</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambAttentionClassifier.build_model"><code class="docutils literal notranslate"><span class="pre">MambAttentionClassifier.build_model()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambAttentionClassifier.evaluate"><code class="docutils literal notranslate"><span class="pre">MambAttentionClassifier.evaluate()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambAttentionClassifier.fit"><code class="docutils literal notranslate"><span class="pre">MambAttentionClassifier.fit()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambAttentionClassifier.get_number_of_params"><code class="docutils literal notranslate"><span class="pre">MambAttentionClassifier.get_number_of_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambAttentionClassifier.get_params"><code class="docutils literal notranslate"><span class="pre">MambAttentionClassifier.get_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambAttentionClassifier.optimize_hparams"><code class="docutils literal notranslate"><span class="pre">MambAttentionClassifier.optimize_hparams()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambAttentionClassifier.predict"><code class="docutils literal notranslate"><span class="pre">MambAttentionClassifier.predict()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambAttentionClassifier.predict_proba"><code class="docutils literal notranslate"><span class="pre">MambAttentionClassifier.predict_proba()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambAttentionClassifier.score"><code class="docutils literal notranslate"><span class="pre">MambAttentionClassifier.score()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambAttentionClassifier.set_params"><code class="docutils literal notranslate"><span class="pre">MambAttentionClassifier.set_params()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambAttentionRegressor"><code class="docutils literal notranslate"><span class="pre">MambAttentionRegressor</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambAttentionRegressor.build_model"><code class="docutils literal notranslate"><span class="pre">MambAttentionRegressor.build_model()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambAttentionRegressor.evaluate"><code class="docutils literal notranslate"><span class="pre">MambAttentionRegressor.evaluate()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambAttentionRegressor.fit"><code class="docutils literal notranslate"><span class="pre">MambAttentionRegressor.fit()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambAttentionRegressor.get_number_of_params"><code class="docutils literal notranslate"><span class="pre">MambAttentionRegressor.get_number_of_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambAttentionRegressor.get_params"><code class="docutils literal notranslate"><span class="pre">MambAttentionRegressor.get_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambAttentionRegressor.optimize_hparams"><code class="docutils literal notranslate"><span class="pre">MambAttentionRegressor.optimize_hparams()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambAttentionRegressor.predict"><code class="docutils literal notranslate"><span class="pre">MambAttentionRegressor.predict()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambAttentionRegressor.score"><code class="docutils literal notranslate"><span class="pre">MambAttentionRegressor.score()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambAttentionRegressor.set_params"><code class="docutils literal notranslate"><span class="pre">MambAttentionRegressor.set_params()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambAttentionLSS"><code class="docutils literal notranslate"><span class="pre">MambAttentionLSS</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambAttentionLSS.build_model"><code class="docutils literal notranslate"><span class="pre">MambAttentionLSS.build_model()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambAttentionLSS.evaluate"><code class="docutils literal notranslate"><span class="pre">MambAttentionLSS.evaluate()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambAttentionLSS.fit"><code class="docutils literal notranslate"><span class="pre">MambAttentionLSS.fit()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambAttentionLSS.get_default_metrics"><code class="docutils literal notranslate"><span class="pre">MambAttentionLSS.get_default_metrics()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambAttentionLSS.get_number_of_params"><code class="docutils literal notranslate"><span class="pre">MambAttentionLSS.get_number_of_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambAttentionLSS.get_params"><code class="docutils literal notranslate"><span class="pre">MambAttentionLSS.get_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambAttentionLSS.optimize_hparams"><code class="docutils literal notranslate"><span class="pre">MambAttentionLSS.optimize_hparams()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambAttentionLSS.predict"><code class="docutils literal notranslate"><span class="pre">MambAttentionLSS.predict()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambAttentionLSS.score"><code class="docutils literal notranslate"><span class="pre">MambAttentionLSS.score()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambAttentionLSS.set_params"><code class="docutils literal notranslate"><span class="pre">MambAttentionLSS.set_params()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabulaRNNClassifier"><code class="docutils literal notranslate"><span class="pre">TabulaRNNClassifier</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabulaRNNClassifier.build_model"><code class="docutils literal notranslate"><span class="pre">TabulaRNNClassifier.build_model()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabulaRNNClassifier.evaluate"><code class="docutils literal notranslate"><span class="pre">TabulaRNNClassifier.evaluate()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabulaRNNClassifier.fit"><code class="docutils literal notranslate"><span class="pre">TabulaRNNClassifier.fit()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabulaRNNClassifier.get_number_of_params"><code class="docutils literal notranslate"><span class="pre">TabulaRNNClassifier.get_number_of_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabulaRNNClassifier.get_params"><code class="docutils literal notranslate"><span class="pre">TabulaRNNClassifier.get_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabulaRNNClassifier.optimize_hparams"><code class="docutils literal notranslate"><span class="pre">TabulaRNNClassifier.optimize_hparams()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabulaRNNClassifier.predict"><code class="docutils literal notranslate"><span class="pre">TabulaRNNClassifier.predict()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabulaRNNClassifier.predict_proba"><code class="docutils literal notranslate"><span class="pre">TabulaRNNClassifier.predict_proba()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabulaRNNClassifier.score"><code class="docutils literal notranslate"><span class="pre">TabulaRNNClassifier.score()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabulaRNNClassifier.set_params"><code class="docutils literal notranslate"><span class="pre">TabulaRNNClassifier.set_params()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabulaRNNRegressor"><code class="docutils literal notranslate"><span class="pre">TabulaRNNRegressor</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabulaRNNRegressor.build_model"><code class="docutils literal notranslate"><span class="pre">TabulaRNNRegressor.build_model()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabulaRNNRegressor.evaluate"><code class="docutils literal notranslate"><span class="pre">TabulaRNNRegressor.evaluate()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabulaRNNRegressor.fit"><code class="docutils literal notranslate"><span class="pre">TabulaRNNRegressor.fit()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabulaRNNRegressor.get_number_of_params"><code class="docutils literal notranslate"><span class="pre">TabulaRNNRegressor.get_number_of_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabulaRNNRegressor.get_params"><code class="docutils literal notranslate"><span class="pre">TabulaRNNRegressor.get_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabulaRNNRegressor.optimize_hparams"><code class="docutils literal notranslate"><span class="pre">TabulaRNNRegressor.optimize_hparams()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabulaRNNRegressor.predict"><code class="docutils literal notranslate"><span class="pre">TabulaRNNRegressor.predict()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabulaRNNRegressor.score"><code class="docutils literal notranslate"><span class="pre">TabulaRNNRegressor.score()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabulaRNNRegressor.set_params"><code class="docutils literal notranslate"><span class="pre">TabulaRNNRegressor.set_params()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabulaRNNLSS"><code class="docutils literal notranslate"><span class="pre">TabulaRNNLSS</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabulaRNNLSS.build_model"><code class="docutils literal notranslate"><span class="pre">TabulaRNNLSS.build_model()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabulaRNNLSS.evaluate"><code class="docutils literal notranslate"><span class="pre">TabulaRNNLSS.evaluate()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabulaRNNLSS.fit"><code class="docutils literal notranslate"><span class="pre">TabulaRNNLSS.fit()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabulaRNNLSS.get_default_metrics"><code class="docutils literal notranslate"><span class="pre">TabulaRNNLSS.get_default_metrics()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabulaRNNLSS.get_number_of_params"><code class="docutils literal notranslate"><span class="pre">TabulaRNNLSS.get_number_of_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabulaRNNLSS.get_params"><code class="docutils literal notranslate"><span class="pre">TabulaRNNLSS.get_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabulaRNNLSS.optimize_hparams"><code class="docutils literal notranslate"><span class="pre">TabulaRNNLSS.optimize_hparams()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabulaRNNLSS.predict"><code class="docutils literal notranslate"><span class="pre">TabulaRNNLSS.predict()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabulaRNNLSS.score"><code class="docutils literal notranslate"><span class="pre">TabulaRNNLSS.score()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabulaRNNLSS.set_params"><code class="docutils literal notranslate"><span class="pre">TabulaRNNLSS.set_params()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabMClassifier"><code class="docutils literal notranslate"><span class="pre">TabMClassifier</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabMClassifier.build_model"><code class="docutils literal notranslate"><span class="pre">TabMClassifier.build_model()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabMClassifier.evaluate"><code class="docutils literal notranslate"><span class="pre">TabMClassifier.evaluate()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabMClassifier.fit"><code class="docutils literal notranslate"><span class="pre">TabMClassifier.fit()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabMClassifier.get_number_of_params"><code class="docutils literal notranslate"><span class="pre">TabMClassifier.get_number_of_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabMClassifier.get_params"><code class="docutils literal notranslate"><span class="pre">TabMClassifier.get_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabMClassifier.optimize_hparams"><code class="docutils literal notranslate"><span class="pre">TabMClassifier.optimize_hparams()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabMClassifier.predict"><code class="docutils literal notranslate"><span class="pre">TabMClassifier.predict()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabMClassifier.predict_proba"><code class="docutils literal notranslate"><span class="pre">TabMClassifier.predict_proba()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabMClassifier.score"><code class="docutils literal notranslate"><span class="pre">TabMClassifier.score()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabMClassifier.set_params"><code class="docutils literal notranslate"><span class="pre">TabMClassifier.set_params()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabMRegressor"><code class="docutils literal notranslate"><span class="pre">TabMRegressor</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabMRegressor.build_model"><code class="docutils literal notranslate"><span class="pre">TabMRegressor.build_model()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabMRegressor.evaluate"><code class="docutils literal notranslate"><span class="pre">TabMRegressor.evaluate()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabMRegressor.fit"><code class="docutils literal notranslate"><span class="pre">TabMRegressor.fit()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabMRegressor.get_number_of_params"><code class="docutils literal notranslate"><span class="pre">TabMRegressor.get_number_of_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabMRegressor.get_params"><code class="docutils literal notranslate"><span class="pre">TabMRegressor.get_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabMRegressor.optimize_hparams"><code class="docutils literal notranslate"><span class="pre">TabMRegressor.optimize_hparams()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabMRegressor.predict"><code class="docutils literal notranslate"><span class="pre">TabMRegressor.predict()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabMRegressor.score"><code class="docutils literal notranslate"><span class="pre">TabMRegressor.score()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabMRegressor.set_params"><code class="docutils literal notranslate"><span class="pre">TabMRegressor.set_params()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabMLSS"><code class="docutils literal notranslate"><span class="pre">TabMLSS</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabMLSS.build_model"><code class="docutils literal notranslate"><span class="pre">TabMLSS.build_model()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabMLSS.evaluate"><code class="docutils literal notranslate"><span class="pre">TabMLSS.evaluate()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabMLSS.fit"><code class="docutils literal notranslate"><span class="pre">TabMLSS.fit()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabMLSS.get_default_metrics"><code class="docutils literal notranslate"><span class="pre">TabMLSS.get_default_metrics()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabMLSS.get_number_of_params"><code class="docutils literal notranslate"><span class="pre">TabMLSS.get_number_of_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabMLSS.get_params"><code class="docutils literal notranslate"><span class="pre">TabMLSS.get_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabMLSS.optimize_hparams"><code class="docutils literal notranslate"><span class="pre">TabMLSS.optimize_hparams()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabMLSS.predict"><code class="docutils literal notranslate"><span class="pre">TabMLSS.predict()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabMLSS.score"><code class="docutils literal notranslate"><span class="pre">TabMLSS.score()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabMLSS.set_params"><code class="docutils literal notranslate"><span class="pre">TabMLSS.set_params()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NODEClassifier"><code class="docutils literal notranslate"><span class="pre">NODEClassifier</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NODEClassifier.build_model"><code class="docutils literal notranslate"><span class="pre">NODEClassifier.build_model()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NODEClassifier.evaluate"><code class="docutils literal notranslate"><span class="pre">NODEClassifier.evaluate()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NODEClassifier.fit"><code class="docutils literal notranslate"><span class="pre">NODEClassifier.fit()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NODEClassifier.get_number_of_params"><code class="docutils literal notranslate"><span class="pre">NODEClassifier.get_number_of_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NODEClassifier.get_params"><code class="docutils literal notranslate"><span class="pre">NODEClassifier.get_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NODEClassifier.optimize_hparams"><code class="docutils literal notranslate"><span class="pre">NODEClassifier.optimize_hparams()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NODEClassifier.predict"><code class="docutils literal notranslate"><span class="pre">NODEClassifier.predict()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NODEClassifier.predict_proba"><code class="docutils literal notranslate"><span class="pre">NODEClassifier.predict_proba()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NODEClassifier.score"><code class="docutils literal notranslate"><span class="pre">NODEClassifier.score()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NODEClassifier.set_params"><code class="docutils literal notranslate"><span class="pre">NODEClassifier.set_params()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NODERegressor"><code class="docutils literal notranslate"><span class="pre">NODERegressor</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NODERegressor.build_model"><code class="docutils literal notranslate"><span class="pre">NODERegressor.build_model()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NODERegressor.evaluate"><code class="docutils literal notranslate"><span class="pre">NODERegressor.evaluate()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NODERegressor.fit"><code class="docutils literal notranslate"><span class="pre">NODERegressor.fit()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NODERegressor.get_number_of_params"><code class="docutils literal notranslate"><span class="pre">NODERegressor.get_number_of_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NODERegressor.get_params"><code class="docutils literal notranslate"><span class="pre">NODERegressor.get_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NODERegressor.optimize_hparams"><code class="docutils literal notranslate"><span class="pre">NODERegressor.optimize_hparams()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NODERegressor.predict"><code class="docutils literal notranslate"><span class="pre">NODERegressor.predict()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NODERegressor.score"><code class="docutils literal notranslate"><span class="pre">NODERegressor.score()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NODERegressor.set_params"><code class="docutils literal notranslate"><span class="pre">NODERegressor.set_params()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NODELSS"><code class="docutils literal notranslate"><span class="pre">NODELSS</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NODELSS.build_model"><code class="docutils literal notranslate"><span class="pre">NODELSS.build_model()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NODELSS.evaluate"><code class="docutils literal notranslate"><span class="pre">NODELSS.evaluate()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NODELSS.fit"><code class="docutils literal notranslate"><span class="pre">NODELSS.fit()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NODELSS.get_default_metrics"><code class="docutils literal notranslate"><span class="pre">NODELSS.get_default_metrics()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NODELSS.get_number_of_params"><code class="docutils literal notranslate"><span class="pre">NODELSS.get_number_of_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NODELSS.get_params"><code class="docutils literal notranslate"><span class="pre">NODELSS.get_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NODELSS.optimize_hparams"><code class="docutils literal notranslate"><span class="pre">NODELSS.optimize_hparams()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NODELSS.predict"><code class="docutils literal notranslate"><span class="pre">NODELSS.predict()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NODELSS.score"><code class="docutils literal notranslate"><span class="pre">NODELSS.score()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NODELSS.set_params"><code class="docutils literal notranslate"><span class="pre">NODELSS.set_params()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NDTFClassifier"><code class="docutils literal notranslate"><span class="pre">NDTFClassifier</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NDTFClassifier.build_model"><code class="docutils literal notranslate"><span class="pre">NDTFClassifier.build_model()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NDTFClassifier.evaluate"><code class="docutils literal notranslate"><span class="pre">NDTFClassifier.evaluate()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NDTFClassifier.fit"><code class="docutils literal notranslate"><span class="pre">NDTFClassifier.fit()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NDTFClassifier.get_number_of_params"><code class="docutils literal notranslate"><span class="pre">NDTFClassifier.get_number_of_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NDTFClassifier.get_params"><code class="docutils literal notranslate"><span class="pre">NDTFClassifier.get_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NDTFClassifier.optimize_hparams"><code class="docutils literal notranslate"><span class="pre">NDTFClassifier.optimize_hparams()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NDTFClassifier.predict"><code class="docutils literal notranslate"><span class="pre">NDTFClassifier.predict()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NDTFClassifier.predict_proba"><code class="docutils literal notranslate"><span class="pre">NDTFClassifier.predict_proba()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NDTFClassifier.score"><code class="docutils literal notranslate"><span class="pre">NDTFClassifier.score()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NDTFClassifier.set_params"><code class="docutils literal notranslate"><span class="pre">NDTFClassifier.set_params()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NDTFRegressor"><code class="docutils literal notranslate"><span class="pre">NDTFRegressor</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NDTFRegressor.build_model"><code class="docutils literal notranslate"><span class="pre">NDTFRegressor.build_model()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NDTFRegressor.evaluate"><code class="docutils literal notranslate"><span class="pre">NDTFRegressor.evaluate()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NDTFRegressor.fit"><code class="docutils literal notranslate"><span class="pre">NDTFRegressor.fit()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NDTFRegressor.get_number_of_params"><code class="docutils literal notranslate"><span class="pre">NDTFRegressor.get_number_of_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NDTFRegressor.get_params"><code class="docutils literal notranslate"><span class="pre">NDTFRegressor.get_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NDTFRegressor.optimize_hparams"><code class="docutils literal notranslate"><span class="pre">NDTFRegressor.optimize_hparams()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NDTFRegressor.predict"><code class="docutils literal notranslate"><span class="pre">NDTFRegressor.predict()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NDTFRegressor.score"><code class="docutils literal notranslate"><span class="pre">NDTFRegressor.score()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NDTFRegressor.set_params"><code class="docutils literal notranslate"><span class="pre">NDTFRegressor.set_params()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NDTFLSS"><code class="docutils literal notranslate"><span class="pre">NDTFLSS</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NDTFLSS.build_model"><code class="docutils literal notranslate"><span class="pre">NDTFLSS.build_model()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NDTFLSS.evaluate"><code class="docutils literal notranslate"><span class="pre">NDTFLSS.evaluate()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NDTFLSS.fit"><code class="docutils literal notranslate"><span class="pre">NDTFLSS.fit()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NDTFLSS.get_default_metrics"><code class="docutils literal notranslate"><span class="pre">NDTFLSS.get_default_metrics()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NDTFLSS.get_number_of_params"><code class="docutils literal notranslate"><span class="pre">NDTFLSS.get_number_of_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NDTFLSS.get_params"><code class="docutils literal notranslate"><span class="pre">NDTFLSS.get_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NDTFLSS.optimize_hparams"><code class="docutils literal notranslate"><span class="pre">NDTFLSS.optimize_hparams()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NDTFLSS.predict"><code class="docutils literal notranslate"><span class="pre">NDTFLSS.predict()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NDTFLSS.score"><code class="docutils literal notranslate"><span class="pre">NDTFLSS.score()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NDTFLSS.set_params"><code class="docutils literal notranslate"><span class="pre">NDTFLSS.set_params()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.SklearnBaseClassifier"><code class="docutils literal notranslate"><span class="pre">SklearnBaseClassifier</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.SklearnBaseClassifier.build_model"><code class="docutils literal notranslate"><span class="pre">SklearnBaseClassifier.build_model()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.SklearnBaseClassifier.evaluate"><code class="docutils literal notranslate"><span class="pre">SklearnBaseClassifier.evaluate()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.SklearnBaseClassifier.fit"><code class="docutils literal notranslate"><span class="pre">SklearnBaseClassifier.fit()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.SklearnBaseClassifier.get_number_of_params"><code class="docutils literal notranslate"><span class="pre">SklearnBaseClassifier.get_number_of_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.SklearnBaseClassifier.get_params"><code class="docutils literal notranslate"><span class="pre">SklearnBaseClassifier.get_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.SklearnBaseClassifier.optimize_hparams"><code class="docutils literal notranslate"><span class="pre">SklearnBaseClassifier.optimize_hparams()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.SklearnBaseClassifier.predict"><code class="docutils literal notranslate"><span class="pre">SklearnBaseClassifier.predict()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.SklearnBaseClassifier.predict_proba"><code class="docutils literal notranslate"><span class="pre">SklearnBaseClassifier.predict_proba()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.SklearnBaseClassifier.score"><code class="docutils literal notranslate"><span class="pre">SklearnBaseClassifier.score()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.SklearnBaseClassifier.set_params"><code class="docutils literal notranslate"><span class="pre">SklearnBaseClassifier.set_params()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.SklearnBaseLSS"><code class="docutils literal notranslate"><span class="pre">SklearnBaseLSS</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.SklearnBaseLSS.build_model"><code class="docutils literal notranslate"><span class="pre">SklearnBaseLSS.build_model()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.SklearnBaseLSS.evaluate"><code class="docutils literal notranslate"><span class="pre">SklearnBaseLSS.evaluate()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.SklearnBaseLSS.fit"><code class="docutils literal notranslate"><span class="pre">SklearnBaseLSS.fit()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.SklearnBaseLSS.get_default_metrics"><code class="docutils literal notranslate"><span class="pre">SklearnBaseLSS.get_default_metrics()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.SklearnBaseLSS.get_number_of_params"><code class="docutils literal notranslate"><span class="pre">SklearnBaseLSS.get_number_of_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.SklearnBaseLSS.get_params"><code class="docutils literal notranslate"><span class="pre">SklearnBaseLSS.get_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.SklearnBaseLSS.optimize_hparams"><code class="docutils literal notranslate"><span class="pre">SklearnBaseLSS.optimize_hparams()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.SklearnBaseLSS.predict"><code class="docutils literal notranslate"><span class="pre">SklearnBaseLSS.predict()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.SklearnBaseLSS.score"><code class="docutils literal notranslate"><span class="pre">SklearnBaseLSS.score()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.SklearnBaseLSS.set_params"><code class="docutils literal notranslate"><span class="pre">SklearnBaseLSS.set_params()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.SklearnBaseRegressor"><code class="docutils literal notranslate"><span class="pre">SklearnBaseRegressor</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.SklearnBaseRegressor.build_model"><code class="docutils literal notranslate"><span class="pre">SklearnBaseRegressor.build_model()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.SklearnBaseRegressor.evaluate"><code class="docutils literal notranslate"><span class="pre">SklearnBaseRegressor.evaluate()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.SklearnBaseRegressor.fit"><code class="docutils literal notranslate"><span class="pre">SklearnBaseRegressor.fit()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.SklearnBaseRegressor.get_number_of_params"><code class="docutils literal notranslate"><span class="pre">SklearnBaseRegressor.get_number_of_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.SklearnBaseRegressor.get_params"><code class="docutils literal notranslate"><span class="pre">SklearnBaseRegressor.get_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.SklearnBaseRegressor.optimize_hparams"><code class="docutils literal notranslate"><span class="pre">SklearnBaseRegressor.optimize_hparams()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.SklearnBaseRegressor.predict"><code class="docutils literal notranslate"><span class="pre">SklearnBaseRegressor.predict()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.SklearnBaseRegressor.score"><code class="docutils literal notranslate"><span class="pre">SklearnBaseRegressor.score()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.SklearnBaseRegressor.set_params"><code class="docutils literal notranslate"><span class="pre">SklearnBaseRegressor.set_params()</span></code></a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="mambular-models">
<h1>mambular.models<a class="headerlink" href="#mambular-models" title="Permalink to this heading">#</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="mambular.models.MambularClassifier">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mambular.models.</span></span><span class="sig-name descname"><span class="pre">MambularClassifier</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/mambular/models/mambular.html#MambularClassifier"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mambular.models.MambularClassifier" title="Permalink to this definition">#</a></dt>
<dd><dl class="simple">
<dt>Mambular classifier. This class extends the SklearnBaseClassifier class and uses the Mambular model</dt><dd><p>with the default Mambular configuration.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The parameters for this class include the attributes from the config
dataclass as well as preprocessing arguments handled by the base class.</p>
<p>Configuration class for the Default Mambular model with predefined hyperparameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lr</strong> (<em>float</em><em>, </em><em>default=1e-04</em>) – Learning rate for the optimizer.</p></li>
<li><p><strong>lr_patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement after which the learning rate will be reduced.</p></li>
<li><p><strong>weight_decay</strong> (<em>float</em><em>, </em><em>default=1e-06</em>) – Weight decay (L2 penalty) for the optimizer.</p></li>
<li><p><strong>lr_factor</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Factor by which the learning rate will be reduced.</p></li>
<li><p><strong>d_model</strong> (<em>int</em><em>, </em><em>default=64</em>) – Dimensionality of the model.</p></li>
<li><p><strong>n_layers</strong> (<em>int</em><em>, </em><em>default=4</em>) – Number of layers in the model.</p></li>
<li><p><strong>expand_factor</strong> (<em>int</em><em>, </em><em>default=2</em>) – Expansion factor for the feed-forward layers.</p></li>
<li><p><strong>bias</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use bias in the linear layers.</p></li>
<li><p><strong>dropout</strong> (<em>float</em><em>, </em><em>default=0.0</em>) – Dropout rate for regularization.</p></li>
<li><p><strong>dt_rank</strong> (<em>str</em><em>, </em><em>default=&quot;auto&quot;</em>) – Rank of the decision tree used in the model.</p></li>
<li><p><strong>d_state</strong> (<em>int</em><em>, </em><em>default=128</em>) – Dimensionality of the state in recurrent layers.</p></li>
<li><p><strong>dt_scale</strong> (<em>float</em><em>, </em><em>default=1.0</em>) – Scaling factor for decision tree parameters.</p></li>
<li><p><strong>dt_init</strong> (<em>str</em><em>, </em><em>default=&quot;random&quot;</em>) – Initialization method for decision tree parameters.</p></li>
<li><p><strong>dt_max</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Maximum value for decision tree initialization.</p></li>
<li><p><strong>dt_min</strong> (<em>float</em><em>, </em><em>default=1e-04</em>) – Minimum value for decision tree initialization.</p></li>
<li><p><strong>dt_init_floor</strong> (<em>float</em><em>, </em><em>default=1e-04</em>) – Floor value for decision tree initialization.</p></li>
<li><p><strong>norm</strong> (<em>str</em><em>, </em><em>default=&quot;RMSNorm&quot;</em>) – Type of normalization used (‘RMSNorm’, etc.).</p></li>
<li><p><strong>activation</strong> (<em>callable</em><em>, </em><em>default=nn.SiLU</em><em>(</em><em>)</em>) – Activation function for the model.</p></li>
<li><p><strong>layer_norm_eps</strong> (<em>float</em><em>, </em><em>default=1e-05</em>) – Epsilon value for layer normalization.</p></li>
<li><p><strong>embedding_activation</strong> (<em>callable</em><em>, </em><em>default=nn.Identity</em><em>(</em><em>)</em>) – Activation function for embeddings.</p></li>
<li><p><strong>embedding_type</strong> (<em>str</em><em>, </em><em>default=&quot;linear&quot;</em>) – Type of embedding to use (‘linear’, etc.).</p></li>
<li><p><strong>embedding_bias</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use bias in the embedding layers.</p></li>
<li><p><strong>plr_lite</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use a lightweight version of Piecewise Linear Regression (PLR).</p></li>
<li><p><strong>n_frequencies</strong> (<em>int</em><em>, </em><em>default=48</em>) – Number of frequencies for PLR embeddings.</p></li>
<li><p><strong>frequencies_init_scale</strong> (<em>float</em><em>, </em><em>default=0.01</em>) – Initial scale for frequency parameters in embeddings.</p></li>
<li><p><strong>layer_norm_after_embedding</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to apply layer normalization after embedding layers.</p></li>
<li><p><strong>shuffle_embeddings</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to shuffle embeddings before being passed to Mamba layers.</p></li>
<li><p><strong>head_layer_sizes</strong> (<em>list</em><em>, </em><em>default=</em><em>(</em><em>)</em>) – Sizes of the layers in the model’s head.</p></li>
<li><p><strong>head_dropout</strong> (<em>float</em><em>, </em><em>default=0.5</em>) – Dropout rate for the head layers.</p></li>
<li><p><strong>head_skip_layers</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to skip layers in the head.</p></li>
<li><p><strong>head_activation</strong> (<em>callable</em><em>, </em><em>default=nn.SELU</em><em>(</em><em>)</em>) – Activation function for the head layers.</p></li>
<li><p><strong>head_use_batch_norm</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use batch normalization in the head layers.</p></li>
<li><p><strong>pooling_method</strong> (<em>str</em><em>, </em><em>default=&quot;avg&quot;</em>) – Pooling method to use (‘avg’, ‘max’, etc.).</p></li>
<li><p><strong>bidirectional</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to process data bidirectionally.</p></li>
<li><p><strong>use_learnable_interaction</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use learnable feature interactions before passing through Mamba blocks.</p></li>
<li><p><strong>use_cls</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to append a CLS token to the input sequences.</p></li>
<li><p><strong>use_pscan</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use PSCAN for the state-space model.</p></li>
<li><p><strong>mamba_version</strong> (<em>str</em><em>, </em><em>default=&quot;mamba-torch&quot;</em>) – Version of the Mamba model to use (‘mamba-torch’, ‘mamba1’, ‘mamba2’).</p></li>
<li><p><strong>n_bins</strong> (<em>int</em><em>, </em><em>default=50</em>) – The number of bins to use for numerical feature binning. This parameter is relevant
only if <code class="docutils literal notranslate"><span class="pre">numerical_preprocessing</span></code> is set to ‘binning’, ‘ple’ or ‘one-hot’.</p></li>
<li><p><strong>numerical_preprocessing</strong> (<em>str</em><em>, </em><em>default=&quot;ple&quot;</em>) – The preprocessing strategy for numerical features. Valid options are
‘ple’, ‘binning’, ‘one-hot’, ‘standardization’, ‘min-max’, ‘quantile’, ‘polynomial’,
‘splines’, ‘box-cox’, ‘yeo-johnson’ and None</p></li>
<li><p><strong>categorical_preprocessing</strong> (<em>str</em><em>, </em><em>default=&quot;int&quot;</em>) – The preprocessing strategy for categorical features. Valid options are
‘int’, ‘one-hot’, None</p></li>
<li><p><strong>use_decision_tree_bins</strong> (<em>bool</em><em>, </em><em>default=False</em>) – If True, uses decision tree regression/classification to determine
optimal bin edges for numerical feature binning. This parameter is
relevant only if <code class="docutils literal notranslate"><span class="pre">numerical_preprocessing</span></code> is set to ‘binning’ or ‘one-hot’.</p></li>
<li><p><strong>binning_strategy</strong> (<em>str</em><em>, </em><em>default=&quot;uniform&quot;</em>) – Defines the strategy for binning numerical features. Options include ‘uniform’,
‘quantile’, or other sklearn-compatible strategies.</p></li>
<li><p><strong>task</strong> (<em>str</em><em>, </em><em>default=&quot;regression&quot;</em>) – Indicates the type of machine learning task (‘regression’ or ‘classification’). This can
influence certain preprocessing behaviors, especially when using decision tree-based binning.</p></li>
<li><p><strong>cat_cutoff</strong> (<em>float</em><em> or </em><em>int</em><em>, </em><em>default=0.03</em>) – Indicates the cutoff after which integer values are treated as categorical.
If float, it’s treated as a percentage. If int, it’s the maximum number of
unique values for a column to be considered categorical.</p></li>
<li><p><strong>treat_all_integers_as_numerical</strong> (<em>bool</em><em>, </em><em>default=False</em>) – If True, all integer columns will be treated as numerical, regardless
of their unique value count or proportion.</p></li>
<li><p><strong>degree</strong> (<em>int</em><em>, </em><em>default=3</em>) – The degree of the polynomial features to be used in preprocessing.</p></li>
<li><p><strong>knots</strong> (<em>int</em><em>, </em><em>default=12</em>) – The number of knots to be used in spline transformations.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mambular.models</span> <span class="kn">import</span> <span class="n">MambularClassifier</span>
<span class="go">    &gt;&gt;&gt; model = MambularClassifier(d_model=64, n_layers=8)</span>
<span class="go">    &gt;&gt;&gt; model.fit(X_train, y_train)</span>
<span class="go">    &gt;&gt;&gt; preds = model.predict(X_test)</span>
<span class="go">    &gt;&gt;&gt; model.evaluate(X_test, y_test)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.MambularClassifier.build_model">
<span class="sig-name descname"><span class="pre">build_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">101</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_patience</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_decay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataloader_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.MambularClassifier.build_model" title="Permalink to this definition">#</a></dt>
<dd><p>Builds the model using the provided training data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The training input samples.</p></li>
<li><p><strong>y</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em>) – The target values (real numbers).</p></li>
<li><p><strong>val_size</strong> (<em>float</em><em>, </em><em>default=0.2</em>) – The proportion of the dataset to include in the validation split if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is None. Ignored if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>X_val</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em><em>, </em><em>optional</em>) – The validation input samples. If provided, <code class="docutils literal notranslate"><span class="pre">X</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> are not split and this data is used for validation.</p></li>
<li><p><strong>y_val</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em><em>, </em><em>optional</em>) – The validation target values. Required if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>random_state</strong> (<em>int</em><em>, </em><em>default=101</em>) – Controls the shuffling applied to the data before applying the split.</p></li>
<li><p><strong>batch_size</strong> (<em>int</em><em>, </em><em>default=64</em>) – Number of samples per gradient update.</p></li>
<li><p><strong>shuffle</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to shuffle the training data before each epoch.</p></li>
<li><p><strong>lr</strong> (<em>float</em><em>, </em><em>default=1e-3</em>) – Learning rate for the optimizer.</p></li>
<li><p><strong>lr_patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement on the validation loss to wait before reducing the learning rate.</p></li>
<li><p><strong>factor</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Factor by which the learning rate will be reduced.</p></li>
<li><p><strong>weight_decay</strong> (<em>float</em><em>, </em><em>default=0.025</em>) – Weight decay (L2 penalty) coefficient.</p></li>
<li><p><strong>dataloader_kwargs</strong> (<em>dict</em><em>, </em><em>default={}</em>) – The kwargs for the pytorch dataloader class.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – The built classifier.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.MambularClassifier.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.MambularClassifier.evaluate" title="Permalink to this definition">#</a></dt>
<dd><p>Evaluate the model on the given data using specified metrics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array-like</em><em> or </em><em>pd.DataFrame</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The input samples to predict.</p></li>
<li><p><strong>y_true</strong> (<em>array-like</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>)</em>) – The true class labels against which to evaluate the predictions.</p></li>
<li><p><strong>metrics</strong> (<em>dict</em>) – A dictionary where keys are metric names and values are tuples containing the metric function
and a boolean indicating whether the metric requires probability scores (True) or class labels (False).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>scores</strong> – A dictionary with metric names as keys and their corresponding scores as values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This method uses either the <code class="docutils literal notranslate"><span class="pre">predict</span></code> or <code class="docutils literal notranslate"><span class="pre">predict_proba</span></code> method depending on the metric requirements.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.MambularClassifier.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">101</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patience</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">15</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">monitor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'val_loss'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'min'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_patience</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_decay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checkpoint_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'model_checkpoints'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataloader_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rebuild</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">trainer_kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.MambularClassifier.fit" title="Permalink to this definition">#</a></dt>
<dd><p>Trains the classification model using the provided training data. Optionally, a separate validation set can be used.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The training input samples.</p></li>
<li><p><strong>y</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em>) – The target values (real numbers).</p></li>
<li><p><strong>val_size</strong> (<em>float</em><em>, </em><em>default=0.2</em>) – The proportion of the dataset to include in the validation split if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is None. Ignored if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>X_val</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em><em>, </em><em>optional</em>) – The validation input samples. If provided, <code class="docutils literal notranslate"><span class="pre">X</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> are not split and this data is used for validation.</p></li>
<li><p><strong>y_val</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em><em>, </em><em>optional</em>) – The validation target values. Required if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>max_epochs</strong> (<em>int</em><em>, </em><em>default=100</em>) – Maximum number of epochs for training.</p></li>
<li><p><strong>random_state</strong> (<em>int</em><em>, </em><em>default=101</em>) – Controls the shuffling applied to the data before applying the split.</p></li>
<li><p><strong>batch_size</strong> (<em>int</em><em>, </em><em>default=64</em>) – Number of samples per gradient update.</p></li>
<li><p><strong>shuffle</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to shuffle the training data before each epoch.</p></li>
<li><p><strong>patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement on the validation loss to wait before early stopping.</p></li>
<li><p><strong>monitor</strong> (<em>str</em><em>, </em><em>default=&quot;val_loss&quot;</em>) – The metric to monitor for early stopping.</p></li>
<li><p><strong>mode</strong> (<em>str</em><em>, </em><em>default=&quot;min&quot;</em>) – Whether the monitored metric should be minimized (<code class="docutils literal notranslate"><span class="pre">min</span></code>) or maximized (<code class="docutils literal notranslate"><span class="pre">max</span></code>).</p></li>
<li><p><strong>lr</strong> (<em>float</em><em>, </em><em>default=1e-3</em>) – Learning rate for the optimizer.</p></li>
<li><p><strong>lr_patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement on the validation loss to wait before reducing the learning rate.</p></li>
<li><p><strong>factor</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Factor by which the learning rate will be reduced.</p></li>
<li><p><strong>weight_decay</strong> (<em>float</em><em>, </em><em>default=0.025</em>) – Weight decay (L2 penalty) coefficient.</p></li>
<li><p><strong>checkpoint_path</strong> (<em>str</em><em>, </em><em>default=&quot;model_checkpoints&quot;</em>) – Path where the checkpoints are being saved.</p></li>
<li><p><strong>dataloader_kwargs</strong> (<em>dict</em><em>, </em><em>default={}</em>) – The kwargs for the pytorch dataloader class.</p></li>
<li><p><strong>rebuild</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to rebuild the model when it already was built.</p></li>
<li><p><strong>**trainer_kwargs</strong> (<em>Additional keyword arguments for PyTorch Lightning's Trainer class.</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – The fitted classifier.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.MambularClassifier.get_number_of_params">
<span class="sig-name descname"><span class="pre">get_number_of_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">requires_grad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.MambularClassifier.get_number_of_params" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate the number of parameters in the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>requires_grad</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, only count the parameters that require gradients (trainable parameters).
If False, count all parameters. Default is True.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The total number of parameters in the model.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the model has not been built prior to calling this method.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.MambularClassifier.get_params">
<span class="sig-name descname"><span class="pre">get_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">deep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.MambularClassifier.get_params" title="Permalink to this definition">#</a></dt>
<dd><p>Get parameters for this estimator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>deep</strong> (<em>bool</em><em>, </em><em>default=True</em>) – If True, will return the parameters for this estimator and contained subobjects that are estimators.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>params</strong> – Parameter names mapped to their values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.MambularClassifier.optimize_hparams">
<span class="sig-name descname"><span class="pre">optimize_hparams</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prune_by_epoch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prune_epoch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fixed_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'cat_encoding':</span> <span class="pre">'int',</span> <span class="pre">'head_layer_size_length':</span> <span class="pre">0,</span> <span class="pre">'head_skip_layer':</span> <span class="pre">False,</span> <span class="pre">'head_skip_layers':</span> <span class="pre">False,</span> <span class="pre">'pooling_method':</span> <span class="pre">'avg',</span> <span class="pre">'use_cls':</span> <span class="pre">False}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">custom_search_space</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">optimize_kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.MambularClassifier.optimize_hparams" title="Permalink to this definition">#</a></dt>
<dd><p>Optimizes hyperparameters using Bayesian optimization with optional pruning.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array-like</em>) – Training data.</p></li>
<li><p><strong>y</strong> (<em>array-like</em>) – Training labels.</p></li>
<li><p><strong>X_val</strong> (<em>array-like</em><em>, </em><em>optional</em>) – Validation data and labels.</p></li>
<li><p><strong>y_val</strong> (<em>array-like</em><em>, </em><em>optional</em>) – Validation data and labels.</p></li>
<li><p><strong>time</strong> (<em>int</em>) – The number of optimization trials to run.</p></li>
<li><p><strong>max_epochs</strong> (<em>int</em>) – Maximum number of epochs for training.</p></li>
<li><p><strong>prune_by_epoch</strong> (<em>bool</em>) – Whether to prune based on a specific epoch (True) or the best validation loss (False).</p></li>
<li><p><strong>prune_epoch</strong> (<em>int</em>) – The specific epoch to prune by when prune_by_epoch is True.</p></li>
<li><p><strong>**optimize_kwargs</strong> (<em>dict</em>) – Additional keyword arguments passed to the fit method.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>best_hparams</strong> – Best hyperparameters found during optimization.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.MambularClassifier.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.MambularClassifier.predict" title="Permalink to this definition">#</a></dt>
<dd><p>Predicts target values for the given input samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>X</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The input samples for which to predict target values.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>predictions</strong> – The predicted target values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray, shape (n_samples,) or (n_samples, n_outputs)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.MambularClassifier.predict_proba">
<span class="sig-name descname"><span class="pre">predict_proba</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.MambularClassifier.predict_proba" title="Permalink to this definition">#</a></dt>
<dd><p>Predict class probabilities for the given input samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>X</strong> (<em>array-like</em><em> or </em><em>pd.DataFrame</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The input samples for which to predict class probabilities.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The method preprocesses the input data using the same preprocessor used during training,
sets the model to evaluation mode, and then performs inference to predict the class probabilities.
Softmax is applied to the logits to obtain probabilities, which are then converted from a PyTorch tensor
to a NumPy array before being returned.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">accuracy_score</span><span class="p">,</span> <span class="n">precision_score</span><span class="p">,</span> <span class="n">f1_score</span><span class="p">,</span> <span class="n">roc_auc_score</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Define the metrics you want to evaluate</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">metrics</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">... </span>    <span class="s1">&#39;Accuracy&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">accuracy_score</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
<span class="gp">... </span>    <span class="s1">&#39;Precision&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">precision_score</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
<span class="gp">... </span>    <span class="s1">&#39;F1 Score&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">f1_score</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
<span class="gp">... </span>    <span class="s1">&#39;AUC Score&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">roc_auc_score</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
<span class="gp">... </span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Assuming &#39;X_test&#39; and &#39;y_test&#39; are your test dataset and labels</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Evaluate using the specified metrics</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results</span> <span class="o">=</span> <span class="n">classifier</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="n">metrics</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>probabilities</strong> – Predicted class probabilities for each input sample.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>ndarray of shape (n_samples, n_classes)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.MambularClassifier.score">
<span class="sig-name descname"><span class="pre">score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(sklearn.metrics.log_loss,</span> <span class="pre">True)</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.MambularClassifier.score" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate the score of the model using the specified metric.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array-like</em><em> or </em><em>pd.DataFrame</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The input samples to predict.</p></li>
<li><p><strong>y</strong> (<em>array-like</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>)</em>) – The true class labels against which to evaluate the predictions.</p></li>
<li><p><strong>metric</strong> (<em>tuple</em><em>, </em><em>default=</em><em>(</em><em>log_loss</em><em>, </em><em>True</em><em>)</em>) – A tuple containing the metric function and a boolean indicating whether the metric requires probability scores (True) or class labels (False).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>score</strong> – The score calculated using the specified metric.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.MambularClassifier.set_params">
<span class="sig-name descname"><span class="pre">set_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">parameters</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.MambularClassifier.set_params" title="Permalink to this definition">#</a></dt>
<dd><p>Set the parameters of this estimator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>**parameters</strong> (<em>dict</em>) – Estimator parameters.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – Estimator instance.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mambular.models.MambularRegressor">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mambular.models.</span></span><span class="sig-name descname"><span class="pre">MambularRegressor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/mambular/models/mambular.html#MambularRegressor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mambular.models.MambularRegressor" title="Permalink to this definition">#</a></dt>
<dd><dl class="simple">
<dt>Mambular regressor. This class extends the SklearnBaseRegressor class and uses the Mambular model</dt><dd><p>with the default Mambular configuration.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The parameters for this class include the attributes from the config
dataclass as well as preprocessing arguments handled by the base class.</p>
<p>Configuration class for the Default Mambular model with predefined hyperparameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lr</strong> (<em>float</em><em>, </em><em>default=1e-04</em>) – Learning rate for the optimizer.</p></li>
<li><p><strong>lr_patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement after which the learning rate will be reduced.</p></li>
<li><p><strong>weight_decay</strong> (<em>float</em><em>, </em><em>default=1e-06</em>) – Weight decay (L2 penalty) for the optimizer.</p></li>
<li><p><strong>lr_factor</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Factor by which the learning rate will be reduced.</p></li>
<li><p><strong>d_model</strong> (<em>int</em><em>, </em><em>default=64</em>) – Dimensionality of the model.</p></li>
<li><p><strong>n_layers</strong> (<em>int</em><em>, </em><em>default=4</em>) – Number of layers in the model.</p></li>
<li><p><strong>expand_factor</strong> (<em>int</em><em>, </em><em>default=2</em>) – Expansion factor for the feed-forward layers.</p></li>
<li><p><strong>bias</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use bias in the linear layers.</p></li>
<li><p><strong>dropout</strong> (<em>float</em><em>, </em><em>default=0.0</em>) – Dropout rate for regularization.</p></li>
<li><p><strong>dt_rank</strong> (<em>str</em><em>, </em><em>default=&quot;auto&quot;</em>) – Rank of the decision tree used in the model.</p></li>
<li><p><strong>d_state</strong> (<em>int</em><em>, </em><em>default=128</em>) – Dimensionality of the state in recurrent layers.</p></li>
<li><p><strong>dt_scale</strong> (<em>float</em><em>, </em><em>default=1.0</em>) – Scaling factor for decision tree parameters.</p></li>
<li><p><strong>dt_init</strong> (<em>str</em><em>, </em><em>default=&quot;random&quot;</em>) – Initialization method for decision tree parameters.</p></li>
<li><p><strong>dt_max</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Maximum value for decision tree initialization.</p></li>
<li><p><strong>dt_min</strong> (<em>float</em><em>, </em><em>default=1e-04</em>) – Minimum value for decision tree initialization.</p></li>
<li><p><strong>dt_init_floor</strong> (<em>float</em><em>, </em><em>default=1e-04</em>) – Floor value for decision tree initialization.</p></li>
<li><p><strong>norm</strong> (<em>str</em><em>, </em><em>default=&quot;RMSNorm&quot;</em>) – Type of normalization used (‘RMSNorm’, etc.).</p></li>
<li><p><strong>activation</strong> (<em>callable</em><em>, </em><em>default=nn.SiLU</em><em>(</em><em>)</em>) – Activation function for the model.</p></li>
<li><p><strong>layer_norm_eps</strong> (<em>float</em><em>, </em><em>default=1e-05</em>) – Epsilon value for layer normalization.</p></li>
<li><p><strong>embedding_activation</strong> (<em>callable</em><em>, </em><em>default=nn.Identity</em><em>(</em><em>)</em>) – Activation function for embeddings.</p></li>
<li><p><strong>embedding_type</strong> (<em>str</em><em>, </em><em>default=&quot;linear&quot;</em>) – Type of embedding to use (‘linear’, etc.).</p></li>
<li><p><strong>embedding_bias</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use bias in the embedding layers.</p></li>
<li><p><strong>plr_lite</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use a lightweight version of Piecewise Linear Regression (PLR).</p></li>
<li><p><strong>n_frequencies</strong> (<em>int</em><em>, </em><em>default=48</em>) – Number of frequencies for PLR embeddings.</p></li>
<li><p><strong>frequencies_init_scale</strong> (<em>float</em><em>, </em><em>default=0.01</em>) – Initial scale for frequency parameters in embeddings.</p></li>
<li><p><strong>layer_norm_after_embedding</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to apply layer normalization after embedding layers.</p></li>
<li><p><strong>shuffle_embeddings</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to shuffle embeddings before being passed to Mamba layers.</p></li>
<li><p><strong>head_layer_sizes</strong> (<em>list</em><em>, </em><em>default=</em><em>(</em><em>)</em>) – Sizes of the layers in the model’s head.</p></li>
<li><p><strong>head_dropout</strong> (<em>float</em><em>, </em><em>default=0.5</em>) – Dropout rate for the head layers.</p></li>
<li><p><strong>head_skip_layers</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to skip layers in the head.</p></li>
<li><p><strong>head_activation</strong> (<em>callable</em><em>, </em><em>default=nn.SELU</em><em>(</em><em>)</em>) – Activation function for the head layers.</p></li>
<li><p><strong>head_use_batch_norm</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use batch normalization in the head layers.</p></li>
<li><p><strong>pooling_method</strong> (<em>str</em><em>, </em><em>default=&quot;avg&quot;</em>) – Pooling method to use (‘avg’, ‘max’, etc.).</p></li>
<li><p><strong>bidirectional</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to process data bidirectionally.</p></li>
<li><p><strong>use_learnable_interaction</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use learnable feature interactions before passing through Mamba blocks.</p></li>
<li><p><strong>use_cls</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to append a CLS token to the input sequences.</p></li>
<li><p><strong>use_pscan</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use PSCAN for the state-space model.</p></li>
<li><p><strong>mamba_version</strong> (<em>str</em><em>, </em><em>default=&quot;mamba-torch&quot;</em>) – Version of the Mamba model to use (‘mamba-torch’, ‘mamba1’, ‘mamba2’).</p></li>
<li><p><strong>n_bins</strong> (<em>int</em><em>, </em><em>default=50</em>) – The number of bins to use for numerical feature binning. This parameter is relevant
only if <code class="docutils literal notranslate"><span class="pre">numerical_preprocessing</span></code> is set to ‘binning’, ‘ple’ or ‘one-hot’.</p></li>
<li><p><strong>numerical_preprocessing</strong> (<em>str</em><em>, </em><em>default=&quot;ple&quot;</em>) – The preprocessing strategy for numerical features. Valid options are
‘ple’, ‘binning’, ‘one-hot’, ‘standardization’, ‘min-max’, ‘quantile’, ‘polynomial’,
‘splines’, ‘box-cox’, ‘yeo-johnson’ and None</p></li>
<li><p><strong>categorical_preprocessing</strong> (<em>str</em><em>, </em><em>default=&quot;int&quot;</em>) – The preprocessing strategy for categorical features. Valid options are
‘int’, ‘one-hot’, None</p></li>
<li><p><strong>use_decision_tree_bins</strong> (<em>bool</em><em>, </em><em>default=False</em>) – If True, uses decision tree regression/classification to determine
optimal bin edges for numerical feature binning. This parameter is
relevant only if <code class="docutils literal notranslate"><span class="pre">numerical_preprocessing</span></code> is set to ‘binning’ or ‘one-hot’.</p></li>
<li><p><strong>binning_strategy</strong> (<em>str</em><em>, </em><em>default=&quot;uniform&quot;</em>) – Defines the strategy for binning numerical features. Options include ‘uniform’,
‘quantile’, or other sklearn-compatible strategies.</p></li>
<li><p><strong>task</strong> (<em>str</em><em>, </em><em>default=&quot;regression&quot;</em>) – Indicates the type of machine learning task (‘regression’ or ‘classification’). This can
influence certain preprocessing behaviors, especially when using decision tree-based binning.</p></li>
<li><p><strong>cat_cutoff</strong> (<em>float</em><em> or </em><em>int</em><em>, </em><em>default=0.03</em>) – Indicates the cutoff after which integer values are treated as categorical.
If float, it’s treated as a percentage. If int, it’s the maximum number of
unique values for a column to be considered categorical.</p></li>
<li><p><strong>treat_all_integers_as_numerical</strong> (<em>bool</em><em>, </em><em>default=False</em>) – If True, all integer columns will be treated as numerical, regardless
of their unique value count or proportion.</p></li>
<li><p><strong>degree</strong> (<em>int</em><em>, </em><em>default=3</em>) – The degree of the polynomial features to be used in preprocessing.</p></li>
<li><p><strong>knots</strong> (<em>int</em><em>, </em><em>default=12</em>) – The number of knots to be used in spline transformations.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mambular.models</span> <span class="kn">import</span> <span class="n">MambularRegressor</span>
<span class="go">    &gt;&gt;&gt; model = MambularRegressor(d_model=64, n_layers=8)</span>
<span class="go">    &gt;&gt;&gt; model.fit(X_train, y_train)</span>
<span class="go">    &gt;&gt;&gt; preds = model.predict(X_test)</span>
<span class="go">    &gt;&gt;&gt; model.evaluate(X_test, y_test)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.MambularRegressor.build_model">
<span class="sig-name descname"><span class="pre">build_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">101</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_patience</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_decay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataloader_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.MambularRegressor.build_model" title="Permalink to this definition">#</a></dt>
<dd><p>Builds the model using the provided training data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The training input samples.</p></li>
<li><p><strong>y</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em>) – The target values (real numbers).</p></li>
<li><p><strong>val_size</strong> (<em>float</em><em>, </em><em>default=0.2</em>) – The proportion of the dataset to include in the validation split if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is None. Ignored if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>X_val</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em><em>, </em><em>optional</em>) – The validation input samples. If provided, <code class="docutils literal notranslate"><span class="pre">X</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> are not split and this data is used for validation.</p></li>
<li><p><strong>y_val</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em><em>, </em><em>optional</em>) – The validation target values. Required if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>random_state</strong> (<em>int</em><em>, </em><em>default=101</em>) – Controls the shuffling applied to the data before applying the split.</p></li>
<li><p><strong>batch_size</strong> (<em>int</em><em>, </em><em>default=64</em>) – Number of samples per gradient update.</p></li>
<li><p><strong>shuffle</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to shuffle the training data before each epoch.</p></li>
<li><p><strong>lr</strong> (<em>float</em><em>, </em><em>default=1e-3</em>) – Learning rate for the optimizer.</p></li>
<li><p><strong>lr_patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement on the validation loss to wait before reducing the learning rate.</p></li>
<li><p><strong>factor</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Factor by which the learning rate will be reduced.</p></li>
<li><p><strong>weight_decay</strong> (<em>float</em><em>, </em><em>default=0.025</em>) – Weight decay (L2 penalty) coefficient.</p></li>
<li><p><strong>dataloader_kwargs</strong> (<em>dict</em><em>, </em><em>default={}</em>) – The kwargs for the pytorch dataloader class.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – The built regressor.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.MambularRegressor.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.MambularRegressor.evaluate" title="Permalink to this definition">#</a></dt>
<dd><p>Evaluate the model on the given data using specified metrics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array-like</em><em> or </em><em>pd.DataFrame</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The input samples to predict.</p></li>
<li><p><strong>y_true</strong> (<em>array-like</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_outputs</em><em>)</em>) – The true target values against which to evaluate the predictions.</p></li>
<li><p><strong>metrics</strong> (<em>dict</em>) – A dictionary where keys are metric names and values are the metric functions.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This method uses the <code class="docutils literal notranslate"><span class="pre">predict</span></code> method to generate predictions and computes each metric.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_squared_error</span><span class="p">,</span> <span class="n">r2_score</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mambular.models</span> <span class="kn">import</span> <span class="n">MambularRegressor</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">metrics</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">... </span>    <span class="s1">&#39;Mean Squared Error&#39;</span><span class="p">:</span> <span class="n">mean_squared_error</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s1">&#39;R2 Score&#39;</span><span class="p">:</span> <span class="n">r2_score</span>
<span class="gp">... </span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Assuming &#39;X_test&#39; and &#39;y_test&#39; are your test dataset and labels</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Evaluate using the specified metrics</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results</span> <span class="o">=</span> <span class="n">regressor</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="n">metrics</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>scores</strong> – A dictionary with metric names as keys and their corresponding scores as values.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.MambularRegressor.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">101</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patience</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">15</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">monitor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'val_loss'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'min'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_patience</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_decay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checkpoint_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'model_checkpoints'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataloader_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rebuild</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">trainer_kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.MambularRegressor.fit" title="Permalink to this definition">#</a></dt>
<dd><p>Trains the regression model using the provided training data. Optionally, a separate validation set can be used.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The training input samples.</p></li>
<li><p><strong>y</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em>) – The target values (real numbers).</p></li>
<li><p><strong>val_size</strong> (<em>float</em><em>, </em><em>default=0.2</em>) – The proportion of the dataset to include in the validation split if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is None. Ignored if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>X_val</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em><em>, </em><em>optional</em>) – The validation input samples. If provided, <code class="docutils literal notranslate"><span class="pre">X</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> are not split and this data is used for validation.</p></li>
<li><p><strong>y_val</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em><em>, </em><em>optional</em>) – The validation target values. Required if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>max_epochs</strong> (<em>int</em><em>, </em><em>default=100</em>) – Maximum number of epochs for training.</p></li>
<li><p><strong>random_state</strong> (<em>int</em><em>, </em><em>default=101</em>) – Controls the shuffling applied to the data before applying the split.</p></li>
<li><p><strong>batch_size</strong> (<em>int</em><em>, </em><em>default=64</em>) – Number of samples per gradient update.</p></li>
<li><p><strong>shuffle</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to shuffle the training data before each epoch.</p></li>
<li><p><strong>patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement on the validation loss to wait before early stopping.</p></li>
<li><p><strong>monitor</strong> (<em>str</em><em>, </em><em>default=&quot;val_loss&quot;</em>) – The metric to monitor for early stopping.</p></li>
<li><p><strong>mode</strong> (<em>str</em><em>, </em><em>default=&quot;min&quot;</em>) – Whether the monitored metric should be minimized (<code class="docutils literal notranslate"><span class="pre">min</span></code>) or maximized (<code class="docutils literal notranslate"><span class="pre">max</span></code>).</p></li>
<li><p><strong>lr</strong> (<em>float</em><em>, </em><em>default=1e-3</em>) – Learning rate for the optimizer.</p></li>
<li><p><strong>lr_patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement on the validation loss to wait before reducing the learning rate.</p></li>
<li><p><strong>factor</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Factor by which the learning rate will be reduced.</p></li>
<li><p><strong>weight_decay</strong> (<em>float</em><em>, </em><em>default=0.025</em>) – Weight decay (L2 penalty) coefficient.</p></li>
<li><p><strong>checkpoint_path</strong> (<em>str</em><em>, </em><em>default=&quot;model_checkpoints&quot;</em>) – Path where the checkpoints are being saved.</p></li>
<li><p><strong>dataloader_kwargs</strong> (<em>dict</em><em>, </em><em>default={}</em>) – The kwargs for the pytorch dataloader class.</p></li>
<li><p><strong>**trainer_kwargs</strong> (<em>Additional keyword arguments for PyTorch Lightning's Trainer class.</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – The fitted regressor.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.MambularRegressor.get_number_of_params">
<span class="sig-name descname"><span class="pre">get_number_of_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">requires_grad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.MambularRegressor.get_number_of_params" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate the number of parameters in the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>requires_grad</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, only count the parameters that require gradients (trainable parameters).
If False, count all parameters. Default is True.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The total number of parameters in the model.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the model has not been built prior to calling this method.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.MambularRegressor.get_params">
<span class="sig-name descname"><span class="pre">get_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">deep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.MambularRegressor.get_params" title="Permalink to this definition">#</a></dt>
<dd><p>Get parameters for this estimator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>deep</strong> (<em>bool</em><em>, </em><em>default=True</em>) – If True, will return the parameters for this estimator and contained subobjects that are estimators.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>params</strong> – Parameter names mapped to their values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.MambularRegressor.optimize_hparams">
<span class="sig-name descname"><span class="pre">optimize_hparams</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prune_by_epoch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prune_epoch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fixed_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'cat_encoding':</span> <span class="pre">'int',</span> <span class="pre">'head_layer_size_length':</span> <span class="pre">0,</span> <span class="pre">'head_skip_layer':</span> <span class="pre">False,</span> <span class="pre">'head_skip_layers':</span> <span class="pre">False,</span> <span class="pre">'pooling_method':</span> <span class="pre">'avg',</span> <span class="pre">'use_cls':</span> <span class="pre">False}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">custom_search_space</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">optimize_kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.MambularRegressor.optimize_hparams" title="Permalink to this definition">#</a></dt>
<dd><p>Optimizes hyperparameters using Bayesian optimization with optional pruning.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array-like</em>) – Training data.</p></li>
<li><p><strong>y</strong> (<em>array-like</em>) – Training labels.</p></li>
<li><p><strong>X_val</strong> (<em>array-like</em><em>, </em><em>optional</em>) – Validation data and labels.</p></li>
<li><p><strong>y_val</strong> (<em>array-like</em><em>, </em><em>optional</em>) – Validation data and labels.</p></li>
<li><p><strong>time</strong> (<em>int</em>) – The number of optimization trials to run.</p></li>
<li><p><strong>max_epochs</strong> (<em>int</em>) – Maximum number of epochs for training.</p></li>
<li><p><strong>prune_by_epoch</strong> (<em>bool</em>) – Whether to prune based on a specific epoch (True) or the best validation loss (False).</p></li>
<li><p><strong>prune_epoch</strong> (<em>int</em>) – The specific epoch to prune by when prune_by_epoch is True.</p></li>
<li><p><strong>**optimize_kwargs</strong> (<em>dict</em>) – Additional keyword arguments passed to the fit method.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>best_hparams</strong> – Best hyperparameters found during optimization.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.MambularRegressor.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.MambularRegressor.predict" title="Permalink to this definition">#</a></dt>
<dd><p>Predicts target values for the given input samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>X</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The input samples for which to predict target values.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>predictions</strong> – The predicted target values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray, shape (n_samples,) or (n_samples, n_outputs)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.MambularRegressor.score">
<span class="sig-name descname"><span class="pre">score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">sklearn.metrics.mean_squared_error</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.MambularRegressor.score" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate the score of the model using the specified metric.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array-like</em><em> or </em><em>pd.DataFrame</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The input samples to predict.</p></li>
<li><p><strong>y</strong> (<em>array-like</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_outputs</em><em>)</em>) – The true target values against which to evaluate the predictions.</p></li>
<li><p><strong>metric</strong> (<em>callable</em><em>, </em><em>default=mean_squared_error</em>) – The metric function to use for evaluation. Must be a callable with the signature <code class="docutils literal notranslate"><span class="pre">metric(y_true,</span> <span class="pre">y_pred)</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>score</strong> – The score calculated using the specified metric.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.MambularRegressor.set_params">
<span class="sig-name descname"><span class="pre">set_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">parameters</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.MambularRegressor.set_params" title="Permalink to this definition">#</a></dt>
<dd><p>Set the parameters of this estimator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>**parameters</strong> (<em>dict</em>) – Estimator parameters.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – Estimator instance.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mambular.models.MambularLSS">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mambular.models.</span></span><span class="sig-name descname"><span class="pre">MambularLSS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/mambular/models/mambular.html#MambularLSS"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mambular.models.MambularLSS" title="Permalink to this definition">#</a></dt>
<dd><dl class="simple">
<dt>Mambular LSS for distributional regression. This class extends the SklearnBaseLSS class and uses the Mambular model</dt><dd><p>with the default Mambular configuration.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The parameters for this class include the attributes from the config
dataclass as well as preprocessing arguments handled by the base class.</p>
<p>Configuration class for the Default Mambular model with predefined hyperparameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lr</strong> (<em>float</em><em>, </em><em>default=1e-04</em>) – Learning rate for the optimizer.</p></li>
<li><p><strong>lr_patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement after which the learning rate will be reduced.</p></li>
<li><p><strong>weight_decay</strong> (<em>float</em><em>, </em><em>default=1e-06</em>) – Weight decay (L2 penalty) for the optimizer.</p></li>
<li><p><strong>lr_factor</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Factor by which the learning rate will be reduced.</p></li>
<li><p><strong>d_model</strong> (<em>int</em><em>, </em><em>default=64</em>) – Dimensionality of the model.</p></li>
<li><p><strong>n_layers</strong> (<em>int</em><em>, </em><em>default=4</em>) – Number of layers in the model.</p></li>
<li><p><strong>expand_factor</strong> (<em>int</em><em>, </em><em>default=2</em>) – Expansion factor for the feed-forward layers.</p></li>
<li><p><strong>bias</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use bias in the linear layers.</p></li>
<li><p><strong>dropout</strong> (<em>float</em><em>, </em><em>default=0.0</em>) – Dropout rate for regularization.</p></li>
<li><p><strong>dt_rank</strong> (<em>str</em><em>, </em><em>default=&quot;auto&quot;</em>) – Rank of the decision tree used in the model.</p></li>
<li><p><strong>d_state</strong> (<em>int</em><em>, </em><em>default=128</em>) – Dimensionality of the state in recurrent layers.</p></li>
<li><p><strong>dt_scale</strong> (<em>float</em><em>, </em><em>default=1.0</em>) – Scaling factor for decision tree parameters.</p></li>
<li><p><strong>dt_init</strong> (<em>str</em><em>, </em><em>default=&quot;random&quot;</em>) – Initialization method for decision tree parameters.</p></li>
<li><p><strong>dt_max</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Maximum value for decision tree initialization.</p></li>
<li><p><strong>dt_min</strong> (<em>float</em><em>, </em><em>default=1e-04</em>) – Minimum value for decision tree initialization.</p></li>
<li><p><strong>dt_init_floor</strong> (<em>float</em><em>, </em><em>default=1e-04</em>) – Floor value for decision tree initialization.</p></li>
<li><p><strong>norm</strong> (<em>str</em><em>, </em><em>default=&quot;RMSNorm&quot;</em>) – Type of normalization used (‘RMSNorm’, etc.).</p></li>
<li><p><strong>activation</strong> (<em>callable</em><em>, </em><em>default=nn.SiLU</em><em>(</em><em>)</em>) – Activation function for the model.</p></li>
<li><p><strong>layer_norm_eps</strong> (<em>float</em><em>, </em><em>default=1e-05</em>) – Epsilon value for layer normalization.</p></li>
<li><p><strong>embedding_activation</strong> (<em>callable</em><em>, </em><em>default=nn.Identity</em><em>(</em><em>)</em>) – Activation function for embeddings.</p></li>
<li><p><strong>embedding_type</strong> (<em>str</em><em>, </em><em>default=&quot;linear&quot;</em>) – Type of embedding to use (‘linear’, etc.).</p></li>
<li><p><strong>embedding_bias</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use bias in the embedding layers.</p></li>
<li><p><strong>plr_lite</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use a lightweight version of Piecewise Linear Regression (PLR).</p></li>
<li><p><strong>n_frequencies</strong> (<em>int</em><em>, </em><em>default=48</em>) – Number of frequencies for PLR embeddings.</p></li>
<li><p><strong>frequencies_init_scale</strong> (<em>float</em><em>, </em><em>default=0.01</em>) – Initial scale for frequency parameters in embeddings.</p></li>
<li><p><strong>layer_norm_after_embedding</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to apply layer normalization after embedding layers.</p></li>
<li><p><strong>shuffle_embeddings</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to shuffle embeddings before being passed to Mamba layers.</p></li>
<li><p><strong>head_layer_sizes</strong> (<em>list</em><em>, </em><em>default=</em><em>(</em><em>)</em>) – Sizes of the layers in the model’s head.</p></li>
<li><p><strong>head_dropout</strong> (<em>float</em><em>, </em><em>default=0.5</em>) – Dropout rate for the head layers.</p></li>
<li><p><strong>head_skip_layers</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to skip layers in the head.</p></li>
<li><p><strong>head_activation</strong> (<em>callable</em><em>, </em><em>default=nn.SELU</em><em>(</em><em>)</em>) – Activation function for the head layers.</p></li>
<li><p><strong>head_use_batch_norm</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use batch normalization in the head layers.</p></li>
<li><p><strong>pooling_method</strong> (<em>str</em><em>, </em><em>default=&quot;avg&quot;</em>) – Pooling method to use (‘avg’, ‘max’, etc.).</p></li>
<li><p><strong>bidirectional</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to process data bidirectionally.</p></li>
<li><p><strong>use_learnable_interaction</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use learnable feature interactions before passing through Mamba blocks.</p></li>
<li><p><strong>use_cls</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to append a CLS token to the input sequences.</p></li>
<li><p><strong>use_pscan</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use PSCAN for the state-space model.</p></li>
<li><p><strong>mamba_version</strong> (<em>str</em><em>, </em><em>default=&quot;mamba-torch&quot;</em>) – Version of the Mamba model to use (‘mamba-torch’, ‘mamba1’, ‘mamba2’).</p></li>
<li><p><strong>n_bins</strong> (<em>int</em><em>, </em><em>default=50</em>) – The number of bins to use for numerical feature binning. This parameter is relevant
only if <code class="docutils literal notranslate"><span class="pre">numerical_preprocessing</span></code> is set to ‘binning’, ‘ple’ or ‘one-hot’.</p></li>
<li><p><strong>numerical_preprocessing</strong> (<em>str</em><em>, </em><em>default=&quot;ple&quot;</em>) – The preprocessing strategy for numerical features. Valid options are
‘ple’, ‘binning’, ‘one-hot’, ‘standardization’, ‘min-max’, ‘quantile’, ‘polynomial’,
‘splines’, ‘box-cox’, ‘yeo-johnson’ and None</p></li>
<li><p><strong>categorical_preprocessing</strong> (<em>str</em><em>, </em><em>default=&quot;int&quot;</em>) – The preprocessing strategy for categorical features. Valid options are
‘int’, ‘one-hot’, None</p></li>
<li><p><strong>use_decision_tree_bins</strong> (<em>bool</em><em>, </em><em>default=False</em>) – If True, uses decision tree regression/classification to determine
optimal bin edges for numerical feature binning. This parameter is
relevant only if <code class="docutils literal notranslate"><span class="pre">numerical_preprocessing</span></code> is set to ‘binning’ or ‘one-hot’.</p></li>
<li><p><strong>binning_strategy</strong> (<em>str</em><em>, </em><em>default=&quot;uniform&quot;</em>) – Defines the strategy for binning numerical features. Options include ‘uniform’,
‘quantile’, or other sklearn-compatible strategies.</p></li>
<li><p><strong>task</strong> (<em>str</em><em>, </em><em>default=&quot;regression&quot;</em>) – Indicates the type of machine learning task (‘regression’ or ‘classification’). This can
influence certain preprocessing behaviors, especially when using decision tree-based binning.</p></li>
<li><p><strong>cat_cutoff</strong> (<em>float</em><em> or </em><em>int</em><em>, </em><em>default=0.03</em>) – Indicates the cutoff after which integer values are treated as categorical.
If float, it’s treated as a percentage. If int, it’s the maximum number of
unique values for a column to be considered categorical.</p></li>
<li><p><strong>treat_all_integers_as_numerical</strong> (<em>bool</em><em>, </em><em>default=False</em>) – If True, all integer columns will be treated as numerical, regardless
of their unique value count or proportion.</p></li>
<li><p><strong>degree</strong> (<em>int</em><em>, </em><em>default=3</em>) – The degree of the polynomial features to be used in preprocessing.</p></li>
<li><p><strong>knots</strong> (<em>int</em><em>, </em><em>default=12</em>) – The number of knots to be used in spline transformations.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mambular.models</span> <span class="kn">import</span> <span class="n">MambularLSS</span>
<span class="go">    &gt;&gt;&gt; model = MambularLSS(d_model=64, n_layers=8)</span>
<span class="go">    &gt;&gt;&gt; model.fit(X_train, y_train, family=&#39;normal&#39;)</span>
<span class="go">    &gt;&gt;&gt; preds = model.predict(X_test)</span>
<span class="go">    &gt;&gt;&gt; model.evaluate(X_test, y_test)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.MambularLSS.build_model">
<span class="sig-name descname"><span class="pre">build_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">101</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_patience</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_decay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataloader_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.MambularLSS.build_model" title="Permalink to this definition">#</a></dt>
<dd><p>Builds the model using the provided training data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The training input samples.</p></li>
<li><p><strong>y</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em>) – The target values (real numbers).</p></li>
<li><p><strong>val_size</strong> (<em>float</em><em>, </em><em>default=0.2</em>) – The proportion of the dataset to include in the validation split if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is None. Ignored if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>X_val</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em><em>, </em><em>optional</em>) – The validation input samples. If provided, <code class="docutils literal notranslate"><span class="pre">X</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> are not split and this data is used for validation.</p></li>
<li><p><strong>y_val</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em><em>, </em><em>optional</em>) – The validation target values. Required if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>random_state</strong> (<em>int</em><em>, </em><em>default=101</em>) – Controls the shuffling applied to the data before applying the split.</p></li>
<li><p><strong>batch_size</strong> (<em>int</em><em>, </em><em>default=64</em>) – Number of samples per gradient update.</p></li>
<li><p><strong>shuffle</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to shuffle the training data before each epoch.</p></li>
<li><p><strong>lr</strong> (<em>float</em><em>, </em><em>default=1e-3</em>) – Learning rate for the optimizer.</p></li>
<li><p><strong>lr_patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement on the validation loss to wait before reducing the learning rate.</p></li>
<li><p><strong>factor</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Factor by which the learning rate will be reduced.</p></li>
<li><p><strong>weight_decay</strong> (<em>float</em><em>, </em><em>default=0.025</em>) – Weight decay (L2 penalty) coefficient.</p></li>
<li><p><strong>dataloader_kwargs</strong> (<em>dict</em><em>, </em><em>default={}</em>) – The kwargs for the pytorch dataloader class.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – The built distributional regressor.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.MambularLSS.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distribution_family</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.MambularLSS.evaluate" title="Permalink to this definition">#</a></dt>
<dd><p>Evaluate the model on the given data using specified metrics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array-like</em><em> or </em><em>pd.DataFrame</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The input samples to predict.</p></li>
<li><p><strong>y_true</strong> (<em>array-like</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>)</em>) – The true class labels against which to evaluate the predictions.</p></li>
<li><p><strong>metrics</strong> (<em>dict</em>) – A dictionary where keys are metric names and values are tuples containing the metric function
and a boolean indicating whether the metric requires probability scores (True) or class labels (False).</p></li>
<li><p><strong>distribution_family</strong> (<em>str</em><em>, </em><em>optional</em>) – Specifies the distribution family the model is predicting for. If None, it will attempt to infer based
on the model’s settings.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>scores</strong> – A dictionary with metric names as keys and their corresponding scores as values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This method uses either the <code class="docutils literal notranslate"><span class="pre">predict</span></code> or <code class="docutils literal notranslate"><span class="pre">predict_proba</span></code> method depending on the metric requirements.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.MambularLSS.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">family</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">101</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patience</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">15</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">monitor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'val_loss'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'min'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_patience</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_decay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checkpoint_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'model_checkpoints'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distributional_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataloader_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rebuild</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">trainer_kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.MambularLSS.fit" title="Permalink to this definition">#</a></dt>
<dd><p>Trains the regression model using the provided training data. Optionally, a separate validation set can be used.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The training input samples.</p></li>
<li><p><strong>y</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em>) – The target values (real numbers).</p></li>
<li><p><strong>family</strong> (<em>str</em>) – The name of the distribution family to use for the loss function. Examples include ‘normal’ for regression tasks.</p></li>
<li><p><strong>val_size</strong> (<em>float</em><em>, </em><em>default=0.2</em>) – The proportion of the dataset to include in the validation split if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is None. Ignored if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>X_val</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em><em>, </em><em>optional</em>) – The validation input samples. If provided, <code class="docutils literal notranslate"><span class="pre">X</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> are not split and this data is used for validation.</p></li>
<li><p><strong>y_val</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em><em>, </em><em>optional</em>) – The validation target values. Required if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>max_epochs</strong> (<em>int</em><em>, </em><em>default=100</em>) – Maximum number of epochs for training.</p></li>
<li><p><strong>random_state</strong> (<em>int</em><em>, </em><em>default=101</em>) – Controls the shuffling applied to the data before applying the split.</p></li>
<li><p><strong>batch_size</strong> (<em>int</em><em>, </em><em>default=64</em>) – Number of samples per gradient update.</p></li>
<li><p><strong>shuffle</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to shuffle the training data before each epoch.</p></li>
<li><p><strong>patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement on the validation loss to wait before early stopping.</p></li>
<li><p><strong>monitor</strong> (<em>str</em><em>, </em><em>default=&quot;val_loss&quot;</em>) – The metric to monitor for early stopping.</p></li>
<li><p><strong>mode</strong> (<em>str</em><em>, </em><em>default=&quot;min&quot;</em>) – Whether the monitored metric should be minimized (<code class="docutils literal notranslate"><span class="pre">min</span></code>) or maximized (<code class="docutils literal notranslate"><span class="pre">max</span></code>).</p></li>
<li><p><strong>lr</strong> (<em>float</em><em>, </em><em>default=1e-3</em>) – Learning rate for the optimizer.</p></li>
<li><p><strong>lr_patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement on the validation loss to wait before reducing the learning rate.</p></li>
<li><p><strong>factor</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Factor by which the learning rate will be reduced.</p></li>
<li><p><strong>weight_decay</strong> (<em>float</em><em>, </em><em>default=0.025</em>) – Weight decay (L2 penalty) coefficient.</p></li>
<li><p><strong>distributional_kwargs</strong> (<em>dict</em><em>, </em><em>default=None</em>) – any arguments taht are specific for a certain distribution.</p></li>
<li><p><strong>checkpoint_path</strong> (<em>str</em><em>, </em><em>default=&quot;model_checkpoints&quot;</em>) – Path where the checkpoints are being saved.</p></li>
<li><p><strong>dataloader_kwargs</strong> (<em>dict</em><em>, </em><em>default={}</em>) – The kwargs for the pytorch dataloader class.</p></li>
<li><p><strong>**trainer_kwargs</strong> (<em>Additional keyword arguments for PyTorch Lightning's Trainer class.</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – The fitted regressor.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.MambularLSS.get_default_metrics">
<span class="sig-name descname"><span class="pre">get_default_metrics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">distribution_family</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.MambularLSS.get_default_metrics" title="Permalink to this definition">#</a></dt>
<dd><p>Provides default metrics based on the distribution family.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>distribution_family</strong> (<em>str</em>) – The distribution family for which to provide default metrics.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>metrics</strong> – A dictionary of default metric functions.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.MambularLSS.get_number_of_params">
<span class="sig-name descname"><span class="pre">get_number_of_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">requires_grad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.MambularLSS.get_number_of_params" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate the number of parameters in the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>requires_grad</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, only count the parameters that require gradients (trainable parameters).
If False, count all parameters. Default is True.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The total number of parameters in the model.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the model has not been built prior to calling this method.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.MambularLSS.get_params">
<span class="sig-name descname"><span class="pre">get_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">deep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.MambularLSS.get_params" title="Permalink to this definition">#</a></dt>
<dd><p>Get parameters for this estimator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>deep</strong> (<em>bool</em><em>, </em><em>default=True</em>) – If True, will return the parameters for this estimator and contained subobjects that are estimators.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>params</strong> – Parameter names mapped to their values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.MambularLSS.optimize_hparams">
<span class="sig-name descname"><span class="pre">optimize_hparams</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prune_by_epoch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prune_epoch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fixed_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'cat_encoding':</span> <span class="pre">'int',</span> <span class="pre">'head_layer_size_length':</span> <span class="pre">0,</span> <span class="pre">'head_skip_layer':</span> <span class="pre">False,</span> <span class="pre">'head_skip_layers':</span> <span class="pre">False,</span> <span class="pre">'pooling_method':</span> <span class="pre">'avg',</span> <span class="pre">'use_cls':</span> <span class="pre">False}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">custom_search_space</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">optimize_kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.MambularLSS.optimize_hparams" title="Permalink to this definition">#</a></dt>
<dd><p>Optimizes hyperparameters using Bayesian optimization with optional pruning.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array-like</em>) – Training data.</p></li>
<li><p><strong>y</strong> (<em>array-like</em>) – Training labels.</p></li>
<li><p><strong>X_val</strong> (<em>array-like</em><em>, </em><em>optional</em>) – Validation data and labels.</p></li>
<li><p><strong>y_val</strong> (<em>array-like</em><em>, </em><em>optional</em>) – Validation data and labels.</p></li>
<li><p><strong>time</strong> (<em>int</em>) – The number of optimization trials to run.</p></li>
<li><p><strong>max_epochs</strong> (<em>int</em>) – Maximum number of epochs for training.</p></li>
<li><p><strong>prune_by_epoch</strong> (<em>bool</em>) – Whether to prune based on a specific epoch (True) or the best validation loss (False).</p></li>
<li><p><strong>prune_epoch</strong> (<em>int</em>) – The specific epoch to prune by when prune_by_epoch is True.</p></li>
<li><p><strong>**optimize_kwargs</strong> (<em>dict</em>) – Additional keyword arguments passed to the fit method.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>best_hparams</strong> – Best hyperparameters found during optimization.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.MambularLSS.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">raw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.MambularLSS.predict" title="Permalink to this definition">#</a></dt>
<dd><p>Predicts target values for the given input samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>X</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The input samples for which to predict target values.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>predictions</strong> – The predicted target values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray, shape (n_samples,) or (n_samples, n_outputs)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.MambularLSS.score">
<span class="sig-name descname"><span class="pre">score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'NLL'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.MambularLSS.score" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate the score of the model using the specified metric.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array-like</em><em> or </em><em>pd.DataFrame</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The input samples to predict.</p></li>
<li><p><strong>y</strong> (<em>array-like</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_outputs</em><em>)</em>) – The true target values against which to evaluate the predictions.</p></li>
<li><p><strong>metric</strong> (<em>str</em><em>, </em><em>default=&quot;NLL&quot;</em>) – So far, only negative log-likelihood is supported</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>score</strong> – The score calculated using the specified metric.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.MambularLSS.set_params">
<span class="sig-name descname"><span class="pre">set_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">parameters</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.MambularLSS.set_params" title="Permalink to this definition">#</a></dt>
<dd><p>Set the parameters of this estimator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>**parameters</strong> (<em>dict</em>) – Estimator parameters.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – Estimator instance.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mambular.models.FTTransformerClassifier">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mambular.models.</span></span><span class="sig-name descname"><span class="pre">FTTransformerClassifier</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/mambular/models/fttransformer.html#FTTransformerClassifier"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mambular.models.FTTransformerClassifier" title="Permalink to this definition">#</a></dt>
<dd><dl class="simple">
<dt>FTTransformer Classifier. This class extends the SklearnBaseClassifier class</dt><dd><p>and uses the FTTransformer model with the default FTTransformer configuration.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The parameters for this class include the attributes from the config
dataclass as well as preprocessing arguments handled by the base class.</p>
<p>Configuration class for the FT Transformer model with predefined hyperparameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lr</strong> (<em>float</em><em>, </em><em>default=1e-04</em>) – Learning rate for the optimizer.</p></li>
<li><p><strong>lr_patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement after which the learning rate will be reduced.</p></li>
<li><p><strong>weight_decay</strong> (<em>float</em><em>, </em><em>default=1e-06</em>) – Weight decay (L2 regularization) for the optimizer.</p></li>
<li><p><strong>lr_factor</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Factor by which the learning rate will be reduced.</p></li>
<li><p><strong>d_model</strong> (<em>int</em><em>, </em><em>default=128</em>) – Dimensionality of the transformer model.</p></li>
<li><p><strong>n_layers</strong> (<em>int</em><em>, </em><em>default=4</em>) – Number of transformer layers.</p></li>
<li><p><strong>n_heads</strong> (<em>int</em><em>, </em><em>default=8</em>) – Number of attention heads in the transformer.</p></li>
<li><p><strong>attn_dropout</strong> (<em>float</em><em>, </em><em>default=0.2</em>) – Dropout rate for the attention mechanism.</p></li>
<li><p><strong>ff_dropout</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Dropout rate for the feed-forward layers.</p></li>
<li><p><strong>norm</strong> (<em>str</em><em>, </em><em>default=&quot;LayerNorm&quot;</em>) – Type of normalization to be used (‘LayerNorm’, ‘RMSNorm’, etc.).</p></li>
<li><p><strong>activation</strong> (<em>callable</em><em>, </em><em>default=nn.SELU</em><em>(</em><em>)</em>) – Activation function for the transformer layers.</p></li>
<li><p><strong>transformer_activation</strong> (<em>callable</em><em>, </em><em>default=ReGLU</em><em>(</em><em>)</em>) – Activation function for the transformer feed-forward layers.</p></li>
<li><p><strong>transformer_dim_feedforward</strong> (<em>int</em><em>, </em><em>default=256</em>) – Dimensionality of the feed-forward layers in the transformer.</p></li>
<li><p><strong>layer_norm_eps</strong> (<em>float</em><em>, </em><em>default=1e-05</em>) – Epsilon value for layer normalization to improve numerical stability.</p></li>
<li><p><strong>norm_first</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to apply normalization before other operations in each transformer block.</p></li>
<li><p><strong>bias</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to use bias in linear layers.</p></li>
<li><p><strong>embedding_activation</strong> (<em>callable</em><em>, </em><em>default=nn.Identity</em><em>(</em><em>)</em>) – Activation function for embeddings.</p></li>
<li><p><strong>embedding_type</strong> (<em>str</em><em>, </em><em>default=&quot;linear&quot;</em>) – Type of embedding to use (‘linear’, ‘plr’, etc.).</p></li>
<li><p><strong>plr_lite</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use a lightweight version of Piecewise Linear Regression (PLR).</p></li>
<li><p><strong>n_frequencies</strong> (<em>int</em><em>, </em><em>default=48</em>) – Number of frequencies for PLR embeddings.</p></li>
<li><p><strong>frequencies_init_scale</strong> (<em>float</em><em>, </em><em>default=0.01</em>) – Initial scale for frequency parameters in embeddings.</p></li>
<li><p><strong>embedding_bias</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use bias in embedding layers.</p></li>
<li><p><strong>layer_norm_after_embedding</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to apply layer normalization after embedding layers.</p></li>
<li><p><strong>head_layer_sizes</strong> (<em>list</em><em>, </em><em>default=</em><em>(</em><em>)</em>) – Sizes of the fully connected layers in the model’s head.</p></li>
<li><p><strong>head_dropout</strong> (<em>float</em><em>, </em><em>default=0.5</em>) – Dropout rate for the head layers.</p></li>
<li><p><strong>head_skip_layers</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use skip connections in the head layers.</p></li>
<li><p><strong>head_activation</strong> (<em>callable</em><em>, </em><em>default=nn.SELU</em><em>(</em><em>)</em>) – Activation function for the head layers.</p></li>
<li><p><strong>head_use_batch_norm</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use batch normalization in the head layers.</p></li>
<li><p><strong>pooling_method</strong> (<em>str</em><em>, </em><em>default=&quot;avg&quot;</em>) – Pooling method to be used (‘cls’, ‘avg’, etc.).</p></li>
<li><p><strong>use_cls</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use a CLS token for pooling.</p></li>
<li><p><strong>cat_encoding</strong> (<em>str</em><em>, </em><em>default=&quot;int&quot;</em>) – Method for encoding categorical features (‘int’, ‘one-hot’, or ‘linear’).</p></li>
<li><p><strong>n_bins</strong> (<em>int</em><em>, </em><em>default=50</em>) – The number of bins to use for numerical feature binning. This parameter is relevant
only if <code class="docutils literal notranslate"><span class="pre">numerical_preprocessing</span></code> is set to ‘binning’, ‘ple’ or ‘one-hot’.</p></li>
<li><p><strong>numerical_preprocessing</strong> (<em>str</em><em>, </em><em>default=&quot;ple&quot;</em>) – The preprocessing strategy for numerical features. Valid options are
‘ple’, ‘binning’, ‘one-hot’, ‘standardization’, ‘min-max’, ‘quantile’, ‘polynomial’,
‘splines’, ‘box-cox’, ‘yeo-johnson’ and None</p></li>
<li><p><strong>categorical_preprocessing</strong> (<em>str</em><em>, </em><em>default=&quot;int&quot;</em>) – The preprocessing strategy for categorical features. Valid options are
‘int’, ‘one-hot’, None</p></li>
<li><p><strong>use_decision_tree_bins</strong> (<em>bool</em><em>, </em><em>default=False</em>) – If True, uses decision tree regression/classification to determine
optimal bin edges for numerical feature binning. This parameter is
relevant only if <code class="docutils literal notranslate"><span class="pre">numerical_preprocessing</span></code> is set to ‘binning’ or ‘one-hot’.</p></li>
<li><p><strong>binning_strategy</strong> (<em>str</em><em>, </em><em>default=&quot;uniform&quot;</em>) – Defines the strategy for binning numerical features. Options include ‘uniform’,
‘quantile’, or other sklearn-compatible strategies.</p></li>
<li><p><strong>task</strong> (<em>str</em><em>, </em><em>default=&quot;regression&quot;</em>) – Indicates the type of machine learning task (‘regression’ or ‘classification’). This can
influence certain preprocessing behaviors, especially when using decision tree-based binning.</p></li>
<li><p><strong>cat_cutoff</strong> (<em>float</em><em> or </em><em>int</em><em>, </em><em>default=0.03</em>) – Indicates the cutoff after which integer values are treated as categorical.
If float, it’s treated as a percentage. If int, it’s the maximum number of
unique values for a column to be considered categorical.</p></li>
<li><p><strong>treat_all_integers_as_numerical</strong> (<em>bool</em><em>, </em><em>default=False</em>) – If True, all integer columns will be treated as numerical, regardless
of their unique value count or proportion.</p></li>
<li><p><strong>degree</strong> (<em>int</em><em>, </em><em>default=3</em>) – The degree of the polynomial features to be used in preprocessing.</p></li>
<li><p><strong>knots</strong> (<em>int</em><em>, </em><em>default=12</em>) – The number of knots to be used in spline transformations.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mambular.models</span> <span class="kn">import</span> <span class="n">FTTransformerClassifier</span>
<span class="go">    &gt;&gt;&gt; model = FTTransformerClassifier(d_model=64, n_layers=8)</span>
<span class="go">    &gt;&gt;&gt; model.fit(X_train, y_train)</span>
<span class="go">    &gt;&gt;&gt; preds = model.predict(X_test)</span>
<span class="go">    &gt;&gt;&gt; model.evaluate(X_test, y_test)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.FTTransformerClassifier.build_model">
<span class="sig-name descname"><span class="pre">build_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">101</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_patience</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_decay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataloader_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.FTTransformerClassifier.build_model" title="Permalink to this definition">#</a></dt>
<dd><p>Builds the model using the provided training data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The training input samples.</p></li>
<li><p><strong>y</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em>) – The target values (real numbers).</p></li>
<li><p><strong>val_size</strong> (<em>float</em><em>, </em><em>default=0.2</em>) – The proportion of the dataset to include in the validation split if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is None. Ignored if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>X_val</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em><em>, </em><em>optional</em>) – The validation input samples. If provided, <code class="docutils literal notranslate"><span class="pre">X</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> are not split and this data is used for validation.</p></li>
<li><p><strong>y_val</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em><em>, </em><em>optional</em>) – The validation target values. Required if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>random_state</strong> (<em>int</em><em>, </em><em>default=101</em>) – Controls the shuffling applied to the data before applying the split.</p></li>
<li><p><strong>batch_size</strong> (<em>int</em><em>, </em><em>default=64</em>) – Number of samples per gradient update.</p></li>
<li><p><strong>shuffle</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to shuffle the training data before each epoch.</p></li>
<li><p><strong>lr</strong> (<em>float</em><em>, </em><em>default=1e-3</em>) – Learning rate for the optimizer.</p></li>
<li><p><strong>lr_patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement on the validation loss to wait before reducing the learning rate.</p></li>
<li><p><strong>factor</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Factor by which the learning rate will be reduced.</p></li>
<li><p><strong>weight_decay</strong> (<em>float</em><em>, </em><em>default=0.025</em>) – Weight decay (L2 penalty) coefficient.</p></li>
<li><p><strong>dataloader_kwargs</strong> (<em>dict</em><em>, </em><em>default={}</em>) – The kwargs for the pytorch dataloader class.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – The built classifier.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.FTTransformerClassifier.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.FTTransformerClassifier.evaluate" title="Permalink to this definition">#</a></dt>
<dd><p>Evaluate the model on the given data using specified metrics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array-like</em><em> or </em><em>pd.DataFrame</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The input samples to predict.</p></li>
<li><p><strong>y_true</strong> (<em>array-like</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>)</em>) – The true class labels against which to evaluate the predictions.</p></li>
<li><p><strong>metrics</strong> (<em>dict</em>) – A dictionary where keys are metric names and values are tuples containing the metric function
and a boolean indicating whether the metric requires probability scores (True) or class labels (False).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>scores</strong> – A dictionary with metric names as keys and their corresponding scores as values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This method uses either the <code class="docutils literal notranslate"><span class="pre">predict</span></code> or <code class="docutils literal notranslate"><span class="pre">predict_proba</span></code> method depending on the metric requirements.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.FTTransformerClassifier.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">101</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patience</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">15</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">monitor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'val_loss'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'min'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_patience</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_decay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checkpoint_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'model_checkpoints'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataloader_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rebuild</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">trainer_kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.FTTransformerClassifier.fit" title="Permalink to this definition">#</a></dt>
<dd><p>Trains the classification model using the provided training data. Optionally, a separate validation set can be used.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The training input samples.</p></li>
<li><p><strong>y</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em>) – The target values (real numbers).</p></li>
<li><p><strong>val_size</strong> (<em>float</em><em>, </em><em>default=0.2</em>) – The proportion of the dataset to include in the validation split if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is None. Ignored if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>X_val</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em><em>, </em><em>optional</em>) – The validation input samples. If provided, <code class="docutils literal notranslate"><span class="pre">X</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> are not split and this data is used for validation.</p></li>
<li><p><strong>y_val</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em><em>, </em><em>optional</em>) – The validation target values. Required if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>max_epochs</strong> (<em>int</em><em>, </em><em>default=100</em>) – Maximum number of epochs for training.</p></li>
<li><p><strong>random_state</strong> (<em>int</em><em>, </em><em>default=101</em>) – Controls the shuffling applied to the data before applying the split.</p></li>
<li><p><strong>batch_size</strong> (<em>int</em><em>, </em><em>default=64</em>) – Number of samples per gradient update.</p></li>
<li><p><strong>shuffle</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to shuffle the training data before each epoch.</p></li>
<li><p><strong>patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement on the validation loss to wait before early stopping.</p></li>
<li><p><strong>monitor</strong> (<em>str</em><em>, </em><em>default=&quot;val_loss&quot;</em>) – The metric to monitor for early stopping.</p></li>
<li><p><strong>mode</strong> (<em>str</em><em>, </em><em>default=&quot;min&quot;</em>) – Whether the monitored metric should be minimized (<code class="docutils literal notranslate"><span class="pre">min</span></code>) or maximized (<code class="docutils literal notranslate"><span class="pre">max</span></code>).</p></li>
<li><p><strong>lr</strong> (<em>float</em><em>, </em><em>default=1e-3</em>) – Learning rate for the optimizer.</p></li>
<li><p><strong>lr_patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement on the validation loss to wait before reducing the learning rate.</p></li>
<li><p><strong>factor</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Factor by which the learning rate will be reduced.</p></li>
<li><p><strong>weight_decay</strong> (<em>float</em><em>, </em><em>default=0.025</em>) – Weight decay (L2 penalty) coefficient.</p></li>
<li><p><strong>checkpoint_path</strong> (<em>str</em><em>, </em><em>default=&quot;model_checkpoints&quot;</em>) – Path where the checkpoints are being saved.</p></li>
<li><p><strong>dataloader_kwargs</strong> (<em>dict</em><em>, </em><em>default={}</em>) – The kwargs for the pytorch dataloader class.</p></li>
<li><p><strong>rebuild</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to rebuild the model when it already was built.</p></li>
<li><p><strong>**trainer_kwargs</strong> (<em>Additional keyword arguments for PyTorch Lightning's Trainer class.</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – The fitted classifier.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.FTTransformerClassifier.get_number_of_params">
<span class="sig-name descname"><span class="pre">get_number_of_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">requires_grad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.FTTransformerClassifier.get_number_of_params" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate the number of parameters in the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>requires_grad</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, only count the parameters that require gradients (trainable parameters).
If False, count all parameters. Default is True.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The total number of parameters in the model.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the model has not been built prior to calling this method.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.FTTransformerClassifier.get_params">
<span class="sig-name descname"><span class="pre">get_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">deep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.FTTransformerClassifier.get_params" title="Permalink to this definition">#</a></dt>
<dd><p>Get parameters for this estimator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>deep</strong> (<em>bool</em><em>, </em><em>default=True</em>) – If True, will return the parameters for this estimator and contained subobjects that are estimators.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>params</strong> – Parameter names mapped to their values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.FTTransformerClassifier.optimize_hparams">
<span class="sig-name descname"><span class="pre">optimize_hparams</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prune_by_epoch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prune_epoch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fixed_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'cat_encoding':</span> <span class="pre">'int',</span> <span class="pre">'head_layer_size_length':</span> <span class="pre">0,</span> <span class="pre">'head_skip_layer':</span> <span class="pre">False,</span> <span class="pre">'head_skip_layers':</span> <span class="pre">False,</span> <span class="pre">'pooling_method':</span> <span class="pre">'avg',</span> <span class="pre">'use_cls':</span> <span class="pre">False}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">custom_search_space</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">optimize_kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.FTTransformerClassifier.optimize_hparams" title="Permalink to this definition">#</a></dt>
<dd><p>Optimizes hyperparameters using Bayesian optimization with optional pruning.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array-like</em>) – Training data.</p></li>
<li><p><strong>y</strong> (<em>array-like</em>) – Training labels.</p></li>
<li><p><strong>X_val</strong> (<em>array-like</em><em>, </em><em>optional</em>) – Validation data and labels.</p></li>
<li><p><strong>y_val</strong> (<em>array-like</em><em>, </em><em>optional</em>) – Validation data and labels.</p></li>
<li><p><strong>time</strong> (<em>int</em>) – The number of optimization trials to run.</p></li>
<li><p><strong>max_epochs</strong> (<em>int</em>) – Maximum number of epochs for training.</p></li>
<li><p><strong>prune_by_epoch</strong> (<em>bool</em>) – Whether to prune based on a specific epoch (True) or the best validation loss (False).</p></li>
<li><p><strong>prune_epoch</strong> (<em>int</em>) – The specific epoch to prune by when prune_by_epoch is True.</p></li>
<li><p><strong>**optimize_kwargs</strong> (<em>dict</em>) – Additional keyword arguments passed to the fit method.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>best_hparams</strong> – Best hyperparameters found during optimization.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.FTTransformerClassifier.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.FTTransformerClassifier.predict" title="Permalink to this definition">#</a></dt>
<dd><p>Predicts target values for the given input samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>X</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The input samples for which to predict target values.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>predictions</strong> – The predicted target values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray, shape (n_samples,) or (n_samples, n_outputs)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.FTTransformerClassifier.predict_proba">
<span class="sig-name descname"><span class="pre">predict_proba</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.FTTransformerClassifier.predict_proba" title="Permalink to this definition">#</a></dt>
<dd><p>Predict class probabilities for the given input samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>X</strong> (<em>array-like</em><em> or </em><em>pd.DataFrame</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The input samples for which to predict class probabilities.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The method preprocesses the input data using the same preprocessor used during training,
sets the model to evaluation mode, and then performs inference to predict the class probabilities.
Softmax is applied to the logits to obtain probabilities, which are then converted from a PyTorch tensor
to a NumPy array before being returned.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">accuracy_score</span><span class="p">,</span> <span class="n">precision_score</span><span class="p">,</span> <span class="n">f1_score</span><span class="p">,</span> <span class="n">roc_auc_score</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Define the metrics you want to evaluate</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">metrics</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">... </span>    <span class="s1">&#39;Accuracy&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">accuracy_score</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
<span class="gp">... </span>    <span class="s1">&#39;Precision&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">precision_score</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
<span class="gp">... </span>    <span class="s1">&#39;F1 Score&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">f1_score</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
<span class="gp">... </span>    <span class="s1">&#39;AUC Score&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">roc_auc_score</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
<span class="gp">... </span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Assuming &#39;X_test&#39; and &#39;y_test&#39; are your test dataset and labels</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Evaluate using the specified metrics</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results</span> <span class="o">=</span> <span class="n">classifier</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="n">metrics</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>probabilities</strong> – Predicted class probabilities for each input sample.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>ndarray of shape (n_samples, n_classes)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.FTTransformerClassifier.score">
<span class="sig-name descname"><span class="pre">score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(sklearn.metrics.log_loss,</span> <span class="pre">True)</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.FTTransformerClassifier.score" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate the score of the model using the specified metric.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array-like</em><em> or </em><em>pd.DataFrame</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The input samples to predict.</p></li>
<li><p><strong>y</strong> (<em>array-like</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>)</em>) – The true class labels against which to evaluate the predictions.</p></li>
<li><p><strong>metric</strong> (<em>tuple</em><em>, </em><em>default=</em><em>(</em><em>log_loss</em><em>, </em><em>True</em><em>)</em>) – A tuple containing the metric function and a boolean indicating whether the metric requires probability scores (True) or class labels (False).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>score</strong> – The score calculated using the specified metric.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.FTTransformerClassifier.set_params">
<span class="sig-name descname"><span class="pre">set_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">parameters</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.FTTransformerClassifier.set_params" title="Permalink to this definition">#</a></dt>
<dd><p>Set the parameters of this estimator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>**parameters</strong> (<em>dict</em>) – Estimator parameters.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – Estimator instance.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mambular.models.FTTransformerRegressor">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mambular.models.</span></span><span class="sig-name descname"><span class="pre">FTTransformerRegressor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/mambular/models/fttransformer.html#FTTransformerRegressor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mambular.models.FTTransformerRegressor" title="Permalink to this definition">#</a></dt>
<dd><dl class="simple">
<dt>FTTransformer regressor. This class extends the SklearnBaseRegressor</dt><dd><p>class and uses the FTTransformer model with the default FTTransformer
configuration.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The parameters for this class include the attributes from the config
dataclass as well as preprocessing arguments handled by the base class.</p>
<p>Configuration class for the FT Transformer model with predefined hyperparameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lr</strong> (<em>float</em><em>, </em><em>default=1e-04</em>) – Learning rate for the optimizer.</p></li>
<li><p><strong>lr_patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement after which the learning rate will be reduced.</p></li>
<li><p><strong>weight_decay</strong> (<em>float</em><em>, </em><em>default=1e-06</em>) – Weight decay (L2 regularization) for the optimizer.</p></li>
<li><p><strong>lr_factor</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Factor by which the learning rate will be reduced.</p></li>
<li><p><strong>d_model</strong> (<em>int</em><em>, </em><em>default=128</em>) – Dimensionality of the transformer model.</p></li>
<li><p><strong>n_layers</strong> (<em>int</em><em>, </em><em>default=4</em>) – Number of transformer layers.</p></li>
<li><p><strong>n_heads</strong> (<em>int</em><em>, </em><em>default=8</em>) – Number of attention heads in the transformer.</p></li>
<li><p><strong>attn_dropout</strong> (<em>float</em><em>, </em><em>default=0.2</em>) – Dropout rate for the attention mechanism.</p></li>
<li><p><strong>ff_dropout</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Dropout rate for the feed-forward layers.</p></li>
<li><p><strong>norm</strong> (<em>str</em><em>, </em><em>default=&quot;LayerNorm&quot;</em>) – Type of normalization to be used (‘LayerNorm’, ‘RMSNorm’, etc.).</p></li>
<li><p><strong>activation</strong> (<em>callable</em><em>, </em><em>default=nn.SELU</em><em>(</em><em>)</em>) – Activation function for the transformer layers.</p></li>
<li><p><strong>transformer_activation</strong> (<em>callable</em><em>, </em><em>default=ReGLU</em><em>(</em><em>)</em>) – Activation function for the transformer feed-forward layers.</p></li>
<li><p><strong>transformer_dim_feedforward</strong> (<em>int</em><em>, </em><em>default=256</em>) – Dimensionality of the feed-forward layers in the transformer.</p></li>
<li><p><strong>layer_norm_eps</strong> (<em>float</em><em>, </em><em>default=1e-05</em>) – Epsilon value for layer normalization to improve numerical stability.</p></li>
<li><p><strong>norm_first</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to apply normalization before other operations in each transformer block.</p></li>
<li><p><strong>bias</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to use bias in linear layers.</p></li>
<li><p><strong>embedding_activation</strong> (<em>callable</em><em>, </em><em>default=nn.Identity</em><em>(</em><em>)</em>) – Activation function for embeddings.</p></li>
<li><p><strong>embedding_type</strong> (<em>str</em><em>, </em><em>default=&quot;linear&quot;</em>) – Type of embedding to use (‘linear’, ‘plr’, etc.).</p></li>
<li><p><strong>plr_lite</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use a lightweight version of Piecewise Linear Regression (PLR).</p></li>
<li><p><strong>n_frequencies</strong> (<em>int</em><em>, </em><em>default=48</em>) – Number of frequencies for PLR embeddings.</p></li>
<li><p><strong>frequencies_init_scale</strong> (<em>float</em><em>, </em><em>default=0.01</em>) – Initial scale for frequency parameters in embeddings.</p></li>
<li><p><strong>embedding_bias</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use bias in embedding layers.</p></li>
<li><p><strong>layer_norm_after_embedding</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to apply layer normalization after embedding layers.</p></li>
<li><p><strong>head_layer_sizes</strong> (<em>list</em><em>, </em><em>default=</em><em>(</em><em>)</em>) – Sizes of the fully connected layers in the model’s head.</p></li>
<li><p><strong>head_dropout</strong> (<em>float</em><em>, </em><em>default=0.5</em>) – Dropout rate for the head layers.</p></li>
<li><p><strong>head_skip_layers</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use skip connections in the head layers.</p></li>
<li><p><strong>head_activation</strong> (<em>callable</em><em>, </em><em>default=nn.SELU</em><em>(</em><em>)</em>) – Activation function for the head layers.</p></li>
<li><p><strong>head_use_batch_norm</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use batch normalization in the head layers.</p></li>
<li><p><strong>pooling_method</strong> (<em>str</em><em>, </em><em>default=&quot;avg&quot;</em>) – Pooling method to be used (‘cls’, ‘avg’, etc.).</p></li>
<li><p><strong>use_cls</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use a CLS token for pooling.</p></li>
<li><p><strong>cat_encoding</strong> (<em>str</em><em>, </em><em>default=&quot;int&quot;</em>) – Method for encoding categorical features (‘int’, ‘one-hot’, or ‘linear’).</p></li>
<li><p><strong>n_bins</strong> (<em>int</em><em>, </em><em>default=50</em>) – The number of bins to use for numerical feature binning. This parameter is relevant
only if <code class="docutils literal notranslate"><span class="pre">numerical_preprocessing</span></code> is set to ‘binning’, ‘ple’ or ‘one-hot’.</p></li>
<li><p><strong>numerical_preprocessing</strong> (<em>str</em><em>, </em><em>default=&quot;ple&quot;</em>) – The preprocessing strategy for numerical features. Valid options are
‘ple’, ‘binning’, ‘one-hot’, ‘standardization’, ‘min-max’, ‘quantile’, ‘polynomial’,
‘splines’, ‘box-cox’, ‘yeo-johnson’ and None</p></li>
<li><p><strong>categorical_preprocessing</strong> (<em>str</em><em>, </em><em>default=&quot;int&quot;</em>) – The preprocessing strategy for categorical features. Valid options are
‘int’, ‘one-hot’, None</p></li>
<li><p><strong>use_decision_tree_bins</strong> (<em>bool</em><em>, </em><em>default=False</em>) – If True, uses decision tree regression/classification to determine
optimal bin edges for numerical feature binning. This parameter is
relevant only if <code class="docutils literal notranslate"><span class="pre">numerical_preprocessing</span></code> is set to ‘binning’ or ‘one-hot’.</p></li>
<li><p><strong>binning_strategy</strong> (<em>str</em><em>, </em><em>default=&quot;uniform&quot;</em>) – Defines the strategy for binning numerical features. Options include ‘uniform’,
‘quantile’, or other sklearn-compatible strategies.</p></li>
<li><p><strong>task</strong> (<em>str</em><em>, </em><em>default=&quot;regression&quot;</em>) – Indicates the type of machine learning task (‘regression’ or ‘classification’). This can
influence certain preprocessing behaviors, especially when using decision tree-based binning.</p></li>
<li><p><strong>cat_cutoff</strong> (<em>float</em><em> or </em><em>int</em><em>, </em><em>default=0.03</em>) – Indicates the cutoff after which integer values are treated as categorical.
If float, it’s treated as a percentage. If int, it’s the maximum number of
unique values for a column to be considered categorical.</p></li>
<li><p><strong>treat_all_integers_as_numerical</strong> (<em>bool</em><em>, </em><em>default=False</em>) – If True, all integer columns will be treated as numerical, regardless
of their unique value count or proportion.</p></li>
<li><p><strong>degree</strong> (<em>int</em><em>, </em><em>default=3</em>) – The degree of the polynomial features to be used in preprocessing.</p></li>
<li><p><strong>knots</strong> (<em>int</em><em>, </em><em>default=12</em>) – The number of knots to be used in spline transformations.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mambular.models</span> <span class="kn">import</span> <span class="n">FTTransformerRegressor</span>
<span class="go">    &gt;&gt;&gt; model = FTTransformerRegressor(d_model=64, n_layers=8)</span>
<span class="go">    &gt;&gt;&gt; model.fit(X_train, y_train)</span>
<span class="go">    &gt;&gt;&gt; preds = model.predict(X_test)</span>
<span class="go">    &gt;&gt;&gt; model.evaluate(X_test, y_test)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.FTTransformerRegressor.build_model">
<span class="sig-name descname"><span class="pre">build_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">101</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_patience</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_decay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataloader_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.FTTransformerRegressor.build_model" title="Permalink to this definition">#</a></dt>
<dd><p>Builds the model using the provided training data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The training input samples.</p></li>
<li><p><strong>y</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em>) – The target values (real numbers).</p></li>
<li><p><strong>val_size</strong> (<em>float</em><em>, </em><em>default=0.2</em>) – The proportion of the dataset to include in the validation split if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is None. Ignored if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>X_val</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em><em>, </em><em>optional</em>) – The validation input samples. If provided, <code class="docutils literal notranslate"><span class="pre">X</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> are not split and this data is used for validation.</p></li>
<li><p><strong>y_val</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em><em>, </em><em>optional</em>) – The validation target values. Required if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>random_state</strong> (<em>int</em><em>, </em><em>default=101</em>) – Controls the shuffling applied to the data before applying the split.</p></li>
<li><p><strong>batch_size</strong> (<em>int</em><em>, </em><em>default=64</em>) – Number of samples per gradient update.</p></li>
<li><p><strong>shuffle</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to shuffle the training data before each epoch.</p></li>
<li><p><strong>lr</strong> (<em>float</em><em>, </em><em>default=1e-3</em>) – Learning rate for the optimizer.</p></li>
<li><p><strong>lr_patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement on the validation loss to wait before reducing the learning rate.</p></li>
<li><p><strong>factor</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Factor by which the learning rate will be reduced.</p></li>
<li><p><strong>weight_decay</strong> (<em>float</em><em>, </em><em>default=0.025</em>) – Weight decay (L2 penalty) coefficient.</p></li>
<li><p><strong>dataloader_kwargs</strong> (<em>dict</em><em>, </em><em>default={}</em>) – The kwargs for the pytorch dataloader class.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – The built regressor.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.FTTransformerRegressor.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.FTTransformerRegressor.evaluate" title="Permalink to this definition">#</a></dt>
<dd><p>Evaluate the model on the given data using specified metrics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array-like</em><em> or </em><em>pd.DataFrame</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The input samples to predict.</p></li>
<li><p><strong>y_true</strong> (<em>array-like</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_outputs</em><em>)</em>) – The true target values against which to evaluate the predictions.</p></li>
<li><p><strong>metrics</strong> (<em>dict</em>) – A dictionary where keys are metric names and values are the metric functions.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This method uses the <code class="docutils literal notranslate"><span class="pre">predict</span></code> method to generate predictions and computes each metric.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_squared_error</span><span class="p">,</span> <span class="n">r2_score</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mambular.models</span> <span class="kn">import</span> <span class="n">MambularRegressor</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">metrics</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">... </span>    <span class="s1">&#39;Mean Squared Error&#39;</span><span class="p">:</span> <span class="n">mean_squared_error</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s1">&#39;R2 Score&#39;</span><span class="p">:</span> <span class="n">r2_score</span>
<span class="gp">... </span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Assuming &#39;X_test&#39; and &#39;y_test&#39; are your test dataset and labels</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Evaluate using the specified metrics</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results</span> <span class="o">=</span> <span class="n">regressor</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="n">metrics</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>scores</strong> – A dictionary with metric names as keys and their corresponding scores as values.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.FTTransformerRegressor.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">101</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patience</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">15</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">monitor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'val_loss'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'min'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_patience</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_decay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checkpoint_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'model_checkpoints'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataloader_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rebuild</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">trainer_kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.FTTransformerRegressor.fit" title="Permalink to this definition">#</a></dt>
<dd><p>Trains the regression model using the provided training data. Optionally, a separate validation set can be used.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The training input samples.</p></li>
<li><p><strong>y</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em>) – The target values (real numbers).</p></li>
<li><p><strong>val_size</strong> (<em>float</em><em>, </em><em>default=0.2</em>) – The proportion of the dataset to include in the validation split if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is None. Ignored if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>X_val</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em><em>, </em><em>optional</em>) – The validation input samples. If provided, <code class="docutils literal notranslate"><span class="pre">X</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> are not split and this data is used for validation.</p></li>
<li><p><strong>y_val</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em><em>, </em><em>optional</em>) – The validation target values. Required if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>max_epochs</strong> (<em>int</em><em>, </em><em>default=100</em>) – Maximum number of epochs for training.</p></li>
<li><p><strong>random_state</strong> (<em>int</em><em>, </em><em>default=101</em>) – Controls the shuffling applied to the data before applying the split.</p></li>
<li><p><strong>batch_size</strong> (<em>int</em><em>, </em><em>default=64</em>) – Number of samples per gradient update.</p></li>
<li><p><strong>shuffle</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to shuffle the training data before each epoch.</p></li>
<li><p><strong>patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement on the validation loss to wait before early stopping.</p></li>
<li><p><strong>monitor</strong> (<em>str</em><em>, </em><em>default=&quot;val_loss&quot;</em>) – The metric to monitor for early stopping.</p></li>
<li><p><strong>mode</strong> (<em>str</em><em>, </em><em>default=&quot;min&quot;</em>) – Whether the monitored metric should be minimized (<code class="docutils literal notranslate"><span class="pre">min</span></code>) or maximized (<code class="docutils literal notranslate"><span class="pre">max</span></code>).</p></li>
<li><p><strong>lr</strong> (<em>float</em><em>, </em><em>default=1e-3</em>) – Learning rate for the optimizer.</p></li>
<li><p><strong>lr_patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement on the validation loss to wait before reducing the learning rate.</p></li>
<li><p><strong>factor</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Factor by which the learning rate will be reduced.</p></li>
<li><p><strong>weight_decay</strong> (<em>float</em><em>, </em><em>default=0.025</em>) – Weight decay (L2 penalty) coefficient.</p></li>
<li><p><strong>checkpoint_path</strong> (<em>str</em><em>, </em><em>default=&quot;model_checkpoints&quot;</em>) – Path where the checkpoints are being saved.</p></li>
<li><p><strong>dataloader_kwargs</strong> (<em>dict</em><em>, </em><em>default={}</em>) – The kwargs for the pytorch dataloader class.</p></li>
<li><p><strong>**trainer_kwargs</strong> (<em>Additional keyword arguments for PyTorch Lightning's Trainer class.</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – The fitted regressor.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.FTTransformerRegressor.get_number_of_params">
<span class="sig-name descname"><span class="pre">get_number_of_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">requires_grad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.FTTransformerRegressor.get_number_of_params" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate the number of parameters in the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>requires_grad</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, only count the parameters that require gradients (trainable parameters).
If False, count all parameters. Default is True.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The total number of parameters in the model.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the model has not been built prior to calling this method.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.FTTransformerRegressor.get_params">
<span class="sig-name descname"><span class="pre">get_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">deep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.FTTransformerRegressor.get_params" title="Permalink to this definition">#</a></dt>
<dd><p>Get parameters for this estimator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>deep</strong> (<em>bool</em><em>, </em><em>default=True</em>) – If True, will return the parameters for this estimator and contained subobjects that are estimators.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>params</strong> – Parameter names mapped to their values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.FTTransformerRegressor.optimize_hparams">
<span class="sig-name descname"><span class="pre">optimize_hparams</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prune_by_epoch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prune_epoch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fixed_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'cat_encoding':</span> <span class="pre">'int',</span> <span class="pre">'head_layer_size_length':</span> <span class="pre">0,</span> <span class="pre">'head_skip_layer':</span> <span class="pre">False,</span> <span class="pre">'head_skip_layers':</span> <span class="pre">False,</span> <span class="pre">'pooling_method':</span> <span class="pre">'avg',</span> <span class="pre">'use_cls':</span> <span class="pre">False}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">custom_search_space</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">optimize_kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.FTTransformerRegressor.optimize_hparams" title="Permalink to this definition">#</a></dt>
<dd><p>Optimizes hyperparameters using Bayesian optimization with optional pruning.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array-like</em>) – Training data.</p></li>
<li><p><strong>y</strong> (<em>array-like</em>) – Training labels.</p></li>
<li><p><strong>X_val</strong> (<em>array-like</em><em>, </em><em>optional</em>) – Validation data and labels.</p></li>
<li><p><strong>y_val</strong> (<em>array-like</em><em>, </em><em>optional</em>) – Validation data and labels.</p></li>
<li><p><strong>time</strong> (<em>int</em>) – The number of optimization trials to run.</p></li>
<li><p><strong>max_epochs</strong> (<em>int</em>) – Maximum number of epochs for training.</p></li>
<li><p><strong>prune_by_epoch</strong> (<em>bool</em>) – Whether to prune based on a specific epoch (True) or the best validation loss (False).</p></li>
<li><p><strong>prune_epoch</strong> (<em>int</em>) – The specific epoch to prune by when prune_by_epoch is True.</p></li>
<li><p><strong>**optimize_kwargs</strong> (<em>dict</em>) – Additional keyword arguments passed to the fit method.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>best_hparams</strong> – Best hyperparameters found during optimization.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.FTTransformerRegressor.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.FTTransformerRegressor.predict" title="Permalink to this definition">#</a></dt>
<dd><p>Predicts target values for the given input samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>X</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The input samples for which to predict target values.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>predictions</strong> – The predicted target values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray, shape (n_samples,) or (n_samples, n_outputs)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.FTTransformerRegressor.score">
<span class="sig-name descname"><span class="pre">score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">sklearn.metrics.mean_squared_error</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.FTTransformerRegressor.score" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate the score of the model using the specified metric.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array-like</em><em> or </em><em>pd.DataFrame</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The input samples to predict.</p></li>
<li><p><strong>y</strong> (<em>array-like</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_outputs</em><em>)</em>) – The true target values against which to evaluate the predictions.</p></li>
<li><p><strong>metric</strong> (<em>callable</em><em>, </em><em>default=mean_squared_error</em>) – The metric function to use for evaluation. Must be a callable with the signature <code class="docutils literal notranslate"><span class="pre">metric(y_true,</span> <span class="pre">y_pred)</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>score</strong> – The score calculated using the specified metric.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.FTTransformerRegressor.set_params">
<span class="sig-name descname"><span class="pre">set_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">parameters</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.FTTransformerRegressor.set_params" title="Permalink to this definition">#</a></dt>
<dd><p>Set the parameters of this estimator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>**parameters</strong> (<em>dict</em>) – Estimator parameters.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – Estimator instance.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mambular.models.FTTransformerLSS">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mambular.models.</span></span><span class="sig-name descname"><span class="pre">FTTransformerLSS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/mambular/models/fttransformer.html#FTTransformerLSS"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mambular.models.FTTransformerLSS" title="Permalink to this definition">#</a></dt>
<dd><dl class="simple">
<dt>FTTransformer for distributional regression.</dt><dd><p>This class extends the SklearnBaseLSS class and uses the
FTTransformer model with the default FTTransformer configuration.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The parameters for this class include the attributes from the config
dataclass as well as preprocessing arguments handled by the base class.</p>
<p>Configuration class for the FT Transformer model with predefined hyperparameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lr</strong> (<em>float</em><em>, </em><em>default=1e-04</em>) – Learning rate for the optimizer.</p></li>
<li><p><strong>lr_patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement after which the learning rate will be reduced.</p></li>
<li><p><strong>weight_decay</strong> (<em>float</em><em>, </em><em>default=1e-06</em>) – Weight decay (L2 regularization) for the optimizer.</p></li>
<li><p><strong>lr_factor</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Factor by which the learning rate will be reduced.</p></li>
<li><p><strong>d_model</strong> (<em>int</em><em>, </em><em>default=128</em>) – Dimensionality of the transformer model.</p></li>
<li><p><strong>n_layers</strong> (<em>int</em><em>, </em><em>default=4</em>) – Number of transformer layers.</p></li>
<li><p><strong>n_heads</strong> (<em>int</em><em>, </em><em>default=8</em>) – Number of attention heads in the transformer.</p></li>
<li><p><strong>attn_dropout</strong> (<em>float</em><em>, </em><em>default=0.2</em>) – Dropout rate for the attention mechanism.</p></li>
<li><p><strong>ff_dropout</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Dropout rate for the feed-forward layers.</p></li>
<li><p><strong>norm</strong> (<em>str</em><em>, </em><em>default=&quot;LayerNorm&quot;</em>) – Type of normalization to be used (‘LayerNorm’, ‘RMSNorm’, etc.).</p></li>
<li><p><strong>activation</strong> (<em>callable</em><em>, </em><em>default=nn.SELU</em><em>(</em><em>)</em>) – Activation function for the transformer layers.</p></li>
<li><p><strong>transformer_activation</strong> (<em>callable</em><em>, </em><em>default=ReGLU</em><em>(</em><em>)</em>) – Activation function for the transformer feed-forward layers.</p></li>
<li><p><strong>transformer_dim_feedforward</strong> (<em>int</em><em>, </em><em>default=256</em>) – Dimensionality of the feed-forward layers in the transformer.</p></li>
<li><p><strong>layer_norm_eps</strong> (<em>float</em><em>, </em><em>default=1e-05</em>) – Epsilon value for layer normalization to improve numerical stability.</p></li>
<li><p><strong>norm_first</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to apply normalization before other operations in each transformer block.</p></li>
<li><p><strong>bias</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to use bias in linear layers.</p></li>
<li><p><strong>embedding_activation</strong> (<em>callable</em><em>, </em><em>default=nn.Identity</em><em>(</em><em>)</em>) – Activation function for embeddings.</p></li>
<li><p><strong>embedding_type</strong> (<em>str</em><em>, </em><em>default=&quot;linear&quot;</em>) – Type of embedding to use (‘linear’, ‘plr’, etc.).</p></li>
<li><p><strong>plr_lite</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use a lightweight version of Piecewise Linear Regression (PLR).</p></li>
<li><p><strong>n_frequencies</strong> (<em>int</em><em>, </em><em>default=48</em>) – Number of frequencies for PLR embeddings.</p></li>
<li><p><strong>frequencies_init_scale</strong> (<em>float</em><em>, </em><em>default=0.01</em>) – Initial scale for frequency parameters in embeddings.</p></li>
<li><p><strong>embedding_bias</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use bias in embedding layers.</p></li>
<li><p><strong>layer_norm_after_embedding</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to apply layer normalization after embedding layers.</p></li>
<li><p><strong>head_layer_sizes</strong> (<em>list</em><em>, </em><em>default=</em><em>(</em><em>)</em>) – Sizes of the fully connected layers in the model’s head.</p></li>
<li><p><strong>head_dropout</strong> (<em>float</em><em>, </em><em>default=0.5</em>) – Dropout rate for the head layers.</p></li>
<li><p><strong>head_skip_layers</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use skip connections in the head layers.</p></li>
<li><p><strong>head_activation</strong> (<em>callable</em><em>, </em><em>default=nn.SELU</em><em>(</em><em>)</em>) – Activation function for the head layers.</p></li>
<li><p><strong>head_use_batch_norm</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use batch normalization in the head layers.</p></li>
<li><p><strong>pooling_method</strong> (<em>str</em><em>, </em><em>default=&quot;avg&quot;</em>) – Pooling method to be used (‘cls’, ‘avg’, etc.).</p></li>
<li><p><strong>use_cls</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use a CLS token for pooling.</p></li>
<li><p><strong>cat_encoding</strong> (<em>str</em><em>, </em><em>default=&quot;int&quot;</em>) – Method for encoding categorical features (‘int’, ‘one-hot’, or ‘linear’).</p></li>
<li><p><strong>n_bins</strong> (<em>int</em><em>, </em><em>default=50</em>) – The number of bins to use for numerical feature binning. This parameter is relevant
only if <code class="docutils literal notranslate"><span class="pre">numerical_preprocessing</span></code> is set to ‘binning’, ‘ple’ or ‘one-hot’.</p></li>
<li><p><strong>numerical_preprocessing</strong> (<em>str</em><em>, </em><em>default=&quot;ple&quot;</em>) – The preprocessing strategy for numerical features. Valid options are
‘ple’, ‘binning’, ‘one-hot’, ‘standardization’, ‘min-max’, ‘quantile’, ‘polynomial’,
‘splines’, ‘box-cox’, ‘yeo-johnson’ and None</p></li>
<li><p><strong>categorical_preprocessing</strong> (<em>str</em><em>, </em><em>default=&quot;int&quot;</em>) – The preprocessing strategy for categorical features. Valid options are
‘int’, ‘one-hot’, None</p></li>
<li><p><strong>use_decision_tree_bins</strong> (<em>bool</em><em>, </em><em>default=False</em>) – If True, uses decision tree regression/classification to determine
optimal bin edges for numerical feature binning. This parameter is
relevant only if <code class="docutils literal notranslate"><span class="pre">numerical_preprocessing</span></code> is set to ‘binning’ or ‘one-hot’.</p></li>
<li><p><strong>binning_strategy</strong> (<em>str</em><em>, </em><em>default=&quot;uniform&quot;</em>) – Defines the strategy for binning numerical features. Options include ‘uniform’,
‘quantile’, or other sklearn-compatible strategies.</p></li>
<li><p><strong>task</strong> (<em>str</em><em>, </em><em>default=&quot;regression&quot;</em>) – Indicates the type of machine learning task (‘regression’ or ‘classification’). This can
influence certain preprocessing behaviors, especially when using decision tree-based binning.</p></li>
<li><p><strong>cat_cutoff</strong> (<em>float</em><em> or </em><em>int</em><em>, </em><em>default=0.03</em>) – Indicates the cutoff after which integer values are treated as categorical.
If float, it’s treated as a percentage. If int, it’s the maximum number of
unique values for a column to be considered categorical.</p></li>
<li><p><strong>treat_all_integers_as_numerical</strong> (<em>bool</em><em>, </em><em>default=False</em>) – If True, all integer columns will be treated as numerical, regardless
of their unique value count or proportion.</p></li>
<li><p><strong>degree</strong> (<em>int</em><em>, </em><em>default=3</em>) – The degree of the polynomial features to be used in preprocessing.</p></li>
<li><p><strong>knots</strong> (<em>int</em><em>, </em><em>default=12</em>) – The number of knots to be used in spline transformations.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mambular.models</span> <span class="kn">import</span> <span class="n">FTTransformerLSS</span>
<span class="go">    &gt;&gt;&gt; model = FTTransformerLSS(d_model=64, n_layers=8)</span>
<span class="go">    &gt;&gt;&gt; model.fit(X_train, y_train, family=&quot;normal&quot;)</span>
<span class="go">    &gt;&gt;&gt; preds = model.predict(X_test)</span>
<span class="go">    &gt;&gt;&gt; model.evaluate(X_test, y_test)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.FTTransformerLSS.build_model">
<span class="sig-name descname"><span class="pre">build_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">101</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_patience</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_decay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataloader_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.FTTransformerLSS.build_model" title="Permalink to this definition">#</a></dt>
<dd><p>Builds the model using the provided training data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The training input samples.</p></li>
<li><p><strong>y</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em>) – The target values (real numbers).</p></li>
<li><p><strong>val_size</strong> (<em>float</em><em>, </em><em>default=0.2</em>) – The proportion of the dataset to include in the validation split if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is None. Ignored if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>X_val</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em><em>, </em><em>optional</em>) – The validation input samples. If provided, <code class="docutils literal notranslate"><span class="pre">X</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> are not split and this data is used for validation.</p></li>
<li><p><strong>y_val</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em><em>, </em><em>optional</em>) – The validation target values. Required if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>random_state</strong> (<em>int</em><em>, </em><em>default=101</em>) – Controls the shuffling applied to the data before applying the split.</p></li>
<li><p><strong>batch_size</strong> (<em>int</em><em>, </em><em>default=64</em>) – Number of samples per gradient update.</p></li>
<li><p><strong>shuffle</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to shuffle the training data before each epoch.</p></li>
<li><p><strong>lr</strong> (<em>float</em><em>, </em><em>default=1e-3</em>) – Learning rate for the optimizer.</p></li>
<li><p><strong>lr_patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement on the validation loss to wait before reducing the learning rate.</p></li>
<li><p><strong>factor</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Factor by which the learning rate will be reduced.</p></li>
<li><p><strong>weight_decay</strong> (<em>float</em><em>, </em><em>default=0.025</em>) – Weight decay (L2 penalty) coefficient.</p></li>
<li><p><strong>dataloader_kwargs</strong> (<em>dict</em><em>, </em><em>default={}</em>) – The kwargs for the pytorch dataloader class.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – The built distributional regressor.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.FTTransformerLSS.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distribution_family</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.FTTransformerLSS.evaluate" title="Permalink to this definition">#</a></dt>
<dd><p>Evaluate the model on the given data using specified metrics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array-like</em><em> or </em><em>pd.DataFrame</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The input samples to predict.</p></li>
<li><p><strong>y_true</strong> (<em>array-like</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>)</em>) – The true class labels against which to evaluate the predictions.</p></li>
<li><p><strong>metrics</strong> (<em>dict</em>) – A dictionary where keys are metric names and values are tuples containing the metric function
and a boolean indicating whether the metric requires probability scores (True) or class labels (False).</p></li>
<li><p><strong>distribution_family</strong> (<em>str</em><em>, </em><em>optional</em>) – Specifies the distribution family the model is predicting for. If None, it will attempt to infer based
on the model’s settings.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>scores</strong> – A dictionary with metric names as keys and their corresponding scores as values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This method uses either the <code class="docutils literal notranslate"><span class="pre">predict</span></code> or <code class="docutils literal notranslate"><span class="pre">predict_proba</span></code> method depending on the metric requirements.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.FTTransformerLSS.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">family</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">101</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patience</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">15</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">monitor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'val_loss'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'min'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_patience</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_decay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checkpoint_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'model_checkpoints'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distributional_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataloader_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rebuild</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">trainer_kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.FTTransformerLSS.fit" title="Permalink to this definition">#</a></dt>
<dd><p>Trains the regression model using the provided training data. Optionally, a separate validation set can be used.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The training input samples.</p></li>
<li><p><strong>y</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em>) – The target values (real numbers).</p></li>
<li><p><strong>family</strong> (<em>str</em>) – The name of the distribution family to use for the loss function. Examples include ‘normal’ for regression tasks.</p></li>
<li><p><strong>val_size</strong> (<em>float</em><em>, </em><em>default=0.2</em>) – The proportion of the dataset to include in the validation split if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is None. Ignored if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>X_val</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em><em>, </em><em>optional</em>) – The validation input samples. If provided, <code class="docutils literal notranslate"><span class="pre">X</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> are not split and this data is used for validation.</p></li>
<li><p><strong>y_val</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em><em>, </em><em>optional</em>) – The validation target values. Required if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>max_epochs</strong> (<em>int</em><em>, </em><em>default=100</em>) – Maximum number of epochs for training.</p></li>
<li><p><strong>random_state</strong> (<em>int</em><em>, </em><em>default=101</em>) – Controls the shuffling applied to the data before applying the split.</p></li>
<li><p><strong>batch_size</strong> (<em>int</em><em>, </em><em>default=64</em>) – Number of samples per gradient update.</p></li>
<li><p><strong>shuffle</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to shuffle the training data before each epoch.</p></li>
<li><p><strong>patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement on the validation loss to wait before early stopping.</p></li>
<li><p><strong>monitor</strong> (<em>str</em><em>, </em><em>default=&quot;val_loss&quot;</em>) – The metric to monitor for early stopping.</p></li>
<li><p><strong>mode</strong> (<em>str</em><em>, </em><em>default=&quot;min&quot;</em>) – Whether the monitored metric should be minimized (<code class="docutils literal notranslate"><span class="pre">min</span></code>) or maximized (<code class="docutils literal notranslate"><span class="pre">max</span></code>).</p></li>
<li><p><strong>lr</strong> (<em>float</em><em>, </em><em>default=1e-3</em>) – Learning rate for the optimizer.</p></li>
<li><p><strong>lr_patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement on the validation loss to wait before reducing the learning rate.</p></li>
<li><p><strong>factor</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Factor by which the learning rate will be reduced.</p></li>
<li><p><strong>weight_decay</strong> (<em>float</em><em>, </em><em>default=0.025</em>) – Weight decay (L2 penalty) coefficient.</p></li>
<li><p><strong>distributional_kwargs</strong> (<em>dict</em><em>, </em><em>default=None</em>) – any arguments taht are specific for a certain distribution.</p></li>
<li><p><strong>checkpoint_path</strong> (<em>str</em><em>, </em><em>default=&quot;model_checkpoints&quot;</em>) – Path where the checkpoints are being saved.</p></li>
<li><p><strong>dataloader_kwargs</strong> (<em>dict</em><em>, </em><em>default={}</em>) – The kwargs for the pytorch dataloader class.</p></li>
<li><p><strong>**trainer_kwargs</strong> (<em>Additional keyword arguments for PyTorch Lightning's Trainer class.</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – The fitted regressor.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.FTTransformerLSS.get_default_metrics">
<span class="sig-name descname"><span class="pre">get_default_metrics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">distribution_family</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.FTTransformerLSS.get_default_metrics" title="Permalink to this definition">#</a></dt>
<dd><p>Provides default metrics based on the distribution family.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>distribution_family</strong> (<em>str</em>) – The distribution family for which to provide default metrics.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>metrics</strong> – A dictionary of default metric functions.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.FTTransformerLSS.get_number_of_params">
<span class="sig-name descname"><span class="pre">get_number_of_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">requires_grad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.FTTransformerLSS.get_number_of_params" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate the number of parameters in the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>requires_grad</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, only count the parameters that require gradients (trainable parameters).
If False, count all parameters. Default is True.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The total number of parameters in the model.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the model has not been built prior to calling this method.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.FTTransformerLSS.get_params">
<span class="sig-name descname"><span class="pre">get_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">deep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.FTTransformerLSS.get_params" title="Permalink to this definition">#</a></dt>
<dd><p>Get parameters for this estimator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>deep</strong> (<em>bool</em><em>, </em><em>default=True</em>) – If True, will return the parameters for this estimator and contained subobjects that are estimators.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>params</strong> – Parameter names mapped to their values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.FTTransformerLSS.optimize_hparams">
<span class="sig-name descname"><span class="pre">optimize_hparams</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prune_by_epoch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prune_epoch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fixed_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'cat_encoding':</span> <span class="pre">'int',</span> <span class="pre">'head_layer_size_length':</span> <span class="pre">0,</span> <span class="pre">'head_skip_layer':</span> <span class="pre">False,</span> <span class="pre">'head_skip_layers':</span> <span class="pre">False,</span> <span class="pre">'pooling_method':</span> <span class="pre">'avg',</span> <span class="pre">'use_cls':</span> <span class="pre">False}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">custom_search_space</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">optimize_kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.FTTransformerLSS.optimize_hparams" title="Permalink to this definition">#</a></dt>
<dd><p>Optimizes hyperparameters using Bayesian optimization with optional pruning.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array-like</em>) – Training data.</p></li>
<li><p><strong>y</strong> (<em>array-like</em>) – Training labels.</p></li>
<li><p><strong>X_val</strong> (<em>array-like</em><em>, </em><em>optional</em>) – Validation data and labels.</p></li>
<li><p><strong>y_val</strong> (<em>array-like</em><em>, </em><em>optional</em>) – Validation data and labels.</p></li>
<li><p><strong>time</strong> (<em>int</em>) – The number of optimization trials to run.</p></li>
<li><p><strong>max_epochs</strong> (<em>int</em>) – Maximum number of epochs for training.</p></li>
<li><p><strong>prune_by_epoch</strong> (<em>bool</em>) – Whether to prune based on a specific epoch (True) or the best validation loss (False).</p></li>
<li><p><strong>prune_epoch</strong> (<em>int</em>) – The specific epoch to prune by when prune_by_epoch is True.</p></li>
<li><p><strong>**optimize_kwargs</strong> (<em>dict</em>) – Additional keyword arguments passed to the fit method.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>best_hparams</strong> – Best hyperparameters found during optimization.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.FTTransformerLSS.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">raw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.FTTransformerLSS.predict" title="Permalink to this definition">#</a></dt>
<dd><p>Predicts target values for the given input samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>X</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The input samples for which to predict target values.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>predictions</strong> – The predicted target values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray, shape (n_samples,) or (n_samples, n_outputs)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.FTTransformerLSS.score">
<span class="sig-name descname"><span class="pre">score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'NLL'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.FTTransformerLSS.score" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate the score of the model using the specified metric.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array-like</em><em> or </em><em>pd.DataFrame</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The input samples to predict.</p></li>
<li><p><strong>y</strong> (<em>array-like</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_outputs</em><em>)</em>) – The true target values against which to evaluate the predictions.</p></li>
<li><p><strong>metric</strong> (<em>str</em><em>, </em><em>default=&quot;NLL&quot;</em>) – So far, only negative log-likelihood is supported</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>score</strong> – The score calculated using the specified metric.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.FTTransformerLSS.set_params">
<span class="sig-name descname"><span class="pre">set_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">parameters</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.FTTransformerLSS.set_params" title="Permalink to this definition">#</a></dt>
<dd><p>Set the parameters of this estimator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>**parameters</strong> (<em>dict</em>) – Estimator parameters.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – Estimator instance.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mambular.models.MLPClassifier">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mambular.models.</span></span><span class="sig-name descname"><span class="pre">MLPClassifier</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/mambular/models/mlp.html#MLPClassifier"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mambular.models.MLPClassifier" title="Permalink to this definition">#</a></dt>
<dd><dl class="simple">
<dt>Multi-Layer Perceptron classifier This class extends the SklearnBaseClassifier class and uses the MLP model</dt><dd><p>with the default MLP configuration.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The parameters for this class include the attributes from the config
dataclass as well as preprocessing arguments handled by the base class.</p>
<p>Configuration class for the default Multi-Layer Perceptron (MLP) model with predefined hyperparameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lr</strong> (<em>float</em><em>, </em><em>default=1e-04</em>) – Learning rate for the optimizer.</p></li>
<li><p><strong>lr_patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement after which the learning rate will be reduced.</p></li>
<li><p><strong>weight_decay</strong> (<em>float</em><em>, </em><em>default=1e-06</em>) – Weight decay (L2 regularization) for the optimizer.</p></li>
<li><p><strong>lr_factor</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Factor by which the learning rate will be reduced.</p></li>
<li><p><strong>layer_sizes</strong> (<em>list</em><em>, </em><em>default=</em><em>(</em><em>256</em><em>, </em><em>128</em><em>, </em><em>32</em><em>)</em>) – Sizes of the layers in the MLP.</p></li>
<li><p><strong>activation</strong> (<em>callable</em><em>, </em><em>default=nn.ReLU</em><em>(</em><em>)</em>) – Activation function for the MLP layers.</p></li>
<li><p><strong>skip_layers</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to skip layers in the MLP.</p></li>
<li><p><strong>dropout</strong> (<em>float</em><em>, </em><em>default=0.2</em>) – Dropout rate for regularization.</p></li>
<li><p><strong>use_glu</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use Gated Linear Units (GLU) in the MLP.</p></li>
<li><p><strong>skip_connections</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use skip connections in the MLP.</p></li>
<li><p><strong>batch_norm</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use batch normalization in the MLP layers.</p></li>
<li><p><strong>layer_norm</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use layer normalization in the MLP layers.</p></li>
<li><p><strong>layer_norm_eps</strong> (<em>float</em><em>, </em><em>default=1e-05</em>) – Epsilon value for layer normalization.</p></li>
<li><p><strong>use_embeddings</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use embedding layers for all features.</p></li>
<li><p><strong>embedding_activation</strong> (<em>callable</em><em>, </em><em>default=nn.Identity</em><em>(</em><em>)</em>) – Activation function for embeddings.</p></li>
<li><p><strong>embedding_type</strong> (<em>str</em><em>, </em><em>default=&quot;linear&quot;</em>) – Type of embedding to use (‘linear’, ‘plr’, etc.).</p></li>
<li><p><strong>embedding_bias</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use bias in the embedding layers.</p></li>
<li><p><strong>layer_norm_after_embedding</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to apply layer normalization after embedding.</p></li>
<li><p><strong>d_model</strong> (<em>int</em><em>, </em><em>default=32</em>) – Dimensionality of the embeddings.</p></li>
<li><p><strong>plr_lite</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use a lightweight version of Piecewise Linear Regression (PLR).</p></li>
<li><p><strong>n_frequencies</strong> (<em>int</em><em>, </em><em>default=48</em>) – Number of frequencies for PLR embeddings.</p></li>
<li><p><strong>frequencies_init_scale</strong> (<em>float</em><em>, </em><em>default=0.01</em>) – Initial scale for frequency parameters in embeddings.</p></li>
<li><p><strong>n_bins</strong> (<em>int</em><em>, </em><em>default=50</em>) – The number of bins to use for numerical feature binning. This parameter is relevant
only if <code class="docutils literal notranslate"><span class="pre">numerical_preprocessing</span></code> is set to ‘binning’, ‘ple’ or ‘one-hot’.</p></li>
<li><p><strong>numerical_preprocessing</strong> (<em>str</em><em>, </em><em>default=&quot;ple&quot;</em>) – The preprocessing strategy for numerical features. Valid options are
‘ple’, ‘binning’, ‘one-hot’, ‘standardization’, ‘min-max’, ‘quantile’, ‘polynomial’,
‘splines’, ‘box-cox’, ‘yeo-johnson’ and None</p></li>
<li><p><strong>categorical_preprocessing</strong> (<em>str</em><em>, </em><em>default=&quot;int&quot;</em>) – The preprocessing strategy for categorical features. Valid options are
‘int’, ‘one-hot’, None</p></li>
<li><p><strong>use_decision_tree_bins</strong> (<em>bool</em><em>, </em><em>default=False</em>) – If True, uses decision tree regression/classification to determine
optimal bin edges for numerical feature binning. This parameter is
relevant only if <code class="docutils literal notranslate"><span class="pre">numerical_preprocessing</span></code> is set to ‘binning’ or ‘one-hot’.</p></li>
<li><p><strong>binning_strategy</strong> (<em>str</em><em>, </em><em>default=&quot;uniform&quot;</em>) – Defines the strategy for binning numerical features. Options include ‘uniform’,
‘quantile’, or other sklearn-compatible strategies.</p></li>
<li><p><strong>task</strong> (<em>str</em><em>, </em><em>default=&quot;regression&quot;</em>) – Indicates the type of machine learning task (‘regression’ or ‘classification’). This can
influence certain preprocessing behaviors, especially when using decision tree-based binning.</p></li>
<li><p><strong>cat_cutoff</strong> (<em>float</em><em> or </em><em>int</em><em>, </em><em>default=0.03</em>) – Indicates the cutoff after which integer values are treated as categorical.
If float, it’s treated as a percentage. If int, it’s the maximum number of
unique values for a column to be considered categorical.</p></li>
<li><p><strong>treat_all_integers_as_numerical</strong> (<em>bool</em><em>, </em><em>default=False</em>) – If True, all integer columns will be treated as numerical, regardless
of their unique value count or proportion.</p></li>
<li><p><strong>degree</strong> (<em>int</em><em>, </em><em>default=3</em>) – The degree of the polynomial features to be used in preprocessing.</p></li>
<li><p><strong>knots</strong> (<em>int</em><em>, </em><em>default=12</em>) – The number of knots to be used in spline transformations.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mambular.models</span> <span class="kn">import</span> <span class="n">MLPClassifier</span>
<span class="go">    &gt;&gt;&gt; model = MLPClassifier(d_model=64, n_layers=8)</span>
<span class="go">    &gt;&gt;&gt; model.fit(X_train, y_train)</span>
<span class="go">    &gt;&gt;&gt; preds = model.predict(X_test)</span>
<span class="go">    &gt;&gt;&gt; model.evaluate(X_test, y_test)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.MLPClassifier.build_model">
<span class="sig-name descname"><span class="pre">build_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">101</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_patience</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_decay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataloader_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.MLPClassifier.build_model" title="Permalink to this definition">#</a></dt>
<dd><p>Builds the model using the provided training data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The training input samples.</p></li>
<li><p><strong>y</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em>) – The target values (real numbers).</p></li>
<li><p><strong>val_size</strong> (<em>float</em><em>, </em><em>default=0.2</em>) – The proportion of the dataset to include in the validation split if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is None. Ignored if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>X_val</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em><em>, </em><em>optional</em>) – The validation input samples. If provided, <code class="docutils literal notranslate"><span class="pre">X</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> are not split and this data is used for validation.</p></li>
<li><p><strong>y_val</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em><em>, </em><em>optional</em>) – The validation target values. Required if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>random_state</strong> (<em>int</em><em>, </em><em>default=101</em>) – Controls the shuffling applied to the data before applying the split.</p></li>
<li><p><strong>batch_size</strong> (<em>int</em><em>, </em><em>default=64</em>) – Number of samples per gradient update.</p></li>
<li><p><strong>shuffle</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to shuffle the training data before each epoch.</p></li>
<li><p><strong>lr</strong> (<em>float</em><em>, </em><em>default=1e-3</em>) – Learning rate for the optimizer.</p></li>
<li><p><strong>lr_patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement on the validation loss to wait before reducing the learning rate.</p></li>
<li><p><strong>factor</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Factor by which the learning rate will be reduced.</p></li>
<li><p><strong>weight_decay</strong> (<em>float</em><em>, </em><em>default=0.025</em>) – Weight decay (L2 penalty) coefficient.</p></li>
<li><p><strong>dataloader_kwargs</strong> (<em>dict</em><em>, </em><em>default={}</em>) – The kwargs for the pytorch dataloader class.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – The built classifier.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.MLPClassifier.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.MLPClassifier.evaluate" title="Permalink to this definition">#</a></dt>
<dd><p>Evaluate the model on the given data using specified metrics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array-like</em><em> or </em><em>pd.DataFrame</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The input samples to predict.</p></li>
<li><p><strong>y_true</strong> (<em>array-like</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>)</em>) – The true class labels against which to evaluate the predictions.</p></li>
<li><p><strong>metrics</strong> (<em>dict</em>) – A dictionary where keys are metric names and values are tuples containing the metric function
and a boolean indicating whether the metric requires probability scores (True) or class labels (False).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>scores</strong> – A dictionary with metric names as keys and their corresponding scores as values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This method uses either the <code class="docutils literal notranslate"><span class="pre">predict</span></code> or <code class="docutils literal notranslate"><span class="pre">predict_proba</span></code> method depending on the metric requirements.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.MLPClassifier.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">101</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patience</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">15</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">monitor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'val_loss'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'min'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_patience</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_decay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checkpoint_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'model_checkpoints'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataloader_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rebuild</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">trainer_kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.MLPClassifier.fit" title="Permalink to this definition">#</a></dt>
<dd><p>Trains the classification model using the provided training data. Optionally, a separate validation set can be used.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The training input samples.</p></li>
<li><p><strong>y</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em>) – The target values (real numbers).</p></li>
<li><p><strong>val_size</strong> (<em>float</em><em>, </em><em>default=0.2</em>) – The proportion of the dataset to include in the validation split if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is None. Ignored if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>X_val</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em><em>, </em><em>optional</em>) – The validation input samples. If provided, <code class="docutils literal notranslate"><span class="pre">X</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> are not split and this data is used for validation.</p></li>
<li><p><strong>y_val</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em><em>, </em><em>optional</em>) – The validation target values. Required if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>max_epochs</strong> (<em>int</em><em>, </em><em>default=100</em>) – Maximum number of epochs for training.</p></li>
<li><p><strong>random_state</strong> (<em>int</em><em>, </em><em>default=101</em>) – Controls the shuffling applied to the data before applying the split.</p></li>
<li><p><strong>batch_size</strong> (<em>int</em><em>, </em><em>default=64</em>) – Number of samples per gradient update.</p></li>
<li><p><strong>shuffle</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to shuffle the training data before each epoch.</p></li>
<li><p><strong>patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement on the validation loss to wait before early stopping.</p></li>
<li><p><strong>monitor</strong> (<em>str</em><em>, </em><em>default=&quot;val_loss&quot;</em>) – The metric to monitor for early stopping.</p></li>
<li><p><strong>mode</strong> (<em>str</em><em>, </em><em>default=&quot;min&quot;</em>) – Whether the monitored metric should be minimized (<code class="docutils literal notranslate"><span class="pre">min</span></code>) or maximized (<code class="docutils literal notranslate"><span class="pre">max</span></code>).</p></li>
<li><p><strong>lr</strong> (<em>float</em><em>, </em><em>default=1e-3</em>) – Learning rate for the optimizer.</p></li>
<li><p><strong>lr_patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement on the validation loss to wait before reducing the learning rate.</p></li>
<li><p><strong>factor</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Factor by which the learning rate will be reduced.</p></li>
<li><p><strong>weight_decay</strong> (<em>float</em><em>, </em><em>default=0.025</em>) – Weight decay (L2 penalty) coefficient.</p></li>
<li><p><strong>checkpoint_path</strong> (<em>str</em><em>, </em><em>default=&quot;model_checkpoints&quot;</em>) – Path where the checkpoints are being saved.</p></li>
<li><p><strong>dataloader_kwargs</strong> (<em>dict</em><em>, </em><em>default={}</em>) – The kwargs for the pytorch dataloader class.</p></li>
<li><p><strong>rebuild</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to rebuild the model when it already was built.</p></li>
<li><p><strong>**trainer_kwargs</strong> (<em>Additional keyword arguments for PyTorch Lightning's Trainer class.</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – The fitted classifier.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.MLPClassifier.get_number_of_params">
<span class="sig-name descname"><span class="pre">get_number_of_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">requires_grad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.MLPClassifier.get_number_of_params" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate the number of parameters in the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>requires_grad</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, only count the parameters that require gradients (trainable parameters).
If False, count all parameters. Default is True.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The total number of parameters in the model.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the model has not been built prior to calling this method.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.MLPClassifier.get_params">
<span class="sig-name descname"><span class="pre">get_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">deep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.MLPClassifier.get_params" title="Permalink to this definition">#</a></dt>
<dd><p>Get parameters for this estimator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>deep</strong> (<em>bool</em><em>, </em><em>default=True</em>) – If True, will return the parameters for this estimator and contained subobjects that are estimators.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>params</strong> – Parameter names mapped to their values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.MLPClassifier.optimize_hparams">
<span class="sig-name descname"><span class="pre">optimize_hparams</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prune_by_epoch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prune_epoch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fixed_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'cat_encoding':</span> <span class="pre">'int',</span> <span class="pre">'head_layer_size_length':</span> <span class="pre">0,</span> <span class="pre">'head_skip_layer':</span> <span class="pre">False,</span> <span class="pre">'head_skip_layers':</span> <span class="pre">False,</span> <span class="pre">'pooling_method':</span> <span class="pre">'avg',</span> <span class="pre">'use_cls':</span> <span class="pre">False}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">custom_search_space</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">optimize_kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.MLPClassifier.optimize_hparams" title="Permalink to this definition">#</a></dt>
<dd><p>Optimizes hyperparameters using Bayesian optimization with optional pruning.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array-like</em>) – Training data.</p></li>
<li><p><strong>y</strong> (<em>array-like</em>) – Training labels.</p></li>
<li><p><strong>X_val</strong> (<em>array-like</em><em>, </em><em>optional</em>) – Validation data and labels.</p></li>
<li><p><strong>y_val</strong> (<em>array-like</em><em>, </em><em>optional</em>) – Validation data and labels.</p></li>
<li><p><strong>time</strong> (<em>int</em>) – The number of optimization trials to run.</p></li>
<li><p><strong>max_epochs</strong> (<em>int</em>) – Maximum number of epochs for training.</p></li>
<li><p><strong>prune_by_epoch</strong> (<em>bool</em>) – Whether to prune based on a specific epoch (True) or the best validation loss (False).</p></li>
<li><p><strong>prune_epoch</strong> (<em>int</em>) – The specific epoch to prune by when prune_by_epoch is True.</p></li>
<li><p><strong>**optimize_kwargs</strong> (<em>dict</em>) – Additional keyword arguments passed to the fit method.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>best_hparams</strong> – Best hyperparameters found during optimization.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.MLPClassifier.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.MLPClassifier.predict" title="Permalink to this definition">#</a></dt>
<dd><p>Predicts target values for the given input samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>X</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The input samples for which to predict target values.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>predictions</strong> – The predicted target values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray, shape (n_samples,) or (n_samples, n_outputs)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.MLPClassifier.predict_proba">
<span class="sig-name descname"><span class="pre">predict_proba</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.MLPClassifier.predict_proba" title="Permalink to this definition">#</a></dt>
<dd><p>Predict class probabilities for the given input samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>X</strong> (<em>array-like</em><em> or </em><em>pd.DataFrame</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The input samples for which to predict class probabilities.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The method preprocesses the input data using the same preprocessor used during training,
sets the model to evaluation mode, and then performs inference to predict the class probabilities.
Softmax is applied to the logits to obtain probabilities, which are then converted from a PyTorch tensor
to a NumPy array before being returned.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">accuracy_score</span><span class="p">,</span> <span class="n">precision_score</span><span class="p">,</span> <span class="n">f1_score</span><span class="p">,</span> <span class="n">roc_auc_score</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Define the metrics you want to evaluate</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">metrics</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">... </span>    <span class="s1">&#39;Accuracy&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">accuracy_score</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
<span class="gp">... </span>    <span class="s1">&#39;Precision&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">precision_score</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
<span class="gp">... </span>    <span class="s1">&#39;F1 Score&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">f1_score</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
<span class="gp">... </span>    <span class="s1">&#39;AUC Score&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">roc_auc_score</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
<span class="gp">... </span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Assuming &#39;X_test&#39; and &#39;y_test&#39; are your test dataset and labels</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Evaluate using the specified metrics</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results</span> <span class="o">=</span> <span class="n">classifier</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="n">metrics</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>probabilities</strong> – Predicted class probabilities for each input sample.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>ndarray of shape (n_samples, n_classes)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.MLPClassifier.score">
<span class="sig-name descname"><span class="pre">score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(sklearn.metrics.log_loss,</span> <span class="pre">True)</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.MLPClassifier.score" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate the score of the model using the specified metric.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array-like</em><em> or </em><em>pd.DataFrame</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The input samples to predict.</p></li>
<li><p><strong>y</strong> (<em>array-like</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>)</em>) – The true class labels against which to evaluate the predictions.</p></li>
<li><p><strong>metric</strong> (<em>tuple</em><em>, </em><em>default=</em><em>(</em><em>log_loss</em><em>, </em><em>True</em><em>)</em>) – A tuple containing the metric function and a boolean indicating whether the metric requires probability scores (True) or class labels (False).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>score</strong> – The score calculated using the specified metric.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.MLPClassifier.set_params">
<span class="sig-name descname"><span class="pre">set_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">parameters</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.MLPClassifier.set_params" title="Permalink to this definition">#</a></dt>
<dd><p>Set the parameters of this estimator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>**parameters</strong> (<em>dict</em>) – Estimator parameters.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – Estimator instance.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mambular.models.MLPRegressor">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mambular.models.</span></span><span class="sig-name descname"><span class="pre">MLPRegressor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/mambular/models/mlp.html#MLPRegressor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mambular.models.MLPRegressor" title="Permalink to this definition">#</a></dt>
<dd><dl class="simple">
<dt>Multi-Layer Perceptron regressor. This class extends the SklearnBaseRegressor class and uses the MLP model</dt><dd><p>with the default MLP configuration.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The parameters for this class include the attributes from the config
dataclass as well as preprocessing arguments handled by the base class.</p>
<p>Configuration class for the default Multi-Layer Perceptron (MLP) model with predefined hyperparameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lr</strong> (<em>float</em><em>, </em><em>default=1e-04</em>) – Learning rate for the optimizer.</p></li>
<li><p><strong>lr_patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement after which the learning rate will be reduced.</p></li>
<li><p><strong>weight_decay</strong> (<em>float</em><em>, </em><em>default=1e-06</em>) – Weight decay (L2 regularization) for the optimizer.</p></li>
<li><p><strong>lr_factor</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Factor by which the learning rate will be reduced.</p></li>
<li><p><strong>layer_sizes</strong> (<em>list</em><em>, </em><em>default=</em><em>(</em><em>256</em><em>, </em><em>128</em><em>, </em><em>32</em><em>)</em>) – Sizes of the layers in the MLP.</p></li>
<li><p><strong>activation</strong> (<em>callable</em><em>, </em><em>default=nn.ReLU</em><em>(</em><em>)</em>) – Activation function for the MLP layers.</p></li>
<li><p><strong>skip_layers</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to skip layers in the MLP.</p></li>
<li><p><strong>dropout</strong> (<em>float</em><em>, </em><em>default=0.2</em>) – Dropout rate for regularization.</p></li>
<li><p><strong>use_glu</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use Gated Linear Units (GLU) in the MLP.</p></li>
<li><p><strong>skip_connections</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use skip connections in the MLP.</p></li>
<li><p><strong>batch_norm</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use batch normalization in the MLP layers.</p></li>
<li><p><strong>layer_norm</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use layer normalization in the MLP layers.</p></li>
<li><p><strong>layer_norm_eps</strong> (<em>float</em><em>, </em><em>default=1e-05</em>) – Epsilon value for layer normalization.</p></li>
<li><p><strong>use_embeddings</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use embedding layers for all features.</p></li>
<li><p><strong>embedding_activation</strong> (<em>callable</em><em>, </em><em>default=nn.Identity</em><em>(</em><em>)</em>) – Activation function for embeddings.</p></li>
<li><p><strong>embedding_type</strong> (<em>str</em><em>, </em><em>default=&quot;linear&quot;</em>) – Type of embedding to use (‘linear’, ‘plr’, etc.).</p></li>
<li><p><strong>embedding_bias</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use bias in the embedding layers.</p></li>
<li><p><strong>layer_norm_after_embedding</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to apply layer normalization after embedding.</p></li>
<li><p><strong>d_model</strong> (<em>int</em><em>, </em><em>default=32</em>) – Dimensionality of the embeddings.</p></li>
<li><p><strong>plr_lite</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use a lightweight version of Piecewise Linear Regression (PLR).</p></li>
<li><p><strong>n_frequencies</strong> (<em>int</em><em>, </em><em>default=48</em>) – Number of frequencies for PLR embeddings.</p></li>
<li><p><strong>frequencies_init_scale</strong> (<em>float</em><em>, </em><em>default=0.01</em>) – Initial scale for frequency parameters in embeddings.</p></li>
<li><p><strong>n_bins</strong> (<em>int</em><em>, </em><em>default=50</em>) – The number of bins to use for numerical feature binning. This parameter is relevant
only if <code class="docutils literal notranslate"><span class="pre">numerical_preprocessing</span></code> is set to ‘binning’, ‘ple’ or ‘one-hot’.</p></li>
<li><p><strong>numerical_preprocessing</strong> (<em>str</em><em>, </em><em>default=&quot;ple&quot;</em>) – The preprocessing strategy for numerical features. Valid options are
‘ple’, ‘binning’, ‘one-hot’, ‘standardization’, ‘min-max’, ‘quantile’, ‘polynomial’,
‘splines’, ‘box-cox’, ‘yeo-johnson’ and None</p></li>
<li><p><strong>categorical_preprocessing</strong> (<em>str</em><em>, </em><em>default=&quot;int&quot;</em>) – The preprocessing strategy for categorical features. Valid options are
‘int’, ‘one-hot’, None</p></li>
<li><p><strong>use_decision_tree_bins</strong> (<em>bool</em><em>, </em><em>default=False</em>) – If True, uses decision tree regression/classification to determine
optimal bin edges for numerical feature binning. This parameter is
relevant only if <code class="docutils literal notranslate"><span class="pre">numerical_preprocessing</span></code> is set to ‘binning’ or ‘one-hot’.</p></li>
<li><p><strong>binning_strategy</strong> (<em>str</em><em>, </em><em>default=&quot;uniform&quot;</em>) – Defines the strategy for binning numerical features. Options include ‘uniform’,
‘quantile’, or other sklearn-compatible strategies.</p></li>
<li><p><strong>task</strong> (<em>str</em><em>, </em><em>default=&quot;regression&quot;</em>) – Indicates the type of machine learning task (‘regression’ or ‘classification’). This can
influence certain preprocessing behaviors, especially when using decision tree-based binning.</p></li>
<li><p><strong>cat_cutoff</strong> (<em>float</em><em> or </em><em>int</em><em>, </em><em>default=0.03</em>) – Indicates the cutoff after which integer values are treated as categorical.
If float, it’s treated as a percentage. If int, it’s the maximum number of
unique values for a column to be considered categorical.</p></li>
<li><p><strong>treat_all_integers_as_numerical</strong> (<em>bool</em><em>, </em><em>default=False</em>) – If True, all integer columns will be treated as numerical, regardless
of their unique value count or proportion.</p></li>
<li><p><strong>degree</strong> (<em>int</em><em>, </em><em>default=3</em>) – The degree of the polynomial features to be used in preprocessing.</p></li>
<li><p><strong>knots</strong> (<em>int</em><em>, </em><em>default=12</em>) – The number of knots to be used in spline transformations.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mambular.models</span> <span class="kn">import</span> <span class="n">MLPRegressor</span>
<span class="go">    &gt;&gt;&gt; model = MLPRegressor(d_model=64, n_layers=8)</span>
<span class="go">    &gt;&gt;&gt; model.fit(X_train, y_train)</span>
<span class="go">    &gt;&gt;&gt; preds = model.predict(X_test)</span>
<span class="go">    &gt;&gt;&gt; model.evaluate(X_test, y_test)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.MLPRegressor.build_model">
<span class="sig-name descname"><span class="pre">build_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">101</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_patience</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_decay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataloader_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.MLPRegressor.build_model" title="Permalink to this definition">#</a></dt>
<dd><p>Builds the model using the provided training data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The training input samples.</p></li>
<li><p><strong>y</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em>) – The target values (real numbers).</p></li>
<li><p><strong>val_size</strong> (<em>float</em><em>, </em><em>default=0.2</em>) – The proportion of the dataset to include in the validation split if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is None. Ignored if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>X_val</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em><em>, </em><em>optional</em>) – The validation input samples. If provided, <code class="docutils literal notranslate"><span class="pre">X</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> are not split and this data is used for validation.</p></li>
<li><p><strong>y_val</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em><em>, </em><em>optional</em>) – The validation target values. Required if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>random_state</strong> (<em>int</em><em>, </em><em>default=101</em>) – Controls the shuffling applied to the data before applying the split.</p></li>
<li><p><strong>batch_size</strong> (<em>int</em><em>, </em><em>default=64</em>) – Number of samples per gradient update.</p></li>
<li><p><strong>shuffle</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to shuffle the training data before each epoch.</p></li>
<li><p><strong>lr</strong> (<em>float</em><em>, </em><em>default=1e-3</em>) – Learning rate for the optimizer.</p></li>
<li><p><strong>lr_patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement on the validation loss to wait before reducing the learning rate.</p></li>
<li><p><strong>factor</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Factor by which the learning rate will be reduced.</p></li>
<li><p><strong>weight_decay</strong> (<em>float</em><em>, </em><em>default=0.025</em>) – Weight decay (L2 penalty) coefficient.</p></li>
<li><p><strong>dataloader_kwargs</strong> (<em>dict</em><em>, </em><em>default={}</em>) – The kwargs for the pytorch dataloader class.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – The built regressor.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.MLPRegressor.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.MLPRegressor.evaluate" title="Permalink to this definition">#</a></dt>
<dd><p>Evaluate the model on the given data using specified metrics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array-like</em><em> or </em><em>pd.DataFrame</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The input samples to predict.</p></li>
<li><p><strong>y_true</strong> (<em>array-like</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_outputs</em><em>)</em>) – The true target values against which to evaluate the predictions.</p></li>
<li><p><strong>metrics</strong> (<em>dict</em>) – A dictionary where keys are metric names and values are the metric functions.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This method uses the <code class="docutils literal notranslate"><span class="pre">predict</span></code> method to generate predictions and computes each metric.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_squared_error</span><span class="p">,</span> <span class="n">r2_score</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mambular.models</span> <span class="kn">import</span> <span class="n">MambularRegressor</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">metrics</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">... </span>    <span class="s1">&#39;Mean Squared Error&#39;</span><span class="p">:</span> <span class="n">mean_squared_error</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s1">&#39;R2 Score&#39;</span><span class="p">:</span> <span class="n">r2_score</span>
<span class="gp">... </span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Assuming &#39;X_test&#39; and &#39;y_test&#39; are your test dataset and labels</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Evaluate using the specified metrics</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results</span> <span class="o">=</span> <span class="n">regressor</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="n">metrics</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>scores</strong> – A dictionary with metric names as keys and their corresponding scores as values.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.MLPRegressor.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">101</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patience</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">15</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">monitor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'val_loss'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'min'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_patience</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_decay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checkpoint_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'model_checkpoints'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataloader_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rebuild</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">trainer_kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.MLPRegressor.fit" title="Permalink to this definition">#</a></dt>
<dd><p>Trains the regression model using the provided training data. Optionally, a separate validation set can be used.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The training input samples.</p></li>
<li><p><strong>y</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em>) – The target values (real numbers).</p></li>
<li><p><strong>val_size</strong> (<em>float</em><em>, </em><em>default=0.2</em>) – The proportion of the dataset to include in the validation split if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is None. Ignored if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>X_val</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em><em>, </em><em>optional</em>) – The validation input samples. If provided, <code class="docutils literal notranslate"><span class="pre">X</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> are not split and this data is used for validation.</p></li>
<li><p><strong>y_val</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em><em>, </em><em>optional</em>) – The validation target values. Required if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>max_epochs</strong> (<em>int</em><em>, </em><em>default=100</em>) – Maximum number of epochs for training.</p></li>
<li><p><strong>random_state</strong> (<em>int</em><em>, </em><em>default=101</em>) – Controls the shuffling applied to the data before applying the split.</p></li>
<li><p><strong>batch_size</strong> (<em>int</em><em>, </em><em>default=64</em>) – Number of samples per gradient update.</p></li>
<li><p><strong>shuffle</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to shuffle the training data before each epoch.</p></li>
<li><p><strong>patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement on the validation loss to wait before early stopping.</p></li>
<li><p><strong>monitor</strong> (<em>str</em><em>, </em><em>default=&quot;val_loss&quot;</em>) – The metric to monitor for early stopping.</p></li>
<li><p><strong>mode</strong> (<em>str</em><em>, </em><em>default=&quot;min&quot;</em>) – Whether the monitored metric should be minimized (<code class="docutils literal notranslate"><span class="pre">min</span></code>) or maximized (<code class="docutils literal notranslate"><span class="pre">max</span></code>).</p></li>
<li><p><strong>lr</strong> (<em>float</em><em>, </em><em>default=1e-3</em>) – Learning rate for the optimizer.</p></li>
<li><p><strong>lr_patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement on the validation loss to wait before reducing the learning rate.</p></li>
<li><p><strong>factor</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Factor by which the learning rate will be reduced.</p></li>
<li><p><strong>weight_decay</strong> (<em>float</em><em>, </em><em>default=0.025</em>) – Weight decay (L2 penalty) coefficient.</p></li>
<li><p><strong>checkpoint_path</strong> (<em>str</em><em>, </em><em>default=&quot;model_checkpoints&quot;</em>) – Path where the checkpoints are being saved.</p></li>
<li><p><strong>dataloader_kwargs</strong> (<em>dict</em><em>, </em><em>default={}</em>) – The kwargs for the pytorch dataloader class.</p></li>
<li><p><strong>**trainer_kwargs</strong> (<em>Additional keyword arguments for PyTorch Lightning's Trainer class.</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – The fitted regressor.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.MLPRegressor.get_number_of_params">
<span class="sig-name descname"><span class="pre">get_number_of_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">requires_grad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.MLPRegressor.get_number_of_params" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate the number of parameters in the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>requires_grad</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, only count the parameters that require gradients (trainable parameters).
If False, count all parameters. Default is True.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The total number of parameters in the model.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the model has not been built prior to calling this method.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.MLPRegressor.get_params">
<span class="sig-name descname"><span class="pre">get_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">deep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.MLPRegressor.get_params" title="Permalink to this definition">#</a></dt>
<dd><p>Get parameters for this estimator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>deep</strong> (<em>bool</em><em>, </em><em>default=True</em>) – If True, will return the parameters for this estimator and contained subobjects that are estimators.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>params</strong> – Parameter names mapped to their values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.MLPRegressor.optimize_hparams">
<span class="sig-name descname"><span class="pre">optimize_hparams</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prune_by_epoch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prune_epoch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fixed_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'cat_encoding':</span> <span class="pre">'int',</span> <span class="pre">'head_layer_size_length':</span> <span class="pre">0,</span> <span class="pre">'head_skip_layer':</span> <span class="pre">False,</span> <span class="pre">'head_skip_layers':</span> <span class="pre">False,</span> <span class="pre">'pooling_method':</span> <span class="pre">'avg',</span> <span class="pre">'use_cls':</span> <span class="pre">False}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">custom_search_space</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">optimize_kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.MLPRegressor.optimize_hparams" title="Permalink to this definition">#</a></dt>
<dd><p>Optimizes hyperparameters using Bayesian optimization with optional pruning.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array-like</em>) – Training data.</p></li>
<li><p><strong>y</strong> (<em>array-like</em>) – Training labels.</p></li>
<li><p><strong>X_val</strong> (<em>array-like</em><em>, </em><em>optional</em>) – Validation data and labels.</p></li>
<li><p><strong>y_val</strong> (<em>array-like</em><em>, </em><em>optional</em>) – Validation data and labels.</p></li>
<li><p><strong>time</strong> (<em>int</em>) – The number of optimization trials to run.</p></li>
<li><p><strong>max_epochs</strong> (<em>int</em>) – Maximum number of epochs for training.</p></li>
<li><p><strong>prune_by_epoch</strong> (<em>bool</em>) – Whether to prune based on a specific epoch (True) or the best validation loss (False).</p></li>
<li><p><strong>prune_epoch</strong> (<em>int</em>) – The specific epoch to prune by when prune_by_epoch is True.</p></li>
<li><p><strong>**optimize_kwargs</strong> (<em>dict</em>) – Additional keyword arguments passed to the fit method.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>best_hparams</strong> – Best hyperparameters found during optimization.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.MLPRegressor.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.MLPRegressor.predict" title="Permalink to this definition">#</a></dt>
<dd><p>Predicts target values for the given input samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>X</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The input samples for which to predict target values.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>predictions</strong> – The predicted target values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray, shape (n_samples,) or (n_samples, n_outputs)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.MLPRegressor.score">
<span class="sig-name descname"><span class="pre">score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">sklearn.metrics.mean_squared_error</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.MLPRegressor.score" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate the score of the model using the specified metric.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array-like</em><em> or </em><em>pd.DataFrame</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The input samples to predict.</p></li>
<li><p><strong>y</strong> (<em>array-like</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_outputs</em><em>)</em>) – The true target values against which to evaluate the predictions.</p></li>
<li><p><strong>metric</strong> (<em>callable</em><em>, </em><em>default=mean_squared_error</em>) – The metric function to use for evaluation. Must be a callable with the signature <code class="docutils literal notranslate"><span class="pre">metric(y_true,</span> <span class="pre">y_pred)</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>score</strong> – The score calculated using the specified metric.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.MLPRegressor.set_params">
<span class="sig-name descname"><span class="pre">set_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">parameters</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.MLPRegressor.set_params" title="Permalink to this definition">#</a></dt>
<dd><p>Set the parameters of this estimator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>**parameters</strong> (<em>dict</em>) – Estimator parameters.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – Estimator instance.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mambular.models.MLPLSS">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mambular.models.</span></span><span class="sig-name descname"><span class="pre">MLPLSS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/mambular/models/mlp.html#MLPLSS"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mambular.models.MLPLSS" title="Permalink to this definition">#</a></dt>
<dd><dl class="simple">
<dt>Multi-Layer Perceptron for distributional regression. This class extends the SklearnBaseLSS class and uses the MLP model</dt><dd><p>with the default MLP configuration.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The parameters for this class include the attributes from the config
dataclass as well as preprocessing arguments handled by the base class.</p>
<p>Configuration class for the default Multi-Layer Perceptron (MLP) model with predefined hyperparameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lr</strong> (<em>float</em><em>, </em><em>default=1e-04</em>) – Learning rate for the optimizer.</p></li>
<li><p><strong>lr_patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement after which the learning rate will be reduced.</p></li>
<li><p><strong>weight_decay</strong> (<em>float</em><em>, </em><em>default=1e-06</em>) – Weight decay (L2 regularization) for the optimizer.</p></li>
<li><p><strong>lr_factor</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Factor by which the learning rate will be reduced.</p></li>
<li><p><strong>layer_sizes</strong> (<em>list</em><em>, </em><em>default=</em><em>(</em><em>256</em><em>, </em><em>128</em><em>, </em><em>32</em><em>)</em>) – Sizes of the layers in the MLP.</p></li>
<li><p><strong>activation</strong> (<em>callable</em><em>, </em><em>default=nn.ReLU</em><em>(</em><em>)</em>) – Activation function for the MLP layers.</p></li>
<li><p><strong>skip_layers</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to skip layers in the MLP.</p></li>
<li><p><strong>dropout</strong> (<em>float</em><em>, </em><em>default=0.2</em>) – Dropout rate for regularization.</p></li>
<li><p><strong>use_glu</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use Gated Linear Units (GLU) in the MLP.</p></li>
<li><p><strong>skip_connections</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use skip connections in the MLP.</p></li>
<li><p><strong>batch_norm</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use batch normalization in the MLP layers.</p></li>
<li><p><strong>layer_norm</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use layer normalization in the MLP layers.</p></li>
<li><p><strong>layer_norm_eps</strong> (<em>float</em><em>, </em><em>default=1e-05</em>) – Epsilon value for layer normalization.</p></li>
<li><p><strong>use_embeddings</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use embedding layers for all features.</p></li>
<li><p><strong>embedding_activation</strong> (<em>callable</em><em>, </em><em>default=nn.Identity</em><em>(</em><em>)</em>) – Activation function for embeddings.</p></li>
<li><p><strong>embedding_type</strong> (<em>str</em><em>, </em><em>default=&quot;linear&quot;</em>) – Type of embedding to use (‘linear’, ‘plr’, etc.).</p></li>
<li><p><strong>embedding_bias</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use bias in the embedding layers.</p></li>
<li><p><strong>layer_norm_after_embedding</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to apply layer normalization after embedding.</p></li>
<li><p><strong>d_model</strong> (<em>int</em><em>, </em><em>default=32</em>) – Dimensionality of the embeddings.</p></li>
<li><p><strong>plr_lite</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use a lightweight version of Piecewise Linear Regression (PLR).</p></li>
<li><p><strong>n_frequencies</strong> (<em>int</em><em>, </em><em>default=48</em>) – Number of frequencies for PLR embeddings.</p></li>
<li><p><strong>frequencies_init_scale</strong> (<em>float</em><em>, </em><em>default=0.01</em>) – Initial scale for frequency parameters in embeddings.</p></li>
<li><p><strong>n_bins</strong> (<em>int</em><em>, </em><em>default=50</em>) – The number of bins to use for numerical feature binning. This parameter is relevant
only if <code class="docutils literal notranslate"><span class="pre">numerical_preprocessing</span></code> is set to ‘binning’, ‘ple’ or ‘one-hot’.</p></li>
<li><p><strong>numerical_preprocessing</strong> (<em>str</em><em>, </em><em>default=&quot;ple&quot;</em>) – The preprocessing strategy for numerical features. Valid options are
‘ple’, ‘binning’, ‘one-hot’, ‘standardization’, ‘min-max’, ‘quantile’, ‘polynomial’,
‘splines’, ‘box-cox’, ‘yeo-johnson’ and None</p></li>
<li><p><strong>categorical_preprocessing</strong> (<em>str</em><em>, </em><em>default=&quot;int&quot;</em>) – The preprocessing strategy for categorical features. Valid options are
‘int’, ‘one-hot’, None</p></li>
<li><p><strong>use_decision_tree_bins</strong> (<em>bool</em><em>, </em><em>default=False</em>) – If True, uses decision tree regression/classification to determine
optimal bin edges for numerical feature binning. This parameter is
relevant only if <code class="docutils literal notranslate"><span class="pre">numerical_preprocessing</span></code> is set to ‘binning’ or ‘one-hot’.</p></li>
<li><p><strong>binning_strategy</strong> (<em>str</em><em>, </em><em>default=&quot;uniform&quot;</em>) – Defines the strategy for binning numerical features. Options include ‘uniform’,
‘quantile’, or other sklearn-compatible strategies.</p></li>
<li><p><strong>task</strong> (<em>str</em><em>, </em><em>default=&quot;regression&quot;</em>) – Indicates the type of machine learning task (‘regression’ or ‘classification’). This can
influence certain preprocessing behaviors, especially when using decision tree-based binning.</p></li>
<li><p><strong>cat_cutoff</strong> (<em>float</em><em> or </em><em>int</em><em>, </em><em>default=0.03</em>) – Indicates the cutoff after which integer values are treated as categorical.
If float, it’s treated as a percentage. If int, it’s the maximum number of
unique values for a column to be considered categorical.</p></li>
<li><p><strong>treat_all_integers_as_numerical</strong> (<em>bool</em><em>, </em><em>default=False</em>) – If True, all integer columns will be treated as numerical, regardless
of their unique value count or proportion.</p></li>
<li><p><strong>degree</strong> (<em>int</em><em>, </em><em>default=3</em>) – The degree of the polynomial features to be used in preprocessing.</p></li>
<li><p><strong>knots</strong> (<em>int</em><em>, </em><em>default=12</em>) – The number of knots to be used in spline transformations.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mambular.models</span> <span class="kn">import</span> <span class="n">MLPLSS</span>
<span class="go">    &gt;&gt;&gt; model = MLPLSS(d_model=64, n_layers=8)</span>
<span class="go">    &gt;&gt;&gt; model.fit(X_train, y_train, family=&#39;normal&#39;)</span>
<span class="go">    &gt;&gt;&gt; preds = model.predict(X_test)</span>
<span class="go">    &gt;&gt;&gt; model.evaluate(X_test, y_test)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.MLPLSS.build_model">
<span class="sig-name descname"><span class="pre">build_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">101</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_patience</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_decay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataloader_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.MLPLSS.build_model" title="Permalink to this definition">#</a></dt>
<dd><p>Builds the model using the provided training data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The training input samples.</p></li>
<li><p><strong>y</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em>) – The target values (real numbers).</p></li>
<li><p><strong>val_size</strong> (<em>float</em><em>, </em><em>default=0.2</em>) – The proportion of the dataset to include in the validation split if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is None. Ignored if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>X_val</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em><em>, </em><em>optional</em>) – The validation input samples. If provided, <code class="docutils literal notranslate"><span class="pre">X</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> are not split and this data is used for validation.</p></li>
<li><p><strong>y_val</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em><em>, </em><em>optional</em>) – The validation target values. Required if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>random_state</strong> (<em>int</em><em>, </em><em>default=101</em>) – Controls the shuffling applied to the data before applying the split.</p></li>
<li><p><strong>batch_size</strong> (<em>int</em><em>, </em><em>default=64</em>) – Number of samples per gradient update.</p></li>
<li><p><strong>shuffle</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to shuffle the training data before each epoch.</p></li>
<li><p><strong>lr</strong> (<em>float</em><em>, </em><em>default=1e-3</em>) – Learning rate for the optimizer.</p></li>
<li><p><strong>lr_patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement on the validation loss to wait before reducing the learning rate.</p></li>
<li><p><strong>factor</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Factor by which the learning rate will be reduced.</p></li>
<li><p><strong>weight_decay</strong> (<em>float</em><em>, </em><em>default=0.025</em>) – Weight decay (L2 penalty) coefficient.</p></li>
<li><p><strong>dataloader_kwargs</strong> (<em>dict</em><em>, </em><em>default={}</em>) – The kwargs for the pytorch dataloader class.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – The built distributional regressor.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.MLPLSS.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distribution_family</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.MLPLSS.evaluate" title="Permalink to this definition">#</a></dt>
<dd><p>Evaluate the model on the given data using specified metrics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array-like</em><em> or </em><em>pd.DataFrame</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The input samples to predict.</p></li>
<li><p><strong>y_true</strong> (<em>array-like</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>)</em>) – The true class labels against which to evaluate the predictions.</p></li>
<li><p><strong>metrics</strong> (<em>dict</em>) – A dictionary where keys are metric names and values are tuples containing the metric function
and a boolean indicating whether the metric requires probability scores (True) or class labels (False).</p></li>
<li><p><strong>distribution_family</strong> (<em>str</em><em>, </em><em>optional</em>) – Specifies the distribution family the model is predicting for. If None, it will attempt to infer based
on the model’s settings.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>scores</strong> – A dictionary with metric names as keys and their corresponding scores as values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This method uses either the <code class="docutils literal notranslate"><span class="pre">predict</span></code> or <code class="docutils literal notranslate"><span class="pre">predict_proba</span></code> method depending on the metric requirements.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.MLPLSS.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">family</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">101</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patience</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">15</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">monitor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'val_loss'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'min'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_patience</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_decay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checkpoint_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'model_checkpoints'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distributional_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataloader_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rebuild</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">trainer_kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.MLPLSS.fit" title="Permalink to this definition">#</a></dt>
<dd><p>Trains the regression model using the provided training data. Optionally, a separate validation set can be used.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The training input samples.</p></li>
<li><p><strong>y</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em>) – The target values (real numbers).</p></li>
<li><p><strong>family</strong> (<em>str</em>) – The name of the distribution family to use for the loss function. Examples include ‘normal’ for regression tasks.</p></li>
<li><p><strong>val_size</strong> (<em>float</em><em>, </em><em>default=0.2</em>) – The proportion of the dataset to include in the validation split if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is None. Ignored if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>X_val</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em><em>, </em><em>optional</em>) – The validation input samples. If provided, <code class="docutils literal notranslate"><span class="pre">X</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> are not split and this data is used for validation.</p></li>
<li><p><strong>y_val</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em><em>, </em><em>optional</em>) – The validation target values. Required if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>max_epochs</strong> (<em>int</em><em>, </em><em>default=100</em>) – Maximum number of epochs for training.</p></li>
<li><p><strong>random_state</strong> (<em>int</em><em>, </em><em>default=101</em>) – Controls the shuffling applied to the data before applying the split.</p></li>
<li><p><strong>batch_size</strong> (<em>int</em><em>, </em><em>default=64</em>) – Number of samples per gradient update.</p></li>
<li><p><strong>shuffle</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to shuffle the training data before each epoch.</p></li>
<li><p><strong>patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement on the validation loss to wait before early stopping.</p></li>
<li><p><strong>monitor</strong> (<em>str</em><em>, </em><em>default=&quot;val_loss&quot;</em>) – The metric to monitor for early stopping.</p></li>
<li><p><strong>mode</strong> (<em>str</em><em>, </em><em>default=&quot;min&quot;</em>) – Whether the monitored metric should be minimized (<code class="docutils literal notranslate"><span class="pre">min</span></code>) or maximized (<code class="docutils literal notranslate"><span class="pre">max</span></code>).</p></li>
<li><p><strong>lr</strong> (<em>float</em><em>, </em><em>default=1e-3</em>) – Learning rate for the optimizer.</p></li>
<li><p><strong>lr_patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement on the validation loss to wait before reducing the learning rate.</p></li>
<li><p><strong>factor</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Factor by which the learning rate will be reduced.</p></li>
<li><p><strong>weight_decay</strong> (<em>float</em><em>, </em><em>default=0.025</em>) – Weight decay (L2 penalty) coefficient.</p></li>
<li><p><strong>distributional_kwargs</strong> (<em>dict</em><em>, </em><em>default=None</em>) – any arguments taht are specific for a certain distribution.</p></li>
<li><p><strong>checkpoint_path</strong> (<em>str</em><em>, </em><em>default=&quot;model_checkpoints&quot;</em>) – Path where the checkpoints are being saved.</p></li>
<li><p><strong>dataloader_kwargs</strong> (<em>dict</em><em>, </em><em>default={}</em>) – The kwargs for the pytorch dataloader class.</p></li>
<li><p><strong>**trainer_kwargs</strong> (<em>Additional keyword arguments for PyTorch Lightning's Trainer class.</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – The fitted regressor.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.MLPLSS.get_default_metrics">
<span class="sig-name descname"><span class="pre">get_default_metrics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">distribution_family</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.MLPLSS.get_default_metrics" title="Permalink to this definition">#</a></dt>
<dd><p>Provides default metrics based on the distribution family.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>distribution_family</strong> (<em>str</em>) – The distribution family for which to provide default metrics.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>metrics</strong> – A dictionary of default metric functions.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.MLPLSS.get_number_of_params">
<span class="sig-name descname"><span class="pre">get_number_of_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">requires_grad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.MLPLSS.get_number_of_params" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate the number of parameters in the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>requires_grad</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, only count the parameters that require gradients (trainable parameters).
If False, count all parameters. Default is True.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The total number of parameters in the model.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the model has not been built prior to calling this method.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.MLPLSS.get_params">
<span class="sig-name descname"><span class="pre">get_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">deep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.MLPLSS.get_params" title="Permalink to this definition">#</a></dt>
<dd><p>Get parameters for this estimator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>deep</strong> (<em>bool</em><em>, </em><em>default=True</em>) – If True, will return the parameters for this estimator and contained subobjects that are estimators.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>params</strong> – Parameter names mapped to their values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.MLPLSS.optimize_hparams">
<span class="sig-name descname"><span class="pre">optimize_hparams</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prune_by_epoch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prune_epoch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fixed_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'cat_encoding':</span> <span class="pre">'int',</span> <span class="pre">'head_layer_size_length':</span> <span class="pre">0,</span> <span class="pre">'head_skip_layer':</span> <span class="pre">False,</span> <span class="pre">'head_skip_layers':</span> <span class="pre">False,</span> <span class="pre">'pooling_method':</span> <span class="pre">'avg',</span> <span class="pre">'use_cls':</span> <span class="pre">False}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">custom_search_space</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">optimize_kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.MLPLSS.optimize_hparams" title="Permalink to this definition">#</a></dt>
<dd><p>Optimizes hyperparameters using Bayesian optimization with optional pruning.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array-like</em>) – Training data.</p></li>
<li><p><strong>y</strong> (<em>array-like</em>) – Training labels.</p></li>
<li><p><strong>X_val</strong> (<em>array-like</em><em>, </em><em>optional</em>) – Validation data and labels.</p></li>
<li><p><strong>y_val</strong> (<em>array-like</em><em>, </em><em>optional</em>) – Validation data and labels.</p></li>
<li><p><strong>time</strong> (<em>int</em>) – The number of optimization trials to run.</p></li>
<li><p><strong>max_epochs</strong> (<em>int</em>) – Maximum number of epochs for training.</p></li>
<li><p><strong>prune_by_epoch</strong> (<em>bool</em>) – Whether to prune based on a specific epoch (True) or the best validation loss (False).</p></li>
<li><p><strong>prune_epoch</strong> (<em>int</em>) – The specific epoch to prune by when prune_by_epoch is True.</p></li>
<li><p><strong>**optimize_kwargs</strong> (<em>dict</em>) – Additional keyword arguments passed to the fit method.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>best_hparams</strong> – Best hyperparameters found during optimization.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.MLPLSS.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">raw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.MLPLSS.predict" title="Permalink to this definition">#</a></dt>
<dd><p>Predicts target values for the given input samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>X</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The input samples for which to predict target values.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>predictions</strong> – The predicted target values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray, shape (n_samples,) or (n_samples, n_outputs)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.MLPLSS.score">
<span class="sig-name descname"><span class="pre">score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'NLL'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.MLPLSS.score" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate the score of the model using the specified metric.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array-like</em><em> or </em><em>pd.DataFrame</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The input samples to predict.</p></li>
<li><p><strong>y</strong> (<em>array-like</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_outputs</em><em>)</em>) – The true target values against which to evaluate the predictions.</p></li>
<li><p><strong>metric</strong> (<em>str</em><em>, </em><em>default=&quot;NLL&quot;</em>) – So far, only negative log-likelihood is supported</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>score</strong> – The score calculated using the specified metric.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.MLPLSS.set_params">
<span class="sig-name descname"><span class="pre">set_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">parameters</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.MLPLSS.set_params" title="Permalink to this definition">#</a></dt>
<dd><p>Set the parameters of this estimator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>**parameters</strong> (<em>dict</em>) – Estimator parameters.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – Estimator instance.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mambular.models.TabTransformerClassifier">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mambular.models.</span></span><span class="sig-name descname"><span class="pre">TabTransformerClassifier</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/mambular/models/tabtransformer.html#TabTransformerClassifier"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mambular.models.TabTransformerClassifier" title="Permalink to this definition">#</a></dt>
<dd><dl class="simple">
<dt>TabTransformer classifier. This class extends the SklearnBaseClassifier class and uses the TabTransformer model</dt><dd><p>with the default TabTransformer configuration.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The parameters for this class include the attributes from the config
dataclass as well as preprocessing arguments handled by the base class.</p>
<p>Configuration class for the default Tab Transformer model with predefined hyperparameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lr</strong> (<em>float</em><em>, </em><em>default=1e-04</em>) – Learning rate for the optimizer.</p></li>
<li><p><strong>lr_patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement after which learning rate will be reduced.</p></li>
<li><p><strong>weight_decay</strong> (<em>float</em><em>, </em><em>default=1e-06</em>) – Weight decay (L2 penalty) for the optimizer.</p></li>
<li><p><strong>lr_factor</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Factor by which the learning rate will be reduced.</p></li>
<li><p><strong>d_model</strong> (<em>int</em><em>, </em><em>default=128</em>) – Dimensionality of the model.</p></li>
<li><p><strong>n_layers</strong> (<em>int</em><em>, </em><em>default=4</em>) – Number of layers in the transformer.</p></li>
<li><p><strong>n_heads</strong> (<em>int</em><em>, </em><em>default=8</em>) – Number of attention heads in the transformer.</p></li>
<li><p><strong>attn_dropout</strong> (<em>float</em><em>, </em><em>default=0.2</em>) – Dropout rate for the attention mechanism.</p></li>
<li><p><strong>ff_dropout</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Dropout rate for the feed-forward layers.</p></li>
<li><p><strong>norm</strong> (<em>str</em><em>, </em><em>default=&quot;LayerNorm&quot;</em>) – Normalization method to be used.</p></li>
<li><p><strong>activation</strong> (<em>callable</em><em>, </em><em>default=nn.SELU</em><em>(</em><em>)</em>) – Activation function for the transformer layers.</p></li>
<li><p><strong>transformer_activation</strong> (<em>callable</em><em>, </em><em>default=ReGLU</em><em>(</em><em>)</em>) – Activation function for the transformer layers.</p></li>
<li><p><strong>transformer_dim_feedforward</strong> (<em>int</em><em>, </em><em>default=512</em>) – Dimensionality of the feed-forward layers in the transformer.</p></li>
<li><p><strong>layer_norm_eps</strong> (<em>float</em><em>, </em><em>default=1e-05</em>) – Epsilon value for layer normalization.</p></li>
<li><p><strong>norm_first</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to apply normalization before other operations in each transformer block.</p></li>
<li><p><strong>bias</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to use bias in the linear layers.</p></li>
<li><p><strong>embedding_activation</strong> (<em>callable</em><em>, </em><em>default=nn.Identity</em><em>(</em><em>)</em>) – Activation function for embeddings.</p></li>
<li><p><strong>embedding_type</strong> (<em>str</em><em>, </em><em>default=&quot;linear&quot;</em>) – Type of embedding to use (‘linear’, etc.).</p></li>
<li><p><strong>embedding_bias</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use bias in the embedding layers.</p></li>
<li><p><strong>layer_norm_after_embedding</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to apply layer normalization after embedding.</p></li>
<li><p><strong>head_layer_sizes</strong> (<em>list</em><em>, </em><em>default=</em><em>(</em><em>)</em>) – Sizes of the layers in the model’s head.</p></li>
<li><p><strong>head_dropout</strong> (<em>float</em><em>, </em><em>default=0.5</em>) – Dropout rate for the head layers.</p></li>
<li><p><strong>head_skip_layers</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to skip layers in the head.</p></li>
<li><p><strong>head_activation</strong> (<em>callable</em><em>, </em><em>default=nn.SELU</em><em>(</em><em>)</em>) – Activation function for the head layers.</p></li>
<li><p><strong>head_use_batch_norm</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use batch normalization in the head layers.</p></li>
<li><p><strong>pooling_method</strong> (<em>str</em><em>, </em><em>default=&quot;avg&quot;</em>) – Pooling method to be used (‘cls’, ‘avg’, etc.).</p></li>
<li><p><strong>cat_encoding</strong> (<em>str</em><em>, </em><em>default=&quot;int&quot;</em>) – Encoding method for categorical features (‘int’, ‘one-hot’, etc.).</p></li>
<li><p><strong>n_bins</strong> (<em>int</em><em>, </em><em>default=50</em>) – The number of bins to use for numerical feature binning. This parameter is relevant
only if <code class="docutils literal notranslate"><span class="pre">numerical_preprocessing</span></code> is set to ‘binning’, ‘ple’ or ‘one-hot’.</p></li>
<li><p><strong>numerical_preprocessing</strong> (<em>str</em><em>, </em><em>default=&quot;ple&quot;</em>) – The preprocessing strategy for numerical features. Valid options are
‘ple’, ‘binning’, ‘one-hot’, ‘standardization’, ‘min-max’, ‘quantile’, ‘polynomial’,
‘splines’, ‘box-cox’, ‘yeo-johnson’ and None</p></li>
<li><p><strong>categorical_preprocessing</strong> (<em>str</em><em>, </em><em>default=&quot;int&quot;</em>) – The preprocessing strategy for categorical features. Valid options are
‘int’, ‘one-hot’, None</p></li>
<li><p><strong>use_decision_tree_bins</strong> (<em>bool</em><em>, </em><em>default=False</em>) – If True, uses decision tree regression/classification to determine
optimal bin edges for numerical feature binning. This parameter is
relevant only if <code class="docutils literal notranslate"><span class="pre">numerical_preprocessing</span></code> is set to ‘binning’ or ‘one-hot’.</p></li>
<li><p><strong>binning_strategy</strong> (<em>str</em><em>, </em><em>default=&quot;uniform&quot;</em>) – Defines the strategy for binning numerical features. Options include ‘uniform’,
‘quantile’, or other sklearn-compatible strategies.</p></li>
<li><p><strong>task</strong> (<em>str</em><em>, </em><em>default=&quot;regression&quot;</em>) – Indicates the type of machine learning task (‘regression’ or ‘classification’). This can
influence certain preprocessing behaviors, especially when using decision tree-based binning.</p></li>
<li><p><strong>cat_cutoff</strong> (<em>float</em><em> or </em><em>int</em><em>, </em><em>default=0.03</em>) – Indicates the cutoff after which integer values are treated as categorical.
If float, it’s treated as a percentage. If int, it’s the maximum number of
unique values for a column to be considered categorical.</p></li>
<li><p><strong>treat_all_integers_as_numerical</strong> (<em>bool</em><em>, </em><em>default=False</em>) – If True, all integer columns will be treated as numerical, regardless
of their unique value count or proportion.</p></li>
<li><p><strong>degree</strong> (<em>int</em><em>, </em><em>default=3</em>) – The degree of the polynomial features to be used in preprocessing.</p></li>
<li><p><strong>knots</strong> (<em>int</em><em>, </em><em>default=12</em>) – The number of knots to be used in spline transformations.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mambular.models</span> <span class="kn">import</span> <span class="n">TabTransformerClassifier</span>
<span class="go">    &gt;&gt;&gt; model = TabTransformerClassifier()</span>
<span class="go">    &gt;&gt;&gt; model.fit(X_train, y_train)</span>
<span class="go">    &gt;&gt;&gt; preds = model.predict(X_test)</span>
<span class="go">    &gt;&gt;&gt; model.evaluate(X_test, y_test)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.TabTransformerClassifier.build_model">
<span class="sig-name descname"><span class="pre">build_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">101</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_patience</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_decay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataloader_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.TabTransformerClassifier.build_model" title="Permalink to this definition">#</a></dt>
<dd><p>Builds the model using the provided training data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The training input samples.</p></li>
<li><p><strong>y</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em>) – The target values (real numbers).</p></li>
<li><p><strong>val_size</strong> (<em>float</em><em>, </em><em>default=0.2</em>) – The proportion of the dataset to include in the validation split if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is None. Ignored if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>X_val</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em><em>, </em><em>optional</em>) – The validation input samples. If provided, <code class="docutils literal notranslate"><span class="pre">X</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> are not split and this data is used for validation.</p></li>
<li><p><strong>y_val</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em><em>, </em><em>optional</em>) – The validation target values. Required if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>random_state</strong> (<em>int</em><em>, </em><em>default=101</em>) – Controls the shuffling applied to the data before applying the split.</p></li>
<li><p><strong>batch_size</strong> (<em>int</em><em>, </em><em>default=64</em>) – Number of samples per gradient update.</p></li>
<li><p><strong>shuffle</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to shuffle the training data before each epoch.</p></li>
<li><p><strong>lr</strong> (<em>float</em><em>, </em><em>default=1e-3</em>) – Learning rate for the optimizer.</p></li>
<li><p><strong>lr_patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement on the validation loss to wait before reducing the learning rate.</p></li>
<li><p><strong>factor</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Factor by which the learning rate will be reduced.</p></li>
<li><p><strong>weight_decay</strong> (<em>float</em><em>, </em><em>default=0.025</em>) – Weight decay (L2 penalty) coefficient.</p></li>
<li><p><strong>dataloader_kwargs</strong> (<em>dict</em><em>, </em><em>default={}</em>) – The kwargs for the pytorch dataloader class.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – The built classifier.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.TabTransformerClassifier.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.TabTransformerClassifier.evaluate" title="Permalink to this definition">#</a></dt>
<dd><p>Evaluate the model on the given data using specified metrics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array-like</em><em> or </em><em>pd.DataFrame</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The input samples to predict.</p></li>
<li><p><strong>y_true</strong> (<em>array-like</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>)</em>) – The true class labels against which to evaluate the predictions.</p></li>
<li><p><strong>metrics</strong> (<em>dict</em>) – A dictionary where keys are metric names and values are tuples containing the metric function
and a boolean indicating whether the metric requires probability scores (True) or class labels (False).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>scores</strong> – A dictionary with metric names as keys and their corresponding scores as values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This method uses either the <code class="docutils literal notranslate"><span class="pre">predict</span></code> or <code class="docutils literal notranslate"><span class="pre">predict_proba</span></code> method depending on the metric requirements.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.TabTransformerClassifier.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">101</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patience</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">15</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">monitor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'val_loss'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'min'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_patience</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_decay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checkpoint_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'model_checkpoints'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataloader_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rebuild</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">trainer_kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.TabTransformerClassifier.fit" title="Permalink to this definition">#</a></dt>
<dd><p>Trains the classification model using the provided training data. Optionally, a separate validation set can be used.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The training input samples.</p></li>
<li><p><strong>y</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em>) – The target values (real numbers).</p></li>
<li><p><strong>val_size</strong> (<em>float</em><em>, </em><em>default=0.2</em>) – The proportion of the dataset to include in the validation split if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is None. Ignored if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>X_val</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em><em>, </em><em>optional</em>) – The validation input samples. If provided, <code class="docutils literal notranslate"><span class="pre">X</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> are not split and this data is used for validation.</p></li>
<li><p><strong>y_val</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em><em>, </em><em>optional</em>) – The validation target values. Required if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>max_epochs</strong> (<em>int</em><em>, </em><em>default=100</em>) – Maximum number of epochs for training.</p></li>
<li><p><strong>random_state</strong> (<em>int</em><em>, </em><em>default=101</em>) – Controls the shuffling applied to the data before applying the split.</p></li>
<li><p><strong>batch_size</strong> (<em>int</em><em>, </em><em>default=64</em>) – Number of samples per gradient update.</p></li>
<li><p><strong>shuffle</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to shuffle the training data before each epoch.</p></li>
<li><p><strong>patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement on the validation loss to wait before early stopping.</p></li>
<li><p><strong>monitor</strong> (<em>str</em><em>, </em><em>default=&quot;val_loss&quot;</em>) – The metric to monitor for early stopping.</p></li>
<li><p><strong>mode</strong> (<em>str</em><em>, </em><em>default=&quot;min&quot;</em>) – Whether the monitored metric should be minimized (<code class="docutils literal notranslate"><span class="pre">min</span></code>) or maximized (<code class="docutils literal notranslate"><span class="pre">max</span></code>).</p></li>
<li><p><strong>lr</strong> (<em>float</em><em>, </em><em>default=1e-3</em>) – Learning rate for the optimizer.</p></li>
<li><p><strong>lr_patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement on the validation loss to wait before reducing the learning rate.</p></li>
<li><p><strong>factor</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Factor by which the learning rate will be reduced.</p></li>
<li><p><strong>weight_decay</strong> (<em>float</em><em>, </em><em>default=0.025</em>) – Weight decay (L2 penalty) coefficient.</p></li>
<li><p><strong>checkpoint_path</strong> (<em>str</em><em>, </em><em>default=&quot;model_checkpoints&quot;</em>) – Path where the checkpoints are being saved.</p></li>
<li><p><strong>dataloader_kwargs</strong> (<em>dict</em><em>, </em><em>default={}</em>) – The kwargs for the pytorch dataloader class.</p></li>
<li><p><strong>rebuild</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to rebuild the model when it already was built.</p></li>
<li><p><strong>**trainer_kwargs</strong> (<em>Additional keyword arguments for PyTorch Lightning's Trainer class.</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – The fitted classifier.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.TabTransformerClassifier.get_number_of_params">
<span class="sig-name descname"><span class="pre">get_number_of_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">requires_grad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.TabTransformerClassifier.get_number_of_params" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate the number of parameters in the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>requires_grad</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, only count the parameters that require gradients (trainable parameters).
If False, count all parameters. Default is True.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The total number of parameters in the model.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the model has not been built prior to calling this method.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.TabTransformerClassifier.get_params">
<span class="sig-name descname"><span class="pre">get_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">deep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.TabTransformerClassifier.get_params" title="Permalink to this definition">#</a></dt>
<dd><p>Get parameters for this estimator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>deep</strong> (<em>bool</em><em>, </em><em>default=True</em>) – If True, will return the parameters for this estimator and contained subobjects that are estimators.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>params</strong> – Parameter names mapped to their values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.TabTransformerClassifier.optimize_hparams">
<span class="sig-name descname"><span class="pre">optimize_hparams</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prune_by_epoch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prune_epoch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fixed_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'cat_encoding':</span> <span class="pre">'int',</span> <span class="pre">'head_layer_size_length':</span> <span class="pre">0,</span> <span class="pre">'head_skip_layer':</span> <span class="pre">False,</span> <span class="pre">'head_skip_layers':</span> <span class="pre">False,</span> <span class="pre">'pooling_method':</span> <span class="pre">'avg',</span> <span class="pre">'use_cls':</span> <span class="pre">False}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">custom_search_space</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">optimize_kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.TabTransformerClassifier.optimize_hparams" title="Permalink to this definition">#</a></dt>
<dd><p>Optimizes hyperparameters using Bayesian optimization with optional pruning.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array-like</em>) – Training data.</p></li>
<li><p><strong>y</strong> (<em>array-like</em>) – Training labels.</p></li>
<li><p><strong>X_val</strong> (<em>array-like</em><em>, </em><em>optional</em>) – Validation data and labels.</p></li>
<li><p><strong>y_val</strong> (<em>array-like</em><em>, </em><em>optional</em>) – Validation data and labels.</p></li>
<li><p><strong>time</strong> (<em>int</em>) – The number of optimization trials to run.</p></li>
<li><p><strong>max_epochs</strong> (<em>int</em>) – Maximum number of epochs for training.</p></li>
<li><p><strong>prune_by_epoch</strong> (<em>bool</em>) – Whether to prune based on a specific epoch (True) or the best validation loss (False).</p></li>
<li><p><strong>prune_epoch</strong> (<em>int</em>) – The specific epoch to prune by when prune_by_epoch is True.</p></li>
<li><p><strong>**optimize_kwargs</strong> (<em>dict</em>) – Additional keyword arguments passed to the fit method.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>best_hparams</strong> – Best hyperparameters found during optimization.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.TabTransformerClassifier.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.TabTransformerClassifier.predict" title="Permalink to this definition">#</a></dt>
<dd><p>Predicts target values for the given input samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>X</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The input samples for which to predict target values.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>predictions</strong> – The predicted target values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray, shape (n_samples,) or (n_samples, n_outputs)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.TabTransformerClassifier.predict_proba">
<span class="sig-name descname"><span class="pre">predict_proba</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.TabTransformerClassifier.predict_proba" title="Permalink to this definition">#</a></dt>
<dd><p>Predict class probabilities for the given input samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>X</strong> (<em>array-like</em><em> or </em><em>pd.DataFrame</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The input samples for which to predict class probabilities.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The method preprocesses the input data using the same preprocessor used during training,
sets the model to evaluation mode, and then performs inference to predict the class probabilities.
Softmax is applied to the logits to obtain probabilities, which are then converted from a PyTorch tensor
to a NumPy array before being returned.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">accuracy_score</span><span class="p">,</span> <span class="n">precision_score</span><span class="p">,</span> <span class="n">f1_score</span><span class="p">,</span> <span class="n">roc_auc_score</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Define the metrics you want to evaluate</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">metrics</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">... </span>    <span class="s1">&#39;Accuracy&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">accuracy_score</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
<span class="gp">... </span>    <span class="s1">&#39;Precision&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">precision_score</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
<span class="gp">... </span>    <span class="s1">&#39;F1 Score&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">f1_score</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
<span class="gp">... </span>    <span class="s1">&#39;AUC Score&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">roc_auc_score</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
<span class="gp">... </span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Assuming &#39;X_test&#39; and &#39;y_test&#39; are your test dataset and labels</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Evaluate using the specified metrics</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results</span> <span class="o">=</span> <span class="n">classifier</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="n">metrics</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>probabilities</strong> – Predicted class probabilities for each input sample.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>ndarray of shape (n_samples, n_classes)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.TabTransformerClassifier.score">
<span class="sig-name descname"><span class="pre">score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(sklearn.metrics.log_loss,</span> <span class="pre">True)</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.TabTransformerClassifier.score" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate the score of the model using the specified metric.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array-like</em><em> or </em><em>pd.DataFrame</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The input samples to predict.</p></li>
<li><p><strong>y</strong> (<em>array-like</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>)</em>) – The true class labels against which to evaluate the predictions.</p></li>
<li><p><strong>metric</strong> (<em>tuple</em><em>, </em><em>default=</em><em>(</em><em>log_loss</em><em>, </em><em>True</em><em>)</em>) – A tuple containing the metric function and a boolean indicating whether the metric requires probability scores (True) or class labels (False).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>score</strong> – The score calculated using the specified metric.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.TabTransformerClassifier.set_params">
<span class="sig-name descname"><span class="pre">set_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">parameters</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.TabTransformerClassifier.set_params" title="Permalink to this definition">#</a></dt>
<dd><p>Set the parameters of this estimator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>**parameters</strong> (<em>dict</em>) – Estimator parameters.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – Estimator instance.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mambular.models.TabTransformerRegressor">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mambular.models.</span></span><span class="sig-name descname"><span class="pre">TabTransformerRegressor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/mambular/models/tabtransformer.html#TabTransformerRegressor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mambular.models.TabTransformerRegressor" title="Permalink to this definition">#</a></dt>
<dd><dl class="simple">
<dt>TabTransformer regressor. This class extends the SklearnBaseRegressor class and uses the TabTransformer model</dt><dd><p>with the default TabTransformer configuration.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The parameters for this class include the attributes from the config
dataclass as well as preprocessing arguments handled by the base class.</p>
<p>Configuration class for the default Tab Transformer model with predefined hyperparameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lr</strong> (<em>float</em><em>, </em><em>default=1e-04</em>) – Learning rate for the optimizer.</p></li>
<li><p><strong>lr_patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement after which learning rate will be reduced.</p></li>
<li><p><strong>weight_decay</strong> (<em>float</em><em>, </em><em>default=1e-06</em>) – Weight decay (L2 penalty) for the optimizer.</p></li>
<li><p><strong>lr_factor</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Factor by which the learning rate will be reduced.</p></li>
<li><p><strong>d_model</strong> (<em>int</em><em>, </em><em>default=128</em>) – Dimensionality of the model.</p></li>
<li><p><strong>n_layers</strong> (<em>int</em><em>, </em><em>default=4</em>) – Number of layers in the transformer.</p></li>
<li><p><strong>n_heads</strong> (<em>int</em><em>, </em><em>default=8</em>) – Number of attention heads in the transformer.</p></li>
<li><p><strong>attn_dropout</strong> (<em>float</em><em>, </em><em>default=0.2</em>) – Dropout rate for the attention mechanism.</p></li>
<li><p><strong>ff_dropout</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Dropout rate for the feed-forward layers.</p></li>
<li><p><strong>norm</strong> (<em>str</em><em>, </em><em>default=&quot;LayerNorm&quot;</em>) – Normalization method to be used.</p></li>
<li><p><strong>activation</strong> (<em>callable</em><em>, </em><em>default=nn.SELU</em><em>(</em><em>)</em>) – Activation function for the transformer layers.</p></li>
<li><p><strong>transformer_activation</strong> (<em>callable</em><em>, </em><em>default=ReGLU</em><em>(</em><em>)</em>) – Activation function for the transformer layers.</p></li>
<li><p><strong>transformer_dim_feedforward</strong> (<em>int</em><em>, </em><em>default=512</em>) – Dimensionality of the feed-forward layers in the transformer.</p></li>
<li><p><strong>layer_norm_eps</strong> (<em>float</em><em>, </em><em>default=1e-05</em>) – Epsilon value for layer normalization.</p></li>
<li><p><strong>norm_first</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to apply normalization before other operations in each transformer block.</p></li>
<li><p><strong>bias</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to use bias in the linear layers.</p></li>
<li><p><strong>embedding_activation</strong> (<em>callable</em><em>, </em><em>default=nn.Identity</em><em>(</em><em>)</em>) – Activation function for embeddings.</p></li>
<li><p><strong>embedding_type</strong> (<em>str</em><em>, </em><em>default=&quot;linear&quot;</em>) – Type of embedding to use (‘linear’, etc.).</p></li>
<li><p><strong>embedding_bias</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use bias in the embedding layers.</p></li>
<li><p><strong>layer_norm_after_embedding</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to apply layer normalization after embedding.</p></li>
<li><p><strong>head_layer_sizes</strong> (<em>list</em><em>, </em><em>default=</em><em>(</em><em>)</em>) – Sizes of the layers in the model’s head.</p></li>
<li><p><strong>head_dropout</strong> (<em>float</em><em>, </em><em>default=0.5</em>) – Dropout rate for the head layers.</p></li>
<li><p><strong>head_skip_layers</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to skip layers in the head.</p></li>
<li><p><strong>head_activation</strong> (<em>callable</em><em>, </em><em>default=nn.SELU</em><em>(</em><em>)</em>) – Activation function for the head layers.</p></li>
<li><p><strong>head_use_batch_norm</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use batch normalization in the head layers.</p></li>
<li><p><strong>pooling_method</strong> (<em>str</em><em>, </em><em>default=&quot;avg&quot;</em>) – Pooling method to be used (‘cls’, ‘avg’, etc.).</p></li>
<li><p><strong>cat_encoding</strong> (<em>str</em><em>, </em><em>default=&quot;int&quot;</em>) – Encoding method for categorical features (‘int’, ‘one-hot’, etc.).</p></li>
<li><p><strong>n_bins</strong> (<em>int</em><em>, </em><em>default=50</em>) – The number of bins to use for numerical feature binning. This parameter is relevant
only if <code class="docutils literal notranslate"><span class="pre">numerical_preprocessing</span></code> is set to ‘binning’, ‘ple’ or ‘one-hot’.</p></li>
<li><p><strong>numerical_preprocessing</strong> (<em>str</em><em>, </em><em>default=&quot;ple&quot;</em>) – The preprocessing strategy for numerical features. Valid options are
‘ple’, ‘binning’, ‘one-hot’, ‘standardization’, ‘min-max’, ‘quantile’, ‘polynomial’,
‘splines’, ‘box-cox’, ‘yeo-johnson’ and None</p></li>
<li><p><strong>categorical_preprocessing</strong> (<em>str</em><em>, </em><em>default=&quot;int&quot;</em>) – The preprocessing strategy for categorical features. Valid options are
‘int’, ‘one-hot’, None</p></li>
<li><p><strong>use_decision_tree_bins</strong> (<em>bool</em><em>, </em><em>default=False</em>) – If True, uses decision tree regression/classification to determine
optimal bin edges for numerical feature binning. This parameter is
relevant only if <code class="docutils literal notranslate"><span class="pre">numerical_preprocessing</span></code> is set to ‘binning’ or ‘one-hot’.</p></li>
<li><p><strong>binning_strategy</strong> (<em>str</em><em>, </em><em>default=&quot;uniform&quot;</em>) – Defines the strategy for binning numerical features. Options include ‘uniform’,
‘quantile’, or other sklearn-compatible strategies.</p></li>
<li><p><strong>task</strong> (<em>str</em><em>, </em><em>default=&quot;regression&quot;</em>) – Indicates the type of machine learning task (‘regression’ or ‘classification’). This can
influence certain preprocessing behaviors, especially when using decision tree-based binning.</p></li>
<li><p><strong>cat_cutoff</strong> (<em>float</em><em> or </em><em>int</em><em>, </em><em>default=0.03</em>) – Indicates the cutoff after which integer values are treated as categorical.
If float, it’s treated as a percentage. If int, it’s the maximum number of
unique values for a column to be considered categorical.</p></li>
<li><p><strong>treat_all_integers_as_numerical</strong> (<em>bool</em><em>, </em><em>default=False</em>) – If True, all integer columns will be treated as numerical, regardless
of their unique value count or proportion.</p></li>
<li><p><strong>degree</strong> (<em>int</em><em>, </em><em>default=3</em>) – The degree of the polynomial features to be used in preprocessing.</p></li>
<li><p><strong>knots</strong> (<em>int</em><em>, </em><em>default=12</em>) – The number of knots to be used in spline transformations.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mambular.models</span> <span class="kn">import</span> <span class="n">TabTransformerRegressor</span>
<span class="go">    &gt;&gt;&gt; model = TabTransformerRegressor()</span>
<span class="go">    &gt;&gt;&gt; model.fit(X_train, y_train)</span>
<span class="go">    &gt;&gt;&gt; preds = model.predict(X_test)</span>
<span class="go">    &gt;&gt;&gt; model.evaluate(X_test, y_test)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.TabTransformerRegressor.build_model">
<span class="sig-name descname"><span class="pre">build_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">101</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_patience</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_decay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataloader_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.TabTransformerRegressor.build_model" title="Permalink to this definition">#</a></dt>
<dd><p>Builds the model using the provided training data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The training input samples.</p></li>
<li><p><strong>y</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em>) – The target values (real numbers).</p></li>
<li><p><strong>val_size</strong> (<em>float</em><em>, </em><em>default=0.2</em>) – The proportion of the dataset to include in the validation split if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is None. Ignored if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>X_val</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em><em>, </em><em>optional</em>) – The validation input samples. If provided, <code class="docutils literal notranslate"><span class="pre">X</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> are not split and this data is used for validation.</p></li>
<li><p><strong>y_val</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em><em>, </em><em>optional</em>) – The validation target values. Required if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>random_state</strong> (<em>int</em><em>, </em><em>default=101</em>) – Controls the shuffling applied to the data before applying the split.</p></li>
<li><p><strong>batch_size</strong> (<em>int</em><em>, </em><em>default=64</em>) – Number of samples per gradient update.</p></li>
<li><p><strong>shuffle</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to shuffle the training data before each epoch.</p></li>
<li><p><strong>lr</strong> (<em>float</em><em>, </em><em>default=1e-3</em>) – Learning rate for the optimizer.</p></li>
<li><p><strong>lr_patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement on the validation loss to wait before reducing the learning rate.</p></li>
<li><p><strong>factor</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Factor by which the learning rate will be reduced.</p></li>
<li><p><strong>weight_decay</strong> (<em>float</em><em>, </em><em>default=0.025</em>) – Weight decay (L2 penalty) coefficient.</p></li>
<li><p><strong>dataloader_kwargs</strong> (<em>dict</em><em>, </em><em>default={}</em>) – The kwargs for the pytorch dataloader class.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – The built regressor.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.TabTransformerRegressor.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.TabTransformerRegressor.evaluate" title="Permalink to this definition">#</a></dt>
<dd><p>Evaluate the model on the given data using specified metrics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array-like</em><em> or </em><em>pd.DataFrame</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The input samples to predict.</p></li>
<li><p><strong>y_true</strong> (<em>array-like</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_outputs</em><em>)</em>) – The true target values against which to evaluate the predictions.</p></li>
<li><p><strong>metrics</strong> (<em>dict</em>) – A dictionary where keys are metric names and values are the metric functions.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This method uses the <code class="docutils literal notranslate"><span class="pre">predict</span></code> method to generate predictions and computes each metric.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_squared_error</span><span class="p">,</span> <span class="n">r2_score</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mambular.models</span> <span class="kn">import</span> <span class="n">MambularRegressor</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">metrics</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">... </span>    <span class="s1">&#39;Mean Squared Error&#39;</span><span class="p">:</span> <span class="n">mean_squared_error</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s1">&#39;R2 Score&#39;</span><span class="p">:</span> <span class="n">r2_score</span>
<span class="gp">... </span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Assuming &#39;X_test&#39; and &#39;y_test&#39; are your test dataset and labels</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Evaluate using the specified metrics</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results</span> <span class="o">=</span> <span class="n">regressor</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="n">metrics</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>scores</strong> – A dictionary with metric names as keys and their corresponding scores as values.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.TabTransformerRegressor.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">101</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patience</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">15</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">monitor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'val_loss'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'min'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_patience</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_decay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checkpoint_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'model_checkpoints'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataloader_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rebuild</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">trainer_kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.TabTransformerRegressor.fit" title="Permalink to this definition">#</a></dt>
<dd><p>Trains the regression model using the provided training data. Optionally, a separate validation set can be used.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The training input samples.</p></li>
<li><p><strong>y</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em>) – The target values (real numbers).</p></li>
<li><p><strong>val_size</strong> (<em>float</em><em>, </em><em>default=0.2</em>) – The proportion of the dataset to include in the validation split if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is None. Ignored if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>X_val</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em><em>, </em><em>optional</em>) – The validation input samples. If provided, <code class="docutils literal notranslate"><span class="pre">X</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> are not split and this data is used for validation.</p></li>
<li><p><strong>y_val</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em><em>, </em><em>optional</em>) – The validation target values. Required if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>max_epochs</strong> (<em>int</em><em>, </em><em>default=100</em>) – Maximum number of epochs for training.</p></li>
<li><p><strong>random_state</strong> (<em>int</em><em>, </em><em>default=101</em>) – Controls the shuffling applied to the data before applying the split.</p></li>
<li><p><strong>batch_size</strong> (<em>int</em><em>, </em><em>default=64</em>) – Number of samples per gradient update.</p></li>
<li><p><strong>shuffle</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to shuffle the training data before each epoch.</p></li>
<li><p><strong>patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement on the validation loss to wait before early stopping.</p></li>
<li><p><strong>monitor</strong> (<em>str</em><em>, </em><em>default=&quot;val_loss&quot;</em>) – The metric to monitor for early stopping.</p></li>
<li><p><strong>mode</strong> (<em>str</em><em>, </em><em>default=&quot;min&quot;</em>) – Whether the monitored metric should be minimized (<code class="docutils literal notranslate"><span class="pre">min</span></code>) or maximized (<code class="docutils literal notranslate"><span class="pre">max</span></code>).</p></li>
<li><p><strong>lr</strong> (<em>float</em><em>, </em><em>default=1e-3</em>) – Learning rate for the optimizer.</p></li>
<li><p><strong>lr_patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement on the validation loss to wait before reducing the learning rate.</p></li>
<li><p><strong>factor</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Factor by which the learning rate will be reduced.</p></li>
<li><p><strong>weight_decay</strong> (<em>float</em><em>, </em><em>default=0.025</em>) – Weight decay (L2 penalty) coefficient.</p></li>
<li><p><strong>checkpoint_path</strong> (<em>str</em><em>, </em><em>default=&quot;model_checkpoints&quot;</em>) – Path where the checkpoints are being saved.</p></li>
<li><p><strong>dataloader_kwargs</strong> (<em>dict</em><em>, </em><em>default={}</em>) – The kwargs for the pytorch dataloader class.</p></li>
<li><p><strong>**trainer_kwargs</strong> (<em>Additional keyword arguments for PyTorch Lightning's Trainer class.</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – The fitted regressor.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.TabTransformerRegressor.get_number_of_params">
<span class="sig-name descname"><span class="pre">get_number_of_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">requires_grad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.TabTransformerRegressor.get_number_of_params" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate the number of parameters in the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>requires_grad</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, only count the parameters that require gradients (trainable parameters).
If False, count all parameters. Default is True.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The total number of parameters in the model.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the model has not been built prior to calling this method.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.TabTransformerRegressor.get_params">
<span class="sig-name descname"><span class="pre">get_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">deep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.TabTransformerRegressor.get_params" title="Permalink to this definition">#</a></dt>
<dd><p>Get parameters for this estimator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>deep</strong> (<em>bool</em><em>, </em><em>default=True</em>) – If True, will return the parameters for this estimator and contained subobjects that are estimators.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>params</strong> – Parameter names mapped to their values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.TabTransformerRegressor.optimize_hparams">
<span class="sig-name descname"><span class="pre">optimize_hparams</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prune_by_epoch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prune_epoch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fixed_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'cat_encoding':</span> <span class="pre">'int',</span> <span class="pre">'head_layer_size_length':</span> <span class="pre">0,</span> <span class="pre">'head_skip_layer':</span> <span class="pre">False,</span> <span class="pre">'head_skip_layers':</span> <span class="pre">False,</span> <span class="pre">'pooling_method':</span> <span class="pre">'avg',</span> <span class="pre">'use_cls':</span> <span class="pre">False}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">custom_search_space</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">optimize_kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.TabTransformerRegressor.optimize_hparams" title="Permalink to this definition">#</a></dt>
<dd><p>Optimizes hyperparameters using Bayesian optimization with optional pruning.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array-like</em>) – Training data.</p></li>
<li><p><strong>y</strong> (<em>array-like</em>) – Training labels.</p></li>
<li><p><strong>X_val</strong> (<em>array-like</em><em>, </em><em>optional</em>) – Validation data and labels.</p></li>
<li><p><strong>y_val</strong> (<em>array-like</em><em>, </em><em>optional</em>) – Validation data and labels.</p></li>
<li><p><strong>time</strong> (<em>int</em>) – The number of optimization trials to run.</p></li>
<li><p><strong>max_epochs</strong> (<em>int</em>) – Maximum number of epochs for training.</p></li>
<li><p><strong>prune_by_epoch</strong> (<em>bool</em>) – Whether to prune based on a specific epoch (True) or the best validation loss (False).</p></li>
<li><p><strong>prune_epoch</strong> (<em>int</em>) – The specific epoch to prune by when prune_by_epoch is True.</p></li>
<li><p><strong>**optimize_kwargs</strong> (<em>dict</em>) – Additional keyword arguments passed to the fit method.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>best_hparams</strong> – Best hyperparameters found during optimization.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.TabTransformerRegressor.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.TabTransformerRegressor.predict" title="Permalink to this definition">#</a></dt>
<dd><p>Predicts target values for the given input samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>X</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The input samples for which to predict target values.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>predictions</strong> – The predicted target values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray, shape (n_samples,) or (n_samples, n_outputs)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.TabTransformerRegressor.score">
<span class="sig-name descname"><span class="pre">score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">sklearn.metrics.mean_squared_error</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.TabTransformerRegressor.score" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate the score of the model using the specified metric.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array-like</em><em> or </em><em>pd.DataFrame</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The input samples to predict.</p></li>
<li><p><strong>y</strong> (<em>array-like</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_outputs</em><em>)</em>) – The true target values against which to evaluate the predictions.</p></li>
<li><p><strong>metric</strong> (<em>callable</em><em>, </em><em>default=mean_squared_error</em>) – The metric function to use for evaluation. Must be a callable with the signature <code class="docutils literal notranslate"><span class="pre">metric(y_true,</span> <span class="pre">y_pred)</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>score</strong> – The score calculated using the specified metric.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.TabTransformerRegressor.set_params">
<span class="sig-name descname"><span class="pre">set_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">parameters</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.TabTransformerRegressor.set_params" title="Permalink to this definition">#</a></dt>
<dd><p>Set the parameters of this estimator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>**parameters</strong> (<em>dict</em>) – Estimator parameters.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – Estimator instance.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mambular.models.TabTransformerLSS">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mambular.models.</span></span><span class="sig-name descname"><span class="pre">TabTransformerLSS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/mambular/models/tabtransformer.html#TabTransformerLSS"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mambular.models.TabTransformerLSS" title="Permalink to this definition">#</a></dt>
<dd><dl class="simple">
<dt>TabTransformer for distributional regression. This class extends the SklearnBaseLSS class and uses the TabTransformer model</dt><dd><p>with the default TabTransformer configuration.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The parameters for this class include the attributes from the config
dataclass as well as preprocessing arguments handled by the base class.</p>
<p>Configuration class for the default Tab Transformer model with predefined hyperparameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lr</strong> (<em>float</em><em>, </em><em>default=1e-04</em>) – Learning rate for the optimizer.</p></li>
<li><p><strong>lr_patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement after which learning rate will be reduced.</p></li>
<li><p><strong>weight_decay</strong> (<em>float</em><em>, </em><em>default=1e-06</em>) – Weight decay (L2 penalty) for the optimizer.</p></li>
<li><p><strong>lr_factor</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Factor by which the learning rate will be reduced.</p></li>
<li><p><strong>d_model</strong> (<em>int</em><em>, </em><em>default=128</em>) – Dimensionality of the model.</p></li>
<li><p><strong>n_layers</strong> (<em>int</em><em>, </em><em>default=4</em>) – Number of layers in the transformer.</p></li>
<li><p><strong>n_heads</strong> (<em>int</em><em>, </em><em>default=8</em>) – Number of attention heads in the transformer.</p></li>
<li><p><strong>attn_dropout</strong> (<em>float</em><em>, </em><em>default=0.2</em>) – Dropout rate for the attention mechanism.</p></li>
<li><p><strong>ff_dropout</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Dropout rate for the feed-forward layers.</p></li>
<li><p><strong>norm</strong> (<em>str</em><em>, </em><em>default=&quot;LayerNorm&quot;</em>) – Normalization method to be used.</p></li>
<li><p><strong>activation</strong> (<em>callable</em><em>, </em><em>default=nn.SELU</em><em>(</em><em>)</em>) – Activation function for the transformer layers.</p></li>
<li><p><strong>transformer_activation</strong> (<em>callable</em><em>, </em><em>default=ReGLU</em><em>(</em><em>)</em>) – Activation function for the transformer layers.</p></li>
<li><p><strong>transformer_dim_feedforward</strong> (<em>int</em><em>, </em><em>default=512</em>) – Dimensionality of the feed-forward layers in the transformer.</p></li>
<li><p><strong>layer_norm_eps</strong> (<em>float</em><em>, </em><em>default=1e-05</em>) – Epsilon value for layer normalization.</p></li>
<li><p><strong>norm_first</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to apply normalization before other operations in each transformer block.</p></li>
<li><p><strong>bias</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to use bias in the linear layers.</p></li>
<li><p><strong>embedding_activation</strong> (<em>callable</em><em>, </em><em>default=nn.Identity</em><em>(</em><em>)</em>) – Activation function for embeddings.</p></li>
<li><p><strong>embedding_type</strong> (<em>str</em><em>, </em><em>default=&quot;linear&quot;</em>) – Type of embedding to use (‘linear’, etc.).</p></li>
<li><p><strong>embedding_bias</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use bias in the embedding layers.</p></li>
<li><p><strong>layer_norm_after_embedding</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to apply layer normalization after embedding.</p></li>
<li><p><strong>head_layer_sizes</strong> (<em>list</em><em>, </em><em>default=</em><em>(</em><em>)</em>) – Sizes of the layers in the model’s head.</p></li>
<li><p><strong>head_dropout</strong> (<em>float</em><em>, </em><em>default=0.5</em>) – Dropout rate for the head layers.</p></li>
<li><p><strong>head_skip_layers</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to skip layers in the head.</p></li>
<li><p><strong>head_activation</strong> (<em>callable</em><em>, </em><em>default=nn.SELU</em><em>(</em><em>)</em>) – Activation function for the head layers.</p></li>
<li><p><strong>head_use_batch_norm</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use batch normalization in the head layers.</p></li>
<li><p><strong>pooling_method</strong> (<em>str</em><em>, </em><em>default=&quot;avg&quot;</em>) – Pooling method to be used (‘cls’, ‘avg’, etc.).</p></li>
<li><p><strong>cat_encoding</strong> (<em>str</em><em>, </em><em>default=&quot;int&quot;</em>) – Encoding method for categorical features (‘int’, ‘one-hot’, etc.).</p></li>
<li><p><strong>n_bins</strong> (<em>int</em><em>, </em><em>default=50</em>) – The number of bins to use for numerical feature binning. This parameter is relevant
only if <code class="docutils literal notranslate"><span class="pre">numerical_preprocessing</span></code> is set to ‘binning’, ‘ple’ or ‘one-hot’.</p></li>
<li><p><strong>numerical_preprocessing</strong> (<em>str</em><em>, </em><em>default=&quot;ple&quot;</em>) – The preprocessing strategy for numerical features. Valid options are
‘ple’, ‘binning’, ‘one-hot’, ‘standardization’, ‘min-max’, ‘quantile’, ‘polynomial’,
‘splines’, ‘box-cox’, ‘yeo-johnson’ and None</p></li>
<li><p><strong>categorical_preprocessing</strong> (<em>str</em><em>, </em><em>default=&quot;int&quot;</em>) – The preprocessing strategy for categorical features. Valid options are
‘int’, ‘one-hot’, None</p></li>
<li><p><strong>use_decision_tree_bins</strong> (<em>bool</em><em>, </em><em>default=False</em>) – If True, uses decision tree regression/classification to determine
optimal bin edges for numerical feature binning. This parameter is
relevant only if <code class="docutils literal notranslate"><span class="pre">numerical_preprocessing</span></code> is set to ‘binning’ or ‘one-hot’.</p></li>
<li><p><strong>binning_strategy</strong> (<em>str</em><em>, </em><em>default=&quot;uniform&quot;</em>) – Defines the strategy for binning numerical features. Options include ‘uniform’,
‘quantile’, or other sklearn-compatible strategies.</p></li>
<li><p><strong>task</strong> (<em>str</em><em>, </em><em>default=&quot;regression&quot;</em>) – Indicates the type of machine learning task (‘regression’ or ‘classification’). This can
influence certain preprocessing behaviors, especially when using decision tree-based binning.</p></li>
<li><p><strong>cat_cutoff</strong> (<em>float</em><em> or </em><em>int</em><em>, </em><em>default=0.03</em>) – Indicates the cutoff after which integer values are treated as categorical.
If float, it’s treated as a percentage. If int, it’s the maximum number of
unique values for a column to be considered categorical.</p></li>
<li><p><strong>treat_all_integers_as_numerical</strong> (<em>bool</em><em>, </em><em>default=False</em>) – If True, all integer columns will be treated as numerical, regardless
of their unique value count or proportion.</p></li>
<li><p><strong>degree</strong> (<em>int</em><em>, </em><em>default=3</em>) – The degree of the polynomial features to be used in preprocessing.</p></li>
<li><p><strong>knots</strong> (<em>int</em><em>, </em><em>default=12</em>) – The number of knots to be used in spline transformations.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mambular.models</span> <span class="kn">import</span> <span class="n">TabTransformerLSS</span>
<span class="go">    &gt;&gt;&gt; model = TabTransformerLSS()</span>
<span class="go">    &gt;&gt;&gt; model.fit(X_train, y_train, family=&#39;normal&#39;)</span>
<span class="go">    &gt;&gt;&gt; preds = model.predict(X_test)</span>
<span class="go">    &gt;&gt;&gt; model.evaluate(X_test, y_test)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.TabTransformerLSS.build_model">
<span class="sig-name descname"><span class="pre">build_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">101</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_patience</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_decay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataloader_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.TabTransformerLSS.build_model" title="Permalink to this definition">#</a></dt>
<dd><p>Builds the model using the provided training data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The training input samples.</p></li>
<li><p><strong>y</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em>) – The target values (real numbers).</p></li>
<li><p><strong>val_size</strong> (<em>float</em><em>, </em><em>default=0.2</em>) – The proportion of the dataset to include in the validation split if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is None. Ignored if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>X_val</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em><em>, </em><em>optional</em>) – The validation input samples. If provided, <code class="docutils literal notranslate"><span class="pre">X</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> are not split and this data is used for validation.</p></li>
<li><p><strong>y_val</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em><em>, </em><em>optional</em>) – The validation target values. Required if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>random_state</strong> (<em>int</em><em>, </em><em>default=101</em>) – Controls the shuffling applied to the data before applying the split.</p></li>
<li><p><strong>batch_size</strong> (<em>int</em><em>, </em><em>default=64</em>) – Number of samples per gradient update.</p></li>
<li><p><strong>shuffle</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to shuffle the training data before each epoch.</p></li>
<li><p><strong>lr</strong> (<em>float</em><em>, </em><em>default=1e-3</em>) – Learning rate for the optimizer.</p></li>
<li><p><strong>lr_patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement on the validation loss to wait before reducing the learning rate.</p></li>
<li><p><strong>factor</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Factor by which the learning rate will be reduced.</p></li>
<li><p><strong>weight_decay</strong> (<em>float</em><em>, </em><em>default=0.025</em>) – Weight decay (L2 penalty) coefficient.</p></li>
<li><p><strong>dataloader_kwargs</strong> (<em>dict</em><em>, </em><em>default={}</em>) – The kwargs for the pytorch dataloader class.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – The built distributional regressor.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.TabTransformerLSS.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distribution_family</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.TabTransformerLSS.evaluate" title="Permalink to this definition">#</a></dt>
<dd><p>Evaluate the model on the given data using specified metrics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array-like</em><em> or </em><em>pd.DataFrame</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The input samples to predict.</p></li>
<li><p><strong>y_true</strong> (<em>array-like</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>)</em>) – The true class labels against which to evaluate the predictions.</p></li>
<li><p><strong>metrics</strong> (<em>dict</em>) – A dictionary where keys are metric names and values are tuples containing the metric function
and a boolean indicating whether the metric requires probability scores (True) or class labels (False).</p></li>
<li><p><strong>distribution_family</strong> (<em>str</em><em>, </em><em>optional</em>) – Specifies the distribution family the model is predicting for. If None, it will attempt to infer based
on the model’s settings.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>scores</strong> – A dictionary with metric names as keys and their corresponding scores as values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This method uses either the <code class="docutils literal notranslate"><span class="pre">predict</span></code> or <code class="docutils literal notranslate"><span class="pre">predict_proba</span></code> method depending on the metric requirements.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.TabTransformerLSS.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">family</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">101</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patience</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">15</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">monitor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'val_loss'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'min'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_patience</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_decay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checkpoint_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'model_checkpoints'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distributional_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataloader_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rebuild</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">trainer_kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.TabTransformerLSS.fit" title="Permalink to this definition">#</a></dt>
<dd><p>Trains the regression model using the provided training data. Optionally, a separate validation set can be used.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The training input samples.</p></li>
<li><p><strong>y</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em>) – The target values (real numbers).</p></li>
<li><p><strong>family</strong> (<em>str</em>) – The name of the distribution family to use for the loss function. Examples include ‘normal’ for regression tasks.</p></li>
<li><p><strong>val_size</strong> (<em>float</em><em>, </em><em>default=0.2</em>) – The proportion of the dataset to include in the validation split if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is None. Ignored if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>X_val</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em><em>, </em><em>optional</em>) – The validation input samples. If provided, <code class="docutils literal notranslate"><span class="pre">X</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> are not split and this data is used for validation.</p></li>
<li><p><strong>y_val</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em><em>, </em><em>optional</em>) – The validation target values. Required if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>max_epochs</strong> (<em>int</em><em>, </em><em>default=100</em>) – Maximum number of epochs for training.</p></li>
<li><p><strong>random_state</strong> (<em>int</em><em>, </em><em>default=101</em>) – Controls the shuffling applied to the data before applying the split.</p></li>
<li><p><strong>batch_size</strong> (<em>int</em><em>, </em><em>default=64</em>) – Number of samples per gradient update.</p></li>
<li><p><strong>shuffle</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to shuffle the training data before each epoch.</p></li>
<li><p><strong>patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement on the validation loss to wait before early stopping.</p></li>
<li><p><strong>monitor</strong> (<em>str</em><em>, </em><em>default=&quot;val_loss&quot;</em>) – The metric to monitor for early stopping.</p></li>
<li><p><strong>mode</strong> (<em>str</em><em>, </em><em>default=&quot;min&quot;</em>) – Whether the monitored metric should be minimized (<code class="docutils literal notranslate"><span class="pre">min</span></code>) or maximized (<code class="docutils literal notranslate"><span class="pre">max</span></code>).</p></li>
<li><p><strong>lr</strong> (<em>float</em><em>, </em><em>default=1e-3</em>) – Learning rate for the optimizer.</p></li>
<li><p><strong>lr_patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement on the validation loss to wait before reducing the learning rate.</p></li>
<li><p><strong>factor</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Factor by which the learning rate will be reduced.</p></li>
<li><p><strong>weight_decay</strong> (<em>float</em><em>, </em><em>default=0.025</em>) – Weight decay (L2 penalty) coefficient.</p></li>
<li><p><strong>distributional_kwargs</strong> (<em>dict</em><em>, </em><em>default=None</em>) – any arguments taht are specific for a certain distribution.</p></li>
<li><p><strong>checkpoint_path</strong> (<em>str</em><em>, </em><em>default=&quot;model_checkpoints&quot;</em>) – Path where the checkpoints are being saved.</p></li>
<li><p><strong>dataloader_kwargs</strong> (<em>dict</em><em>, </em><em>default={}</em>) – The kwargs for the pytorch dataloader class.</p></li>
<li><p><strong>**trainer_kwargs</strong> (<em>Additional keyword arguments for PyTorch Lightning's Trainer class.</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – The fitted regressor.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.TabTransformerLSS.get_default_metrics">
<span class="sig-name descname"><span class="pre">get_default_metrics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">distribution_family</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.TabTransformerLSS.get_default_metrics" title="Permalink to this definition">#</a></dt>
<dd><p>Provides default metrics based on the distribution family.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>distribution_family</strong> (<em>str</em>) – The distribution family for which to provide default metrics.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>metrics</strong> – A dictionary of default metric functions.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.TabTransformerLSS.get_number_of_params">
<span class="sig-name descname"><span class="pre">get_number_of_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">requires_grad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.TabTransformerLSS.get_number_of_params" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate the number of parameters in the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>requires_grad</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, only count the parameters that require gradients (trainable parameters).
If False, count all parameters. Default is True.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The total number of parameters in the model.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the model has not been built prior to calling this method.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.TabTransformerLSS.get_params">
<span class="sig-name descname"><span class="pre">get_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">deep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.TabTransformerLSS.get_params" title="Permalink to this definition">#</a></dt>
<dd><p>Get parameters for this estimator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>deep</strong> (<em>bool</em><em>, </em><em>default=True</em>) – If True, will return the parameters for this estimator and contained subobjects that are estimators.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>params</strong> – Parameter names mapped to their values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.TabTransformerLSS.optimize_hparams">
<span class="sig-name descname"><span class="pre">optimize_hparams</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prune_by_epoch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prune_epoch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fixed_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'cat_encoding':</span> <span class="pre">'int',</span> <span class="pre">'head_layer_size_length':</span> <span class="pre">0,</span> <span class="pre">'head_skip_layer':</span> <span class="pre">False,</span> <span class="pre">'head_skip_layers':</span> <span class="pre">False,</span> <span class="pre">'pooling_method':</span> <span class="pre">'avg',</span> <span class="pre">'use_cls':</span> <span class="pre">False}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">custom_search_space</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">optimize_kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.TabTransformerLSS.optimize_hparams" title="Permalink to this definition">#</a></dt>
<dd><p>Optimizes hyperparameters using Bayesian optimization with optional pruning.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array-like</em>) – Training data.</p></li>
<li><p><strong>y</strong> (<em>array-like</em>) – Training labels.</p></li>
<li><p><strong>X_val</strong> (<em>array-like</em><em>, </em><em>optional</em>) – Validation data and labels.</p></li>
<li><p><strong>y_val</strong> (<em>array-like</em><em>, </em><em>optional</em>) – Validation data and labels.</p></li>
<li><p><strong>time</strong> (<em>int</em>) – The number of optimization trials to run.</p></li>
<li><p><strong>max_epochs</strong> (<em>int</em>) – Maximum number of epochs for training.</p></li>
<li><p><strong>prune_by_epoch</strong> (<em>bool</em>) – Whether to prune based on a specific epoch (True) or the best validation loss (False).</p></li>
<li><p><strong>prune_epoch</strong> (<em>int</em>) – The specific epoch to prune by when prune_by_epoch is True.</p></li>
<li><p><strong>**optimize_kwargs</strong> (<em>dict</em>) – Additional keyword arguments passed to the fit method.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>best_hparams</strong> – Best hyperparameters found during optimization.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.TabTransformerLSS.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">raw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.TabTransformerLSS.predict" title="Permalink to this definition">#</a></dt>
<dd><p>Predicts target values for the given input samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>X</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The input samples for which to predict target values.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>predictions</strong> – The predicted target values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray, shape (n_samples,) or (n_samples, n_outputs)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.TabTransformerLSS.score">
<span class="sig-name descname"><span class="pre">score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'NLL'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.TabTransformerLSS.score" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate the score of the model using the specified metric.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array-like</em><em> or </em><em>pd.DataFrame</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The input samples to predict.</p></li>
<li><p><strong>y</strong> (<em>array-like</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_outputs</em><em>)</em>) – The true target values against which to evaluate the predictions.</p></li>
<li><p><strong>metric</strong> (<em>str</em><em>, </em><em>default=&quot;NLL&quot;</em>) – So far, only negative log-likelihood is supported</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>score</strong> – The score calculated using the specified metric.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.TabTransformerLSS.set_params">
<span class="sig-name descname"><span class="pre">set_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">parameters</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.TabTransformerLSS.set_params" title="Permalink to this definition">#</a></dt>
<dd><p>Set the parameters of this estimator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>**parameters</strong> (<em>dict</em>) – Estimator parameters.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – Estimator instance.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mambular.models.ResNetClassifier">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mambular.models.</span></span><span class="sig-name descname"><span class="pre">ResNetClassifier</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/mambular/models/resnet.html#ResNetClassifier"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mambular.models.ResNetClassifier" title="Permalink to this definition">#</a></dt>
<dd><dl class="simple">
<dt>ResNet classifier This class extends the SklearnBaseClassifier class and uses the ResNet model</dt><dd><p>with the default ResNet configuration.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The parameters for this class include the attributes from the config
dataclass as well as preprocessing arguments handled by the base class.</p>
<p>Configuration class for the default ResNet model with predefined hyperparameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lr</strong> (<em>float</em><em>, </em><em>default=1e-04</em>) – Learning rate for the optimizer.</p></li>
<li><p><strong>lr_patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement after which the learning rate will be reduced.</p></li>
<li><p><strong>weight_decay</strong> (<em>float</em><em>, </em><em>default=1e-06</em>) – Weight decay (L2 regularization penalty) applied by the optimizer.</p></li>
<li><p><strong>lr_factor</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Factor by which the learning rate is reduced when there is no improvement.</p></li>
<li><p><strong>layer_sizes</strong> (<em>list</em><em>, </em><em>default=</em><em>(</em><em>256</em><em>, </em><em>128</em><em>, </em><em>32</em><em>)</em>) – Sizes of the layers in the ResNet.</p></li>
<li><p><strong>activation</strong> (<em>callable</em><em>, </em><em>default=nn.SELU</em><em>(</em><em>)</em>) – Activation function for the ResNet layers.</p></li>
<li><p><strong>skip_layers</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to skip layers in the ResNet.</p></li>
<li><p><strong>dropout</strong> (<em>float</em><em>, </em><em>default=0.5</em>) – Dropout rate for regularization.</p></li>
<li><p><strong>norm</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use normalization in the ResNet.</p></li>
<li><p><strong>use_glu</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use Gated Linear Units (GLU) in the ResNet.</p></li>
<li><p><strong>skip_connections</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to use skip connections in the ResNet.</p></li>
<li><p><strong>batch_norm</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to use batch normalization in the ResNet layers.</p></li>
<li><p><strong>layer_norm</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use layer normalization in the ResNet layers.</p></li>
<li><p><strong>layer_norm_eps</strong> (<em>float</em><em>, </em><em>default=1e-05</em>) – Epsilon value for layer normalization.</p></li>
<li><p><strong>num_blocks</strong> (<em>int</em><em>, </em><em>default=3</em>) – Number of residual blocks in the ResNet.</p></li>
<li><p><strong>use_embeddings</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to use embedding layers for all features.</p></li>
<li><p><strong>embedding_type</strong> (<em>str</em><em>, </em><em>default=&quot;linear&quot;</em>) – Type of embedding to use (‘linear’, etc.).</p></li>
<li><p><strong>embedding_bias</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use bias in the embedding layers.</p></li>
<li><p><strong>plr_lite</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use a lightweight version of Piecewise Linear Regression (PLR).</p></li>
<li><p><strong>average_embeddings</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to average embeddings during the forward pass.</p></li>
<li><p><strong>embedding_activation</strong> (<em>callable</em><em>, </em><em>default=nn.Identity</em><em>(</em><em>)</em>) – Activation function for embeddings.</p></li>
<li><p><strong>layer_norm_after_embedding</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to apply layer normalization after embedding layers.</p></li>
<li><p><strong>d_model</strong> (<em>int</em><em>, </em><em>default=64</em>) – Dimensionality of the embeddings.</p></li>
<li><p><strong>n_bins</strong> (<em>int</em><em>, </em><em>default=50</em>) – The number of bins to use for numerical feature binning. This parameter is relevant
only if <code class="docutils literal notranslate"><span class="pre">numerical_preprocessing</span></code> is set to ‘binning’, ‘ple’ or ‘one-hot’.</p></li>
<li><p><strong>numerical_preprocessing</strong> (<em>str</em><em>, </em><em>default=&quot;ple&quot;</em>) – The preprocessing strategy for numerical features. Valid options are
‘ple’, ‘binning’, ‘one-hot’, ‘standardization’, ‘min-max’, ‘quantile’, ‘polynomial’,
‘splines’, ‘box-cox’, ‘yeo-johnson’ and None</p></li>
<li><p><strong>categorical_preprocessing</strong> (<em>str</em><em>, </em><em>default=&quot;int&quot;</em>) – The preprocessing strategy for categorical features. Valid options are
‘int’, ‘one-hot’, None</p></li>
<li><p><strong>use_decision_tree_bins</strong> (<em>bool</em><em>, </em><em>default=False</em>) – If True, uses decision tree regression/classification to determine
optimal bin edges for numerical feature binning. This parameter is
relevant only if <code class="docutils literal notranslate"><span class="pre">numerical_preprocessing</span></code> is set to ‘binning’ or ‘one-hot’.</p></li>
<li><p><strong>binning_strategy</strong> (<em>str</em><em>, </em><em>default=&quot;uniform&quot;</em>) – Defines the strategy for binning numerical features. Options include ‘uniform’,
‘quantile’, or other sklearn-compatible strategies.</p></li>
<li><p><strong>task</strong> (<em>str</em><em>, </em><em>default=&quot;regression&quot;</em>) – Indicates the type of machine learning task (‘regression’ or ‘classification’). This can
influence certain preprocessing behaviors, especially when using decision tree-based binning.</p></li>
<li><p><strong>cat_cutoff</strong> (<em>float</em><em> or </em><em>int</em><em>, </em><em>default=0.03</em>) – Indicates the cutoff after which integer values are treated as categorical.
If float, it’s treated as a percentage. If int, it’s the maximum number of
unique values for a column to be considered categorical.</p></li>
<li><p><strong>treat_all_integers_as_numerical</strong> (<em>bool</em><em>, </em><em>default=False</em>) – If True, all integer columns will be treated as numerical, regardless
of their unique value count or proportion.</p></li>
<li><p><strong>degree</strong> (<em>int</em><em>, </em><em>default=3</em>) – The degree of the polynomial features to be used in preprocessing.</p></li>
<li><p><strong>knots</strong> (<em>int</em><em>, </em><em>default=12</em>) – The number of knots to be used in spline transformations.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mambular.models</span> <span class="kn">import</span> <span class="n">ResNetClassifier</span>
<span class="go">    &gt;&gt;&gt; model = ResNetClassifier()</span>
<span class="go">    &gt;&gt;&gt; model.fit(X_train, y_train)</span>
<span class="go">    &gt;&gt;&gt; preds = model.predict(X_test)</span>
<span class="go">    &gt;&gt;&gt; model.evaluate(X_test, y_test)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.ResNetClassifier.build_model">
<span class="sig-name descname"><span class="pre">build_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">101</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_patience</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_decay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataloader_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.ResNetClassifier.build_model" title="Permalink to this definition">#</a></dt>
<dd><p>Builds the model using the provided training data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The training input samples.</p></li>
<li><p><strong>y</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em>) – The target values (real numbers).</p></li>
<li><p><strong>val_size</strong> (<em>float</em><em>, </em><em>default=0.2</em>) – The proportion of the dataset to include in the validation split if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is None. Ignored if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>X_val</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em><em>, </em><em>optional</em>) – The validation input samples. If provided, <code class="docutils literal notranslate"><span class="pre">X</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> are not split and this data is used for validation.</p></li>
<li><p><strong>y_val</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em><em>, </em><em>optional</em>) – The validation target values. Required if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>random_state</strong> (<em>int</em><em>, </em><em>default=101</em>) – Controls the shuffling applied to the data before applying the split.</p></li>
<li><p><strong>batch_size</strong> (<em>int</em><em>, </em><em>default=64</em>) – Number of samples per gradient update.</p></li>
<li><p><strong>shuffle</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to shuffle the training data before each epoch.</p></li>
<li><p><strong>lr</strong> (<em>float</em><em>, </em><em>default=1e-3</em>) – Learning rate for the optimizer.</p></li>
<li><p><strong>lr_patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement on the validation loss to wait before reducing the learning rate.</p></li>
<li><p><strong>factor</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Factor by which the learning rate will be reduced.</p></li>
<li><p><strong>weight_decay</strong> (<em>float</em><em>, </em><em>default=0.025</em>) – Weight decay (L2 penalty) coefficient.</p></li>
<li><p><strong>dataloader_kwargs</strong> (<em>dict</em><em>, </em><em>default={}</em>) – The kwargs for the pytorch dataloader class.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – The built classifier.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.ResNetClassifier.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.ResNetClassifier.evaluate" title="Permalink to this definition">#</a></dt>
<dd><p>Evaluate the model on the given data using specified metrics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array-like</em><em> or </em><em>pd.DataFrame</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The input samples to predict.</p></li>
<li><p><strong>y_true</strong> (<em>array-like</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>)</em>) – The true class labels against which to evaluate the predictions.</p></li>
<li><p><strong>metrics</strong> (<em>dict</em>) – A dictionary where keys are metric names and values are tuples containing the metric function
and a boolean indicating whether the metric requires probability scores (True) or class labels (False).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>scores</strong> – A dictionary with metric names as keys and their corresponding scores as values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This method uses either the <code class="docutils literal notranslate"><span class="pre">predict</span></code> or <code class="docutils literal notranslate"><span class="pre">predict_proba</span></code> method depending on the metric requirements.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.ResNetClassifier.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">101</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patience</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">15</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">monitor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'val_loss'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'min'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_patience</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_decay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checkpoint_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'model_checkpoints'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataloader_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rebuild</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">trainer_kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.ResNetClassifier.fit" title="Permalink to this definition">#</a></dt>
<dd><p>Trains the classification model using the provided training data. Optionally, a separate validation set can be used.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The training input samples.</p></li>
<li><p><strong>y</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em>) – The target values (real numbers).</p></li>
<li><p><strong>val_size</strong> (<em>float</em><em>, </em><em>default=0.2</em>) – The proportion of the dataset to include in the validation split if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is None. Ignored if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>X_val</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em><em>, </em><em>optional</em>) – The validation input samples. If provided, <code class="docutils literal notranslate"><span class="pre">X</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> are not split and this data is used for validation.</p></li>
<li><p><strong>y_val</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em><em>, </em><em>optional</em>) – The validation target values. Required if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>max_epochs</strong> (<em>int</em><em>, </em><em>default=100</em>) – Maximum number of epochs for training.</p></li>
<li><p><strong>random_state</strong> (<em>int</em><em>, </em><em>default=101</em>) – Controls the shuffling applied to the data before applying the split.</p></li>
<li><p><strong>batch_size</strong> (<em>int</em><em>, </em><em>default=64</em>) – Number of samples per gradient update.</p></li>
<li><p><strong>shuffle</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to shuffle the training data before each epoch.</p></li>
<li><p><strong>patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement on the validation loss to wait before early stopping.</p></li>
<li><p><strong>monitor</strong> (<em>str</em><em>, </em><em>default=&quot;val_loss&quot;</em>) – The metric to monitor for early stopping.</p></li>
<li><p><strong>mode</strong> (<em>str</em><em>, </em><em>default=&quot;min&quot;</em>) – Whether the monitored metric should be minimized (<code class="docutils literal notranslate"><span class="pre">min</span></code>) or maximized (<code class="docutils literal notranslate"><span class="pre">max</span></code>).</p></li>
<li><p><strong>lr</strong> (<em>float</em><em>, </em><em>default=1e-3</em>) – Learning rate for the optimizer.</p></li>
<li><p><strong>lr_patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement on the validation loss to wait before reducing the learning rate.</p></li>
<li><p><strong>factor</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Factor by which the learning rate will be reduced.</p></li>
<li><p><strong>weight_decay</strong> (<em>float</em><em>, </em><em>default=0.025</em>) – Weight decay (L2 penalty) coefficient.</p></li>
<li><p><strong>checkpoint_path</strong> (<em>str</em><em>, </em><em>default=&quot;model_checkpoints&quot;</em>) – Path where the checkpoints are being saved.</p></li>
<li><p><strong>dataloader_kwargs</strong> (<em>dict</em><em>, </em><em>default={}</em>) – The kwargs for the pytorch dataloader class.</p></li>
<li><p><strong>rebuild</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to rebuild the model when it already was built.</p></li>
<li><p><strong>**trainer_kwargs</strong> (<em>Additional keyword arguments for PyTorch Lightning's Trainer class.</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – The fitted classifier.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.ResNetClassifier.get_number_of_params">
<span class="sig-name descname"><span class="pre">get_number_of_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">requires_grad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.ResNetClassifier.get_number_of_params" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate the number of parameters in the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>requires_grad</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, only count the parameters that require gradients (trainable parameters).
If False, count all parameters. Default is True.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The total number of parameters in the model.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the model has not been built prior to calling this method.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.ResNetClassifier.get_params">
<span class="sig-name descname"><span class="pre">get_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">deep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.ResNetClassifier.get_params" title="Permalink to this definition">#</a></dt>
<dd><p>Get parameters for this estimator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>deep</strong> (<em>bool</em><em>, </em><em>default=True</em>) – If True, will return the parameters for this estimator and contained subobjects that are estimators.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>params</strong> – Parameter names mapped to their values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.ResNetClassifier.optimize_hparams">
<span class="sig-name descname"><span class="pre">optimize_hparams</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prune_by_epoch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prune_epoch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fixed_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'cat_encoding':</span> <span class="pre">'int',</span> <span class="pre">'head_layer_size_length':</span> <span class="pre">0,</span> <span class="pre">'head_skip_layer':</span> <span class="pre">False,</span> <span class="pre">'head_skip_layers':</span> <span class="pre">False,</span> <span class="pre">'pooling_method':</span> <span class="pre">'avg',</span> <span class="pre">'use_cls':</span> <span class="pre">False}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">custom_search_space</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">optimize_kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.ResNetClassifier.optimize_hparams" title="Permalink to this definition">#</a></dt>
<dd><p>Optimizes hyperparameters using Bayesian optimization with optional pruning.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array-like</em>) – Training data.</p></li>
<li><p><strong>y</strong> (<em>array-like</em>) – Training labels.</p></li>
<li><p><strong>X_val</strong> (<em>array-like</em><em>, </em><em>optional</em>) – Validation data and labels.</p></li>
<li><p><strong>y_val</strong> (<em>array-like</em><em>, </em><em>optional</em>) – Validation data and labels.</p></li>
<li><p><strong>time</strong> (<em>int</em>) – The number of optimization trials to run.</p></li>
<li><p><strong>max_epochs</strong> (<em>int</em>) – Maximum number of epochs for training.</p></li>
<li><p><strong>prune_by_epoch</strong> (<em>bool</em>) – Whether to prune based on a specific epoch (True) or the best validation loss (False).</p></li>
<li><p><strong>prune_epoch</strong> (<em>int</em>) – The specific epoch to prune by when prune_by_epoch is True.</p></li>
<li><p><strong>**optimize_kwargs</strong> (<em>dict</em>) – Additional keyword arguments passed to the fit method.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>best_hparams</strong> – Best hyperparameters found during optimization.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.ResNetClassifier.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.ResNetClassifier.predict" title="Permalink to this definition">#</a></dt>
<dd><p>Predicts target values for the given input samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>X</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The input samples for which to predict target values.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>predictions</strong> – The predicted target values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray, shape (n_samples,) or (n_samples, n_outputs)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.ResNetClassifier.predict_proba">
<span class="sig-name descname"><span class="pre">predict_proba</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.ResNetClassifier.predict_proba" title="Permalink to this definition">#</a></dt>
<dd><p>Predict class probabilities for the given input samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>X</strong> (<em>array-like</em><em> or </em><em>pd.DataFrame</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The input samples for which to predict class probabilities.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The method preprocesses the input data using the same preprocessor used during training,
sets the model to evaluation mode, and then performs inference to predict the class probabilities.
Softmax is applied to the logits to obtain probabilities, which are then converted from a PyTorch tensor
to a NumPy array before being returned.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">accuracy_score</span><span class="p">,</span> <span class="n">precision_score</span><span class="p">,</span> <span class="n">f1_score</span><span class="p">,</span> <span class="n">roc_auc_score</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Define the metrics you want to evaluate</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">metrics</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">... </span>    <span class="s1">&#39;Accuracy&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">accuracy_score</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
<span class="gp">... </span>    <span class="s1">&#39;Precision&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">precision_score</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
<span class="gp">... </span>    <span class="s1">&#39;F1 Score&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">f1_score</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
<span class="gp">... </span>    <span class="s1">&#39;AUC Score&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">roc_auc_score</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
<span class="gp">... </span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Assuming &#39;X_test&#39; and &#39;y_test&#39; are your test dataset and labels</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Evaluate using the specified metrics</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results</span> <span class="o">=</span> <span class="n">classifier</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="n">metrics</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>probabilities</strong> – Predicted class probabilities for each input sample.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>ndarray of shape (n_samples, n_classes)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.ResNetClassifier.score">
<span class="sig-name descname"><span class="pre">score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(sklearn.metrics.log_loss,</span> <span class="pre">True)</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.ResNetClassifier.score" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate the score of the model using the specified metric.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array-like</em><em> or </em><em>pd.DataFrame</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The input samples to predict.</p></li>
<li><p><strong>y</strong> (<em>array-like</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>)</em>) – The true class labels against which to evaluate the predictions.</p></li>
<li><p><strong>metric</strong> (<em>tuple</em><em>, </em><em>default=</em><em>(</em><em>log_loss</em><em>, </em><em>True</em><em>)</em>) – A tuple containing the metric function and a boolean indicating whether the metric requires probability scores (True) or class labels (False).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>score</strong> – The score calculated using the specified metric.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.ResNetClassifier.set_params">
<span class="sig-name descname"><span class="pre">set_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">parameters</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.ResNetClassifier.set_params" title="Permalink to this definition">#</a></dt>
<dd><p>Set the parameters of this estimator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>**parameters</strong> (<em>dict</em>) – Estimator parameters.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – Estimator instance.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mambular.models.ResNetRegressor">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mambular.models.</span></span><span class="sig-name descname"><span class="pre">ResNetRegressor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/mambular/models/resnet.html#ResNetRegressor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mambular.models.ResNetRegressor" title="Permalink to this definition">#</a></dt>
<dd><dl class="simple">
<dt>ResNet regressor. This class extends the SklearnBaseRegressor class and uses the ResNet model</dt><dd><p>with the default ResNet configuration.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The parameters for this class include the attributes from the config
dataclass as well as preprocessing arguments handled by the base class.</p>
<p>Configuration class for the default ResNet model with predefined hyperparameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lr</strong> (<em>float</em><em>, </em><em>default=1e-04</em>) – Learning rate for the optimizer.</p></li>
<li><p><strong>lr_patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement after which the learning rate will be reduced.</p></li>
<li><p><strong>weight_decay</strong> (<em>float</em><em>, </em><em>default=1e-06</em>) – Weight decay (L2 regularization penalty) applied by the optimizer.</p></li>
<li><p><strong>lr_factor</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Factor by which the learning rate is reduced when there is no improvement.</p></li>
<li><p><strong>layer_sizes</strong> (<em>list</em><em>, </em><em>default=</em><em>(</em><em>256</em><em>, </em><em>128</em><em>, </em><em>32</em><em>)</em>) – Sizes of the layers in the ResNet.</p></li>
<li><p><strong>activation</strong> (<em>callable</em><em>, </em><em>default=nn.SELU</em><em>(</em><em>)</em>) – Activation function for the ResNet layers.</p></li>
<li><p><strong>skip_layers</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to skip layers in the ResNet.</p></li>
<li><p><strong>dropout</strong> (<em>float</em><em>, </em><em>default=0.5</em>) – Dropout rate for regularization.</p></li>
<li><p><strong>norm</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use normalization in the ResNet.</p></li>
<li><p><strong>use_glu</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use Gated Linear Units (GLU) in the ResNet.</p></li>
<li><p><strong>skip_connections</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to use skip connections in the ResNet.</p></li>
<li><p><strong>batch_norm</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to use batch normalization in the ResNet layers.</p></li>
<li><p><strong>layer_norm</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use layer normalization in the ResNet layers.</p></li>
<li><p><strong>layer_norm_eps</strong> (<em>float</em><em>, </em><em>default=1e-05</em>) – Epsilon value for layer normalization.</p></li>
<li><p><strong>num_blocks</strong> (<em>int</em><em>, </em><em>default=3</em>) – Number of residual blocks in the ResNet.</p></li>
<li><p><strong>use_embeddings</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to use embedding layers for all features.</p></li>
<li><p><strong>embedding_type</strong> (<em>str</em><em>, </em><em>default=&quot;linear&quot;</em>) – Type of embedding to use (‘linear’, etc.).</p></li>
<li><p><strong>embedding_bias</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use bias in the embedding layers.</p></li>
<li><p><strong>plr_lite</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use a lightweight version of Piecewise Linear Regression (PLR).</p></li>
<li><p><strong>average_embeddings</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to average embeddings during the forward pass.</p></li>
<li><p><strong>embedding_activation</strong> (<em>callable</em><em>, </em><em>default=nn.Identity</em><em>(</em><em>)</em>) – Activation function for embeddings.</p></li>
<li><p><strong>layer_norm_after_embedding</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to apply layer normalization after embedding layers.</p></li>
<li><p><strong>d_model</strong> (<em>int</em><em>, </em><em>default=64</em>) – Dimensionality of the embeddings.</p></li>
<li><p><strong>n_bins</strong> (<em>int</em><em>, </em><em>default=50</em>) – The number of bins to use for numerical feature binning. This parameter is relevant
only if <code class="docutils literal notranslate"><span class="pre">numerical_preprocessing</span></code> is set to ‘binning’, ‘ple’ or ‘one-hot’.</p></li>
<li><p><strong>numerical_preprocessing</strong> (<em>str</em><em>, </em><em>default=&quot;ple&quot;</em>) – The preprocessing strategy for numerical features. Valid options are
‘ple’, ‘binning’, ‘one-hot’, ‘standardization’, ‘min-max’, ‘quantile’, ‘polynomial’,
‘splines’, ‘box-cox’, ‘yeo-johnson’ and None</p></li>
<li><p><strong>categorical_preprocessing</strong> (<em>str</em><em>, </em><em>default=&quot;int&quot;</em>) – The preprocessing strategy for categorical features. Valid options are
‘int’, ‘one-hot’, None</p></li>
<li><p><strong>use_decision_tree_bins</strong> (<em>bool</em><em>, </em><em>default=False</em>) – If True, uses decision tree regression/classification to determine
optimal bin edges for numerical feature binning. This parameter is
relevant only if <code class="docutils literal notranslate"><span class="pre">numerical_preprocessing</span></code> is set to ‘binning’ or ‘one-hot’.</p></li>
<li><p><strong>binning_strategy</strong> (<em>str</em><em>, </em><em>default=&quot;uniform&quot;</em>) – Defines the strategy for binning numerical features. Options include ‘uniform’,
‘quantile’, or other sklearn-compatible strategies.</p></li>
<li><p><strong>task</strong> (<em>str</em><em>, </em><em>default=&quot;regression&quot;</em>) – Indicates the type of machine learning task (‘regression’ or ‘classification’). This can
influence certain preprocessing behaviors, especially when using decision tree-based binning.</p></li>
<li><p><strong>cat_cutoff</strong> (<em>float</em><em> or </em><em>int</em><em>, </em><em>default=0.03</em>) – Indicates the cutoff after which integer values are treated as categorical.
If float, it’s treated as a percentage. If int, it’s the maximum number of
unique values for a column to be considered categorical.</p></li>
<li><p><strong>treat_all_integers_as_numerical</strong> (<em>bool</em><em>, </em><em>default=False</em>) – If True, all integer columns will be treated as numerical, regardless
of their unique value count or proportion.</p></li>
<li><p><strong>degree</strong> (<em>int</em><em>, </em><em>default=3</em>) – The degree of the polynomial features to be used in preprocessing.</p></li>
<li><p><strong>knots</strong> (<em>int</em><em>, </em><em>default=12</em>) – The number of knots to be used in spline transformations.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mambular.models</span> <span class="kn">import</span> <span class="n">ResNetRegressor</span>
<span class="go">    &gt;&gt;&gt; model = ResNetRegressor()</span>
<span class="go">    &gt;&gt;&gt; model.fit(X_train, y_train)</span>
<span class="go">    &gt;&gt;&gt; preds = model.predict(X_test)</span>
<span class="go">    &gt;&gt;&gt; model.evaluate(X_test, y_test)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.ResNetRegressor.build_model">
<span class="sig-name descname"><span class="pre">build_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">101</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_patience</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_decay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataloader_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.ResNetRegressor.build_model" title="Permalink to this definition">#</a></dt>
<dd><p>Builds the model using the provided training data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The training input samples.</p></li>
<li><p><strong>y</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em>) – The target values (real numbers).</p></li>
<li><p><strong>val_size</strong> (<em>float</em><em>, </em><em>default=0.2</em>) – The proportion of the dataset to include in the validation split if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is None. Ignored if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>X_val</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em><em>, </em><em>optional</em>) – The validation input samples. If provided, <code class="docutils literal notranslate"><span class="pre">X</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> are not split and this data is used for validation.</p></li>
<li><p><strong>y_val</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em><em>, </em><em>optional</em>) – The validation target values. Required if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>random_state</strong> (<em>int</em><em>, </em><em>default=101</em>) – Controls the shuffling applied to the data before applying the split.</p></li>
<li><p><strong>batch_size</strong> (<em>int</em><em>, </em><em>default=64</em>) – Number of samples per gradient update.</p></li>
<li><p><strong>shuffle</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to shuffle the training data before each epoch.</p></li>
<li><p><strong>lr</strong> (<em>float</em><em>, </em><em>default=1e-3</em>) – Learning rate for the optimizer.</p></li>
<li><p><strong>lr_patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement on the validation loss to wait before reducing the learning rate.</p></li>
<li><p><strong>factor</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Factor by which the learning rate will be reduced.</p></li>
<li><p><strong>weight_decay</strong> (<em>float</em><em>, </em><em>default=0.025</em>) – Weight decay (L2 penalty) coefficient.</p></li>
<li><p><strong>dataloader_kwargs</strong> (<em>dict</em><em>, </em><em>default={}</em>) – The kwargs for the pytorch dataloader class.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – The built regressor.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.ResNetRegressor.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.ResNetRegressor.evaluate" title="Permalink to this definition">#</a></dt>
<dd><p>Evaluate the model on the given data using specified metrics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array-like</em><em> or </em><em>pd.DataFrame</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The input samples to predict.</p></li>
<li><p><strong>y_true</strong> (<em>array-like</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_outputs</em><em>)</em>) – The true target values against which to evaluate the predictions.</p></li>
<li><p><strong>metrics</strong> (<em>dict</em>) – A dictionary where keys are metric names and values are the metric functions.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This method uses the <code class="docutils literal notranslate"><span class="pre">predict</span></code> method to generate predictions and computes each metric.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_squared_error</span><span class="p">,</span> <span class="n">r2_score</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mambular.models</span> <span class="kn">import</span> <span class="n">MambularRegressor</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">metrics</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">... </span>    <span class="s1">&#39;Mean Squared Error&#39;</span><span class="p">:</span> <span class="n">mean_squared_error</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s1">&#39;R2 Score&#39;</span><span class="p">:</span> <span class="n">r2_score</span>
<span class="gp">... </span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Assuming &#39;X_test&#39; and &#39;y_test&#39; are your test dataset and labels</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Evaluate using the specified metrics</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results</span> <span class="o">=</span> <span class="n">regressor</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="n">metrics</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>scores</strong> – A dictionary with metric names as keys and their corresponding scores as values.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.ResNetRegressor.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">101</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patience</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">15</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">monitor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'val_loss'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'min'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_patience</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_decay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checkpoint_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'model_checkpoints'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataloader_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rebuild</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">trainer_kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.ResNetRegressor.fit" title="Permalink to this definition">#</a></dt>
<dd><p>Trains the regression model using the provided training data. Optionally, a separate validation set can be used.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The training input samples.</p></li>
<li><p><strong>y</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em>) – The target values (real numbers).</p></li>
<li><p><strong>val_size</strong> (<em>float</em><em>, </em><em>default=0.2</em>) – The proportion of the dataset to include in the validation split if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is None. Ignored if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>X_val</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em><em>, </em><em>optional</em>) – The validation input samples. If provided, <code class="docutils literal notranslate"><span class="pre">X</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> are not split and this data is used for validation.</p></li>
<li><p><strong>y_val</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em><em>, </em><em>optional</em>) – The validation target values. Required if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>max_epochs</strong> (<em>int</em><em>, </em><em>default=100</em>) – Maximum number of epochs for training.</p></li>
<li><p><strong>random_state</strong> (<em>int</em><em>, </em><em>default=101</em>) – Controls the shuffling applied to the data before applying the split.</p></li>
<li><p><strong>batch_size</strong> (<em>int</em><em>, </em><em>default=64</em>) – Number of samples per gradient update.</p></li>
<li><p><strong>shuffle</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to shuffle the training data before each epoch.</p></li>
<li><p><strong>patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement on the validation loss to wait before early stopping.</p></li>
<li><p><strong>monitor</strong> (<em>str</em><em>, </em><em>default=&quot;val_loss&quot;</em>) – The metric to monitor for early stopping.</p></li>
<li><p><strong>mode</strong> (<em>str</em><em>, </em><em>default=&quot;min&quot;</em>) – Whether the monitored metric should be minimized (<code class="docutils literal notranslate"><span class="pre">min</span></code>) or maximized (<code class="docutils literal notranslate"><span class="pre">max</span></code>).</p></li>
<li><p><strong>lr</strong> (<em>float</em><em>, </em><em>default=1e-3</em>) – Learning rate for the optimizer.</p></li>
<li><p><strong>lr_patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement on the validation loss to wait before reducing the learning rate.</p></li>
<li><p><strong>factor</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Factor by which the learning rate will be reduced.</p></li>
<li><p><strong>weight_decay</strong> (<em>float</em><em>, </em><em>default=0.025</em>) – Weight decay (L2 penalty) coefficient.</p></li>
<li><p><strong>checkpoint_path</strong> (<em>str</em><em>, </em><em>default=&quot;model_checkpoints&quot;</em>) – Path where the checkpoints are being saved.</p></li>
<li><p><strong>dataloader_kwargs</strong> (<em>dict</em><em>, </em><em>default={}</em>) – The kwargs for the pytorch dataloader class.</p></li>
<li><p><strong>**trainer_kwargs</strong> (<em>Additional keyword arguments for PyTorch Lightning's Trainer class.</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – The fitted regressor.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.ResNetRegressor.get_number_of_params">
<span class="sig-name descname"><span class="pre">get_number_of_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">requires_grad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.ResNetRegressor.get_number_of_params" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate the number of parameters in the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>requires_grad</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, only count the parameters that require gradients (trainable parameters).
If False, count all parameters. Default is True.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The total number of parameters in the model.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the model has not been built prior to calling this method.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.ResNetRegressor.get_params">
<span class="sig-name descname"><span class="pre">get_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">deep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.ResNetRegressor.get_params" title="Permalink to this definition">#</a></dt>
<dd><p>Get parameters for this estimator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>deep</strong> (<em>bool</em><em>, </em><em>default=True</em>) – If True, will return the parameters for this estimator and contained subobjects that are estimators.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>params</strong> – Parameter names mapped to their values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.ResNetRegressor.optimize_hparams">
<span class="sig-name descname"><span class="pre">optimize_hparams</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prune_by_epoch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prune_epoch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fixed_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'cat_encoding':</span> <span class="pre">'int',</span> <span class="pre">'head_layer_size_length':</span> <span class="pre">0,</span> <span class="pre">'head_skip_layer':</span> <span class="pre">False,</span> <span class="pre">'head_skip_layers':</span> <span class="pre">False,</span> <span class="pre">'pooling_method':</span> <span class="pre">'avg',</span> <span class="pre">'use_cls':</span> <span class="pre">False}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">custom_search_space</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">optimize_kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.ResNetRegressor.optimize_hparams" title="Permalink to this definition">#</a></dt>
<dd><p>Optimizes hyperparameters using Bayesian optimization with optional pruning.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array-like</em>) – Training data.</p></li>
<li><p><strong>y</strong> (<em>array-like</em>) – Training labels.</p></li>
<li><p><strong>X_val</strong> (<em>array-like</em><em>, </em><em>optional</em>) – Validation data and labels.</p></li>
<li><p><strong>y_val</strong> (<em>array-like</em><em>, </em><em>optional</em>) – Validation data and labels.</p></li>
<li><p><strong>time</strong> (<em>int</em>) – The number of optimization trials to run.</p></li>
<li><p><strong>max_epochs</strong> (<em>int</em>) – Maximum number of epochs for training.</p></li>
<li><p><strong>prune_by_epoch</strong> (<em>bool</em>) – Whether to prune based on a specific epoch (True) or the best validation loss (False).</p></li>
<li><p><strong>prune_epoch</strong> (<em>int</em>) – The specific epoch to prune by when prune_by_epoch is True.</p></li>
<li><p><strong>**optimize_kwargs</strong> (<em>dict</em>) – Additional keyword arguments passed to the fit method.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>best_hparams</strong> – Best hyperparameters found during optimization.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.ResNetRegressor.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.ResNetRegressor.predict" title="Permalink to this definition">#</a></dt>
<dd><p>Predicts target values for the given input samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>X</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The input samples for which to predict target values.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>predictions</strong> – The predicted target values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray, shape (n_samples,) or (n_samples, n_outputs)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.ResNetRegressor.score">
<span class="sig-name descname"><span class="pre">score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">sklearn.metrics.mean_squared_error</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.ResNetRegressor.score" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate the score of the model using the specified metric.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array-like</em><em> or </em><em>pd.DataFrame</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The input samples to predict.</p></li>
<li><p><strong>y</strong> (<em>array-like</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_outputs</em><em>)</em>) – The true target values against which to evaluate the predictions.</p></li>
<li><p><strong>metric</strong> (<em>callable</em><em>, </em><em>default=mean_squared_error</em>) – The metric function to use for evaluation. Must be a callable with the signature <code class="docutils literal notranslate"><span class="pre">metric(y_true,</span> <span class="pre">y_pred)</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>score</strong> – The score calculated using the specified metric.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.ResNetRegressor.set_params">
<span class="sig-name descname"><span class="pre">set_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">parameters</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.ResNetRegressor.set_params" title="Permalink to this definition">#</a></dt>
<dd><p>Set the parameters of this estimator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>**parameters</strong> (<em>dict</em>) – Estimator parameters.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – Estimator instance.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mambular.models.ResNetLSS">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mambular.models.</span></span><span class="sig-name descname"><span class="pre">ResNetLSS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/mambular/models/resnet.html#ResNetLSS"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mambular.models.ResNetLSS" title="Permalink to this definition">#</a></dt>
<dd><dl class="simple">
<dt>ResNet for distributional regressor. This class extends the SklearnBaseLSS class and uses the ResNet model</dt><dd><p>with the default ResNet configuration.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The parameters for this class include the attributes from the config
dataclass as well as preprocessing arguments handled by the base class.</p>
<p>Configuration class for the default ResNet model with predefined hyperparameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lr</strong> (<em>float</em><em>, </em><em>default=1e-04</em>) – Learning rate for the optimizer.</p></li>
<li><p><strong>lr_patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement after which the learning rate will be reduced.</p></li>
<li><p><strong>weight_decay</strong> (<em>float</em><em>, </em><em>default=1e-06</em>) – Weight decay (L2 regularization penalty) applied by the optimizer.</p></li>
<li><p><strong>lr_factor</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Factor by which the learning rate is reduced when there is no improvement.</p></li>
<li><p><strong>layer_sizes</strong> (<em>list</em><em>, </em><em>default=</em><em>(</em><em>256</em><em>, </em><em>128</em><em>, </em><em>32</em><em>)</em>) – Sizes of the layers in the ResNet.</p></li>
<li><p><strong>activation</strong> (<em>callable</em><em>, </em><em>default=nn.SELU</em><em>(</em><em>)</em>) – Activation function for the ResNet layers.</p></li>
<li><p><strong>skip_layers</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to skip layers in the ResNet.</p></li>
<li><p><strong>dropout</strong> (<em>float</em><em>, </em><em>default=0.5</em>) – Dropout rate for regularization.</p></li>
<li><p><strong>norm</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use normalization in the ResNet.</p></li>
<li><p><strong>use_glu</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use Gated Linear Units (GLU) in the ResNet.</p></li>
<li><p><strong>skip_connections</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to use skip connections in the ResNet.</p></li>
<li><p><strong>batch_norm</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to use batch normalization in the ResNet layers.</p></li>
<li><p><strong>layer_norm</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use layer normalization in the ResNet layers.</p></li>
<li><p><strong>layer_norm_eps</strong> (<em>float</em><em>, </em><em>default=1e-05</em>) – Epsilon value for layer normalization.</p></li>
<li><p><strong>num_blocks</strong> (<em>int</em><em>, </em><em>default=3</em>) – Number of residual blocks in the ResNet.</p></li>
<li><p><strong>use_embeddings</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to use embedding layers for all features.</p></li>
<li><p><strong>embedding_type</strong> (<em>str</em><em>, </em><em>default=&quot;linear&quot;</em>) – Type of embedding to use (‘linear’, etc.).</p></li>
<li><p><strong>embedding_bias</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use bias in the embedding layers.</p></li>
<li><p><strong>plr_lite</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use a lightweight version of Piecewise Linear Regression (PLR).</p></li>
<li><p><strong>average_embeddings</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to average embeddings during the forward pass.</p></li>
<li><p><strong>embedding_activation</strong> (<em>callable</em><em>, </em><em>default=nn.Identity</em><em>(</em><em>)</em>) – Activation function for embeddings.</p></li>
<li><p><strong>layer_norm_after_embedding</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to apply layer normalization after embedding layers.</p></li>
<li><p><strong>d_model</strong> (<em>int</em><em>, </em><em>default=64</em>) – Dimensionality of the embeddings.</p></li>
<li><p><strong>n_bins</strong> (<em>int</em><em>, </em><em>default=50</em>) – The number of bins to use for numerical feature binning. This parameter is relevant
only if <code class="docutils literal notranslate"><span class="pre">numerical_preprocessing</span></code> is set to ‘binning’, ‘ple’ or ‘one-hot’.</p></li>
<li><p><strong>numerical_preprocessing</strong> (<em>str</em><em>, </em><em>default=&quot;ple&quot;</em>) – The preprocessing strategy for numerical features. Valid options are
‘ple’, ‘binning’, ‘one-hot’, ‘standardization’, ‘min-max’, ‘quantile’, ‘polynomial’,
‘splines’, ‘box-cox’, ‘yeo-johnson’ and None</p></li>
<li><p><strong>categorical_preprocessing</strong> (<em>str</em><em>, </em><em>default=&quot;int&quot;</em>) – The preprocessing strategy for categorical features. Valid options are
‘int’, ‘one-hot’, None</p></li>
<li><p><strong>use_decision_tree_bins</strong> (<em>bool</em><em>, </em><em>default=False</em>) – If True, uses decision tree regression/classification to determine
optimal bin edges for numerical feature binning. This parameter is
relevant only if <code class="docutils literal notranslate"><span class="pre">numerical_preprocessing</span></code> is set to ‘binning’ or ‘one-hot’.</p></li>
<li><p><strong>binning_strategy</strong> (<em>str</em><em>, </em><em>default=&quot;uniform&quot;</em>) – Defines the strategy for binning numerical features. Options include ‘uniform’,
‘quantile’, or other sklearn-compatible strategies.</p></li>
<li><p><strong>task</strong> (<em>str</em><em>, </em><em>default=&quot;regression&quot;</em>) – Indicates the type of machine learning task (‘regression’ or ‘classification’). This can
influence certain preprocessing behaviors, especially when using decision tree-based binning.</p></li>
<li><p><strong>cat_cutoff</strong> (<em>float</em><em> or </em><em>int</em><em>, </em><em>default=0.03</em>) – Indicates the cutoff after which integer values are treated as categorical.
If float, it’s treated as a percentage. If int, it’s the maximum number of
unique values for a column to be considered categorical.</p></li>
<li><p><strong>treat_all_integers_as_numerical</strong> (<em>bool</em><em>, </em><em>default=False</em>) – If True, all integer columns will be treated as numerical, regardless
of their unique value count or proportion.</p></li>
<li><p><strong>degree</strong> (<em>int</em><em>, </em><em>default=3</em>) – The degree of the polynomial features to be used in preprocessing.</p></li>
<li><p><strong>knots</strong> (<em>int</em><em>, </em><em>default=12</em>) – The number of knots to be used in spline transformations.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mambular.models</span> <span class="kn">import</span> <span class="n">ResNetLSS</span>
<span class="go">    &gt;&gt;&gt; model = ResNetLSS()</span>
<span class="go">    &gt;&gt;&gt; model.fit(X_train, y_train, family=&#39;normal&#39;)</span>
<span class="go">    &gt;&gt;&gt; preds = model.predict(X_test)</span>
<span class="go">    &gt;&gt;&gt; model.evaluate(X_test, y_test)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.ResNetLSS.build_model">
<span class="sig-name descname"><span class="pre">build_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">101</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_patience</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_decay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataloader_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.ResNetLSS.build_model" title="Permalink to this definition">#</a></dt>
<dd><p>Builds the model using the provided training data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The training input samples.</p></li>
<li><p><strong>y</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em>) – The target values (real numbers).</p></li>
<li><p><strong>val_size</strong> (<em>float</em><em>, </em><em>default=0.2</em>) – The proportion of the dataset to include in the validation split if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is None. Ignored if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>X_val</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em><em>, </em><em>optional</em>) – The validation input samples. If provided, <code class="docutils literal notranslate"><span class="pre">X</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> are not split and this data is used for validation.</p></li>
<li><p><strong>y_val</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em><em>, </em><em>optional</em>) – The validation target values. Required if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>random_state</strong> (<em>int</em><em>, </em><em>default=101</em>) – Controls the shuffling applied to the data before applying the split.</p></li>
<li><p><strong>batch_size</strong> (<em>int</em><em>, </em><em>default=64</em>) – Number of samples per gradient update.</p></li>
<li><p><strong>shuffle</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to shuffle the training data before each epoch.</p></li>
<li><p><strong>lr</strong> (<em>float</em><em>, </em><em>default=1e-3</em>) – Learning rate for the optimizer.</p></li>
<li><p><strong>lr_patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement on the validation loss to wait before reducing the learning rate.</p></li>
<li><p><strong>factor</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Factor by which the learning rate will be reduced.</p></li>
<li><p><strong>weight_decay</strong> (<em>float</em><em>, </em><em>default=0.025</em>) – Weight decay (L2 penalty) coefficient.</p></li>
<li><p><strong>dataloader_kwargs</strong> (<em>dict</em><em>, </em><em>default={}</em>) – The kwargs for the pytorch dataloader class.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – The built distributional regressor.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.ResNetLSS.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distribution_family</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.ResNetLSS.evaluate" title="Permalink to this definition">#</a></dt>
<dd><p>Evaluate the model on the given data using specified metrics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array-like</em><em> or </em><em>pd.DataFrame</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The input samples to predict.</p></li>
<li><p><strong>y_true</strong> (<em>array-like</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>)</em>) – The true class labels against which to evaluate the predictions.</p></li>
<li><p><strong>metrics</strong> (<em>dict</em>) – A dictionary where keys are metric names and values are tuples containing the metric function
and a boolean indicating whether the metric requires probability scores (True) or class labels (False).</p></li>
<li><p><strong>distribution_family</strong> (<em>str</em><em>, </em><em>optional</em>) – Specifies the distribution family the model is predicting for. If None, it will attempt to infer based
on the model’s settings.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>scores</strong> – A dictionary with metric names as keys and their corresponding scores as values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This method uses either the <code class="docutils literal notranslate"><span class="pre">predict</span></code> or <code class="docutils literal notranslate"><span class="pre">predict_proba</span></code> method depending on the metric requirements.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.ResNetLSS.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">family</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">101</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patience</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">15</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">monitor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'val_loss'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'min'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_patience</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_decay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checkpoint_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'model_checkpoints'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distributional_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataloader_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rebuild</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">trainer_kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.ResNetLSS.fit" title="Permalink to this definition">#</a></dt>
<dd><p>Trains the regression model using the provided training data. Optionally, a separate validation set can be used.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The training input samples.</p></li>
<li><p><strong>y</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em>) – The target values (real numbers).</p></li>
<li><p><strong>family</strong> (<em>str</em>) – The name of the distribution family to use for the loss function. Examples include ‘normal’ for regression tasks.</p></li>
<li><p><strong>val_size</strong> (<em>float</em><em>, </em><em>default=0.2</em>) – The proportion of the dataset to include in the validation split if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is None. Ignored if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>X_val</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em><em>, </em><em>optional</em>) – The validation input samples. If provided, <code class="docutils literal notranslate"><span class="pre">X</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> are not split and this data is used for validation.</p></li>
<li><p><strong>y_val</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em><em>, </em><em>optional</em>) – The validation target values. Required if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>max_epochs</strong> (<em>int</em><em>, </em><em>default=100</em>) – Maximum number of epochs for training.</p></li>
<li><p><strong>random_state</strong> (<em>int</em><em>, </em><em>default=101</em>) – Controls the shuffling applied to the data before applying the split.</p></li>
<li><p><strong>batch_size</strong> (<em>int</em><em>, </em><em>default=64</em>) – Number of samples per gradient update.</p></li>
<li><p><strong>shuffle</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to shuffle the training data before each epoch.</p></li>
<li><p><strong>patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement on the validation loss to wait before early stopping.</p></li>
<li><p><strong>monitor</strong> (<em>str</em><em>, </em><em>default=&quot;val_loss&quot;</em>) – The metric to monitor for early stopping.</p></li>
<li><p><strong>mode</strong> (<em>str</em><em>, </em><em>default=&quot;min&quot;</em>) – Whether the monitored metric should be minimized (<code class="docutils literal notranslate"><span class="pre">min</span></code>) or maximized (<code class="docutils literal notranslate"><span class="pre">max</span></code>).</p></li>
<li><p><strong>lr</strong> (<em>float</em><em>, </em><em>default=1e-3</em>) – Learning rate for the optimizer.</p></li>
<li><p><strong>lr_patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement on the validation loss to wait before reducing the learning rate.</p></li>
<li><p><strong>factor</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Factor by which the learning rate will be reduced.</p></li>
<li><p><strong>weight_decay</strong> (<em>float</em><em>, </em><em>default=0.025</em>) – Weight decay (L2 penalty) coefficient.</p></li>
<li><p><strong>distributional_kwargs</strong> (<em>dict</em><em>, </em><em>default=None</em>) – any arguments taht are specific for a certain distribution.</p></li>
<li><p><strong>checkpoint_path</strong> (<em>str</em><em>, </em><em>default=&quot;model_checkpoints&quot;</em>) – Path where the checkpoints are being saved.</p></li>
<li><p><strong>dataloader_kwargs</strong> (<em>dict</em><em>, </em><em>default={}</em>) – The kwargs for the pytorch dataloader class.</p></li>
<li><p><strong>**trainer_kwargs</strong> (<em>Additional keyword arguments for PyTorch Lightning's Trainer class.</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – The fitted regressor.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.ResNetLSS.get_default_metrics">
<span class="sig-name descname"><span class="pre">get_default_metrics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">distribution_family</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.ResNetLSS.get_default_metrics" title="Permalink to this definition">#</a></dt>
<dd><p>Provides default metrics based on the distribution family.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>distribution_family</strong> (<em>str</em>) – The distribution family for which to provide default metrics.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>metrics</strong> – A dictionary of default metric functions.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.ResNetLSS.get_number_of_params">
<span class="sig-name descname"><span class="pre">get_number_of_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">requires_grad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.ResNetLSS.get_number_of_params" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate the number of parameters in the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>requires_grad</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, only count the parameters that require gradients (trainable parameters).
If False, count all parameters. Default is True.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The total number of parameters in the model.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the model has not been built prior to calling this method.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.ResNetLSS.get_params">
<span class="sig-name descname"><span class="pre">get_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">deep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.ResNetLSS.get_params" title="Permalink to this definition">#</a></dt>
<dd><p>Get parameters for this estimator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>deep</strong> (<em>bool</em><em>, </em><em>default=True</em>) – If True, will return the parameters for this estimator and contained subobjects that are estimators.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>params</strong> – Parameter names mapped to their values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.ResNetLSS.optimize_hparams">
<span class="sig-name descname"><span class="pre">optimize_hparams</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prune_by_epoch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prune_epoch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fixed_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'cat_encoding':</span> <span class="pre">'int',</span> <span class="pre">'head_layer_size_length':</span> <span class="pre">0,</span> <span class="pre">'head_skip_layer':</span> <span class="pre">False,</span> <span class="pre">'head_skip_layers':</span> <span class="pre">False,</span> <span class="pre">'pooling_method':</span> <span class="pre">'avg',</span> <span class="pre">'use_cls':</span> <span class="pre">False}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">custom_search_space</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">optimize_kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.ResNetLSS.optimize_hparams" title="Permalink to this definition">#</a></dt>
<dd><p>Optimizes hyperparameters using Bayesian optimization with optional pruning.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array-like</em>) – Training data.</p></li>
<li><p><strong>y</strong> (<em>array-like</em>) – Training labels.</p></li>
<li><p><strong>X_val</strong> (<em>array-like</em><em>, </em><em>optional</em>) – Validation data and labels.</p></li>
<li><p><strong>y_val</strong> (<em>array-like</em><em>, </em><em>optional</em>) – Validation data and labels.</p></li>
<li><p><strong>time</strong> (<em>int</em>) – The number of optimization trials to run.</p></li>
<li><p><strong>max_epochs</strong> (<em>int</em>) – Maximum number of epochs for training.</p></li>
<li><p><strong>prune_by_epoch</strong> (<em>bool</em>) – Whether to prune based on a specific epoch (True) or the best validation loss (False).</p></li>
<li><p><strong>prune_epoch</strong> (<em>int</em>) – The specific epoch to prune by when prune_by_epoch is True.</p></li>
<li><p><strong>**optimize_kwargs</strong> (<em>dict</em>) – Additional keyword arguments passed to the fit method.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>best_hparams</strong> – Best hyperparameters found during optimization.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.ResNetLSS.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">raw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.ResNetLSS.predict" title="Permalink to this definition">#</a></dt>
<dd><p>Predicts target values for the given input samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>X</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The input samples for which to predict target values.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>predictions</strong> – The predicted target values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray, shape (n_samples,) or (n_samples, n_outputs)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.ResNetLSS.score">
<span class="sig-name descname"><span class="pre">score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'NLL'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.ResNetLSS.score" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate the score of the model using the specified metric.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array-like</em><em> or </em><em>pd.DataFrame</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The input samples to predict.</p></li>
<li><p><strong>y</strong> (<em>array-like</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_outputs</em><em>)</em>) – The true target values against which to evaluate the predictions.</p></li>
<li><p><strong>metric</strong> (<em>str</em><em>, </em><em>default=&quot;NLL&quot;</em>) – So far, only negative log-likelihood is supported</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>score</strong> – The score calculated using the specified metric.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.ResNetLSS.set_params">
<span class="sig-name descname"><span class="pre">set_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">parameters</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.ResNetLSS.set_params" title="Permalink to this definition">#</a></dt>
<dd><p>Set the parameters of this estimator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>**parameters</strong> (<em>dict</em>) – Estimator parameters.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – Estimator instance.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mambular.models.MambaTabClassifier">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mambular.models.</span></span><span class="sig-name descname"><span class="pre">MambaTabClassifier</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/mambular/models/mambatab.html#MambaTabClassifier"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mambular.models.MambaTabClassifier" title="Permalink to this definition">#</a></dt>
<dd><dl class="simple">
<dt>MambaTab classifier. This class extends the SklearnBaseClassifier class and uses the MambaTab model</dt><dd><p>with the default MambaTab configuration.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The parameters for this class include the attributes from the config
dataclass as well as preprocessing arguments handled by the base class.</p>
<p>Configuration class for the Default MambaTab model with predefined hyperparameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lr</strong> (<em>float</em><em>, </em><em>default=1e-04</em>) – Learning rate for the optimizer.</p></li>
<li><p><strong>lr_patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement after which the learning rate will be reduced.</p></li>
<li><p><strong>weight_decay</strong> (<em>float</em><em>, </em><em>default=1e-06</em>) – Weight decay (L2 regularization) for the optimizer.</p></li>
<li><p><strong>lr_factor</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Factor by which the learning rate will be reduced.</p></li>
<li><p><strong>d_model</strong> (<em>int</em><em>, </em><em>default=64</em>) – Dimensionality of the model.</p></li>
<li><p><strong>n_layers</strong> (<em>int</em><em>, </em><em>default=1</em>) – Number of layers in the model.</p></li>
<li><p><strong>expand_factor</strong> (<em>int</em><em>, </em><em>default=2</em>) – Expansion factor for the feed-forward layers.</p></li>
<li><p><strong>bias</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use bias in the linear layers.</p></li>
<li><p><strong>d_conv</strong> (<em>int</em><em>, </em><em>default=16</em>) – Dimensionality of the convolutional layers.</p></li>
<li><p><strong>conv_bias</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to use bias in the convolutional layers.</p></li>
<li><p><strong>dropout</strong> (<em>float</em><em>, </em><em>default=0.05</em>) – Dropout rate for regularization.</p></li>
<li><p><strong>dt_rank</strong> (<em>str</em><em>, </em><em>default=&quot;auto&quot;</em>) – Rank of the decision tree used in the model.</p></li>
<li><p><strong>d_state</strong> (<em>int</em><em>, </em><em>default=128</em>) – Dimensionality of the state in recurrent layers.</p></li>
<li><p><strong>dt_scale</strong> (<em>float</em><em>, </em><em>default=1.0</em>) – Scaling factor for the decision tree.</p></li>
<li><p><strong>dt_init</strong> (<em>str</em><em>, </em><em>default=&quot;random&quot;</em>) – Initialization method for the decision tree.</p></li>
<li><p><strong>dt_max</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Maximum value for decision tree initialization.</p></li>
<li><p><strong>dt_min</strong> (<em>float</em><em>, </em><em>default=1e-04</em>) – Minimum value for decision tree initialization.</p></li>
<li><p><strong>dt_init_floor</strong> (<em>float</em><em>, </em><em>default=1e-04</em>) – Floor value for decision tree initialization.</p></li>
<li><p><strong>activation</strong> (<em>callable</em><em>, </em><em>default=nn.ReLU</em><em>(</em><em>)</em>) – Activation function for the model.</p></li>
<li><p><strong>axis</strong> (<em>int</em><em>, </em><em>default=1</em>) – Axis along which operations are applied, if applicable.</p></li>
<li><p><strong>num_embedding_activation</strong> (<em>callable</em><em>, </em><em>default=nn.ReLU</em><em>(</em><em>)</em>) – Activation function for numerical embeddings.</p></li>
<li><p><strong>embedding_type</strong> (<em>str</em><em>, </em><em>default=&quot;linear&quot;</em>) – Type of embedding to use (‘linear’, etc.).</p></li>
<li><p><strong>embedding_bias</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use bias in the embedding layers.</p></li>
<li><p><strong>plr_lite</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use a lightweight version of Piecewise Linear Regression (PLR).</p></li>
<li><p><strong>n_frequencies</strong> (<em>int</em><em>, </em><em>default=48</em>) – Number of frequencies for PLR embeddings.</p></li>
<li><p><strong>frequencies_init_scale</strong> (<em>float</em><em>, </em><em>default=0.01</em>) – Initial scale for frequency parameters in embeddings.</p></li>
<li><p><strong>head_layer_sizes</strong> (<em>list</em><em>, </em><em>default=</em><em>(</em><em>)</em>) – Sizes of the fully connected layers in the model’s head.</p></li>
<li><p><strong>head_dropout</strong> (<em>float</em><em>, </em><em>default=0.0</em>) – Dropout rate for the head layers.</p></li>
<li><p><strong>head_skip_layers</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to skip layers in the head.</p></li>
<li><p><strong>head_activation</strong> (<em>callable</em><em>, </em><em>default=nn.ReLU</em><em>(</em><em>)</em>) – Activation function for the head layers.</p></li>
<li><p><strong>head_use_batch_norm</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use batch normalization in the head layers.</p></li>
<li><p><strong>norm</strong> (<em>str</em><em>, </em><em>default=&quot;LayerNorm&quot;</em>) – Type of normalization to be used (‘LayerNorm’, ‘RMSNorm’, etc.).</p></li>
<li><p><strong>use_pscan</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use PSCAN for the state-space model.</p></li>
<li><p><strong>mamba_version</strong> (<em>str</em><em>, </em><em>default=&quot;mamba-torch&quot;</em>) – Version of the Mamba model to use (‘mamba-torch’, ‘mamba1’, ‘mamba2’).</p></li>
<li><p><strong>bidirectional</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to process data bidirectionally.</p></li>
<li><p><strong>n_bins</strong> (<em>int</em><em>, </em><em>default=50</em>) – The number of bins to use for numerical feature binning. This parameter is relevant
only if <code class="docutils literal notranslate"><span class="pre">numerical_preprocessing</span></code> is set to ‘binning’, ‘ple’ or ‘one-hot’.</p></li>
<li><p><strong>numerical_preprocessing</strong> (<em>str</em><em>, </em><em>default=&quot;ple&quot;</em>) – The preprocessing strategy for numerical features. Valid options are
‘ple’, ‘binning’, ‘one-hot’, ‘standardization’, ‘min-max’, ‘quantile’, ‘polynomial’,
‘splines’, ‘box-cox’, ‘yeo-johnson’ and None</p></li>
<li><p><strong>categorical_preprocessing</strong> (<em>str</em><em>, </em><em>default=&quot;int&quot;</em>) – The preprocessing strategy for categorical features. Valid options are
‘int’, ‘one-hot’, None</p></li>
<li><p><strong>use_decision_tree_bins</strong> (<em>bool</em><em>, </em><em>default=False</em>) – If True, uses decision tree regression/classification to determine
optimal bin edges for numerical feature binning. This parameter is
relevant only if <code class="docutils literal notranslate"><span class="pre">numerical_preprocessing</span></code> is set to ‘binning’ or ‘one-hot’.</p></li>
<li><p><strong>binning_strategy</strong> (<em>str</em><em>, </em><em>default=&quot;uniform&quot;</em>) – Defines the strategy for binning numerical features. Options include ‘uniform’,
‘quantile’, or other sklearn-compatible strategies.</p></li>
<li><p><strong>task</strong> (<em>str</em><em>, </em><em>default=&quot;regression&quot;</em>) – Indicates the type of machine learning task (‘regression’ or ‘classification’). This can
influence certain preprocessing behaviors, especially when using decision tree-based binning.</p></li>
<li><p><strong>cat_cutoff</strong> (<em>float</em><em> or </em><em>int</em><em>, </em><em>default=0.03</em>) – Indicates the cutoff after which integer values are treated as categorical.
If float, it’s treated as a percentage. If int, it’s the maximum number of
unique values for a column to be considered categorical.</p></li>
<li><p><strong>treat_all_integers_as_numerical</strong> (<em>bool</em><em>, </em><em>default=False</em>) – If True, all integer columns will be treated as numerical, regardless
of their unique value count or proportion.</p></li>
<li><p><strong>degree</strong> (<em>int</em><em>, </em><em>default=3</em>) – The degree of the polynomial features to be used in preprocessing.</p></li>
<li><p><strong>knots</strong> (<em>int</em><em>, </em><em>default=12</em>) – The number of knots to be used in spline transformations.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.MambaTabClassifier.build_model">
<span class="sig-name descname"><span class="pre">build_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">101</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_patience</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_decay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataloader_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.MambaTabClassifier.build_model" title="Permalink to this definition">#</a></dt>
<dd><p>Builds the model using the provided training data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The training input samples.</p></li>
<li><p><strong>y</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em>) – The target values (real numbers).</p></li>
<li><p><strong>val_size</strong> (<em>float</em><em>, </em><em>default=0.2</em>) – The proportion of the dataset to include in the validation split if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is None. Ignored if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>X_val</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em><em>, </em><em>optional</em>) – The validation input samples. If provided, <code class="docutils literal notranslate"><span class="pre">X</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> are not split and this data is used for validation.</p></li>
<li><p><strong>y_val</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em><em>, </em><em>optional</em>) – The validation target values. Required if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>random_state</strong> (<em>int</em><em>, </em><em>default=101</em>) – Controls the shuffling applied to the data before applying the split.</p></li>
<li><p><strong>batch_size</strong> (<em>int</em><em>, </em><em>default=64</em>) – Number of samples per gradient update.</p></li>
<li><p><strong>shuffle</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to shuffle the training data before each epoch.</p></li>
<li><p><strong>lr</strong> (<em>float</em><em>, </em><em>default=1e-3</em>) – Learning rate for the optimizer.</p></li>
<li><p><strong>lr_patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement on the validation loss to wait before reducing the learning rate.</p></li>
<li><p><strong>factor</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Factor by which the learning rate will be reduced.</p></li>
<li><p><strong>weight_decay</strong> (<em>float</em><em>, </em><em>default=0.025</em>) – Weight decay (L2 penalty) coefficient.</p></li>
<li><p><strong>dataloader_kwargs</strong> (<em>dict</em><em>, </em><em>default={}</em>) – The kwargs for the pytorch dataloader class.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – The built classifier.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.MambaTabClassifier.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.MambaTabClassifier.evaluate" title="Permalink to this definition">#</a></dt>
<dd><p>Evaluate the model on the given data using specified metrics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array-like</em><em> or </em><em>pd.DataFrame</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The input samples to predict.</p></li>
<li><p><strong>y_true</strong> (<em>array-like</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>)</em>) – The true class labels against which to evaluate the predictions.</p></li>
<li><p><strong>metrics</strong> (<em>dict</em>) – A dictionary where keys are metric names and values are tuples containing the metric function
and a boolean indicating whether the metric requires probability scores (True) or class labels (False).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>scores</strong> – A dictionary with metric names as keys and their corresponding scores as values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This method uses either the <code class="docutils literal notranslate"><span class="pre">predict</span></code> or <code class="docutils literal notranslate"><span class="pre">predict_proba</span></code> method depending on the metric requirements.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.MambaTabClassifier.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">101</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patience</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">15</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">monitor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'val_loss'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'min'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_patience</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_decay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checkpoint_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'model_checkpoints'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataloader_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rebuild</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">trainer_kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.MambaTabClassifier.fit" title="Permalink to this definition">#</a></dt>
<dd><p>Trains the classification model using the provided training data. Optionally, a separate validation set can be used.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The training input samples.</p></li>
<li><p><strong>y</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em>) – The target values (real numbers).</p></li>
<li><p><strong>val_size</strong> (<em>float</em><em>, </em><em>default=0.2</em>) – The proportion of the dataset to include in the validation split if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is None. Ignored if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>X_val</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em><em>, </em><em>optional</em>) – The validation input samples. If provided, <code class="docutils literal notranslate"><span class="pre">X</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> are not split and this data is used for validation.</p></li>
<li><p><strong>y_val</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em><em>, </em><em>optional</em>) – The validation target values. Required if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>max_epochs</strong> (<em>int</em><em>, </em><em>default=100</em>) – Maximum number of epochs for training.</p></li>
<li><p><strong>random_state</strong> (<em>int</em><em>, </em><em>default=101</em>) – Controls the shuffling applied to the data before applying the split.</p></li>
<li><p><strong>batch_size</strong> (<em>int</em><em>, </em><em>default=64</em>) – Number of samples per gradient update.</p></li>
<li><p><strong>shuffle</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to shuffle the training data before each epoch.</p></li>
<li><p><strong>patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement on the validation loss to wait before early stopping.</p></li>
<li><p><strong>monitor</strong> (<em>str</em><em>, </em><em>default=&quot;val_loss&quot;</em>) – The metric to monitor for early stopping.</p></li>
<li><p><strong>mode</strong> (<em>str</em><em>, </em><em>default=&quot;min&quot;</em>) – Whether the monitored metric should be minimized (<code class="docutils literal notranslate"><span class="pre">min</span></code>) or maximized (<code class="docutils literal notranslate"><span class="pre">max</span></code>).</p></li>
<li><p><strong>lr</strong> (<em>float</em><em>, </em><em>default=1e-3</em>) – Learning rate for the optimizer.</p></li>
<li><p><strong>lr_patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement on the validation loss to wait before reducing the learning rate.</p></li>
<li><p><strong>factor</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Factor by which the learning rate will be reduced.</p></li>
<li><p><strong>weight_decay</strong> (<em>float</em><em>, </em><em>default=0.025</em>) – Weight decay (L2 penalty) coefficient.</p></li>
<li><p><strong>checkpoint_path</strong> (<em>str</em><em>, </em><em>default=&quot;model_checkpoints&quot;</em>) – Path where the checkpoints are being saved.</p></li>
<li><p><strong>dataloader_kwargs</strong> (<em>dict</em><em>, </em><em>default={}</em>) – The kwargs for the pytorch dataloader class.</p></li>
<li><p><strong>rebuild</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to rebuild the model when it already was built.</p></li>
<li><p><strong>**trainer_kwargs</strong> (<em>Additional keyword arguments for PyTorch Lightning's Trainer class.</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – The fitted classifier.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.MambaTabClassifier.get_number_of_params">
<span class="sig-name descname"><span class="pre">get_number_of_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">requires_grad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.MambaTabClassifier.get_number_of_params" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate the number of parameters in the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>requires_grad</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, only count the parameters that require gradients (trainable parameters).
If False, count all parameters. Default is True.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The total number of parameters in the model.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the model has not been built prior to calling this method.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.MambaTabClassifier.get_params">
<span class="sig-name descname"><span class="pre">get_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">deep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.MambaTabClassifier.get_params" title="Permalink to this definition">#</a></dt>
<dd><p>Get parameters for this estimator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>deep</strong> (<em>bool</em><em>, </em><em>default=True</em>) – If True, will return the parameters for this estimator and contained subobjects that are estimators.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>params</strong> – Parameter names mapped to their values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.MambaTabClassifier.optimize_hparams">
<span class="sig-name descname"><span class="pre">optimize_hparams</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prune_by_epoch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prune_epoch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fixed_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'cat_encoding':</span> <span class="pre">'int',</span> <span class="pre">'head_layer_size_length':</span> <span class="pre">0,</span> <span class="pre">'head_skip_layer':</span> <span class="pre">False,</span> <span class="pre">'head_skip_layers':</span> <span class="pre">False,</span> <span class="pre">'pooling_method':</span> <span class="pre">'avg',</span> <span class="pre">'use_cls':</span> <span class="pre">False}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">custom_search_space</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">optimize_kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.MambaTabClassifier.optimize_hparams" title="Permalink to this definition">#</a></dt>
<dd><p>Optimizes hyperparameters using Bayesian optimization with optional pruning.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array-like</em>) – Training data.</p></li>
<li><p><strong>y</strong> (<em>array-like</em>) – Training labels.</p></li>
<li><p><strong>X_val</strong> (<em>array-like</em><em>, </em><em>optional</em>) – Validation data and labels.</p></li>
<li><p><strong>y_val</strong> (<em>array-like</em><em>, </em><em>optional</em>) – Validation data and labels.</p></li>
<li><p><strong>time</strong> (<em>int</em>) – The number of optimization trials to run.</p></li>
<li><p><strong>max_epochs</strong> (<em>int</em>) – Maximum number of epochs for training.</p></li>
<li><p><strong>prune_by_epoch</strong> (<em>bool</em>) – Whether to prune based on a specific epoch (True) or the best validation loss (False).</p></li>
<li><p><strong>prune_epoch</strong> (<em>int</em>) – The specific epoch to prune by when prune_by_epoch is True.</p></li>
<li><p><strong>**optimize_kwargs</strong> (<em>dict</em>) – Additional keyword arguments passed to the fit method.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>best_hparams</strong> – Best hyperparameters found during optimization.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.MambaTabClassifier.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.MambaTabClassifier.predict" title="Permalink to this definition">#</a></dt>
<dd><p>Predicts target values for the given input samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>X</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The input samples for which to predict target values.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>predictions</strong> – The predicted target values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray, shape (n_samples,) or (n_samples, n_outputs)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.MambaTabClassifier.predict_proba">
<span class="sig-name descname"><span class="pre">predict_proba</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.MambaTabClassifier.predict_proba" title="Permalink to this definition">#</a></dt>
<dd><p>Predict class probabilities for the given input samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>X</strong> (<em>array-like</em><em> or </em><em>pd.DataFrame</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The input samples for which to predict class probabilities.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The method preprocesses the input data using the same preprocessor used during training,
sets the model to evaluation mode, and then performs inference to predict the class probabilities.
Softmax is applied to the logits to obtain probabilities, which are then converted from a PyTorch tensor
to a NumPy array before being returned.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">accuracy_score</span><span class="p">,</span> <span class="n">precision_score</span><span class="p">,</span> <span class="n">f1_score</span><span class="p">,</span> <span class="n">roc_auc_score</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Define the metrics you want to evaluate</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">metrics</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">... </span>    <span class="s1">&#39;Accuracy&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">accuracy_score</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
<span class="gp">... </span>    <span class="s1">&#39;Precision&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">precision_score</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
<span class="gp">... </span>    <span class="s1">&#39;F1 Score&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">f1_score</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
<span class="gp">... </span>    <span class="s1">&#39;AUC Score&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">roc_auc_score</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
<span class="gp">... </span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Assuming &#39;X_test&#39; and &#39;y_test&#39; are your test dataset and labels</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Evaluate using the specified metrics</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results</span> <span class="o">=</span> <span class="n">classifier</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="n">metrics</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>probabilities</strong> – Predicted class probabilities for each input sample.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>ndarray of shape (n_samples, n_classes)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.MambaTabClassifier.score">
<span class="sig-name descname"><span class="pre">score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(sklearn.metrics.log_loss,</span> <span class="pre">True)</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.MambaTabClassifier.score" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate the score of the model using the specified metric.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array-like</em><em> or </em><em>pd.DataFrame</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The input samples to predict.</p></li>
<li><p><strong>y</strong> (<em>array-like</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>)</em>) – The true class labels against which to evaluate the predictions.</p></li>
<li><p><strong>metric</strong> (<em>tuple</em><em>, </em><em>default=</em><em>(</em><em>log_loss</em><em>, </em><em>True</em><em>)</em>) – A tuple containing the metric function and a boolean indicating whether the metric requires probability scores (True) or class labels (False).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>score</strong> – The score calculated using the specified metric.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.MambaTabClassifier.set_params">
<span class="sig-name descname"><span class="pre">set_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">parameters</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.MambaTabClassifier.set_params" title="Permalink to this definition">#</a></dt>
<dd><p>Set the parameters of this estimator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>**parameters</strong> (<em>dict</em>) – Estimator parameters.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – Estimator instance.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mambular.models.MambaTabRegressor">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mambular.models.</span></span><span class="sig-name descname"><span class="pre">MambaTabRegressor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/mambular/models/mambatab.html#MambaTabRegressor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mambular.models.MambaTabRegressor" title="Permalink to this definition">#</a></dt>
<dd><dl class="simple">
<dt>MambaTab regressor. This class extends the SklearnBaseRegressor class and uses the MambaTab model</dt><dd><p>with the default MambaTab configuration.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The parameters for this class include the attributes from the config
dataclass as well as preprocessing arguments handled by the base class.</p>
<p>Configuration class for the Default MambaTab model with predefined hyperparameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lr</strong> (<em>float</em><em>, </em><em>default=1e-04</em>) – Learning rate for the optimizer.</p></li>
<li><p><strong>lr_patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement after which the learning rate will be reduced.</p></li>
<li><p><strong>weight_decay</strong> (<em>float</em><em>, </em><em>default=1e-06</em>) – Weight decay (L2 regularization) for the optimizer.</p></li>
<li><p><strong>lr_factor</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Factor by which the learning rate will be reduced.</p></li>
<li><p><strong>d_model</strong> (<em>int</em><em>, </em><em>default=64</em>) – Dimensionality of the model.</p></li>
<li><p><strong>n_layers</strong> (<em>int</em><em>, </em><em>default=1</em>) – Number of layers in the model.</p></li>
<li><p><strong>expand_factor</strong> (<em>int</em><em>, </em><em>default=2</em>) – Expansion factor for the feed-forward layers.</p></li>
<li><p><strong>bias</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use bias in the linear layers.</p></li>
<li><p><strong>d_conv</strong> (<em>int</em><em>, </em><em>default=16</em>) – Dimensionality of the convolutional layers.</p></li>
<li><p><strong>conv_bias</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to use bias in the convolutional layers.</p></li>
<li><p><strong>dropout</strong> (<em>float</em><em>, </em><em>default=0.05</em>) – Dropout rate for regularization.</p></li>
<li><p><strong>dt_rank</strong> (<em>str</em><em>, </em><em>default=&quot;auto&quot;</em>) – Rank of the decision tree used in the model.</p></li>
<li><p><strong>d_state</strong> (<em>int</em><em>, </em><em>default=128</em>) – Dimensionality of the state in recurrent layers.</p></li>
<li><p><strong>dt_scale</strong> (<em>float</em><em>, </em><em>default=1.0</em>) – Scaling factor for the decision tree.</p></li>
<li><p><strong>dt_init</strong> (<em>str</em><em>, </em><em>default=&quot;random&quot;</em>) – Initialization method for the decision tree.</p></li>
<li><p><strong>dt_max</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Maximum value for decision tree initialization.</p></li>
<li><p><strong>dt_min</strong> (<em>float</em><em>, </em><em>default=1e-04</em>) – Minimum value for decision tree initialization.</p></li>
<li><p><strong>dt_init_floor</strong> (<em>float</em><em>, </em><em>default=1e-04</em>) – Floor value for decision tree initialization.</p></li>
<li><p><strong>activation</strong> (<em>callable</em><em>, </em><em>default=nn.ReLU</em><em>(</em><em>)</em>) – Activation function for the model.</p></li>
<li><p><strong>axis</strong> (<em>int</em><em>, </em><em>default=1</em>) – Axis along which operations are applied, if applicable.</p></li>
<li><p><strong>num_embedding_activation</strong> (<em>callable</em><em>, </em><em>default=nn.ReLU</em><em>(</em><em>)</em>) – Activation function for numerical embeddings.</p></li>
<li><p><strong>embedding_type</strong> (<em>str</em><em>, </em><em>default=&quot;linear&quot;</em>) – Type of embedding to use (‘linear’, etc.).</p></li>
<li><p><strong>embedding_bias</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use bias in the embedding layers.</p></li>
<li><p><strong>plr_lite</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use a lightweight version of Piecewise Linear Regression (PLR).</p></li>
<li><p><strong>n_frequencies</strong> (<em>int</em><em>, </em><em>default=48</em>) – Number of frequencies for PLR embeddings.</p></li>
<li><p><strong>frequencies_init_scale</strong> (<em>float</em><em>, </em><em>default=0.01</em>) – Initial scale for frequency parameters in embeddings.</p></li>
<li><p><strong>head_layer_sizes</strong> (<em>list</em><em>, </em><em>default=</em><em>(</em><em>)</em>) – Sizes of the fully connected layers in the model’s head.</p></li>
<li><p><strong>head_dropout</strong> (<em>float</em><em>, </em><em>default=0.0</em>) – Dropout rate for the head layers.</p></li>
<li><p><strong>head_skip_layers</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to skip layers in the head.</p></li>
<li><p><strong>head_activation</strong> (<em>callable</em><em>, </em><em>default=nn.ReLU</em><em>(</em><em>)</em>) – Activation function for the head layers.</p></li>
<li><p><strong>head_use_batch_norm</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use batch normalization in the head layers.</p></li>
<li><p><strong>norm</strong> (<em>str</em><em>, </em><em>default=&quot;LayerNorm&quot;</em>) – Type of normalization to be used (‘LayerNorm’, ‘RMSNorm’, etc.).</p></li>
<li><p><strong>use_pscan</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use PSCAN for the state-space model.</p></li>
<li><p><strong>mamba_version</strong> (<em>str</em><em>, </em><em>default=&quot;mamba-torch&quot;</em>) – Version of the Mamba model to use (‘mamba-torch’, ‘mamba1’, ‘mamba2’).</p></li>
<li><p><strong>bidirectional</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to process data bidirectionally.</p></li>
<li><p><strong>n_bins</strong> (<em>int</em><em>, </em><em>default=50</em>) – The number of bins to use for numerical feature binning. This parameter is relevant
only if <code class="docutils literal notranslate"><span class="pre">numerical_preprocessing</span></code> is set to ‘binning’, ‘ple’ or ‘one-hot’.</p></li>
<li><p><strong>numerical_preprocessing</strong> (<em>str</em><em>, </em><em>default=&quot;ple&quot;</em>) – The preprocessing strategy for numerical features. Valid options are
‘ple’, ‘binning’, ‘one-hot’, ‘standardization’, ‘min-max’, ‘quantile’, ‘polynomial’,
‘splines’, ‘box-cox’, ‘yeo-johnson’ and None</p></li>
<li><p><strong>categorical_preprocessing</strong> (<em>str</em><em>, </em><em>default=&quot;int&quot;</em>) – The preprocessing strategy for categorical features. Valid options are
‘int’, ‘one-hot’, None</p></li>
<li><p><strong>use_decision_tree_bins</strong> (<em>bool</em><em>, </em><em>default=False</em>) – If True, uses decision tree regression/classification to determine
optimal bin edges for numerical feature binning. This parameter is
relevant only if <code class="docutils literal notranslate"><span class="pre">numerical_preprocessing</span></code> is set to ‘binning’ or ‘one-hot’.</p></li>
<li><p><strong>binning_strategy</strong> (<em>str</em><em>, </em><em>default=&quot;uniform&quot;</em>) – Defines the strategy for binning numerical features. Options include ‘uniform’,
‘quantile’, or other sklearn-compatible strategies.</p></li>
<li><p><strong>task</strong> (<em>str</em><em>, </em><em>default=&quot;regression&quot;</em>) – Indicates the type of machine learning task (‘regression’ or ‘classification’). This can
influence certain preprocessing behaviors, especially when using decision tree-based binning.</p></li>
<li><p><strong>cat_cutoff</strong> (<em>float</em><em> or </em><em>int</em><em>, </em><em>default=0.03</em>) – Indicates the cutoff after which integer values are treated as categorical.
If float, it’s treated as a percentage. If int, it’s the maximum number of
unique values for a column to be considered categorical.</p></li>
<li><p><strong>treat_all_integers_as_numerical</strong> (<em>bool</em><em>, </em><em>default=False</em>) – If True, all integer columns will be treated as numerical, regardless
of their unique value count or proportion.</p></li>
<li><p><strong>degree</strong> (<em>int</em><em>, </em><em>default=3</em>) – The degree of the polynomial features to be used in preprocessing.</p></li>
<li><p><strong>knots</strong> (<em>int</em><em>, </em><em>default=12</em>) – The number of knots to be used in spline transformations.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.MambaTabRegressor.build_model">
<span class="sig-name descname"><span class="pre">build_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">101</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_patience</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_decay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataloader_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.MambaTabRegressor.build_model" title="Permalink to this definition">#</a></dt>
<dd><p>Builds the model using the provided training data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The training input samples.</p></li>
<li><p><strong>y</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em>) – The target values (real numbers).</p></li>
<li><p><strong>val_size</strong> (<em>float</em><em>, </em><em>default=0.2</em>) – The proportion of the dataset to include in the validation split if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is None. Ignored if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>X_val</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em><em>, </em><em>optional</em>) – The validation input samples. If provided, <code class="docutils literal notranslate"><span class="pre">X</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> are not split and this data is used for validation.</p></li>
<li><p><strong>y_val</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em><em>, </em><em>optional</em>) – The validation target values. Required if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>random_state</strong> (<em>int</em><em>, </em><em>default=101</em>) – Controls the shuffling applied to the data before applying the split.</p></li>
<li><p><strong>batch_size</strong> (<em>int</em><em>, </em><em>default=64</em>) – Number of samples per gradient update.</p></li>
<li><p><strong>shuffle</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to shuffle the training data before each epoch.</p></li>
<li><p><strong>lr</strong> (<em>float</em><em>, </em><em>default=1e-3</em>) – Learning rate for the optimizer.</p></li>
<li><p><strong>lr_patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement on the validation loss to wait before reducing the learning rate.</p></li>
<li><p><strong>factor</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Factor by which the learning rate will be reduced.</p></li>
<li><p><strong>weight_decay</strong> (<em>float</em><em>, </em><em>default=0.025</em>) – Weight decay (L2 penalty) coefficient.</p></li>
<li><p><strong>dataloader_kwargs</strong> (<em>dict</em><em>, </em><em>default={}</em>) – The kwargs for the pytorch dataloader class.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – The built regressor.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.MambaTabRegressor.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.MambaTabRegressor.evaluate" title="Permalink to this definition">#</a></dt>
<dd><p>Evaluate the model on the given data using specified metrics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array-like</em><em> or </em><em>pd.DataFrame</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The input samples to predict.</p></li>
<li><p><strong>y_true</strong> (<em>array-like</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_outputs</em><em>)</em>) – The true target values against which to evaluate the predictions.</p></li>
<li><p><strong>metrics</strong> (<em>dict</em>) – A dictionary where keys are metric names and values are the metric functions.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This method uses the <code class="docutils literal notranslate"><span class="pre">predict</span></code> method to generate predictions and computes each metric.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_squared_error</span><span class="p">,</span> <span class="n">r2_score</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mambular.models</span> <span class="kn">import</span> <span class="n">MambularRegressor</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">metrics</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">... </span>    <span class="s1">&#39;Mean Squared Error&#39;</span><span class="p">:</span> <span class="n">mean_squared_error</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s1">&#39;R2 Score&#39;</span><span class="p">:</span> <span class="n">r2_score</span>
<span class="gp">... </span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Assuming &#39;X_test&#39; and &#39;y_test&#39; are your test dataset and labels</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Evaluate using the specified metrics</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results</span> <span class="o">=</span> <span class="n">regressor</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="n">metrics</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>scores</strong> – A dictionary with metric names as keys and their corresponding scores as values.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.MambaTabRegressor.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">101</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patience</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">15</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">monitor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'val_loss'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'min'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_patience</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_decay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checkpoint_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'model_checkpoints'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataloader_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rebuild</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">trainer_kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.MambaTabRegressor.fit" title="Permalink to this definition">#</a></dt>
<dd><p>Trains the regression model using the provided training data. Optionally, a separate validation set can be used.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The training input samples.</p></li>
<li><p><strong>y</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em>) – The target values (real numbers).</p></li>
<li><p><strong>val_size</strong> (<em>float</em><em>, </em><em>default=0.2</em>) – The proportion of the dataset to include in the validation split if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is None. Ignored if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>X_val</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em><em>, </em><em>optional</em>) – The validation input samples. If provided, <code class="docutils literal notranslate"><span class="pre">X</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> are not split and this data is used for validation.</p></li>
<li><p><strong>y_val</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em><em>, </em><em>optional</em>) – The validation target values. Required if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>max_epochs</strong> (<em>int</em><em>, </em><em>default=100</em>) – Maximum number of epochs for training.</p></li>
<li><p><strong>random_state</strong> (<em>int</em><em>, </em><em>default=101</em>) – Controls the shuffling applied to the data before applying the split.</p></li>
<li><p><strong>batch_size</strong> (<em>int</em><em>, </em><em>default=64</em>) – Number of samples per gradient update.</p></li>
<li><p><strong>shuffle</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to shuffle the training data before each epoch.</p></li>
<li><p><strong>patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement on the validation loss to wait before early stopping.</p></li>
<li><p><strong>monitor</strong> (<em>str</em><em>, </em><em>default=&quot;val_loss&quot;</em>) – The metric to monitor for early stopping.</p></li>
<li><p><strong>mode</strong> (<em>str</em><em>, </em><em>default=&quot;min&quot;</em>) – Whether the monitored metric should be minimized (<code class="docutils literal notranslate"><span class="pre">min</span></code>) or maximized (<code class="docutils literal notranslate"><span class="pre">max</span></code>).</p></li>
<li><p><strong>lr</strong> (<em>float</em><em>, </em><em>default=1e-3</em>) – Learning rate for the optimizer.</p></li>
<li><p><strong>lr_patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement on the validation loss to wait before reducing the learning rate.</p></li>
<li><p><strong>factor</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Factor by which the learning rate will be reduced.</p></li>
<li><p><strong>weight_decay</strong> (<em>float</em><em>, </em><em>default=0.025</em>) – Weight decay (L2 penalty) coefficient.</p></li>
<li><p><strong>checkpoint_path</strong> (<em>str</em><em>, </em><em>default=&quot;model_checkpoints&quot;</em>) – Path where the checkpoints are being saved.</p></li>
<li><p><strong>dataloader_kwargs</strong> (<em>dict</em><em>, </em><em>default={}</em>) – The kwargs for the pytorch dataloader class.</p></li>
<li><p><strong>**trainer_kwargs</strong> (<em>Additional keyword arguments for PyTorch Lightning's Trainer class.</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – The fitted regressor.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.MambaTabRegressor.get_number_of_params">
<span class="sig-name descname"><span class="pre">get_number_of_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">requires_grad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.MambaTabRegressor.get_number_of_params" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate the number of parameters in the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>requires_grad</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, only count the parameters that require gradients (trainable parameters).
If False, count all parameters. Default is True.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The total number of parameters in the model.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the model has not been built prior to calling this method.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.MambaTabRegressor.get_params">
<span class="sig-name descname"><span class="pre">get_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">deep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.MambaTabRegressor.get_params" title="Permalink to this definition">#</a></dt>
<dd><p>Get parameters for this estimator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>deep</strong> (<em>bool</em><em>, </em><em>default=True</em>) – If True, will return the parameters for this estimator and contained subobjects that are estimators.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>params</strong> – Parameter names mapped to their values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.MambaTabRegressor.optimize_hparams">
<span class="sig-name descname"><span class="pre">optimize_hparams</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prune_by_epoch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prune_epoch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fixed_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'cat_encoding':</span> <span class="pre">'int',</span> <span class="pre">'head_layer_size_length':</span> <span class="pre">0,</span> <span class="pre">'head_skip_layer':</span> <span class="pre">False,</span> <span class="pre">'head_skip_layers':</span> <span class="pre">False,</span> <span class="pre">'pooling_method':</span> <span class="pre">'avg',</span> <span class="pre">'use_cls':</span> <span class="pre">False}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">custom_search_space</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">optimize_kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.MambaTabRegressor.optimize_hparams" title="Permalink to this definition">#</a></dt>
<dd><p>Optimizes hyperparameters using Bayesian optimization with optional pruning.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array-like</em>) – Training data.</p></li>
<li><p><strong>y</strong> (<em>array-like</em>) – Training labels.</p></li>
<li><p><strong>X_val</strong> (<em>array-like</em><em>, </em><em>optional</em>) – Validation data and labels.</p></li>
<li><p><strong>y_val</strong> (<em>array-like</em><em>, </em><em>optional</em>) – Validation data and labels.</p></li>
<li><p><strong>time</strong> (<em>int</em>) – The number of optimization trials to run.</p></li>
<li><p><strong>max_epochs</strong> (<em>int</em>) – Maximum number of epochs for training.</p></li>
<li><p><strong>prune_by_epoch</strong> (<em>bool</em>) – Whether to prune based on a specific epoch (True) or the best validation loss (False).</p></li>
<li><p><strong>prune_epoch</strong> (<em>int</em>) – The specific epoch to prune by when prune_by_epoch is True.</p></li>
<li><p><strong>**optimize_kwargs</strong> (<em>dict</em>) – Additional keyword arguments passed to the fit method.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>best_hparams</strong> – Best hyperparameters found during optimization.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.MambaTabRegressor.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.MambaTabRegressor.predict" title="Permalink to this definition">#</a></dt>
<dd><p>Predicts target values for the given input samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>X</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The input samples for which to predict target values.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>predictions</strong> – The predicted target values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray, shape (n_samples,) or (n_samples, n_outputs)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.MambaTabRegressor.score">
<span class="sig-name descname"><span class="pre">score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">sklearn.metrics.mean_squared_error</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.MambaTabRegressor.score" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate the score of the model using the specified metric.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array-like</em><em> or </em><em>pd.DataFrame</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The input samples to predict.</p></li>
<li><p><strong>y</strong> (<em>array-like</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_outputs</em><em>)</em>) – The true target values against which to evaluate the predictions.</p></li>
<li><p><strong>metric</strong> (<em>callable</em><em>, </em><em>default=mean_squared_error</em>) – The metric function to use for evaluation. Must be a callable with the signature <code class="docutils literal notranslate"><span class="pre">metric(y_true,</span> <span class="pre">y_pred)</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>score</strong> – The score calculated using the specified metric.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.MambaTabRegressor.set_params">
<span class="sig-name descname"><span class="pre">set_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">parameters</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.MambaTabRegressor.set_params" title="Permalink to this definition">#</a></dt>
<dd><p>Set the parameters of this estimator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>**parameters</strong> (<em>dict</em>) – Estimator parameters.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – Estimator instance.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mambular.models.MambaTabLSS">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mambular.models.</span></span><span class="sig-name descname"><span class="pre">MambaTabLSS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/mambular/models/mambatab.html#MambaTabLSS"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mambular.models.MambaTabLSS" title="Permalink to this definition">#</a></dt>
<dd><dl class="simple">
<dt>MambaTab LSS for distributional regression. This class extends the SklearnBaseLSS class and uses the MambaTab model</dt><dd><p>with the default MambaTab configuration.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The parameters for this class include the attributes from the config
dataclass as well as preprocessing arguments handled by the base class.</p>
<p>Configuration class for the Default MambaTab model with predefined hyperparameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lr</strong> (<em>float</em><em>, </em><em>default=1e-04</em>) – Learning rate for the optimizer.</p></li>
<li><p><strong>lr_patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement after which the learning rate will be reduced.</p></li>
<li><p><strong>weight_decay</strong> (<em>float</em><em>, </em><em>default=1e-06</em>) – Weight decay (L2 regularization) for the optimizer.</p></li>
<li><p><strong>lr_factor</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Factor by which the learning rate will be reduced.</p></li>
<li><p><strong>d_model</strong> (<em>int</em><em>, </em><em>default=64</em>) – Dimensionality of the model.</p></li>
<li><p><strong>n_layers</strong> (<em>int</em><em>, </em><em>default=1</em>) – Number of layers in the model.</p></li>
<li><p><strong>expand_factor</strong> (<em>int</em><em>, </em><em>default=2</em>) – Expansion factor for the feed-forward layers.</p></li>
<li><p><strong>bias</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use bias in the linear layers.</p></li>
<li><p><strong>d_conv</strong> (<em>int</em><em>, </em><em>default=16</em>) – Dimensionality of the convolutional layers.</p></li>
<li><p><strong>conv_bias</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to use bias in the convolutional layers.</p></li>
<li><p><strong>dropout</strong> (<em>float</em><em>, </em><em>default=0.05</em>) – Dropout rate for regularization.</p></li>
<li><p><strong>dt_rank</strong> (<em>str</em><em>, </em><em>default=&quot;auto&quot;</em>) – Rank of the decision tree used in the model.</p></li>
<li><p><strong>d_state</strong> (<em>int</em><em>, </em><em>default=128</em>) – Dimensionality of the state in recurrent layers.</p></li>
<li><p><strong>dt_scale</strong> (<em>float</em><em>, </em><em>default=1.0</em>) – Scaling factor for the decision tree.</p></li>
<li><p><strong>dt_init</strong> (<em>str</em><em>, </em><em>default=&quot;random&quot;</em>) – Initialization method for the decision tree.</p></li>
<li><p><strong>dt_max</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Maximum value for decision tree initialization.</p></li>
<li><p><strong>dt_min</strong> (<em>float</em><em>, </em><em>default=1e-04</em>) – Minimum value for decision tree initialization.</p></li>
<li><p><strong>dt_init_floor</strong> (<em>float</em><em>, </em><em>default=1e-04</em>) – Floor value for decision tree initialization.</p></li>
<li><p><strong>activation</strong> (<em>callable</em><em>, </em><em>default=nn.ReLU</em><em>(</em><em>)</em>) – Activation function for the model.</p></li>
<li><p><strong>axis</strong> (<em>int</em><em>, </em><em>default=1</em>) – Axis along which operations are applied, if applicable.</p></li>
<li><p><strong>num_embedding_activation</strong> (<em>callable</em><em>, </em><em>default=nn.ReLU</em><em>(</em><em>)</em>) – Activation function for numerical embeddings.</p></li>
<li><p><strong>embedding_type</strong> (<em>str</em><em>, </em><em>default=&quot;linear&quot;</em>) – Type of embedding to use (‘linear’, etc.).</p></li>
<li><p><strong>embedding_bias</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use bias in the embedding layers.</p></li>
<li><p><strong>plr_lite</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use a lightweight version of Piecewise Linear Regression (PLR).</p></li>
<li><p><strong>n_frequencies</strong> (<em>int</em><em>, </em><em>default=48</em>) – Number of frequencies for PLR embeddings.</p></li>
<li><p><strong>frequencies_init_scale</strong> (<em>float</em><em>, </em><em>default=0.01</em>) – Initial scale for frequency parameters in embeddings.</p></li>
<li><p><strong>head_layer_sizes</strong> (<em>list</em><em>, </em><em>default=</em><em>(</em><em>)</em>) – Sizes of the fully connected layers in the model’s head.</p></li>
<li><p><strong>head_dropout</strong> (<em>float</em><em>, </em><em>default=0.0</em>) – Dropout rate for the head layers.</p></li>
<li><p><strong>head_skip_layers</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to skip layers in the head.</p></li>
<li><p><strong>head_activation</strong> (<em>callable</em><em>, </em><em>default=nn.ReLU</em><em>(</em><em>)</em>) – Activation function for the head layers.</p></li>
<li><p><strong>head_use_batch_norm</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use batch normalization in the head layers.</p></li>
<li><p><strong>norm</strong> (<em>str</em><em>, </em><em>default=&quot;LayerNorm&quot;</em>) – Type of normalization to be used (‘LayerNorm’, ‘RMSNorm’, etc.).</p></li>
<li><p><strong>use_pscan</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use PSCAN for the state-space model.</p></li>
<li><p><strong>mamba_version</strong> (<em>str</em><em>, </em><em>default=&quot;mamba-torch&quot;</em>) – Version of the Mamba model to use (‘mamba-torch’, ‘mamba1’, ‘mamba2’).</p></li>
<li><p><strong>bidirectional</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to process data bidirectionally.</p></li>
<li><p><strong>n_bins</strong> (<em>int</em><em>, </em><em>default=50</em>) – The number of bins to use for numerical feature binning. This parameter is relevant
only if <code class="docutils literal notranslate"><span class="pre">numerical_preprocessing</span></code> is set to ‘binning’, ‘ple’ or ‘one-hot’.</p></li>
<li><p><strong>numerical_preprocessing</strong> (<em>str</em><em>, </em><em>default=&quot;ple&quot;</em>) – The preprocessing strategy for numerical features. Valid options are
‘ple’, ‘binning’, ‘one-hot’, ‘standardization’, ‘min-max’, ‘quantile’, ‘polynomial’,
‘splines’, ‘box-cox’, ‘yeo-johnson’ and None</p></li>
<li><p><strong>categorical_preprocessing</strong> (<em>str</em><em>, </em><em>default=&quot;int&quot;</em>) – The preprocessing strategy for categorical features. Valid options are
‘int’, ‘one-hot’, None</p></li>
<li><p><strong>use_decision_tree_bins</strong> (<em>bool</em><em>, </em><em>default=False</em>) – If True, uses decision tree regression/classification to determine
optimal bin edges for numerical feature binning. This parameter is
relevant only if <code class="docutils literal notranslate"><span class="pre">numerical_preprocessing</span></code> is set to ‘binning’ or ‘one-hot’.</p></li>
<li><p><strong>binning_strategy</strong> (<em>str</em><em>, </em><em>default=&quot;uniform&quot;</em>) – Defines the strategy for binning numerical features. Options include ‘uniform’,
‘quantile’, or other sklearn-compatible strategies.</p></li>
<li><p><strong>task</strong> (<em>str</em><em>, </em><em>default=&quot;regression&quot;</em>) – Indicates the type of machine learning task (‘regression’ or ‘classification’). This can
influence certain preprocessing behaviors, especially when using decision tree-based binning.</p></li>
<li><p><strong>cat_cutoff</strong> (<em>float</em><em> or </em><em>int</em><em>, </em><em>default=0.03</em>) – Indicates the cutoff after which integer values are treated as categorical.
If float, it’s treated as a percentage. If int, it’s the maximum number of
unique values for a column to be considered categorical.</p></li>
<li><p><strong>treat_all_integers_as_numerical</strong> (<em>bool</em><em>, </em><em>default=False</em>) – If True, all integer columns will be treated as numerical, regardless
of their unique value count or proportion.</p></li>
<li><p><strong>degree</strong> (<em>int</em><em>, </em><em>default=3</em>) – The degree of the polynomial features to be used in preprocessing.</p></li>
<li><p><strong>knots</strong> (<em>int</em><em>, </em><em>default=12</em>) – The number of knots to be used in spline transformations.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.MambaTabLSS.build_model">
<span class="sig-name descname"><span class="pre">build_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">101</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_patience</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_decay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataloader_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.MambaTabLSS.build_model" title="Permalink to this definition">#</a></dt>
<dd><p>Builds the model using the provided training data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The training input samples.</p></li>
<li><p><strong>y</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em>) – The target values (real numbers).</p></li>
<li><p><strong>val_size</strong> (<em>float</em><em>, </em><em>default=0.2</em>) – The proportion of the dataset to include in the validation split if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is None. Ignored if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>X_val</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em><em>, </em><em>optional</em>) – The validation input samples. If provided, <code class="docutils literal notranslate"><span class="pre">X</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> are not split and this data is used for validation.</p></li>
<li><p><strong>y_val</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em><em>, </em><em>optional</em>) – The validation target values. Required if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>random_state</strong> (<em>int</em><em>, </em><em>default=101</em>) – Controls the shuffling applied to the data before applying the split.</p></li>
<li><p><strong>batch_size</strong> (<em>int</em><em>, </em><em>default=64</em>) – Number of samples per gradient update.</p></li>
<li><p><strong>shuffle</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to shuffle the training data before each epoch.</p></li>
<li><p><strong>lr</strong> (<em>float</em><em>, </em><em>default=1e-3</em>) – Learning rate for the optimizer.</p></li>
<li><p><strong>lr_patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement on the validation loss to wait before reducing the learning rate.</p></li>
<li><p><strong>factor</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Factor by which the learning rate will be reduced.</p></li>
<li><p><strong>weight_decay</strong> (<em>float</em><em>, </em><em>default=0.025</em>) – Weight decay (L2 penalty) coefficient.</p></li>
<li><p><strong>dataloader_kwargs</strong> (<em>dict</em><em>, </em><em>default={}</em>) – The kwargs for the pytorch dataloader class.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – The built distributional regressor.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.MambaTabLSS.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distribution_family</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.MambaTabLSS.evaluate" title="Permalink to this definition">#</a></dt>
<dd><p>Evaluate the model on the given data using specified metrics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array-like</em><em> or </em><em>pd.DataFrame</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The input samples to predict.</p></li>
<li><p><strong>y_true</strong> (<em>array-like</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>)</em>) – The true class labels against which to evaluate the predictions.</p></li>
<li><p><strong>metrics</strong> (<em>dict</em>) – A dictionary where keys are metric names and values are tuples containing the metric function
and a boolean indicating whether the metric requires probability scores (True) or class labels (False).</p></li>
<li><p><strong>distribution_family</strong> (<em>str</em><em>, </em><em>optional</em>) – Specifies the distribution family the model is predicting for. If None, it will attempt to infer based
on the model’s settings.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>scores</strong> – A dictionary with metric names as keys and their corresponding scores as values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This method uses either the <code class="docutils literal notranslate"><span class="pre">predict</span></code> or <code class="docutils literal notranslate"><span class="pre">predict_proba</span></code> method depending on the metric requirements.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.MambaTabLSS.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">family</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">101</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patience</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">15</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">monitor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'val_loss'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'min'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_patience</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_decay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checkpoint_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'model_checkpoints'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distributional_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataloader_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rebuild</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">trainer_kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.MambaTabLSS.fit" title="Permalink to this definition">#</a></dt>
<dd><p>Trains the regression model using the provided training data. Optionally, a separate validation set can be used.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The training input samples.</p></li>
<li><p><strong>y</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em>) – The target values (real numbers).</p></li>
<li><p><strong>family</strong> (<em>str</em>) – The name of the distribution family to use for the loss function. Examples include ‘normal’ for regression tasks.</p></li>
<li><p><strong>val_size</strong> (<em>float</em><em>, </em><em>default=0.2</em>) – The proportion of the dataset to include in the validation split if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is None. Ignored if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>X_val</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em><em>, </em><em>optional</em>) – The validation input samples. If provided, <code class="docutils literal notranslate"><span class="pre">X</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> are not split and this data is used for validation.</p></li>
<li><p><strong>y_val</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em><em>, </em><em>optional</em>) – The validation target values. Required if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>max_epochs</strong> (<em>int</em><em>, </em><em>default=100</em>) – Maximum number of epochs for training.</p></li>
<li><p><strong>random_state</strong> (<em>int</em><em>, </em><em>default=101</em>) – Controls the shuffling applied to the data before applying the split.</p></li>
<li><p><strong>batch_size</strong> (<em>int</em><em>, </em><em>default=64</em>) – Number of samples per gradient update.</p></li>
<li><p><strong>shuffle</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to shuffle the training data before each epoch.</p></li>
<li><p><strong>patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement on the validation loss to wait before early stopping.</p></li>
<li><p><strong>monitor</strong> (<em>str</em><em>, </em><em>default=&quot;val_loss&quot;</em>) – The metric to monitor for early stopping.</p></li>
<li><p><strong>mode</strong> (<em>str</em><em>, </em><em>default=&quot;min&quot;</em>) – Whether the monitored metric should be minimized (<code class="docutils literal notranslate"><span class="pre">min</span></code>) or maximized (<code class="docutils literal notranslate"><span class="pre">max</span></code>).</p></li>
<li><p><strong>lr</strong> (<em>float</em><em>, </em><em>default=1e-3</em>) – Learning rate for the optimizer.</p></li>
<li><p><strong>lr_patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement on the validation loss to wait before reducing the learning rate.</p></li>
<li><p><strong>factor</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Factor by which the learning rate will be reduced.</p></li>
<li><p><strong>weight_decay</strong> (<em>float</em><em>, </em><em>default=0.025</em>) – Weight decay (L2 penalty) coefficient.</p></li>
<li><p><strong>distributional_kwargs</strong> (<em>dict</em><em>, </em><em>default=None</em>) – any arguments taht are specific for a certain distribution.</p></li>
<li><p><strong>checkpoint_path</strong> (<em>str</em><em>, </em><em>default=&quot;model_checkpoints&quot;</em>) – Path where the checkpoints are being saved.</p></li>
<li><p><strong>dataloader_kwargs</strong> (<em>dict</em><em>, </em><em>default={}</em>) – The kwargs for the pytorch dataloader class.</p></li>
<li><p><strong>**trainer_kwargs</strong> (<em>Additional keyword arguments for PyTorch Lightning's Trainer class.</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – The fitted regressor.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.MambaTabLSS.get_default_metrics">
<span class="sig-name descname"><span class="pre">get_default_metrics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">distribution_family</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.MambaTabLSS.get_default_metrics" title="Permalink to this definition">#</a></dt>
<dd><p>Provides default metrics based on the distribution family.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>distribution_family</strong> (<em>str</em>) – The distribution family for which to provide default metrics.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>metrics</strong> – A dictionary of default metric functions.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.MambaTabLSS.get_number_of_params">
<span class="sig-name descname"><span class="pre">get_number_of_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">requires_grad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.MambaTabLSS.get_number_of_params" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate the number of parameters in the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>requires_grad</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, only count the parameters that require gradients (trainable parameters).
If False, count all parameters. Default is True.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The total number of parameters in the model.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the model has not been built prior to calling this method.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.MambaTabLSS.get_params">
<span class="sig-name descname"><span class="pre">get_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">deep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.MambaTabLSS.get_params" title="Permalink to this definition">#</a></dt>
<dd><p>Get parameters for this estimator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>deep</strong> (<em>bool</em><em>, </em><em>default=True</em>) – If True, will return the parameters for this estimator and contained subobjects that are estimators.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>params</strong> – Parameter names mapped to their values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.MambaTabLSS.optimize_hparams">
<span class="sig-name descname"><span class="pre">optimize_hparams</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prune_by_epoch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prune_epoch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fixed_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'cat_encoding':</span> <span class="pre">'int',</span> <span class="pre">'head_layer_size_length':</span> <span class="pre">0,</span> <span class="pre">'head_skip_layer':</span> <span class="pre">False,</span> <span class="pre">'head_skip_layers':</span> <span class="pre">False,</span> <span class="pre">'pooling_method':</span> <span class="pre">'avg',</span> <span class="pre">'use_cls':</span> <span class="pre">False}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">custom_search_space</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">optimize_kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.MambaTabLSS.optimize_hparams" title="Permalink to this definition">#</a></dt>
<dd><p>Optimizes hyperparameters using Bayesian optimization with optional pruning.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array-like</em>) – Training data.</p></li>
<li><p><strong>y</strong> (<em>array-like</em>) – Training labels.</p></li>
<li><p><strong>X_val</strong> (<em>array-like</em><em>, </em><em>optional</em>) – Validation data and labels.</p></li>
<li><p><strong>y_val</strong> (<em>array-like</em><em>, </em><em>optional</em>) – Validation data and labels.</p></li>
<li><p><strong>time</strong> (<em>int</em>) – The number of optimization trials to run.</p></li>
<li><p><strong>max_epochs</strong> (<em>int</em>) – Maximum number of epochs for training.</p></li>
<li><p><strong>prune_by_epoch</strong> (<em>bool</em>) – Whether to prune based on a specific epoch (True) or the best validation loss (False).</p></li>
<li><p><strong>prune_epoch</strong> (<em>int</em>) – The specific epoch to prune by when prune_by_epoch is True.</p></li>
<li><p><strong>**optimize_kwargs</strong> (<em>dict</em>) – Additional keyword arguments passed to the fit method.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>best_hparams</strong> – Best hyperparameters found during optimization.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.MambaTabLSS.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">raw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.MambaTabLSS.predict" title="Permalink to this definition">#</a></dt>
<dd><p>Predicts target values for the given input samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>X</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The input samples for which to predict target values.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>predictions</strong> – The predicted target values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray, shape (n_samples,) or (n_samples, n_outputs)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.MambaTabLSS.score">
<span class="sig-name descname"><span class="pre">score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'NLL'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.MambaTabLSS.score" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate the score of the model using the specified metric.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array-like</em><em> or </em><em>pd.DataFrame</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The input samples to predict.</p></li>
<li><p><strong>y</strong> (<em>array-like</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_outputs</em><em>)</em>) – The true target values against which to evaluate the predictions.</p></li>
<li><p><strong>metric</strong> (<em>str</em><em>, </em><em>default=&quot;NLL&quot;</em>) – So far, only negative log-likelihood is supported</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>score</strong> – The score calculated using the specified metric.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.MambaTabLSS.set_params">
<span class="sig-name descname"><span class="pre">set_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">parameters</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.MambaTabLSS.set_params" title="Permalink to this definition">#</a></dt>
<dd><p>Set the parameters of this estimator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>**parameters</strong> (<em>dict</em>) – Estimator parameters.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – Estimator instance.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mambular.models.MambAttentionClassifier">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mambular.models.</span></span><span class="sig-name descname"><span class="pre">MambAttentionClassifier</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/mambular/models/mambattention.html#MambAttentionClassifier"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mambular.models.MambAttentionClassifier" title="Permalink to this definition">#</a></dt>
<dd><dl class="simple">
<dt>MambAttention classifier. This class extends the SklearnBaseClassifier class and uses the MambAttention model</dt><dd><p>with the default MambAttention configuration.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The parameters for this class include the attributes from the config
dataclass as well as preprocessing arguments handled by the base class.</p>
<p>Configuration class for the Default Mambular Attention model with predefined hyperparameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lr</strong> (<em>float</em><em>, </em><em>default=1e-04</em>) – Learning rate for the optimizer.</p></li>
<li><p><strong>lr_patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement after which learning rate will be reduced.</p></li>
<li><p><strong>weight_decay</strong> (<em>float</em><em>, </em><em>default=1e-06</em>) – Weight decay (L2 penalty) for the optimizer.</p></li>
<li><p><strong>lr_factor</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Factor by which the learning rate will be reduced.</p></li>
<li><p><strong>d_model</strong> (<em>int</em><em>, </em><em>default=64</em>) – Dimensionality of the model.</p></li>
<li><p><strong>n_layers</strong> (<em>int</em><em>, </em><em>default=4</em>) – Number of layers in the model.</p></li>
<li><p><strong>expand_factor</strong> (<em>int</em><em>, </em><em>default=2</em>) – Expansion factor for the feed-forward layers.</p></li>
<li><p><strong>n_heads</strong> (<em>int</em><em>, </em><em>default=8</em>) – Number of attention heads in the model.</p></li>
<li><p><strong>last_layer</strong> (<em>str</em><em>, </em><em>default=&quot;attn&quot;</em>) – Type of the last layer (e.g., ‘attn’).</p></li>
<li><p><strong>n_mamba_per_attention</strong> (<em>int</em><em>, </em><em>default=1</em>) – Number of Mamba blocks per attention layer.</p></li>
<li><p><strong>bias</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use bias in the linear layers.</p></li>
<li><p><strong>d_conv</strong> (<em>int</em><em>, </em><em>default=4</em>) – Dimensionality of the convolutional layers.</p></li>
<li><p><strong>conv_bias</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to use bias in the convolutional layers.</p></li>
<li><p><strong>dropout</strong> (<em>float</em><em>, </em><em>default=0.0</em>) – Dropout rate for regularization.</p></li>
<li><p><strong>attn_dropout</strong> (<em>float</em><em>, </em><em>default=0.2</em>) – Dropout rate for the attention mechanism.</p></li>
<li><p><strong>dt_rank</strong> (<em>str</em><em>, </em><em>default=&quot;auto&quot;</em>) – Rank of the decision tree.</p></li>
<li><p><strong>d_state</strong> (<em>int</em><em>, </em><em>default=128</em>) – Dimensionality of the state in recurrent layers.</p></li>
<li><p><strong>dt_scale</strong> (<em>float</em><em>, </em><em>default=1.0</em>) – Scaling factor for the decision tree.</p></li>
<li><p><strong>dt_init</strong> (<em>str</em><em>, </em><em>default=&quot;random&quot;</em>) – Initialization method for the decision tree.</p></li>
<li><p><strong>dt_max</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Maximum value for decision tree initialization.</p></li>
<li><p><strong>dt_min</strong> (<em>float</em><em>, </em><em>default=1e-04</em>) – Minimum value for decision tree initialization.</p></li>
<li><p><strong>dt_init_floor</strong> (<em>float</em><em>, </em><em>default=1e-04</em>) – Floor value for decision tree initialization.</p></li>
<li><p><strong>norm</strong> (<em>str</em><em>, </em><em>default=&quot;LayerNorm&quot;</em>) – Type of normalization used in the model.</p></li>
<li><p><strong>activation</strong> (<em>callable</em><em>, </em><em>default=nn.SiLU</em><em>(</em><em>)</em>) – Activation function for the model.</p></li>
<li><p><strong>layer_norm_eps</strong> (<em>float</em><em>, </em><em>default=1e-05</em>) – Epsilon value for layer normalization.</p></li>
<li><p><strong>num_embedding_activation</strong> (<em>callable</em><em>, </em><em>default=nn.ReLU</em><em>(</em><em>)</em>) – Activation function for numerical embeddings.</p></li>
<li><p><strong>embedding_type</strong> (<em>str</em><em>, </em><em>default=&quot;linear&quot;</em>) – Type of embedding to use (‘linear’, etc.).</p></li>
<li><p><strong>embedding_bias</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use bias in the embedding layers.</p></li>
<li><p><strong>plr_lite</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use a lightweight version of Piecewise Linear Regression (PLR).</p></li>
<li><p><strong>n_frequencies</strong> (<em>int</em><em>, </em><em>default=48</em>) – Number of frequencies for PLR embeddings.</p></li>
<li><p><strong>frequencies_init_scale</strong> (<em>float</em><em>, </em><em>default=0.01</em>) – Initial scale for frequency parameters in embeddings.</p></li>
<li><p><strong>layer_norm_after_embedding</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to apply layer normalization after embedding layers.</p></li>
<li><p><strong>head_layer_sizes</strong> (<em>list</em><em>, </em><em>default=</em><em>(</em><em>)</em>) – Sizes of the fully connected layers in the model’s head.</p></li>
<li><p><strong>head_dropout</strong> (<em>float</em><em>, </em><em>default=0.5</em>) – Dropout rate for the head layers.</p></li>
<li><p><strong>head_skip_layers</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use skip connections in the head layers.</p></li>
<li><p><strong>head_activation</strong> (<em>callable</em><em>, </em><em>default=nn.SELU</em><em>(</em><em>)</em>) – Activation function for the head layers.</p></li>
<li><p><strong>head_use_batch_norm</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use batch normalization in the head layers.</p></li>
<li><p><strong>pooling_method</strong> (<em>str</em><em>, </em><em>default=&quot;avg&quot;</em>) – Pooling method to be used (‘avg’, ‘max’, etc.).</p></li>
<li><p><strong>bidirectional</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to process input sequences bidirectionally.</p></li>
<li><p><strong>use_learnable_interaction</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use learnable feature interactions before passing through Mamba blocks.</p></li>
<li><p><strong>use_cls</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to append a CLS token for sequence pooling.</p></li>
<li><p><strong>shuffle_embeddings</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to shuffle embeddings before passing to Mamba layers.</p></li>
<li><p><strong>cat_encoding</strong> (<em>str</em><em>, </em><em>default=&quot;int&quot;</em>) – Encoding method for categorical features (‘int’, ‘one-hot’, etc.).</p></li>
<li><p><strong>AD_weight_decay</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether weight decay is applied to A-D matrices.</p></li>
<li><p><strong>BC_layer_norm</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to apply layer normalization to B-C matrices.</p></li>
<li><p><strong>use_pscan</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use PSCAN for the state-space model.</p></li>
<li><p><strong>n_attention_layers</strong> (<em>int</em><em>, </em><em>default=1</em>) – Number of attention layers in the model.</p></li>
<li><p><strong>n_bins</strong> (<em>int</em><em>, </em><em>default=50</em>) – The number of bins to use for numerical feature binning. This parameter is relevant
only if <code class="docutils literal notranslate"><span class="pre">numerical_preprocessing</span></code> is set to ‘binning’, ‘ple’ or ‘one-hot’.</p></li>
<li><p><strong>numerical_preprocessing</strong> (<em>str</em><em>, </em><em>default=&quot;ple&quot;</em>) – The preprocessing strategy for numerical features. Valid options are
‘ple’, ‘binning’, ‘one-hot’, ‘standardization’, ‘min-max’, ‘quantile’, ‘polynomial’,
‘splines’, ‘box-cox’, ‘yeo-johnson’ and None</p></li>
<li><p><strong>categorical_preprocessing</strong> (<em>str</em><em>, </em><em>default=&quot;int&quot;</em>) – The preprocessing strategy for categorical features. Valid options are
‘int’, ‘one-hot’, None</p></li>
<li><p><strong>use_decision_tree_bins</strong> (<em>bool</em><em>, </em><em>default=False</em>) – If True, uses decision tree regression/classification to determine
optimal bin edges for numerical feature binning. This parameter is
relevant only if <code class="docutils literal notranslate"><span class="pre">numerical_preprocessing</span></code> is set to ‘binning’ or ‘one-hot’.</p></li>
<li><p><strong>binning_strategy</strong> (<em>str</em><em>, </em><em>default=&quot;uniform&quot;</em>) – Defines the strategy for binning numerical features. Options include ‘uniform’,
‘quantile’, or other sklearn-compatible strategies.</p></li>
<li><p><strong>task</strong> (<em>str</em><em>, </em><em>default=&quot;regression&quot;</em>) – Indicates the type of machine learning task (‘regression’ or ‘classification’). This can
influence certain preprocessing behaviors, especially when using decision tree-based binning.</p></li>
<li><p><strong>cat_cutoff</strong> (<em>float</em><em> or </em><em>int</em><em>, </em><em>default=0.03</em>) – Indicates the cutoff after which integer values are treated as categorical.
If float, it’s treated as a percentage. If int, it’s the maximum number of
unique values for a column to be considered categorical.</p></li>
<li><p><strong>treat_all_integers_as_numerical</strong> (<em>bool</em><em>, </em><em>default=False</em>) – If True, all integer columns will be treated as numerical, regardless
of their unique value count or proportion.</p></li>
<li><p><strong>degree</strong> (<em>int</em><em>, </em><em>default=3</em>) – The degree of the polynomial features to be used in preprocessing.</p></li>
<li><p><strong>knots</strong> (<em>int</em><em>, </em><em>default=12</em>) – The number of knots to be used in spline transformations.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">MambAttention.models</span> <span class="kn">import</span> <span class="n">MambAttentionClassifier</span>
<span class="go">    &gt;&gt;&gt; model = MambAttentionClassifier(d_model=64, n_layers=8)</span>
<span class="go">    &gt;&gt;&gt; model.fit(X_train, y_train)</span>
<span class="go">    &gt;&gt;&gt; preds = model.predict(X_test)</span>
<span class="go">    &gt;&gt;&gt; model.evaluate(X_test, y_test)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.MambAttentionClassifier.build_model">
<span class="sig-name descname"><span class="pre">build_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">101</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_patience</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_decay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataloader_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.MambAttentionClassifier.build_model" title="Permalink to this definition">#</a></dt>
<dd><p>Builds the model using the provided training data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The training input samples.</p></li>
<li><p><strong>y</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em>) – The target values (real numbers).</p></li>
<li><p><strong>val_size</strong> (<em>float</em><em>, </em><em>default=0.2</em>) – The proportion of the dataset to include in the validation split if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is None. Ignored if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>X_val</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em><em>, </em><em>optional</em>) – The validation input samples. If provided, <code class="docutils literal notranslate"><span class="pre">X</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> are not split and this data is used for validation.</p></li>
<li><p><strong>y_val</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em><em>, </em><em>optional</em>) – The validation target values. Required if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>random_state</strong> (<em>int</em><em>, </em><em>default=101</em>) – Controls the shuffling applied to the data before applying the split.</p></li>
<li><p><strong>batch_size</strong> (<em>int</em><em>, </em><em>default=64</em>) – Number of samples per gradient update.</p></li>
<li><p><strong>shuffle</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to shuffle the training data before each epoch.</p></li>
<li><p><strong>lr</strong> (<em>float</em><em>, </em><em>default=1e-3</em>) – Learning rate for the optimizer.</p></li>
<li><p><strong>lr_patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement on the validation loss to wait before reducing the learning rate.</p></li>
<li><p><strong>factor</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Factor by which the learning rate will be reduced.</p></li>
<li><p><strong>weight_decay</strong> (<em>float</em><em>, </em><em>default=0.025</em>) – Weight decay (L2 penalty) coefficient.</p></li>
<li><p><strong>dataloader_kwargs</strong> (<em>dict</em><em>, </em><em>default={}</em>) – The kwargs for the pytorch dataloader class.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – The built classifier.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.MambAttentionClassifier.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.MambAttentionClassifier.evaluate" title="Permalink to this definition">#</a></dt>
<dd><p>Evaluate the model on the given data using specified metrics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array-like</em><em> or </em><em>pd.DataFrame</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The input samples to predict.</p></li>
<li><p><strong>y_true</strong> (<em>array-like</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>)</em>) – The true class labels against which to evaluate the predictions.</p></li>
<li><p><strong>metrics</strong> (<em>dict</em>) – A dictionary where keys are metric names and values are tuples containing the metric function
and a boolean indicating whether the metric requires probability scores (True) or class labels (False).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>scores</strong> – A dictionary with metric names as keys and their corresponding scores as values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This method uses either the <code class="docutils literal notranslate"><span class="pre">predict</span></code> or <code class="docutils literal notranslate"><span class="pre">predict_proba</span></code> method depending on the metric requirements.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.MambAttentionClassifier.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">101</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patience</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">15</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">monitor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'val_loss'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'min'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_patience</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_decay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checkpoint_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'model_checkpoints'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataloader_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rebuild</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">trainer_kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.MambAttentionClassifier.fit" title="Permalink to this definition">#</a></dt>
<dd><p>Trains the classification model using the provided training data. Optionally, a separate validation set can be used.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The training input samples.</p></li>
<li><p><strong>y</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em>) – The target values (real numbers).</p></li>
<li><p><strong>val_size</strong> (<em>float</em><em>, </em><em>default=0.2</em>) – The proportion of the dataset to include in the validation split if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is None. Ignored if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>X_val</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em><em>, </em><em>optional</em>) – The validation input samples. If provided, <code class="docutils literal notranslate"><span class="pre">X</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> are not split and this data is used for validation.</p></li>
<li><p><strong>y_val</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em><em>, </em><em>optional</em>) – The validation target values. Required if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>max_epochs</strong> (<em>int</em><em>, </em><em>default=100</em>) – Maximum number of epochs for training.</p></li>
<li><p><strong>random_state</strong> (<em>int</em><em>, </em><em>default=101</em>) – Controls the shuffling applied to the data before applying the split.</p></li>
<li><p><strong>batch_size</strong> (<em>int</em><em>, </em><em>default=64</em>) – Number of samples per gradient update.</p></li>
<li><p><strong>shuffle</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to shuffle the training data before each epoch.</p></li>
<li><p><strong>patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement on the validation loss to wait before early stopping.</p></li>
<li><p><strong>monitor</strong> (<em>str</em><em>, </em><em>default=&quot;val_loss&quot;</em>) – The metric to monitor for early stopping.</p></li>
<li><p><strong>mode</strong> (<em>str</em><em>, </em><em>default=&quot;min&quot;</em>) – Whether the monitored metric should be minimized (<code class="docutils literal notranslate"><span class="pre">min</span></code>) or maximized (<code class="docutils literal notranslate"><span class="pre">max</span></code>).</p></li>
<li><p><strong>lr</strong> (<em>float</em><em>, </em><em>default=1e-3</em>) – Learning rate for the optimizer.</p></li>
<li><p><strong>lr_patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement on the validation loss to wait before reducing the learning rate.</p></li>
<li><p><strong>factor</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Factor by which the learning rate will be reduced.</p></li>
<li><p><strong>weight_decay</strong> (<em>float</em><em>, </em><em>default=0.025</em>) – Weight decay (L2 penalty) coefficient.</p></li>
<li><p><strong>checkpoint_path</strong> (<em>str</em><em>, </em><em>default=&quot;model_checkpoints&quot;</em>) – Path where the checkpoints are being saved.</p></li>
<li><p><strong>dataloader_kwargs</strong> (<em>dict</em><em>, </em><em>default={}</em>) – The kwargs for the pytorch dataloader class.</p></li>
<li><p><strong>rebuild</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to rebuild the model when it already was built.</p></li>
<li><p><strong>**trainer_kwargs</strong> (<em>Additional keyword arguments for PyTorch Lightning's Trainer class.</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – The fitted classifier.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.MambAttentionClassifier.get_number_of_params">
<span class="sig-name descname"><span class="pre">get_number_of_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">requires_grad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.MambAttentionClassifier.get_number_of_params" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate the number of parameters in the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>requires_grad</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, only count the parameters that require gradients (trainable parameters).
If False, count all parameters. Default is True.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The total number of parameters in the model.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the model has not been built prior to calling this method.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.MambAttentionClassifier.get_params">
<span class="sig-name descname"><span class="pre">get_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">deep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.MambAttentionClassifier.get_params" title="Permalink to this definition">#</a></dt>
<dd><p>Get parameters for this estimator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>deep</strong> (<em>bool</em><em>, </em><em>default=True</em>) – If True, will return the parameters for this estimator and contained subobjects that are estimators.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>params</strong> – Parameter names mapped to their values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.MambAttentionClassifier.optimize_hparams">
<span class="sig-name descname"><span class="pre">optimize_hparams</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prune_by_epoch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prune_epoch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fixed_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'cat_encoding':</span> <span class="pre">'int',</span> <span class="pre">'head_layer_size_length':</span> <span class="pre">0,</span> <span class="pre">'head_skip_layer':</span> <span class="pre">False,</span> <span class="pre">'head_skip_layers':</span> <span class="pre">False,</span> <span class="pre">'pooling_method':</span> <span class="pre">'avg',</span> <span class="pre">'use_cls':</span> <span class="pre">False}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">custom_search_space</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">optimize_kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.MambAttentionClassifier.optimize_hparams" title="Permalink to this definition">#</a></dt>
<dd><p>Optimizes hyperparameters using Bayesian optimization with optional pruning.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array-like</em>) – Training data.</p></li>
<li><p><strong>y</strong> (<em>array-like</em>) – Training labels.</p></li>
<li><p><strong>X_val</strong> (<em>array-like</em><em>, </em><em>optional</em>) – Validation data and labels.</p></li>
<li><p><strong>y_val</strong> (<em>array-like</em><em>, </em><em>optional</em>) – Validation data and labels.</p></li>
<li><p><strong>time</strong> (<em>int</em>) – The number of optimization trials to run.</p></li>
<li><p><strong>max_epochs</strong> (<em>int</em>) – Maximum number of epochs for training.</p></li>
<li><p><strong>prune_by_epoch</strong> (<em>bool</em>) – Whether to prune based on a specific epoch (True) or the best validation loss (False).</p></li>
<li><p><strong>prune_epoch</strong> (<em>int</em>) – The specific epoch to prune by when prune_by_epoch is True.</p></li>
<li><p><strong>**optimize_kwargs</strong> (<em>dict</em>) – Additional keyword arguments passed to the fit method.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>best_hparams</strong> – Best hyperparameters found during optimization.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.MambAttentionClassifier.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.MambAttentionClassifier.predict" title="Permalink to this definition">#</a></dt>
<dd><p>Predicts target values for the given input samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>X</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The input samples for which to predict target values.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>predictions</strong> – The predicted target values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray, shape (n_samples,) or (n_samples, n_outputs)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.MambAttentionClassifier.predict_proba">
<span class="sig-name descname"><span class="pre">predict_proba</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.MambAttentionClassifier.predict_proba" title="Permalink to this definition">#</a></dt>
<dd><p>Predict class probabilities for the given input samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>X</strong> (<em>array-like</em><em> or </em><em>pd.DataFrame</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The input samples for which to predict class probabilities.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The method preprocesses the input data using the same preprocessor used during training,
sets the model to evaluation mode, and then performs inference to predict the class probabilities.
Softmax is applied to the logits to obtain probabilities, which are then converted from a PyTorch tensor
to a NumPy array before being returned.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">accuracy_score</span><span class="p">,</span> <span class="n">precision_score</span><span class="p">,</span> <span class="n">f1_score</span><span class="p">,</span> <span class="n">roc_auc_score</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Define the metrics you want to evaluate</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">metrics</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">... </span>    <span class="s1">&#39;Accuracy&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">accuracy_score</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
<span class="gp">... </span>    <span class="s1">&#39;Precision&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">precision_score</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
<span class="gp">... </span>    <span class="s1">&#39;F1 Score&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">f1_score</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
<span class="gp">... </span>    <span class="s1">&#39;AUC Score&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">roc_auc_score</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
<span class="gp">... </span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Assuming &#39;X_test&#39; and &#39;y_test&#39; are your test dataset and labels</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Evaluate using the specified metrics</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results</span> <span class="o">=</span> <span class="n">classifier</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="n">metrics</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>probabilities</strong> – Predicted class probabilities for each input sample.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>ndarray of shape (n_samples, n_classes)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.MambAttentionClassifier.score">
<span class="sig-name descname"><span class="pre">score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(sklearn.metrics.log_loss,</span> <span class="pre">True)</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.MambAttentionClassifier.score" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate the score of the model using the specified metric.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array-like</em><em> or </em><em>pd.DataFrame</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The input samples to predict.</p></li>
<li><p><strong>y</strong> (<em>array-like</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>)</em>) – The true class labels against which to evaluate the predictions.</p></li>
<li><p><strong>metric</strong> (<em>tuple</em><em>, </em><em>default=</em><em>(</em><em>log_loss</em><em>, </em><em>True</em><em>)</em>) – A tuple containing the metric function and a boolean indicating whether the metric requires probability scores (True) or class labels (False).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>score</strong> – The score calculated using the specified metric.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.MambAttentionClassifier.set_params">
<span class="sig-name descname"><span class="pre">set_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">parameters</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.MambAttentionClassifier.set_params" title="Permalink to this definition">#</a></dt>
<dd><p>Set the parameters of this estimator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>**parameters</strong> (<em>dict</em>) – Estimator parameters.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – Estimator instance.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mambular.models.MambAttentionRegressor">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mambular.models.</span></span><span class="sig-name descname"><span class="pre">MambAttentionRegressor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/mambular/models/mambattention.html#MambAttentionRegressor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mambular.models.MambAttentionRegressor" title="Permalink to this definition">#</a></dt>
<dd><dl class="simple">
<dt>MambAttention regressor. This class extends the SklearnBaseRegressor class and uses the MambAttention model</dt><dd><p>with the default MambAttention configuration.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The parameters for this class include the attributes from the config
dataclass as well as preprocessing arguments handled by the base class.</p>
<p>Configuration class for the Default Mambular Attention model with predefined hyperparameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lr</strong> (<em>float</em><em>, </em><em>default=1e-04</em>) – Learning rate for the optimizer.</p></li>
<li><p><strong>lr_patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement after which learning rate will be reduced.</p></li>
<li><p><strong>weight_decay</strong> (<em>float</em><em>, </em><em>default=1e-06</em>) – Weight decay (L2 penalty) for the optimizer.</p></li>
<li><p><strong>lr_factor</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Factor by which the learning rate will be reduced.</p></li>
<li><p><strong>d_model</strong> (<em>int</em><em>, </em><em>default=64</em>) – Dimensionality of the model.</p></li>
<li><p><strong>n_layers</strong> (<em>int</em><em>, </em><em>default=4</em>) – Number of layers in the model.</p></li>
<li><p><strong>expand_factor</strong> (<em>int</em><em>, </em><em>default=2</em>) – Expansion factor for the feed-forward layers.</p></li>
<li><p><strong>n_heads</strong> (<em>int</em><em>, </em><em>default=8</em>) – Number of attention heads in the model.</p></li>
<li><p><strong>last_layer</strong> (<em>str</em><em>, </em><em>default=&quot;attn&quot;</em>) – Type of the last layer (e.g., ‘attn’).</p></li>
<li><p><strong>n_mamba_per_attention</strong> (<em>int</em><em>, </em><em>default=1</em>) – Number of Mamba blocks per attention layer.</p></li>
<li><p><strong>bias</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use bias in the linear layers.</p></li>
<li><p><strong>d_conv</strong> (<em>int</em><em>, </em><em>default=4</em>) – Dimensionality of the convolutional layers.</p></li>
<li><p><strong>conv_bias</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to use bias in the convolutional layers.</p></li>
<li><p><strong>dropout</strong> (<em>float</em><em>, </em><em>default=0.0</em>) – Dropout rate for regularization.</p></li>
<li><p><strong>attn_dropout</strong> (<em>float</em><em>, </em><em>default=0.2</em>) – Dropout rate for the attention mechanism.</p></li>
<li><p><strong>dt_rank</strong> (<em>str</em><em>, </em><em>default=&quot;auto&quot;</em>) – Rank of the decision tree.</p></li>
<li><p><strong>d_state</strong> (<em>int</em><em>, </em><em>default=128</em>) – Dimensionality of the state in recurrent layers.</p></li>
<li><p><strong>dt_scale</strong> (<em>float</em><em>, </em><em>default=1.0</em>) – Scaling factor for the decision tree.</p></li>
<li><p><strong>dt_init</strong> (<em>str</em><em>, </em><em>default=&quot;random&quot;</em>) – Initialization method for the decision tree.</p></li>
<li><p><strong>dt_max</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Maximum value for decision tree initialization.</p></li>
<li><p><strong>dt_min</strong> (<em>float</em><em>, </em><em>default=1e-04</em>) – Minimum value for decision tree initialization.</p></li>
<li><p><strong>dt_init_floor</strong> (<em>float</em><em>, </em><em>default=1e-04</em>) – Floor value for decision tree initialization.</p></li>
<li><p><strong>norm</strong> (<em>str</em><em>, </em><em>default=&quot;LayerNorm&quot;</em>) – Type of normalization used in the model.</p></li>
<li><p><strong>activation</strong> (<em>callable</em><em>, </em><em>default=nn.SiLU</em><em>(</em><em>)</em>) – Activation function for the model.</p></li>
<li><p><strong>layer_norm_eps</strong> (<em>float</em><em>, </em><em>default=1e-05</em>) – Epsilon value for layer normalization.</p></li>
<li><p><strong>num_embedding_activation</strong> (<em>callable</em><em>, </em><em>default=nn.ReLU</em><em>(</em><em>)</em>) – Activation function for numerical embeddings.</p></li>
<li><p><strong>embedding_type</strong> (<em>str</em><em>, </em><em>default=&quot;linear&quot;</em>) – Type of embedding to use (‘linear’, etc.).</p></li>
<li><p><strong>embedding_bias</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use bias in the embedding layers.</p></li>
<li><p><strong>plr_lite</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use a lightweight version of Piecewise Linear Regression (PLR).</p></li>
<li><p><strong>n_frequencies</strong> (<em>int</em><em>, </em><em>default=48</em>) – Number of frequencies for PLR embeddings.</p></li>
<li><p><strong>frequencies_init_scale</strong> (<em>float</em><em>, </em><em>default=0.01</em>) – Initial scale for frequency parameters in embeddings.</p></li>
<li><p><strong>layer_norm_after_embedding</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to apply layer normalization after embedding layers.</p></li>
<li><p><strong>head_layer_sizes</strong> (<em>list</em><em>, </em><em>default=</em><em>(</em><em>)</em>) – Sizes of the fully connected layers in the model’s head.</p></li>
<li><p><strong>head_dropout</strong> (<em>float</em><em>, </em><em>default=0.5</em>) – Dropout rate for the head layers.</p></li>
<li><p><strong>head_skip_layers</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use skip connections in the head layers.</p></li>
<li><p><strong>head_activation</strong> (<em>callable</em><em>, </em><em>default=nn.SELU</em><em>(</em><em>)</em>) – Activation function for the head layers.</p></li>
<li><p><strong>head_use_batch_norm</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use batch normalization in the head layers.</p></li>
<li><p><strong>pooling_method</strong> (<em>str</em><em>, </em><em>default=&quot;avg&quot;</em>) – Pooling method to be used (‘avg’, ‘max’, etc.).</p></li>
<li><p><strong>bidirectional</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to process input sequences bidirectionally.</p></li>
<li><p><strong>use_learnable_interaction</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use learnable feature interactions before passing through Mamba blocks.</p></li>
<li><p><strong>use_cls</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to append a CLS token for sequence pooling.</p></li>
<li><p><strong>shuffle_embeddings</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to shuffle embeddings before passing to Mamba layers.</p></li>
<li><p><strong>cat_encoding</strong> (<em>str</em><em>, </em><em>default=&quot;int&quot;</em>) – Encoding method for categorical features (‘int’, ‘one-hot’, etc.).</p></li>
<li><p><strong>AD_weight_decay</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether weight decay is applied to A-D matrices.</p></li>
<li><p><strong>BC_layer_norm</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to apply layer normalization to B-C matrices.</p></li>
<li><p><strong>use_pscan</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use PSCAN for the state-space model.</p></li>
<li><p><strong>n_attention_layers</strong> (<em>int</em><em>, </em><em>default=1</em>) – Number of attention layers in the model.</p></li>
<li><p><strong>n_bins</strong> (<em>int</em><em>, </em><em>default=50</em>) – The number of bins to use for numerical feature binning. This parameter is relevant
only if <code class="docutils literal notranslate"><span class="pre">numerical_preprocessing</span></code> is set to ‘binning’, ‘ple’ or ‘one-hot’.</p></li>
<li><p><strong>numerical_preprocessing</strong> (<em>str</em><em>, </em><em>default=&quot;ple&quot;</em>) – The preprocessing strategy for numerical features. Valid options are
‘ple’, ‘binning’, ‘one-hot’, ‘standardization’, ‘min-max’, ‘quantile’, ‘polynomial’,
‘splines’, ‘box-cox’, ‘yeo-johnson’ and None</p></li>
<li><p><strong>categorical_preprocessing</strong> (<em>str</em><em>, </em><em>default=&quot;int&quot;</em>) – The preprocessing strategy for categorical features. Valid options are
‘int’, ‘one-hot’, None</p></li>
<li><p><strong>use_decision_tree_bins</strong> (<em>bool</em><em>, </em><em>default=False</em>) – If True, uses decision tree regression/classification to determine
optimal bin edges for numerical feature binning. This parameter is
relevant only if <code class="docutils literal notranslate"><span class="pre">numerical_preprocessing</span></code> is set to ‘binning’ or ‘one-hot’.</p></li>
<li><p><strong>binning_strategy</strong> (<em>str</em><em>, </em><em>default=&quot;uniform&quot;</em>) – Defines the strategy for binning numerical features. Options include ‘uniform’,
‘quantile’, or other sklearn-compatible strategies.</p></li>
<li><p><strong>task</strong> (<em>str</em><em>, </em><em>default=&quot;regression&quot;</em>) – Indicates the type of machine learning task (‘regression’ or ‘classification’). This can
influence certain preprocessing behaviors, especially when using decision tree-based binning.</p></li>
<li><p><strong>cat_cutoff</strong> (<em>float</em><em> or </em><em>int</em><em>, </em><em>default=0.03</em>) – Indicates the cutoff after which integer values are treated as categorical.
If float, it’s treated as a percentage. If int, it’s the maximum number of
unique values for a column to be considered categorical.</p></li>
<li><p><strong>treat_all_integers_as_numerical</strong> (<em>bool</em><em>, </em><em>default=False</em>) – If True, all integer columns will be treated as numerical, regardless
of their unique value count or proportion.</p></li>
<li><p><strong>degree</strong> (<em>int</em><em>, </em><em>default=3</em>) – The degree of the polynomial features to be used in preprocessing.</p></li>
<li><p><strong>knots</strong> (<em>int</em><em>, </em><em>default=12</em>) – The number of knots to be used in spline transformations.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mambular.models</span> <span class="kn">import</span> <span class="n">MambAttentionRegressor</span>
<span class="go">    &gt;&gt;&gt; model = MambAttentionRegressor(d_model=64, n_layers=8)</span>
<span class="go">    &gt;&gt;&gt; model.fit(X_train, y_train)</span>
<span class="go">    &gt;&gt;&gt; preds = model.predict(X_test)</span>
<span class="go">    &gt;&gt;&gt; model.evaluate(X_test, y_test)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.MambAttentionRegressor.build_model">
<span class="sig-name descname"><span class="pre">build_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">101</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_patience</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_decay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataloader_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.MambAttentionRegressor.build_model" title="Permalink to this definition">#</a></dt>
<dd><p>Builds the model using the provided training data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The training input samples.</p></li>
<li><p><strong>y</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em>) – The target values (real numbers).</p></li>
<li><p><strong>val_size</strong> (<em>float</em><em>, </em><em>default=0.2</em>) – The proportion of the dataset to include in the validation split if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is None. Ignored if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>X_val</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em><em>, </em><em>optional</em>) – The validation input samples. If provided, <code class="docutils literal notranslate"><span class="pre">X</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> are not split and this data is used for validation.</p></li>
<li><p><strong>y_val</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em><em>, </em><em>optional</em>) – The validation target values. Required if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>random_state</strong> (<em>int</em><em>, </em><em>default=101</em>) – Controls the shuffling applied to the data before applying the split.</p></li>
<li><p><strong>batch_size</strong> (<em>int</em><em>, </em><em>default=64</em>) – Number of samples per gradient update.</p></li>
<li><p><strong>shuffle</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to shuffle the training data before each epoch.</p></li>
<li><p><strong>lr</strong> (<em>float</em><em>, </em><em>default=1e-3</em>) – Learning rate for the optimizer.</p></li>
<li><p><strong>lr_patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement on the validation loss to wait before reducing the learning rate.</p></li>
<li><p><strong>factor</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Factor by which the learning rate will be reduced.</p></li>
<li><p><strong>weight_decay</strong> (<em>float</em><em>, </em><em>default=0.025</em>) – Weight decay (L2 penalty) coefficient.</p></li>
<li><p><strong>dataloader_kwargs</strong> (<em>dict</em><em>, </em><em>default={}</em>) – The kwargs for the pytorch dataloader class.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – The built regressor.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.MambAttentionRegressor.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.MambAttentionRegressor.evaluate" title="Permalink to this definition">#</a></dt>
<dd><p>Evaluate the model on the given data using specified metrics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array-like</em><em> or </em><em>pd.DataFrame</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The input samples to predict.</p></li>
<li><p><strong>y_true</strong> (<em>array-like</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_outputs</em><em>)</em>) – The true target values against which to evaluate the predictions.</p></li>
<li><p><strong>metrics</strong> (<em>dict</em>) – A dictionary where keys are metric names and values are the metric functions.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This method uses the <code class="docutils literal notranslate"><span class="pre">predict</span></code> method to generate predictions and computes each metric.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_squared_error</span><span class="p">,</span> <span class="n">r2_score</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mambular.models</span> <span class="kn">import</span> <span class="n">MambularRegressor</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">metrics</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">... </span>    <span class="s1">&#39;Mean Squared Error&#39;</span><span class="p">:</span> <span class="n">mean_squared_error</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s1">&#39;R2 Score&#39;</span><span class="p">:</span> <span class="n">r2_score</span>
<span class="gp">... </span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Assuming &#39;X_test&#39; and &#39;y_test&#39; are your test dataset and labels</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Evaluate using the specified metrics</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results</span> <span class="o">=</span> <span class="n">regressor</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="n">metrics</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>scores</strong> – A dictionary with metric names as keys and their corresponding scores as values.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.MambAttentionRegressor.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">101</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patience</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">15</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">monitor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'val_loss'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'min'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_patience</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_decay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checkpoint_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'model_checkpoints'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataloader_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rebuild</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">trainer_kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.MambAttentionRegressor.fit" title="Permalink to this definition">#</a></dt>
<dd><p>Trains the regression model using the provided training data. Optionally, a separate validation set can be used.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The training input samples.</p></li>
<li><p><strong>y</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em>) – The target values (real numbers).</p></li>
<li><p><strong>val_size</strong> (<em>float</em><em>, </em><em>default=0.2</em>) – The proportion of the dataset to include in the validation split if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is None. Ignored if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>X_val</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em><em>, </em><em>optional</em>) – The validation input samples. If provided, <code class="docutils literal notranslate"><span class="pre">X</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> are not split and this data is used for validation.</p></li>
<li><p><strong>y_val</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em><em>, </em><em>optional</em>) – The validation target values. Required if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>max_epochs</strong> (<em>int</em><em>, </em><em>default=100</em>) – Maximum number of epochs for training.</p></li>
<li><p><strong>random_state</strong> (<em>int</em><em>, </em><em>default=101</em>) – Controls the shuffling applied to the data before applying the split.</p></li>
<li><p><strong>batch_size</strong> (<em>int</em><em>, </em><em>default=64</em>) – Number of samples per gradient update.</p></li>
<li><p><strong>shuffle</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to shuffle the training data before each epoch.</p></li>
<li><p><strong>patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement on the validation loss to wait before early stopping.</p></li>
<li><p><strong>monitor</strong> (<em>str</em><em>, </em><em>default=&quot;val_loss&quot;</em>) – The metric to monitor for early stopping.</p></li>
<li><p><strong>mode</strong> (<em>str</em><em>, </em><em>default=&quot;min&quot;</em>) – Whether the monitored metric should be minimized (<code class="docutils literal notranslate"><span class="pre">min</span></code>) or maximized (<code class="docutils literal notranslate"><span class="pre">max</span></code>).</p></li>
<li><p><strong>lr</strong> (<em>float</em><em>, </em><em>default=1e-3</em>) – Learning rate for the optimizer.</p></li>
<li><p><strong>lr_patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement on the validation loss to wait before reducing the learning rate.</p></li>
<li><p><strong>factor</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Factor by which the learning rate will be reduced.</p></li>
<li><p><strong>weight_decay</strong> (<em>float</em><em>, </em><em>default=0.025</em>) – Weight decay (L2 penalty) coefficient.</p></li>
<li><p><strong>checkpoint_path</strong> (<em>str</em><em>, </em><em>default=&quot;model_checkpoints&quot;</em>) – Path where the checkpoints are being saved.</p></li>
<li><p><strong>dataloader_kwargs</strong> (<em>dict</em><em>, </em><em>default={}</em>) – The kwargs for the pytorch dataloader class.</p></li>
<li><p><strong>**trainer_kwargs</strong> (<em>Additional keyword arguments for PyTorch Lightning's Trainer class.</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – The fitted regressor.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.MambAttentionRegressor.get_number_of_params">
<span class="sig-name descname"><span class="pre">get_number_of_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">requires_grad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.MambAttentionRegressor.get_number_of_params" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate the number of parameters in the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>requires_grad</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, only count the parameters that require gradients (trainable parameters).
If False, count all parameters. Default is True.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The total number of parameters in the model.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the model has not been built prior to calling this method.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.MambAttentionRegressor.get_params">
<span class="sig-name descname"><span class="pre">get_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">deep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.MambAttentionRegressor.get_params" title="Permalink to this definition">#</a></dt>
<dd><p>Get parameters for this estimator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>deep</strong> (<em>bool</em><em>, </em><em>default=True</em>) – If True, will return the parameters for this estimator and contained subobjects that are estimators.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>params</strong> – Parameter names mapped to their values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.MambAttentionRegressor.optimize_hparams">
<span class="sig-name descname"><span class="pre">optimize_hparams</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prune_by_epoch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prune_epoch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fixed_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'cat_encoding':</span> <span class="pre">'int',</span> <span class="pre">'head_layer_size_length':</span> <span class="pre">0,</span> <span class="pre">'head_skip_layer':</span> <span class="pre">False,</span> <span class="pre">'head_skip_layers':</span> <span class="pre">False,</span> <span class="pre">'pooling_method':</span> <span class="pre">'avg',</span> <span class="pre">'use_cls':</span> <span class="pre">False}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">custom_search_space</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">optimize_kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.MambAttentionRegressor.optimize_hparams" title="Permalink to this definition">#</a></dt>
<dd><p>Optimizes hyperparameters using Bayesian optimization with optional pruning.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array-like</em>) – Training data.</p></li>
<li><p><strong>y</strong> (<em>array-like</em>) – Training labels.</p></li>
<li><p><strong>X_val</strong> (<em>array-like</em><em>, </em><em>optional</em>) – Validation data and labels.</p></li>
<li><p><strong>y_val</strong> (<em>array-like</em><em>, </em><em>optional</em>) – Validation data and labels.</p></li>
<li><p><strong>time</strong> (<em>int</em>) – The number of optimization trials to run.</p></li>
<li><p><strong>max_epochs</strong> (<em>int</em>) – Maximum number of epochs for training.</p></li>
<li><p><strong>prune_by_epoch</strong> (<em>bool</em>) – Whether to prune based on a specific epoch (True) or the best validation loss (False).</p></li>
<li><p><strong>prune_epoch</strong> (<em>int</em>) – The specific epoch to prune by when prune_by_epoch is True.</p></li>
<li><p><strong>**optimize_kwargs</strong> (<em>dict</em>) – Additional keyword arguments passed to the fit method.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>best_hparams</strong> – Best hyperparameters found during optimization.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.MambAttentionRegressor.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.MambAttentionRegressor.predict" title="Permalink to this definition">#</a></dt>
<dd><p>Predicts target values for the given input samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>X</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The input samples for which to predict target values.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>predictions</strong> – The predicted target values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray, shape (n_samples,) or (n_samples, n_outputs)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.MambAttentionRegressor.score">
<span class="sig-name descname"><span class="pre">score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">sklearn.metrics.mean_squared_error</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.MambAttentionRegressor.score" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate the score of the model using the specified metric.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array-like</em><em> or </em><em>pd.DataFrame</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The input samples to predict.</p></li>
<li><p><strong>y</strong> (<em>array-like</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_outputs</em><em>)</em>) – The true target values against which to evaluate the predictions.</p></li>
<li><p><strong>metric</strong> (<em>callable</em><em>, </em><em>default=mean_squared_error</em>) – The metric function to use for evaluation. Must be a callable with the signature <code class="docutils literal notranslate"><span class="pre">metric(y_true,</span> <span class="pre">y_pred)</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>score</strong> – The score calculated using the specified metric.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.MambAttentionRegressor.set_params">
<span class="sig-name descname"><span class="pre">set_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">parameters</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.MambAttentionRegressor.set_params" title="Permalink to this definition">#</a></dt>
<dd><p>Set the parameters of this estimator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>**parameters</strong> (<em>dict</em>) – Estimator parameters.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – Estimator instance.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mambular.models.MambAttentionLSS">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mambular.models.</span></span><span class="sig-name descname"><span class="pre">MambAttentionLSS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/mambular/models/mambattention.html#MambAttentionLSS"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mambular.models.MambAttentionLSS" title="Permalink to this definition">#</a></dt>
<dd><dl class="simple">
<dt>MambAttention LSS for distributional regression. This class extends the SklearnBaseLSS class and uses the MambAttention model</dt><dd><p>with the default MambAttention configuration.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The parameters for this class include the attributes from the config
dataclass as well as preprocessing arguments handled by the base class.</p>
<p>Configuration class for the Default Mambular Attention model with predefined hyperparameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lr</strong> (<em>float</em><em>, </em><em>default=1e-04</em>) – Learning rate for the optimizer.</p></li>
<li><p><strong>lr_patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement after which learning rate will be reduced.</p></li>
<li><p><strong>weight_decay</strong> (<em>float</em><em>, </em><em>default=1e-06</em>) – Weight decay (L2 penalty) for the optimizer.</p></li>
<li><p><strong>lr_factor</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Factor by which the learning rate will be reduced.</p></li>
<li><p><strong>d_model</strong> (<em>int</em><em>, </em><em>default=64</em>) – Dimensionality of the model.</p></li>
<li><p><strong>n_layers</strong> (<em>int</em><em>, </em><em>default=4</em>) – Number of layers in the model.</p></li>
<li><p><strong>expand_factor</strong> (<em>int</em><em>, </em><em>default=2</em>) – Expansion factor for the feed-forward layers.</p></li>
<li><p><strong>n_heads</strong> (<em>int</em><em>, </em><em>default=8</em>) – Number of attention heads in the model.</p></li>
<li><p><strong>last_layer</strong> (<em>str</em><em>, </em><em>default=&quot;attn&quot;</em>) – Type of the last layer (e.g., ‘attn’).</p></li>
<li><p><strong>n_mamba_per_attention</strong> (<em>int</em><em>, </em><em>default=1</em>) – Number of Mamba blocks per attention layer.</p></li>
<li><p><strong>bias</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use bias in the linear layers.</p></li>
<li><p><strong>d_conv</strong> (<em>int</em><em>, </em><em>default=4</em>) – Dimensionality of the convolutional layers.</p></li>
<li><p><strong>conv_bias</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to use bias in the convolutional layers.</p></li>
<li><p><strong>dropout</strong> (<em>float</em><em>, </em><em>default=0.0</em>) – Dropout rate for regularization.</p></li>
<li><p><strong>attn_dropout</strong> (<em>float</em><em>, </em><em>default=0.2</em>) – Dropout rate for the attention mechanism.</p></li>
<li><p><strong>dt_rank</strong> (<em>str</em><em>, </em><em>default=&quot;auto&quot;</em>) – Rank of the decision tree.</p></li>
<li><p><strong>d_state</strong> (<em>int</em><em>, </em><em>default=128</em>) – Dimensionality of the state in recurrent layers.</p></li>
<li><p><strong>dt_scale</strong> (<em>float</em><em>, </em><em>default=1.0</em>) – Scaling factor for the decision tree.</p></li>
<li><p><strong>dt_init</strong> (<em>str</em><em>, </em><em>default=&quot;random&quot;</em>) – Initialization method for the decision tree.</p></li>
<li><p><strong>dt_max</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Maximum value for decision tree initialization.</p></li>
<li><p><strong>dt_min</strong> (<em>float</em><em>, </em><em>default=1e-04</em>) – Minimum value for decision tree initialization.</p></li>
<li><p><strong>dt_init_floor</strong> (<em>float</em><em>, </em><em>default=1e-04</em>) – Floor value for decision tree initialization.</p></li>
<li><p><strong>norm</strong> (<em>str</em><em>, </em><em>default=&quot;LayerNorm&quot;</em>) – Type of normalization used in the model.</p></li>
<li><p><strong>activation</strong> (<em>callable</em><em>, </em><em>default=nn.SiLU</em><em>(</em><em>)</em>) – Activation function for the model.</p></li>
<li><p><strong>layer_norm_eps</strong> (<em>float</em><em>, </em><em>default=1e-05</em>) – Epsilon value for layer normalization.</p></li>
<li><p><strong>num_embedding_activation</strong> (<em>callable</em><em>, </em><em>default=nn.ReLU</em><em>(</em><em>)</em>) – Activation function for numerical embeddings.</p></li>
<li><p><strong>embedding_type</strong> (<em>str</em><em>, </em><em>default=&quot;linear&quot;</em>) – Type of embedding to use (‘linear’, etc.).</p></li>
<li><p><strong>embedding_bias</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use bias in the embedding layers.</p></li>
<li><p><strong>plr_lite</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use a lightweight version of Piecewise Linear Regression (PLR).</p></li>
<li><p><strong>n_frequencies</strong> (<em>int</em><em>, </em><em>default=48</em>) – Number of frequencies for PLR embeddings.</p></li>
<li><p><strong>frequencies_init_scale</strong> (<em>float</em><em>, </em><em>default=0.01</em>) – Initial scale for frequency parameters in embeddings.</p></li>
<li><p><strong>layer_norm_after_embedding</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to apply layer normalization after embedding layers.</p></li>
<li><p><strong>head_layer_sizes</strong> (<em>list</em><em>, </em><em>default=</em><em>(</em><em>)</em>) – Sizes of the fully connected layers in the model’s head.</p></li>
<li><p><strong>head_dropout</strong> (<em>float</em><em>, </em><em>default=0.5</em>) – Dropout rate for the head layers.</p></li>
<li><p><strong>head_skip_layers</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use skip connections in the head layers.</p></li>
<li><p><strong>head_activation</strong> (<em>callable</em><em>, </em><em>default=nn.SELU</em><em>(</em><em>)</em>) – Activation function for the head layers.</p></li>
<li><p><strong>head_use_batch_norm</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use batch normalization in the head layers.</p></li>
<li><p><strong>pooling_method</strong> (<em>str</em><em>, </em><em>default=&quot;avg&quot;</em>) – Pooling method to be used (‘avg’, ‘max’, etc.).</p></li>
<li><p><strong>bidirectional</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to process input sequences bidirectionally.</p></li>
<li><p><strong>use_learnable_interaction</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use learnable feature interactions before passing through Mamba blocks.</p></li>
<li><p><strong>use_cls</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to append a CLS token for sequence pooling.</p></li>
<li><p><strong>shuffle_embeddings</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to shuffle embeddings before passing to Mamba layers.</p></li>
<li><p><strong>cat_encoding</strong> (<em>str</em><em>, </em><em>default=&quot;int&quot;</em>) – Encoding method for categorical features (‘int’, ‘one-hot’, etc.).</p></li>
<li><p><strong>AD_weight_decay</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether weight decay is applied to A-D matrices.</p></li>
<li><p><strong>BC_layer_norm</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to apply layer normalization to B-C matrices.</p></li>
<li><p><strong>use_pscan</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use PSCAN for the state-space model.</p></li>
<li><p><strong>n_attention_layers</strong> (<em>int</em><em>, </em><em>default=1</em>) – Number of attention layers in the model.</p></li>
<li><p><strong>n_bins</strong> (<em>int</em><em>, </em><em>default=50</em>) – The number of bins to use for numerical feature binning. This parameter is relevant
only if <code class="docutils literal notranslate"><span class="pre">numerical_preprocessing</span></code> is set to ‘binning’, ‘ple’ or ‘one-hot’.</p></li>
<li><p><strong>numerical_preprocessing</strong> (<em>str</em><em>, </em><em>default=&quot;ple&quot;</em>) – The preprocessing strategy for numerical features. Valid options are
‘ple’, ‘binning’, ‘one-hot’, ‘standardization’, ‘min-max’, ‘quantile’, ‘polynomial’,
‘splines’, ‘box-cox’, ‘yeo-johnson’ and None</p></li>
<li><p><strong>categorical_preprocessing</strong> (<em>str</em><em>, </em><em>default=&quot;int&quot;</em>) – The preprocessing strategy for categorical features. Valid options are
‘int’, ‘one-hot’, None</p></li>
<li><p><strong>use_decision_tree_bins</strong> (<em>bool</em><em>, </em><em>default=False</em>) – If True, uses decision tree regression/classification to determine
optimal bin edges for numerical feature binning. This parameter is
relevant only if <code class="docutils literal notranslate"><span class="pre">numerical_preprocessing</span></code> is set to ‘binning’ or ‘one-hot’.</p></li>
<li><p><strong>binning_strategy</strong> (<em>str</em><em>, </em><em>default=&quot;uniform&quot;</em>) – Defines the strategy for binning numerical features. Options include ‘uniform’,
‘quantile’, or other sklearn-compatible strategies.</p></li>
<li><p><strong>task</strong> (<em>str</em><em>, </em><em>default=&quot;regression&quot;</em>) – Indicates the type of machine learning task (‘regression’ or ‘classification’). This can
influence certain preprocessing behaviors, especially when using decision tree-based binning.</p></li>
<li><p><strong>cat_cutoff</strong> (<em>float</em><em> or </em><em>int</em><em>, </em><em>default=0.03</em>) – Indicates the cutoff after which integer values are treated as categorical.
If float, it’s treated as a percentage. If int, it’s the maximum number of
unique values for a column to be considered categorical.</p></li>
<li><p><strong>treat_all_integers_as_numerical</strong> (<em>bool</em><em>, </em><em>default=False</em>) – If True, all integer columns will be treated as numerical, regardless
of their unique value count or proportion.</p></li>
<li><p><strong>degree</strong> (<em>int</em><em>, </em><em>default=3</em>) – The degree of the polynomial features to be used in preprocessing.</p></li>
<li><p><strong>knots</strong> (<em>int</em><em>, </em><em>default=12</em>) – The number of knots to be used in spline transformations.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">MambAttention.models</span> <span class="kn">import</span> <span class="n">MambAttentionLSS</span>
<span class="go">    &gt;&gt;&gt; model = MambAttentionLSS(d_model=64, n_layers=8)</span>
<span class="go">    &gt;&gt;&gt; model.fit(X_train, y_train, family=&#39;normal&#39;)</span>
<span class="go">    &gt;&gt;&gt; preds = model.predict(X_test)</span>
<span class="go">    &gt;&gt;&gt; model.evaluate(X_test, y_test)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.MambAttentionLSS.build_model">
<span class="sig-name descname"><span class="pre">build_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">101</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_patience</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_decay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataloader_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.MambAttentionLSS.build_model" title="Permalink to this definition">#</a></dt>
<dd><p>Builds the model using the provided training data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The training input samples.</p></li>
<li><p><strong>y</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em>) – The target values (real numbers).</p></li>
<li><p><strong>val_size</strong> (<em>float</em><em>, </em><em>default=0.2</em>) – The proportion of the dataset to include in the validation split if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is None. Ignored if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>X_val</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em><em>, </em><em>optional</em>) – The validation input samples. If provided, <code class="docutils literal notranslate"><span class="pre">X</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> are not split and this data is used for validation.</p></li>
<li><p><strong>y_val</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em><em>, </em><em>optional</em>) – The validation target values. Required if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>random_state</strong> (<em>int</em><em>, </em><em>default=101</em>) – Controls the shuffling applied to the data before applying the split.</p></li>
<li><p><strong>batch_size</strong> (<em>int</em><em>, </em><em>default=64</em>) – Number of samples per gradient update.</p></li>
<li><p><strong>shuffle</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to shuffle the training data before each epoch.</p></li>
<li><p><strong>lr</strong> (<em>float</em><em>, </em><em>default=1e-3</em>) – Learning rate for the optimizer.</p></li>
<li><p><strong>lr_patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement on the validation loss to wait before reducing the learning rate.</p></li>
<li><p><strong>factor</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Factor by which the learning rate will be reduced.</p></li>
<li><p><strong>weight_decay</strong> (<em>float</em><em>, </em><em>default=0.025</em>) – Weight decay (L2 penalty) coefficient.</p></li>
<li><p><strong>dataloader_kwargs</strong> (<em>dict</em><em>, </em><em>default={}</em>) – The kwargs for the pytorch dataloader class.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – The built distributional regressor.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.MambAttentionLSS.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distribution_family</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.MambAttentionLSS.evaluate" title="Permalink to this definition">#</a></dt>
<dd><p>Evaluate the model on the given data using specified metrics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array-like</em><em> or </em><em>pd.DataFrame</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The input samples to predict.</p></li>
<li><p><strong>y_true</strong> (<em>array-like</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>)</em>) – The true class labels against which to evaluate the predictions.</p></li>
<li><p><strong>metrics</strong> (<em>dict</em>) – A dictionary where keys are metric names and values are tuples containing the metric function
and a boolean indicating whether the metric requires probability scores (True) or class labels (False).</p></li>
<li><p><strong>distribution_family</strong> (<em>str</em><em>, </em><em>optional</em>) – Specifies the distribution family the model is predicting for. If None, it will attempt to infer based
on the model’s settings.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>scores</strong> – A dictionary with metric names as keys and their corresponding scores as values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This method uses either the <code class="docutils literal notranslate"><span class="pre">predict</span></code> or <code class="docutils literal notranslate"><span class="pre">predict_proba</span></code> method depending on the metric requirements.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.MambAttentionLSS.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">family</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">101</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patience</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">15</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">monitor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'val_loss'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'min'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_patience</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_decay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checkpoint_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'model_checkpoints'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distributional_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataloader_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rebuild</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">trainer_kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.MambAttentionLSS.fit" title="Permalink to this definition">#</a></dt>
<dd><p>Trains the regression model using the provided training data. Optionally, a separate validation set can be used.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The training input samples.</p></li>
<li><p><strong>y</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em>) – The target values (real numbers).</p></li>
<li><p><strong>family</strong> (<em>str</em>) – The name of the distribution family to use for the loss function. Examples include ‘normal’ for regression tasks.</p></li>
<li><p><strong>val_size</strong> (<em>float</em><em>, </em><em>default=0.2</em>) – The proportion of the dataset to include in the validation split if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is None. Ignored if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>X_val</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em><em>, </em><em>optional</em>) – The validation input samples. If provided, <code class="docutils literal notranslate"><span class="pre">X</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> are not split and this data is used for validation.</p></li>
<li><p><strong>y_val</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em><em>, </em><em>optional</em>) – The validation target values. Required if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>max_epochs</strong> (<em>int</em><em>, </em><em>default=100</em>) – Maximum number of epochs for training.</p></li>
<li><p><strong>random_state</strong> (<em>int</em><em>, </em><em>default=101</em>) – Controls the shuffling applied to the data before applying the split.</p></li>
<li><p><strong>batch_size</strong> (<em>int</em><em>, </em><em>default=64</em>) – Number of samples per gradient update.</p></li>
<li><p><strong>shuffle</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to shuffle the training data before each epoch.</p></li>
<li><p><strong>patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement on the validation loss to wait before early stopping.</p></li>
<li><p><strong>monitor</strong> (<em>str</em><em>, </em><em>default=&quot;val_loss&quot;</em>) – The metric to monitor for early stopping.</p></li>
<li><p><strong>mode</strong> (<em>str</em><em>, </em><em>default=&quot;min&quot;</em>) – Whether the monitored metric should be minimized (<code class="docutils literal notranslate"><span class="pre">min</span></code>) or maximized (<code class="docutils literal notranslate"><span class="pre">max</span></code>).</p></li>
<li><p><strong>lr</strong> (<em>float</em><em>, </em><em>default=1e-3</em>) – Learning rate for the optimizer.</p></li>
<li><p><strong>lr_patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement on the validation loss to wait before reducing the learning rate.</p></li>
<li><p><strong>factor</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Factor by which the learning rate will be reduced.</p></li>
<li><p><strong>weight_decay</strong> (<em>float</em><em>, </em><em>default=0.025</em>) – Weight decay (L2 penalty) coefficient.</p></li>
<li><p><strong>distributional_kwargs</strong> (<em>dict</em><em>, </em><em>default=None</em>) – any arguments taht are specific for a certain distribution.</p></li>
<li><p><strong>checkpoint_path</strong> (<em>str</em><em>, </em><em>default=&quot;model_checkpoints&quot;</em>) – Path where the checkpoints are being saved.</p></li>
<li><p><strong>dataloader_kwargs</strong> (<em>dict</em><em>, </em><em>default={}</em>) – The kwargs for the pytorch dataloader class.</p></li>
<li><p><strong>**trainer_kwargs</strong> (<em>Additional keyword arguments for PyTorch Lightning's Trainer class.</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – The fitted regressor.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.MambAttentionLSS.get_default_metrics">
<span class="sig-name descname"><span class="pre">get_default_metrics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">distribution_family</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.MambAttentionLSS.get_default_metrics" title="Permalink to this definition">#</a></dt>
<dd><p>Provides default metrics based on the distribution family.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>distribution_family</strong> (<em>str</em>) – The distribution family for which to provide default metrics.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>metrics</strong> – A dictionary of default metric functions.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.MambAttentionLSS.get_number_of_params">
<span class="sig-name descname"><span class="pre">get_number_of_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">requires_grad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.MambAttentionLSS.get_number_of_params" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate the number of parameters in the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>requires_grad</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, only count the parameters that require gradients (trainable parameters).
If False, count all parameters. Default is True.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The total number of parameters in the model.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the model has not been built prior to calling this method.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.MambAttentionLSS.get_params">
<span class="sig-name descname"><span class="pre">get_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">deep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.MambAttentionLSS.get_params" title="Permalink to this definition">#</a></dt>
<dd><p>Get parameters for this estimator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>deep</strong> (<em>bool</em><em>, </em><em>default=True</em>) – If True, will return the parameters for this estimator and contained subobjects that are estimators.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>params</strong> – Parameter names mapped to their values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.MambAttentionLSS.optimize_hparams">
<span class="sig-name descname"><span class="pre">optimize_hparams</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prune_by_epoch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prune_epoch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fixed_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'cat_encoding':</span> <span class="pre">'int',</span> <span class="pre">'head_layer_size_length':</span> <span class="pre">0,</span> <span class="pre">'head_skip_layer':</span> <span class="pre">False,</span> <span class="pre">'head_skip_layers':</span> <span class="pre">False,</span> <span class="pre">'pooling_method':</span> <span class="pre">'avg',</span> <span class="pre">'use_cls':</span> <span class="pre">False}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">custom_search_space</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">optimize_kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.MambAttentionLSS.optimize_hparams" title="Permalink to this definition">#</a></dt>
<dd><p>Optimizes hyperparameters using Bayesian optimization with optional pruning.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array-like</em>) – Training data.</p></li>
<li><p><strong>y</strong> (<em>array-like</em>) – Training labels.</p></li>
<li><p><strong>X_val</strong> (<em>array-like</em><em>, </em><em>optional</em>) – Validation data and labels.</p></li>
<li><p><strong>y_val</strong> (<em>array-like</em><em>, </em><em>optional</em>) – Validation data and labels.</p></li>
<li><p><strong>time</strong> (<em>int</em>) – The number of optimization trials to run.</p></li>
<li><p><strong>max_epochs</strong> (<em>int</em>) – Maximum number of epochs for training.</p></li>
<li><p><strong>prune_by_epoch</strong> (<em>bool</em>) – Whether to prune based on a specific epoch (True) or the best validation loss (False).</p></li>
<li><p><strong>prune_epoch</strong> (<em>int</em>) – The specific epoch to prune by when prune_by_epoch is True.</p></li>
<li><p><strong>**optimize_kwargs</strong> (<em>dict</em>) – Additional keyword arguments passed to the fit method.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>best_hparams</strong> – Best hyperparameters found during optimization.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.MambAttentionLSS.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">raw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.MambAttentionLSS.predict" title="Permalink to this definition">#</a></dt>
<dd><p>Predicts target values for the given input samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>X</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The input samples for which to predict target values.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>predictions</strong> – The predicted target values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray, shape (n_samples,) or (n_samples, n_outputs)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.MambAttentionLSS.score">
<span class="sig-name descname"><span class="pre">score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'NLL'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.MambAttentionLSS.score" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate the score of the model using the specified metric.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array-like</em><em> or </em><em>pd.DataFrame</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The input samples to predict.</p></li>
<li><p><strong>y</strong> (<em>array-like</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_outputs</em><em>)</em>) – The true target values against which to evaluate the predictions.</p></li>
<li><p><strong>metric</strong> (<em>str</em><em>, </em><em>default=&quot;NLL&quot;</em>) – So far, only negative log-likelihood is supported</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>score</strong> – The score calculated using the specified metric.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.MambAttentionLSS.set_params">
<span class="sig-name descname"><span class="pre">set_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">parameters</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.MambAttentionLSS.set_params" title="Permalink to this definition">#</a></dt>
<dd><p>Set the parameters of this estimator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>**parameters</strong> (<em>dict</em>) – Estimator parameters.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – Estimator instance.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mambular.models.TabulaRNNClassifier">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mambular.models.</span></span><span class="sig-name descname"><span class="pre">TabulaRNNClassifier</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/mambular/models/tabularnn.html#TabulaRNNClassifier"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mambular.models.TabulaRNNClassifier" title="Permalink to this definition">#</a></dt>
<dd><dl class="simple">
<dt>TabulaRNN classifier. This class extends the SklearnBaseClassifier</dt><dd><p>class and uses the TabulaRNN model with the default TabulaRNN
configuration.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The parameters for this class include the attributes from the config
dataclass as well as preprocessing arguments handled by the base class.</p>
<p>Configuration class for the TabulaRNN model with predefined hyperparameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lr</strong> (<em>float</em><em>, </em><em>default=1e-04</em>) – Learning rate for the optimizer.</p></li>
<li><p><strong>lr_patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement after which learning rate will be reduced.</p></li>
<li><p><strong>weight_decay</strong> (<em>float</em><em>, </em><em>default=1e-06</em>) – Weight decay (L2 penalty) for the optimizer.</p></li>
<li><p><strong>lr_factor</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Factor by which the learning rate will be reduced.</p></li>
<li><p><strong>model_type</strong> (<em>str</em><em>, </em><em>default=&quot;RNN&quot;</em>) – Type of model, one of “RNN”, “LSTM”, “GRU”, “mLSTM”, “sLSTM”.</p></li>
<li><p><strong>d_model</strong> (<em>int</em><em>, </em><em>default=128</em>) – Dimensionality of the model.</p></li>
<li><p><strong>n_layers</strong> (<em>int</em><em>, </em><em>default=4</em>) – Number of layers in the RNN.</p></li>
<li><p><strong>rnn_dropout</strong> (<em>float</em><em>, </em><em>default=0.2</em>) – Dropout rate for the RNN layers.</p></li>
<li><p><strong>norm</strong> (<em>str</em><em>, </em><em>default=&quot;RMSNorm&quot;</em>) – Normalization method to be used.</p></li>
<li><p><strong>activation</strong> (<em>callable</em><em>, </em><em>default=nn.SELU</em><em>(</em><em>)</em>) – Activation function for the RNN layers.</p></li>
<li><p><strong>residuals</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to include residual connections in the RNN.</p></li>
<li><p><strong>embedding_type</strong> (<em>str</em><em>, </em><em>default=&quot;linear&quot;</em>) – Type of embedding for features (‘linear’, ‘plr’, etc.).</p></li>
<li><p><strong>embedding_bias</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use bias in the embedding layers.</p></li>
<li><p><strong>plr_lite</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use a lightweight version of Piecewise Linear Regression (PLR).</p></li>
<li><p><strong>n_frequencies</strong> (<em>int</em><em>, </em><em>default=48</em>) – Number of frequencies for PLR embeddings.</p></li>
<li><p><strong>frequencies_init_scale</strong> (<em>float</em><em>, </em><em>default=0.01</em>) – Initial scale for frequency parameters in embeddings.</p></li>
<li><p><strong>embedding_activation</strong> (<em>callable</em><em>, </em><em>default=nn.ReLU</em><em>(</em><em>)</em>) – Activation function for embeddings.</p></li>
<li><p><strong>layer_norm_after_embedding</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to apply layer normalization after embedding layers.</p></li>
<li><p><strong>head_layer_sizes</strong> (<em>list</em><em>, </em><em>default=</em><em>(</em><em>)</em>) – Sizes of the layers in the head of the model.</p></li>
<li><p><strong>head_dropout</strong> (<em>float</em><em>, </em><em>default=0.5</em>) – Dropout rate for the head layers.</p></li>
<li><p><strong>head_skip_layers</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to skip layers in the head.</p></li>
<li><p><strong>head_activation</strong> (<em>callable</em><em>, </em><em>default=nn.SELU</em><em>(</em><em>)</em>) – Activation function for the head layers.</p></li>
<li><p><strong>head_use_batch_norm</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use batch normalization in the head layers.</p></li>
<li><p><strong>pooling_method</strong> (<em>str</em><em>, </em><em>default=&quot;avg&quot;</em>) – Pooling method to be used (‘avg’, ‘cls’, etc.).</p></li>
<li><p><strong>norm_first</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to apply normalization before other operations in each block.</p></li>
<li><p><strong>layer_norm_eps</strong> (<em>float</em><em>, </em><em>default=1e-05</em>) – Epsilon value for layer normalization.</p></li>
<li><p><strong>bias</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to use bias in the linear layers.</p></li>
<li><p><strong>rnn_activation</strong> (<em>str</em><em>, </em><em>default=&quot;relu&quot;</em>) – Activation function for the RNN layers.</p></li>
<li><p><strong>dim_feedforward</strong> (<em>int</em><em>, </em><em>default=256</em>) – Size of the feedforward network.</p></li>
<li><p><strong>d_conv</strong> (<em>int</em><em>, </em><em>default=4</em>) – Size of the convolutional layer for embedding features.</p></li>
<li><p><strong>conv_bias</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to use bias in the convolutional layers.</p></li>
<li><p><strong>n_bins</strong> (<em>int</em><em>, </em><em>default=50</em>) – The number of bins to use for numerical feature binning. This parameter is relevant
only if <code class="docutils literal notranslate"><span class="pre">numerical_preprocessing</span></code> is set to ‘binning’, ‘ple’ or ‘one-hot’.</p></li>
<li><p><strong>numerical_preprocessing</strong> (<em>str</em><em>, </em><em>default=&quot;ple&quot;</em>) – The preprocessing strategy for numerical features. Valid options are
‘ple’, ‘binning’, ‘one-hot’, ‘standardization’, ‘min-max’, ‘quantile’, ‘polynomial’,
‘splines’, ‘box-cox’, ‘yeo-johnson’ and None</p></li>
<li><p><strong>categorical_preprocessing</strong> (<em>str</em><em>, </em><em>default=&quot;int&quot;</em>) – The preprocessing strategy for categorical features. Valid options are
‘int’, ‘one-hot’, None</p></li>
<li><p><strong>use_decision_tree_bins</strong> (<em>bool</em><em>, </em><em>default=False</em>) – If True, uses decision tree regression/classification to determine
optimal bin edges for numerical feature binning. This parameter is
relevant only if <code class="docutils literal notranslate"><span class="pre">numerical_preprocessing</span></code> is set to ‘binning’ or ‘one-hot’.</p></li>
<li><p><strong>binning_strategy</strong> (<em>str</em><em>, </em><em>default=&quot;uniform&quot;</em>) – Defines the strategy for binning numerical features. Options include ‘uniform’,
‘quantile’, or other sklearn-compatible strategies.</p></li>
<li><p><strong>task</strong> (<em>str</em><em>, </em><em>default=&quot;regression&quot;</em>) – Indicates the type of machine learning task (‘regression’ or ‘classification’). This can
influence certain preprocessing behaviors, especially when using decision tree-based binning.</p></li>
<li><p><strong>cat_cutoff</strong> (<em>float</em><em> or </em><em>int</em><em>, </em><em>default=0.03</em>) – Indicates the cutoff after which integer values are treated as categorical.
If float, it’s treated as a percentage. If int, it’s the maximum number of
unique values for a column to be considered categorical.</p></li>
<li><p><strong>treat_all_integers_as_numerical</strong> (<em>bool</em><em>, </em><em>default=False</em>) – If True, all integer columns will be treated as numerical, regardless
of their unique value count or proportion.</p></li>
<li><p><strong>degree</strong> (<em>int</em><em>, </em><em>default=3</em>) – The degree of the polynomial features to be used in preprocessing.</p></li>
<li><p><strong>knots</strong> (<em>int</em><em>, </em><em>default=12</em>) – The number of knots to be used in spline transformations.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mambular.models</span> <span class="kn">import</span> <span class="n">TabulaRNNClassifier</span>
<span class="go">    &gt;&gt;&gt; model = TabulaRNNClassifier(d_model=64)</span>
<span class="go">    &gt;&gt;&gt; model.fit(X_train, y_train)</span>
<span class="go">    &gt;&gt;&gt; preds = model.predict(X_test)</span>
<span class="go">    &gt;&gt;&gt; model.evaluate(X_test, y_test)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.TabulaRNNClassifier.build_model">
<span class="sig-name descname"><span class="pre">build_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">101</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_patience</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_decay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataloader_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.TabulaRNNClassifier.build_model" title="Permalink to this definition">#</a></dt>
<dd><p>Builds the model using the provided training data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The training input samples.</p></li>
<li><p><strong>y</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em>) – The target values (real numbers).</p></li>
<li><p><strong>val_size</strong> (<em>float</em><em>, </em><em>default=0.2</em>) – The proportion of the dataset to include in the validation split if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is None. Ignored if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>X_val</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em><em>, </em><em>optional</em>) – The validation input samples. If provided, <code class="docutils literal notranslate"><span class="pre">X</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> are not split and this data is used for validation.</p></li>
<li><p><strong>y_val</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em><em>, </em><em>optional</em>) – The validation target values. Required if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>random_state</strong> (<em>int</em><em>, </em><em>default=101</em>) – Controls the shuffling applied to the data before applying the split.</p></li>
<li><p><strong>batch_size</strong> (<em>int</em><em>, </em><em>default=64</em>) – Number of samples per gradient update.</p></li>
<li><p><strong>shuffle</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to shuffle the training data before each epoch.</p></li>
<li><p><strong>lr</strong> (<em>float</em><em>, </em><em>default=1e-3</em>) – Learning rate for the optimizer.</p></li>
<li><p><strong>lr_patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement on the validation loss to wait before reducing the learning rate.</p></li>
<li><p><strong>factor</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Factor by which the learning rate will be reduced.</p></li>
<li><p><strong>weight_decay</strong> (<em>float</em><em>, </em><em>default=0.025</em>) – Weight decay (L2 penalty) coefficient.</p></li>
<li><p><strong>dataloader_kwargs</strong> (<em>dict</em><em>, </em><em>default={}</em>) – The kwargs for the pytorch dataloader class.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – The built classifier.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.TabulaRNNClassifier.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.TabulaRNNClassifier.evaluate" title="Permalink to this definition">#</a></dt>
<dd><p>Evaluate the model on the given data using specified metrics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array-like</em><em> or </em><em>pd.DataFrame</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The input samples to predict.</p></li>
<li><p><strong>y_true</strong> (<em>array-like</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>)</em>) – The true class labels against which to evaluate the predictions.</p></li>
<li><p><strong>metrics</strong> (<em>dict</em>) – A dictionary where keys are metric names and values are tuples containing the metric function
and a boolean indicating whether the metric requires probability scores (True) or class labels (False).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>scores</strong> – A dictionary with metric names as keys and their corresponding scores as values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This method uses either the <code class="docutils literal notranslate"><span class="pre">predict</span></code> or <code class="docutils literal notranslate"><span class="pre">predict_proba</span></code> method depending on the metric requirements.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.TabulaRNNClassifier.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">101</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patience</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">15</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">monitor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'val_loss'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'min'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_patience</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_decay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checkpoint_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'model_checkpoints'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataloader_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rebuild</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">trainer_kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.TabulaRNNClassifier.fit" title="Permalink to this definition">#</a></dt>
<dd><p>Trains the classification model using the provided training data. Optionally, a separate validation set can be used.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The training input samples.</p></li>
<li><p><strong>y</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em>) – The target values (real numbers).</p></li>
<li><p><strong>val_size</strong> (<em>float</em><em>, </em><em>default=0.2</em>) – The proportion of the dataset to include in the validation split if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is None. Ignored if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>X_val</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em><em>, </em><em>optional</em>) – The validation input samples. If provided, <code class="docutils literal notranslate"><span class="pre">X</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> are not split and this data is used for validation.</p></li>
<li><p><strong>y_val</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em><em>, </em><em>optional</em>) – The validation target values. Required if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>max_epochs</strong> (<em>int</em><em>, </em><em>default=100</em>) – Maximum number of epochs for training.</p></li>
<li><p><strong>random_state</strong> (<em>int</em><em>, </em><em>default=101</em>) – Controls the shuffling applied to the data before applying the split.</p></li>
<li><p><strong>batch_size</strong> (<em>int</em><em>, </em><em>default=64</em>) – Number of samples per gradient update.</p></li>
<li><p><strong>shuffle</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to shuffle the training data before each epoch.</p></li>
<li><p><strong>patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement on the validation loss to wait before early stopping.</p></li>
<li><p><strong>monitor</strong> (<em>str</em><em>, </em><em>default=&quot;val_loss&quot;</em>) – The metric to monitor for early stopping.</p></li>
<li><p><strong>mode</strong> (<em>str</em><em>, </em><em>default=&quot;min&quot;</em>) – Whether the monitored metric should be minimized (<code class="docutils literal notranslate"><span class="pre">min</span></code>) or maximized (<code class="docutils literal notranslate"><span class="pre">max</span></code>).</p></li>
<li><p><strong>lr</strong> (<em>float</em><em>, </em><em>default=1e-3</em>) – Learning rate for the optimizer.</p></li>
<li><p><strong>lr_patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement on the validation loss to wait before reducing the learning rate.</p></li>
<li><p><strong>factor</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Factor by which the learning rate will be reduced.</p></li>
<li><p><strong>weight_decay</strong> (<em>float</em><em>, </em><em>default=0.025</em>) – Weight decay (L2 penalty) coefficient.</p></li>
<li><p><strong>checkpoint_path</strong> (<em>str</em><em>, </em><em>default=&quot;model_checkpoints&quot;</em>) – Path where the checkpoints are being saved.</p></li>
<li><p><strong>dataloader_kwargs</strong> (<em>dict</em><em>, </em><em>default={}</em>) – The kwargs for the pytorch dataloader class.</p></li>
<li><p><strong>rebuild</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to rebuild the model when it already was built.</p></li>
<li><p><strong>**trainer_kwargs</strong> (<em>Additional keyword arguments for PyTorch Lightning's Trainer class.</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – The fitted classifier.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.TabulaRNNClassifier.get_number_of_params">
<span class="sig-name descname"><span class="pre">get_number_of_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">requires_grad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.TabulaRNNClassifier.get_number_of_params" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate the number of parameters in the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>requires_grad</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, only count the parameters that require gradients (trainable parameters).
If False, count all parameters. Default is True.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The total number of parameters in the model.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the model has not been built prior to calling this method.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.TabulaRNNClassifier.get_params">
<span class="sig-name descname"><span class="pre">get_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">deep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.TabulaRNNClassifier.get_params" title="Permalink to this definition">#</a></dt>
<dd><p>Get parameters for this estimator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>deep</strong> (<em>bool</em><em>, </em><em>default=True</em>) – If True, will return the parameters for this estimator and contained subobjects that are estimators.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>params</strong> – Parameter names mapped to their values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.TabulaRNNClassifier.optimize_hparams">
<span class="sig-name descname"><span class="pre">optimize_hparams</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prune_by_epoch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prune_epoch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fixed_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'cat_encoding':</span> <span class="pre">'int',</span> <span class="pre">'head_layer_size_length':</span> <span class="pre">0,</span> <span class="pre">'head_skip_layer':</span> <span class="pre">False,</span> <span class="pre">'head_skip_layers':</span> <span class="pre">False,</span> <span class="pre">'pooling_method':</span> <span class="pre">'avg',</span> <span class="pre">'use_cls':</span> <span class="pre">False}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">custom_search_space</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">optimize_kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.TabulaRNNClassifier.optimize_hparams" title="Permalink to this definition">#</a></dt>
<dd><p>Optimizes hyperparameters using Bayesian optimization with optional pruning.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array-like</em>) – Training data.</p></li>
<li><p><strong>y</strong> (<em>array-like</em>) – Training labels.</p></li>
<li><p><strong>X_val</strong> (<em>array-like</em><em>, </em><em>optional</em>) – Validation data and labels.</p></li>
<li><p><strong>y_val</strong> (<em>array-like</em><em>, </em><em>optional</em>) – Validation data and labels.</p></li>
<li><p><strong>time</strong> (<em>int</em>) – The number of optimization trials to run.</p></li>
<li><p><strong>max_epochs</strong> (<em>int</em>) – Maximum number of epochs for training.</p></li>
<li><p><strong>prune_by_epoch</strong> (<em>bool</em>) – Whether to prune based on a specific epoch (True) or the best validation loss (False).</p></li>
<li><p><strong>prune_epoch</strong> (<em>int</em>) – The specific epoch to prune by when prune_by_epoch is True.</p></li>
<li><p><strong>**optimize_kwargs</strong> (<em>dict</em>) – Additional keyword arguments passed to the fit method.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>best_hparams</strong> – Best hyperparameters found during optimization.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.TabulaRNNClassifier.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.TabulaRNNClassifier.predict" title="Permalink to this definition">#</a></dt>
<dd><p>Predicts target values for the given input samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>X</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The input samples for which to predict target values.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>predictions</strong> – The predicted target values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray, shape (n_samples,) or (n_samples, n_outputs)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.TabulaRNNClassifier.predict_proba">
<span class="sig-name descname"><span class="pre">predict_proba</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.TabulaRNNClassifier.predict_proba" title="Permalink to this definition">#</a></dt>
<dd><p>Predict class probabilities for the given input samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>X</strong> (<em>array-like</em><em> or </em><em>pd.DataFrame</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The input samples for which to predict class probabilities.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The method preprocesses the input data using the same preprocessor used during training,
sets the model to evaluation mode, and then performs inference to predict the class probabilities.
Softmax is applied to the logits to obtain probabilities, which are then converted from a PyTorch tensor
to a NumPy array before being returned.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">accuracy_score</span><span class="p">,</span> <span class="n">precision_score</span><span class="p">,</span> <span class="n">f1_score</span><span class="p">,</span> <span class="n">roc_auc_score</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Define the metrics you want to evaluate</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">metrics</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">... </span>    <span class="s1">&#39;Accuracy&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">accuracy_score</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
<span class="gp">... </span>    <span class="s1">&#39;Precision&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">precision_score</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
<span class="gp">... </span>    <span class="s1">&#39;F1 Score&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">f1_score</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
<span class="gp">... </span>    <span class="s1">&#39;AUC Score&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">roc_auc_score</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
<span class="gp">... </span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Assuming &#39;X_test&#39; and &#39;y_test&#39; are your test dataset and labels</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Evaluate using the specified metrics</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results</span> <span class="o">=</span> <span class="n">classifier</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="n">metrics</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>probabilities</strong> – Predicted class probabilities for each input sample.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>ndarray of shape (n_samples, n_classes)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.TabulaRNNClassifier.score">
<span class="sig-name descname"><span class="pre">score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(sklearn.metrics.log_loss,</span> <span class="pre">True)</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.TabulaRNNClassifier.score" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate the score of the model using the specified metric.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array-like</em><em> or </em><em>pd.DataFrame</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The input samples to predict.</p></li>
<li><p><strong>y</strong> (<em>array-like</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>)</em>) – The true class labels against which to evaluate the predictions.</p></li>
<li><p><strong>metric</strong> (<em>tuple</em><em>, </em><em>default=</em><em>(</em><em>log_loss</em><em>, </em><em>True</em><em>)</em>) – A tuple containing the metric function and a boolean indicating whether the metric requires probability scores (True) or class labels (False).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>score</strong> – The score calculated using the specified metric.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.TabulaRNNClassifier.set_params">
<span class="sig-name descname"><span class="pre">set_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">parameters</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.TabulaRNNClassifier.set_params" title="Permalink to this definition">#</a></dt>
<dd><p>Set the parameters of this estimator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>**parameters</strong> (<em>dict</em>) – Estimator parameters.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – Estimator instance.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mambular.models.TabulaRNNRegressor">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mambular.models.</span></span><span class="sig-name descname"><span class="pre">TabulaRNNRegressor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/mambular/models/tabularnn.html#TabulaRNNRegressor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mambular.models.TabulaRNNRegressor" title="Permalink to this definition">#</a></dt>
<dd><dl class="simple">
<dt>TabulaRNN regressor. This class extends the SklearnBaseRegressor</dt><dd><p>class and uses the TabulaRNN model with the default TabulaRNN
configuration.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The parameters for this class include the attributes from the config
dataclass as well as preprocessing arguments handled by the base class.</p>
<p>Configuration class for the TabulaRNN model with predefined hyperparameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lr</strong> (<em>float</em><em>, </em><em>default=1e-04</em>) – Learning rate for the optimizer.</p></li>
<li><p><strong>lr_patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement after which learning rate will be reduced.</p></li>
<li><p><strong>weight_decay</strong> (<em>float</em><em>, </em><em>default=1e-06</em>) – Weight decay (L2 penalty) for the optimizer.</p></li>
<li><p><strong>lr_factor</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Factor by which the learning rate will be reduced.</p></li>
<li><p><strong>model_type</strong> (<em>str</em><em>, </em><em>default=&quot;RNN&quot;</em>) – Type of model, one of “RNN”, “LSTM”, “GRU”, “mLSTM”, “sLSTM”.</p></li>
<li><p><strong>d_model</strong> (<em>int</em><em>, </em><em>default=128</em>) – Dimensionality of the model.</p></li>
<li><p><strong>n_layers</strong> (<em>int</em><em>, </em><em>default=4</em>) – Number of layers in the RNN.</p></li>
<li><p><strong>rnn_dropout</strong> (<em>float</em><em>, </em><em>default=0.2</em>) – Dropout rate for the RNN layers.</p></li>
<li><p><strong>norm</strong> (<em>str</em><em>, </em><em>default=&quot;RMSNorm&quot;</em>) – Normalization method to be used.</p></li>
<li><p><strong>activation</strong> (<em>callable</em><em>, </em><em>default=nn.SELU</em><em>(</em><em>)</em>) – Activation function for the RNN layers.</p></li>
<li><p><strong>residuals</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to include residual connections in the RNN.</p></li>
<li><p><strong>embedding_type</strong> (<em>str</em><em>, </em><em>default=&quot;linear&quot;</em>) – Type of embedding for features (‘linear’, ‘plr’, etc.).</p></li>
<li><p><strong>embedding_bias</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use bias in the embedding layers.</p></li>
<li><p><strong>plr_lite</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use a lightweight version of Piecewise Linear Regression (PLR).</p></li>
<li><p><strong>n_frequencies</strong> (<em>int</em><em>, </em><em>default=48</em>) – Number of frequencies for PLR embeddings.</p></li>
<li><p><strong>frequencies_init_scale</strong> (<em>float</em><em>, </em><em>default=0.01</em>) – Initial scale for frequency parameters in embeddings.</p></li>
<li><p><strong>embedding_activation</strong> (<em>callable</em><em>, </em><em>default=nn.ReLU</em><em>(</em><em>)</em>) – Activation function for embeddings.</p></li>
<li><p><strong>layer_norm_after_embedding</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to apply layer normalization after embedding layers.</p></li>
<li><p><strong>head_layer_sizes</strong> (<em>list</em><em>, </em><em>default=</em><em>(</em><em>)</em>) – Sizes of the layers in the head of the model.</p></li>
<li><p><strong>head_dropout</strong> (<em>float</em><em>, </em><em>default=0.5</em>) – Dropout rate for the head layers.</p></li>
<li><p><strong>head_skip_layers</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to skip layers in the head.</p></li>
<li><p><strong>head_activation</strong> (<em>callable</em><em>, </em><em>default=nn.SELU</em><em>(</em><em>)</em>) – Activation function for the head layers.</p></li>
<li><p><strong>head_use_batch_norm</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use batch normalization in the head layers.</p></li>
<li><p><strong>pooling_method</strong> (<em>str</em><em>, </em><em>default=&quot;avg&quot;</em>) – Pooling method to be used (‘avg’, ‘cls’, etc.).</p></li>
<li><p><strong>norm_first</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to apply normalization before other operations in each block.</p></li>
<li><p><strong>layer_norm_eps</strong> (<em>float</em><em>, </em><em>default=1e-05</em>) – Epsilon value for layer normalization.</p></li>
<li><p><strong>bias</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to use bias in the linear layers.</p></li>
<li><p><strong>rnn_activation</strong> (<em>str</em><em>, </em><em>default=&quot;relu&quot;</em>) – Activation function for the RNN layers.</p></li>
<li><p><strong>dim_feedforward</strong> (<em>int</em><em>, </em><em>default=256</em>) – Size of the feedforward network.</p></li>
<li><p><strong>d_conv</strong> (<em>int</em><em>, </em><em>default=4</em>) – Size of the convolutional layer for embedding features.</p></li>
<li><p><strong>conv_bias</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to use bias in the convolutional layers.</p></li>
<li><p><strong>n_bins</strong> (<em>int</em><em>, </em><em>default=50</em>) – The number of bins to use for numerical feature binning. This parameter is relevant
only if <code class="docutils literal notranslate"><span class="pre">numerical_preprocessing</span></code> is set to ‘binning’, ‘ple’ or ‘one-hot’.</p></li>
<li><p><strong>numerical_preprocessing</strong> (<em>str</em><em>, </em><em>default=&quot;ple&quot;</em>) – The preprocessing strategy for numerical features. Valid options are
‘ple’, ‘binning’, ‘one-hot’, ‘standardization’, ‘min-max’, ‘quantile’, ‘polynomial’,
‘splines’, ‘box-cox’, ‘yeo-johnson’ and None</p></li>
<li><p><strong>categorical_preprocessing</strong> (<em>str</em><em>, </em><em>default=&quot;int&quot;</em>) – The preprocessing strategy for categorical features. Valid options are
‘int’, ‘one-hot’, None</p></li>
<li><p><strong>use_decision_tree_bins</strong> (<em>bool</em><em>, </em><em>default=False</em>) – If True, uses decision tree regression/classification to determine
optimal bin edges for numerical feature binning. This parameter is
relevant only if <code class="docutils literal notranslate"><span class="pre">numerical_preprocessing</span></code> is set to ‘binning’ or ‘one-hot’.</p></li>
<li><p><strong>binning_strategy</strong> (<em>str</em><em>, </em><em>default=&quot;uniform&quot;</em>) – Defines the strategy for binning numerical features. Options include ‘uniform’,
‘quantile’, or other sklearn-compatible strategies.</p></li>
<li><p><strong>task</strong> (<em>str</em><em>, </em><em>default=&quot;regression&quot;</em>) – Indicates the type of machine learning task (‘regression’ or ‘classification’). This can
influence certain preprocessing behaviors, especially when using decision tree-based binning.</p></li>
<li><p><strong>cat_cutoff</strong> (<em>float</em><em> or </em><em>int</em><em>, </em><em>default=0.03</em>) – Indicates the cutoff after which integer values are treated as categorical.
If float, it’s treated as a percentage. If int, it’s the maximum number of
unique values for a column to be considered categorical.</p></li>
<li><p><strong>treat_all_integers_as_numerical</strong> (<em>bool</em><em>, </em><em>default=False</em>) – If True, all integer columns will be treated as numerical, regardless
of their unique value count or proportion.</p></li>
<li><p><strong>degree</strong> (<em>int</em><em>, </em><em>default=3</em>) – The degree of the polynomial features to be used in preprocessing.</p></li>
<li><p><strong>knots</strong> (<em>int</em><em>, </em><em>default=12</em>) – The number of knots to be used in spline transformations.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mambular.models</span> <span class="kn">import</span> <span class="n">TabulaRNNRegressor</span>
<span class="go">    &gt;&gt;&gt; model = TabulaRNNRegressor(d_model=64)</span>
<span class="go">    &gt;&gt;&gt; model.fit(X_train, y_train)</span>
<span class="go">    &gt;&gt;&gt; preds = model.predict(X_test)</span>
<span class="go">    &gt;&gt;&gt; model.evaluate(X_test, y_test)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.TabulaRNNRegressor.build_model">
<span class="sig-name descname"><span class="pre">build_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">101</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_patience</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_decay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataloader_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.TabulaRNNRegressor.build_model" title="Permalink to this definition">#</a></dt>
<dd><p>Builds the model using the provided training data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The training input samples.</p></li>
<li><p><strong>y</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em>) – The target values (real numbers).</p></li>
<li><p><strong>val_size</strong> (<em>float</em><em>, </em><em>default=0.2</em>) – The proportion of the dataset to include in the validation split if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is None. Ignored if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>X_val</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em><em>, </em><em>optional</em>) – The validation input samples. If provided, <code class="docutils literal notranslate"><span class="pre">X</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> are not split and this data is used for validation.</p></li>
<li><p><strong>y_val</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em><em>, </em><em>optional</em>) – The validation target values. Required if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>random_state</strong> (<em>int</em><em>, </em><em>default=101</em>) – Controls the shuffling applied to the data before applying the split.</p></li>
<li><p><strong>batch_size</strong> (<em>int</em><em>, </em><em>default=64</em>) – Number of samples per gradient update.</p></li>
<li><p><strong>shuffle</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to shuffle the training data before each epoch.</p></li>
<li><p><strong>lr</strong> (<em>float</em><em>, </em><em>default=1e-3</em>) – Learning rate for the optimizer.</p></li>
<li><p><strong>lr_patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement on the validation loss to wait before reducing the learning rate.</p></li>
<li><p><strong>factor</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Factor by which the learning rate will be reduced.</p></li>
<li><p><strong>weight_decay</strong> (<em>float</em><em>, </em><em>default=0.025</em>) – Weight decay (L2 penalty) coefficient.</p></li>
<li><p><strong>dataloader_kwargs</strong> (<em>dict</em><em>, </em><em>default={}</em>) – The kwargs for the pytorch dataloader class.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – The built regressor.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.TabulaRNNRegressor.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.TabulaRNNRegressor.evaluate" title="Permalink to this definition">#</a></dt>
<dd><p>Evaluate the model on the given data using specified metrics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array-like</em><em> or </em><em>pd.DataFrame</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The input samples to predict.</p></li>
<li><p><strong>y_true</strong> (<em>array-like</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_outputs</em><em>)</em>) – The true target values against which to evaluate the predictions.</p></li>
<li><p><strong>metrics</strong> (<em>dict</em>) – A dictionary where keys are metric names and values are the metric functions.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This method uses the <code class="docutils literal notranslate"><span class="pre">predict</span></code> method to generate predictions and computes each metric.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_squared_error</span><span class="p">,</span> <span class="n">r2_score</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mambular.models</span> <span class="kn">import</span> <span class="n">MambularRegressor</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">metrics</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">... </span>    <span class="s1">&#39;Mean Squared Error&#39;</span><span class="p">:</span> <span class="n">mean_squared_error</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s1">&#39;R2 Score&#39;</span><span class="p">:</span> <span class="n">r2_score</span>
<span class="gp">... </span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Assuming &#39;X_test&#39; and &#39;y_test&#39; are your test dataset and labels</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Evaluate using the specified metrics</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results</span> <span class="o">=</span> <span class="n">regressor</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="n">metrics</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>scores</strong> – A dictionary with metric names as keys and their corresponding scores as values.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.TabulaRNNRegressor.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">101</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patience</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">15</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">monitor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'val_loss'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'min'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_patience</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_decay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checkpoint_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'model_checkpoints'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataloader_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rebuild</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">trainer_kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.TabulaRNNRegressor.fit" title="Permalink to this definition">#</a></dt>
<dd><p>Trains the regression model using the provided training data. Optionally, a separate validation set can be used.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The training input samples.</p></li>
<li><p><strong>y</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em>) – The target values (real numbers).</p></li>
<li><p><strong>val_size</strong> (<em>float</em><em>, </em><em>default=0.2</em>) – The proportion of the dataset to include in the validation split if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is None. Ignored if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>X_val</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em><em>, </em><em>optional</em>) – The validation input samples. If provided, <code class="docutils literal notranslate"><span class="pre">X</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> are not split and this data is used for validation.</p></li>
<li><p><strong>y_val</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em><em>, </em><em>optional</em>) – The validation target values. Required if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>max_epochs</strong> (<em>int</em><em>, </em><em>default=100</em>) – Maximum number of epochs for training.</p></li>
<li><p><strong>random_state</strong> (<em>int</em><em>, </em><em>default=101</em>) – Controls the shuffling applied to the data before applying the split.</p></li>
<li><p><strong>batch_size</strong> (<em>int</em><em>, </em><em>default=64</em>) – Number of samples per gradient update.</p></li>
<li><p><strong>shuffle</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to shuffle the training data before each epoch.</p></li>
<li><p><strong>patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement on the validation loss to wait before early stopping.</p></li>
<li><p><strong>monitor</strong> (<em>str</em><em>, </em><em>default=&quot;val_loss&quot;</em>) – The metric to monitor for early stopping.</p></li>
<li><p><strong>mode</strong> (<em>str</em><em>, </em><em>default=&quot;min&quot;</em>) – Whether the monitored metric should be minimized (<code class="docutils literal notranslate"><span class="pre">min</span></code>) or maximized (<code class="docutils literal notranslate"><span class="pre">max</span></code>).</p></li>
<li><p><strong>lr</strong> (<em>float</em><em>, </em><em>default=1e-3</em>) – Learning rate for the optimizer.</p></li>
<li><p><strong>lr_patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement on the validation loss to wait before reducing the learning rate.</p></li>
<li><p><strong>factor</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Factor by which the learning rate will be reduced.</p></li>
<li><p><strong>weight_decay</strong> (<em>float</em><em>, </em><em>default=0.025</em>) – Weight decay (L2 penalty) coefficient.</p></li>
<li><p><strong>checkpoint_path</strong> (<em>str</em><em>, </em><em>default=&quot;model_checkpoints&quot;</em>) – Path where the checkpoints are being saved.</p></li>
<li><p><strong>dataloader_kwargs</strong> (<em>dict</em><em>, </em><em>default={}</em>) – The kwargs for the pytorch dataloader class.</p></li>
<li><p><strong>**trainer_kwargs</strong> (<em>Additional keyword arguments for PyTorch Lightning's Trainer class.</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – The fitted regressor.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.TabulaRNNRegressor.get_number_of_params">
<span class="sig-name descname"><span class="pre">get_number_of_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">requires_grad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.TabulaRNNRegressor.get_number_of_params" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate the number of parameters in the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>requires_grad</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, only count the parameters that require gradients (trainable parameters).
If False, count all parameters. Default is True.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The total number of parameters in the model.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the model has not been built prior to calling this method.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.TabulaRNNRegressor.get_params">
<span class="sig-name descname"><span class="pre">get_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">deep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.TabulaRNNRegressor.get_params" title="Permalink to this definition">#</a></dt>
<dd><p>Get parameters for this estimator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>deep</strong> (<em>bool</em><em>, </em><em>default=True</em>) – If True, will return the parameters for this estimator and contained subobjects that are estimators.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>params</strong> – Parameter names mapped to their values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.TabulaRNNRegressor.optimize_hparams">
<span class="sig-name descname"><span class="pre">optimize_hparams</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prune_by_epoch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prune_epoch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fixed_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'cat_encoding':</span> <span class="pre">'int',</span> <span class="pre">'head_layer_size_length':</span> <span class="pre">0,</span> <span class="pre">'head_skip_layer':</span> <span class="pre">False,</span> <span class="pre">'head_skip_layers':</span> <span class="pre">False,</span> <span class="pre">'pooling_method':</span> <span class="pre">'avg',</span> <span class="pre">'use_cls':</span> <span class="pre">False}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">custom_search_space</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">optimize_kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.TabulaRNNRegressor.optimize_hparams" title="Permalink to this definition">#</a></dt>
<dd><p>Optimizes hyperparameters using Bayesian optimization with optional pruning.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array-like</em>) – Training data.</p></li>
<li><p><strong>y</strong> (<em>array-like</em>) – Training labels.</p></li>
<li><p><strong>X_val</strong> (<em>array-like</em><em>, </em><em>optional</em>) – Validation data and labels.</p></li>
<li><p><strong>y_val</strong> (<em>array-like</em><em>, </em><em>optional</em>) – Validation data and labels.</p></li>
<li><p><strong>time</strong> (<em>int</em>) – The number of optimization trials to run.</p></li>
<li><p><strong>max_epochs</strong> (<em>int</em>) – Maximum number of epochs for training.</p></li>
<li><p><strong>prune_by_epoch</strong> (<em>bool</em>) – Whether to prune based on a specific epoch (True) or the best validation loss (False).</p></li>
<li><p><strong>prune_epoch</strong> (<em>int</em>) – The specific epoch to prune by when prune_by_epoch is True.</p></li>
<li><p><strong>**optimize_kwargs</strong> (<em>dict</em>) – Additional keyword arguments passed to the fit method.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>best_hparams</strong> – Best hyperparameters found during optimization.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.TabulaRNNRegressor.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.TabulaRNNRegressor.predict" title="Permalink to this definition">#</a></dt>
<dd><p>Predicts target values for the given input samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>X</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The input samples for which to predict target values.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>predictions</strong> – The predicted target values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray, shape (n_samples,) or (n_samples, n_outputs)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.TabulaRNNRegressor.score">
<span class="sig-name descname"><span class="pre">score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">sklearn.metrics.mean_squared_error</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.TabulaRNNRegressor.score" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate the score of the model using the specified metric.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array-like</em><em> or </em><em>pd.DataFrame</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The input samples to predict.</p></li>
<li><p><strong>y</strong> (<em>array-like</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_outputs</em><em>)</em>) – The true target values against which to evaluate the predictions.</p></li>
<li><p><strong>metric</strong> (<em>callable</em><em>, </em><em>default=mean_squared_error</em>) – The metric function to use for evaluation. Must be a callable with the signature <code class="docutils literal notranslate"><span class="pre">metric(y_true,</span> <span class="pre">y_pred)</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>score</strong> – The score calculated using the specified metric.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.TabulaRNNRegressor.set_params">
<span class="sig-name descname"><span class="pre">set_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">parameters</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.TabulaRNNRegressor.set_params" title="Permalink to this definition">#</a></dt>
<dd><p>Set the parameters of this estimator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>**parameters</strong> (<em>dict</em>) – Estimator parameters.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – Estimator instance.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mambular.models.TabulaRNNLSS">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mambular.models.</span></span><span class="sig-name descname"><span class="pre">TabulaRNNLSS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/mambular/models/tabularnn.html#TabulaRNNLSS"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mambular.models.TabulaRNNLSS" title="Permalink to this definition">#</a></dt>
<dd><p>RNN LSS. This class extends the SklearnBaseLSS class and uses the TabulaRNN model
with the default TabulaRNN configuration.</p>
<p>The accepted arguments to the TabulaRNNLSS class include both the attributes in the DefaultTabulaRNNConfig dataclass
and the parameters for the Preprocessor class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lr</strong> (<em>float</em><em>, </em><em>default=1e-04</em>) – Learning rate for the optimizer.</p></li>
<li><p><strong>model_type</strong> (<em>str</em><em>, </em><em>default=&quot;RNN&quot;</em>) – type of model, one of “RNN”, “LSTM”, “GRU”</p></li>
<li><p><strong>family</strong> (<em>str</em><em>, </em><em>default=None</em>) – Distributional family to be used for the model.</p></li>
<li><p><strong>lr_patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement after which learning rate will be reduced.</p></li>
<li><p><strong>weight_decay</strong> (<em>float</em><em>, </em><em>default=1e-06</em>) – Weight decay (L2 penalty) for the optimizer.</p></li>
<li><p><strong>lr_factor</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Factor by which the learning rate will be reduced.</p></li>
<li><p><strong>d_model</strong> (<em>int</em><em>, </em><em>default=64</em>) – Dimensionality of the model.</p></li>
<li><p><strong>n_layers</strong> (<em>int</em><em>, </em><em>default=8</em>) – Number of layers in the transformer.</p></li>
<li><p><strong>norm</strong> (<em>str</em><em>, </em><em>default=&quot;RMSNorm&quot;</em>) – Normalization method to be used.</p></li>
<li><p><strong>activation</strong> (<em>callable</em><em>, </em><em>default=nn.SELU</em><em>(</em><em>)</em>) – Activation function for the transformer.</p></li>
<li><p><strong>embedding_activation</strong> (<em>callable</em><em>, </em><em>default=nn.Identity</em><em>(</em><em>)</em>) – Activation function for numerical embeddings.</p></li>
<li><p><strong>head_layer_sizes</strong> (<em>list</em><em>, </em><em>default=</em><em>(</em><em>128</em><em>, </em><em>64</em><em>, </em><em>32</em><em>)</em>) – Sizes of the layers in the head of the model.</p></li>
<li><p><strong>head_dropout</strong> (<em>float</em><em>, </em><em>default=0.5</em>) – Dropout rate for the head layers.</p></li>
<li><p><strong>head_skip_layers</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to skip layers in the head.</p></li>
<li><p><strong>head_activation</strong> (<em>callable</em><em>, </em><em>default=nn.SELU</em><em>(</em><em>)</em>) – Activation function for the head layers.</p></li>
<li><p><strong>head_use_batch_norm</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use batch normalization in the head layers.</p></li>
<li><p><strong>layer_norm_after_embedding</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to apply layer normalization after embedding.</p></li>
<li><p><strong>pooling_method</strong> (<em>str</em><em>, </em><em>default=&quot;cls&quot;</em>) – Pooling method to be used (‘cls’, ‘avg’, etc.).</p></li>
<li><p><strong>norm_first</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to apply normalization before other operations in each transformer block.</p></li>
<li><p><strong>bias</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to use bias in the linear layers.</p></li>
<li><p><strong>rnn_activation</strong> (<em>callable</em><em>, </em><em>default=nn.SELU</em><em>(</em><em>)</em>) – Activation function for the transformer layers.</p></li>
<li><p><strong>bidirectional</strong> (<em>bool</em><em>, </em><em>default=False.</em>) – Whether to process data bidirectionally</p></li>
<li><p><strong>cat_encoding</strong> (<em>str</em><em>, </em><em>default=&quot;int&quot;</em>) – Encoding method for categorical features.</p></li>
<li><p><strong>n_bins</strong> (<em>int</em><em>, </em><em>default=50</em>) – The number of bins to use for numerical feature binning. This parameter is relevant
only if <code class="docutils literal notranslate"><span class="pre">numerical_preprocessing</span></code> is set to ‘binning’ or ‘one_hot’.</p></li>
<li><p><strong>numerical_preprocessing</strong> (<em>str</em><em>, </em><em>default=&quot;ple&quot;</em>) – The preprocessing strategy for numerical features. Valid options are
‘binning’, ‘one_hot’, ‘standardization’, and ‘normalization’.</p></li>
<li><p><strong>use_decision_tree_bins</strong> (<em>bool</em><em>, </em><em>default=False</em>) – If True, uses decision tree regression/classification to determine
optimal bin edges for numerical feature binning. This parameter is
relevant only if <code class="docutils literal notranslate"><span class="pre">numerical_preprocessing</span></code> is set to ‘binning’ or ‘one_hot’.</p></li>
<li><p><strong>binning_strategy</strong> (<em>str</em><em>, </em><em>default=&quot;uniform&quot;</em>) – Defines the strategy for binning numerical features. Options include ‘uniform’,
‘quantile’, or other sklearn-compatible strategies.</p></li>
<li><p><strong>cat_cutoff</strong> (<em>float</em><em> or </em><em>int</em><em>, </em><em>default=0.03</em>) – Indicates the cutoff after which integer values are treated as categorical.
If float, it’s treated as a percentage. If int, it’s the maximum number of
unique values for a column to be considered categorical.</p></li>
<li><p><strong>treat_all_integers_as_numerical</strong> (<em>bool</em><em>, </em><em>default=False</em>) – If True, all integer columns will be treated as numerical, regardless
of their unique value count or proportion.</p></li>
<li><p><strong>degree</strong> (<em>int</em><em>, </em><em>default=3</em>) – The degree of the polynomial features to be used in preprocessing.</p></li>
<li><p><strong>knots</strong> (<em>int</em><em>, </em><em>default=12</em>) – The number of knots to be used in spline transformations.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.TabulaRNNLSS.build_model">
<span class="sig-name descname"><span class="pre">build_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">101</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_patience</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_decay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataloader_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.TabulaRNNLSS.build_model" title="Permalink to this definition">#</a></dt>
<dd><p>Builds the model using the provided training data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The training input samples.</p></li>
<li><p><strong>y</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em>) – The target values (real numbers).</p></li>
<li><p><strong>val_size</strong> (<em>float</em><em>, </em><em>default=0.2</em>) – The proportion of the dataset to include in the validation split if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is None. Ignored if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>X_val</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em><em>, </em><em>optional</em>) – The validation input samples. If provided, <code class="docutils literal notranslate"><span class="pre">X</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> are not split and this data is used for validation.</p></li>
<li><p><strong>y_val</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em><em>, </em><em>optional</em>) – The validation target values. Required if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>random_state</strong> (<em>int</em><em>, </em><em>default=101</em>) – Controls the shuffling applied to the data before applying the split.</p></li>
<li><p><strong>batch_size</strong> (<em>int</em><em>, </em><em>default=64</em>) – Number of samples per gradient update.</p></li>
<li><p><strong>shuffle</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to shuffle the training data before each epoch.</p></li>
<li><p><strong>lr</strong> (<em>float</em><em>, </em><em>default=1e-3</em>) – Learning rate for the optimizer.</p></li>
<li><p><strong>lr_patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement on the validation loss to wait before reducing the learning rate.</p></li>
<li><p><strong>factor</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Factor by which the learning rate will be reduced.</p></li>
<li><p><strong>weight_decay</strong> (<em>float</em><em>, </em><em>default=0.025</em>) – Weight decay (L2 penalty) coefficient.</p></li>
<li><p><strong>dataloader_kwargs</strong> (<em>dict</em><em>, </em><em>default={}</em>) – The kwargs for the pytorch dataloader class.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – The built distributional regressor.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.TabulaRNNLSS.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distribution_family</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.TabulaRNNLSS.evaluate" title="Permalink to this definition">#</a></dt>
<dd><p>Evaluate the model on the given data using specified metrics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array-like</em><em> or </em><em>pd.DataFrame</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The input samples to predict.</p></li>
<li><p><strong>y_true</strong> (<em>array-like</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>)</em>) – The true class labels against which to evaluate the predictions.</p></li>
<li><p><strong>metrics</strong> (<em>dict</em>) – A dictionary where keys are metric names and values are tuples containing the metric function
and a boolean indicating whether the metric requires probability scores (True) or class labels (False).</p></li>
<li><p><strong>distribution_family</strong> (<em>str</em><em>, </em><em>optional</em>) – Specifies the distribution family the model is predicting for. If None, it will attempt to infer based
on the model’s settings.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>scores</strong> – A dictionary with metric names as keys and their corresponding scores as values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This method uses either the <code class="docutils literal notranslate"><span class="pre">predict</span></code> or <code class="docutils literal notranslate"><span class="pre">predict_proba</span></code> method depending on the metric requirements.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.TabulaRNNLSS.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">family</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">101</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patience</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">15</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">monitor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'val_loss'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'min'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_patience</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_decay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checkpoint_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'model_checkpoints'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distributional_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataloader_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rebuild</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">trainer_kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.TabulaRNNLSS.fit" title="Permalink to this definition">#</a></dt>
<dd><p>Trains the regression model using the provided training data. Optionally, a separate validation set can be used.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The training input samples.</p></li>
<li><p><strong>y</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em>) – The target values (real numbers).</p></li>
<li><p><strong>family</strong> (<em>str</em>) – The name of the distribution family to use for the loss function. Examples include ‘normal’ for regression tasks.</p></li>
<li><p><strong>val_size</strong> (<em>float</em><em>, </em><em>default=0.2</em>) – The proportion of the dataset to include in the validation split if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is None. Ignored if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>X_val</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em><em>, </em><em>optional</em>) – The validation input samples. If provided, <code class="docutils literal notranslate"><span class="pre">X</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> are not split and this data is used for validation.</p></li>
<li><p><strong>y_val</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em><em>, </em><em>optional</em>) – The validation target values. Required if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>max_epochs</strong> (<em>int</em><em>, </em><em>default=100</em>) – Maximum number of epochs for training.</p></li>
<li><p><strong>random_state</strong> (<em>int</em><em>, </em><em>default=101</em>) – Controls the shuffling applied to the data before applying the split.</p></li>
<li><p><strong>batch_size</strong> (<em>int</em><em>, </em><em>default=64</em>) – Number of samples per gradient update.</p></li>
<li><p><strong>shuffle</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to shuffle the training data before each epoch.</p></li>
<li><p><strong>patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement on the validation loss to wait before early stopping.</p></li>
<li><p><strong>monitor</strong> (<em>str</em><em>, </em><em>default=&quot;val_loss&quot;</em>) – The metric to monitor for early stopping.</p></li>
<li><p><strong>mode</strong> (<em>str</em><em>, </em><em>default=&quot;min&quot;</em>) – Whether the monitored metric should be minimized (<code class="docutils literal notranslate"><span class="pre">min</span></code>) or maximized (<code class="docutils literal notranslate"><span class="pre">max</span></code>).</p></li>
<li><p><strong>lr</strong> (<em>float</em><em>, </em><em>default=1e-3</em>) – Learning rate for the optimizer.</p></li>
<li><p><strong>lr_patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement on the validation loss to wait before reducing the learning rate.</p></li>
<li><p><strong>factor</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Factor by which the learning rate will be reduced.</p></li>
<li><p><strong>weight_decay</strong> (<em>float</em><em>, </em><em>default=0.025</em>) – Weight decay (L2 penalty) coefficient.</p></li>
<li><p><strong>distributional_kwargs</strong> (<em>dict</em><em>, </em><em>default=None</em>) – any arguments taht are specific for a certain distribution.</p></li>
<li><p><strong>checkpoint_path</strong> (<em>str</em><em>, </em><em>default=&quot;model_checkpoints&quot;</em>) – Path where the checkpoints are being saved.</p></li>
<li><p><strong>dataloader_kwargs</strong> (<em>dict</em><em>, </em><em>default={}</em>) – The kwargs for the pytorch dataloader class.</p></li>
<li><p><strong>**trainer_kwargs</strong> (<em>Additional keyword arguments for PyTorch Lightning's Trainer class.</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – The fitted regressor.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.TabulaRNNLSS.get_default_metrics">
<span class="sig-name descname"><span class="pre">get_default_metrics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">distribution_family</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.TabulaRNNLSS.get_default_metrics" title="Permalink to this definition">#</a></dt>
<dd><p>Provides default metrics based on the distribution family.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>distribution_family</strong> (<em>str</em>) – The distribution family for which to provide default metrics.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>metrics</strong> – A dictionary of default metric functions.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.TabulaRNNLSS.get_number_of_params">
<span class="sig-name descname"><span class="pre">get_number_of_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">requires_grad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.TabulaRNNLSS.get_number_of_params" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate the number of parameters in the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>requires_grad</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, only count the parameters that require gradients (trainable parameters).
If False, count all parameters. Default is True.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The total number of parameters in the model.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the model has not been built prior to calling this method.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.TabulaRNNLSS.get_params">
<span class="sig-name descname"><span class="pre">get_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">deep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.TabulaRNNLSS.get_params" title="Permalink to this definition">#</a></dt>
<dd><p>Get parameters for this estimator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>deep</strong> (<em>bool</em><em>, </em><em>default=True</em>) – If True, will return the parameters for this estimator and contained subobjects that are estimators.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>params</strong> – Parameter names mapped to their values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.TabulaRNNLSS.optimize_hparams">
<span class="sig-name descname"><span class="pre">optimize_hparams</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prune_by_epoch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prune_epoch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fixed_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'cat_encoding':</span> <span class="pre">'int',</span> <span class="pre">'head_layer_size_length':</span> <span class="pre">0,</span> <span class="pre">'head_skip_layer':</span> <span class="pre">False,</span> <span class="pre">'head_skip_layers':</span> <span class="pre">False,</span> <span class="pre">'pooling_method':</span> <span class="pre">'avg',</span> <span class="pre">'use_cls':</span> <span class="pre">False}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">custom_search_space</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">optimize_kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.TabulaRNNLSS.optimize_hparams" title="Permalink to this definition">#</a></dt>
<dd><p>Optimizes hyperparameters using Bayesian optimization with optional pruning.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array-like</em>) – Training data.</p></li>
<li><p><strong>y</strong> (<em>array-like</em>) – Training labels.</p></li>
<li><p><strong>X_val</strong> (<em>array-like</em><em>, </em><em>optional</em>) – Validation data and labels.</p></li>
<li><p><strong>y_val</strong> (<em>array-like</em><em>, </em><em>optional</em>) – Validation data and labels.</p></li>
<li><p><strong>time</strong> (<em>int</em>) – The number of optimization trials to run.</p></li>
<li><p><strong>max_epochs</strong> (<em>int</em>) – Maximum number of epochs for training.</p></li>
<li><p><strong>prune_by_epoch</strong> (<em>bool</em>) – Whether to prune based on a specific epoch (True) or the best validation loss (False).</p></li>
<li><p><strong>prune_epoch</strong> (<em>int</em>) – The specific epoch to prune by when prune_by_epoch is True.</p></li>
<li><p><strong>**optimize_kwargs</strong> (<em>dict</em>) – Additional keyword arguments passed to the fit method.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>best_hparams</strong> – Best hyperparameters found during optimization.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.TabulaRNNLSS.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">raw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.TabulaRNNLSS.predict" title="Permalink to this definition">#</a></dt>
<dd><p>Predicts target values for the given input samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>X</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The input samples for which to predict target values.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>predictions</strong> – The predicted target values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray, shape (n_samples,) or (n_samples, n_outputs)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.TabulaRNNLSS.score">
<span class="sig-name descname"><span class="pre">score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'NLL'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.TabulaRNNLSS.score" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate the score of the model using the specified metric.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array-like</em><em> or </em><em>pd.DataFrame</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The input samples to predict.</p></li>
<li><p><strong>y</strong> (<em>array-like</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_outputs</em><em>)</em>) – The true target values against which to evaluate the predictions.</p></li>
<li><p><strong>metric</strong> (<em>str</em><em>, </em><em>default=&quot;NLL&quot;</em>) – So far, only negative log-likelihood is supported</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>score</strong> – The score calculated using the specified metric.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.TabulaRNNLSS.set_params">
<span class="sig-name descname"><span class="pre">set_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">parameters</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.TabulaRNNLSS.set_params" title="Permalink to this definition">#</a></dt>
<dd><p>Set the parameters of this estimator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>**parameters</strong> (<em>dict</em>) – Estimator parameters.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – Estimator instance.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mambular.models.TabMClassifier">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mambular.models.</span></span><span class="sig-name descname"><span class="pre">TabMClassifier</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/mambular/models/tabm.html#TabMClassifier"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mambular.models.TabMClassifier" title="Permalink to this definition">#</a></dt>
<dd><dl class="simple">
<dt>TabM classifier. This class extends the SklearnBaseClassifier class and uses the TabM model</dt><dd><p>with the default TabM configuration.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The parameters for this class include the attributes from the config
dataclass as well as preprocessing arguments handled by the base class.</p>
<p>Configuration class for the TabM model with batch ensembling and predefined hyperparameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lr</strong> (<em>float</em><em>, </em><em>default=1e-04</em>) – Learning rate for the optimizer.</p></li>
<li><p><strong>lr_patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement after which the learning rate will be reduced.</p></li>
<li><p><strong>weight_decay</strong> (<em>float</em><em>, </em><em>default=1e-06</em>) – Weight decay (L2 penalty) for the optimizer.</p></li>
<li><p><strong>lr_factor</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Factor by which the learning rate is reduced when there is no improvement.</p></li>
<li><p><strong>layer_sizes</strong> (<em>list</em><em>, </em><em>default=</em><em>(</em><em>512</em><em>, </em><em>512</em><em>, </em><em>128</em><em>)</em>) – Sizes of the layers in the model.</p></li>
<li><p><strong>activation</strong> (<em>callable</em><em>, </em><em>default=nn.ReLU</em><em>(</em><em>)</em>) – Activation function for the model layers.</p></li>
<li><p><strong>dropout</strong> (<em>float</em><em>, </em><em>default=0.3</em>) – Dropout rate for regularization.</p></li>
<li><p><strong>norm</strong> (<em>str</em><em>, </em><em>default=None</em>) – Normalization method to be used, if any.</p></li>
<li><p><strong>use_glu</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use Gated Linear Units (GLU) in the model.</p></li>
<li><p><strong>batch_norm</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use batch normalization in the model layers.</p></li>
<li><p><strong>layer_norm</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use layer normalization in the model layers.</p></li>
<li><p><strong>layer_norm_eps</strong> (<em>float</em><em>, </em><em>default=1e-05</em>) – Epsilon value for layer normalization.</p></li>
<li><p><strong>use_embeddings</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to use embedding layers for all features.</p></li>
<li><p><strong>embedding_type</strong> (<em>str</em><em>, </em><em>default=&quot;plr&quot;</em>) – Type of embedding to use (‘plr’, etc.).</p></li>
<li><p><strong>embedding_bias</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use bias in the embedding layers.</p></li>
<li><p><strong>plr_lite</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use a lightweight version of Piecewise Linear Regression (PLR).</p></li>
<li><p><strong>n_frequencies</strong> (<em>int</em><em>, </em><em>default=48</em>) – Number of frequencies for PLR embeddings.</p></li>
<li><p><strong>frequencies_init_scale</strong> (<em>float</em><em>, </em><em>default=0.01</em>) – Initial scale for frequency parameters in embeddings.</p></li>
<li><p><strong>average_embeddings</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to average embeddings during the forward pass.</p></li>
<li><p><strong>embedding_activation</strong> (<em>callable</em><em>, </em><em>default=nn.ReLU</em><em>(</em><em>)</em>) – Activation function for embeddings.</p></li>
<li><p><strong>layer_norm_after_embedding</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to apply layer normalization after embedding layers.</p></li>
<li><p><strong>d_model</strong> (<em>int</em><em>, </em><em>default=64</em>) – Dimensionality of the embeddings.</p></li>
<li><p><strong>ensemble_size</strong> (<em>int</em><em>, </em><em>default=32</em>) – Number of ensemble members for batch ensembling.</p></li>
<li><p><strong>ensemble_scaling_in</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to use input scaling for each ensemble member.</p></li>
<li><p><strong>ensemble_scaling_out</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to use output scaling for each ensemble member.</p></li>
<li><p><strong>ensemble_bias</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to use a unique bias term for each ensemble member.</p></li>
<li><p><strong>scaling_init</strong> (<em>{&quot;ones&quot;</em><em>, </em><em>&quot;random-signs&quot;</em><em>, </em><em>&quot;normal&quot;}</em><em>, </em><em>default=&quot;normal&quot;</em>) – Initialization method for scaling weights.</p></li>
<li><p><strong>average_ensembles</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to average the outputs of the ensembles.</p></li>
<li><p><strong>model_type</strong> (<em>{&quot;mini&quot;</em><em>, </em><em>&quot;full&quot;}</em><em>, </em><em>default=&quot;mini&quot;</em>) – Model type to use (‘mini’ for reduced version, ‘full’ for complete model).</p></li>
<li><p><strong>n_bins</strong> (<em>int</em><em>, </em><em>default=50</em>) – The number of bins to use for numerical feature binning. This parameter is relevant
only if <code class="docutils literal notranslate"><span class="pre">numerical_preprocessing</span></code> is set to ‘binning’, ‘ple’ or ‘one-hot’.</p></li>
<li><p><strong>numerical_preprocessing</strong> (<em>str</em><em>, </em><em>default=&quot;ple&quot;</em>) – The preprocessing strategy for numerical features. Valid options are
‘ple’, ‘binning’, ‘one-hot’, ‘standardization’, ‘min-max’, ‘quantile’, ‘polynomial’,
‘splines’, ‘box-cox’, ‘yeo-johnson’ and None</p></li>
<li><p><strong>categorical_preprocessing</strong> (<em>str</em><em>, </em><em>default=&quot;int&quot;</em>) – The preprocessing strategy for categorical features. Valid options are
‘int’, ‘one-hot’, None</p></li>
<li><p><strong>use_decision_tree_bins</strong> (<em>bool</em><em>, </em><em>default=False</em>) – If True, uses decision tree regression/classification to determine
optimal bin edges for numerical feature binning. This parameter is
relevant only if <code class="docutils literal notranslate"><span class="pre">numerical_preprocessing</span></code> is set to ‘binning’ or ‘one-hot’.</p></li>
<li><p><strong>binning_strategy</strong> (<em>str</em><em>, </em><em>default=&quot;uniform&quot;</em>) – Defines the strategy for binning numerical features. Options include ‘uniform’,
‘quantile’, or other sklearn-compatible strategies.</p></li>
<li><p><strong>task</strong> (<em>str</em><em>, </em><em>default=&quot;regression&quot;</em>) – Indicates the type of machine learning task (‘regression’ or ‘classification’). This can
influence certain preprocessing behaviors, especially when using decision tree-based binning.</p></li>
<li><p><strong>cat_cutoff</strong> (<em>float</em><em> or </em><em>int</em><em>, </em><em>default=0.03</em>) – Indicates the cutoff after which integer values are treated as categorical.
If float, it’s treated as a percentage. If int, it’s the maximum number of
unique values for a column to be considered categorical.</p></li>
<li><p><strong>treat_all_integers_as_numerical</strong> (<em>bool</em><em>, </em><em>default=False</em>) – If True, all integer columns will be treated as numerical, regardless
of their unique value count or proportion.</p></li>
<li><p><strong>degree</strong> (<em>int</em><em>, </em><em>default=3</em>) – The degree of the polynomial features to be used in preprocessing.</p></li>
<li><p><strong>knots</strong> (<em>int</em><em>, </em><em>default=12</em>) – The number of knots to be used in spline transformations.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mambular.models</span> <span class="kn">import</span> <span class="n">TabMClassifier</span>
<span class="go">    &gt;&gt;&gt; model = TabMClassifier(ensemble_size=32, model_type=&#39;full&#39;)</span>
<span class="go">    &gt;&gt;&gt; model.fit(X_train, y_train)</span>
<span class="go">    &gt;&gt;&gt; preds = model.predict(X_test)</span>
<span class="go">    &gt;&gt;&gt; model.evaluate(X_test, y_test)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.TabMClassifier.build_model">
<span class="sig-name descname"><span class="pre">build_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">101</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_patience</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_decay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataloader_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.TabMClassifier.build_model" title="Permalink to this definition">#</a></dt>
<dd><p>Builds the model using the provided training data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The training input samples.</p></li>
<li><p><strong>y</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em>) – The target values (real numbers).</p></li>
<li><p><strong>val_size</strong> (<em>float</em><em>, </em><em>default=0.2</em>) – The proportion of the dataset to include in the validation split if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is None. Ignored if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>X_val</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em><em>, </em><em>optional</em>) – The validation input samples. If provided, <code class="docutils literal notranslate"><span class="pre">X</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> are not split and this data is used for validation.</p></li>
<li><p><strong>y_val</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em><em>, </em><em>optional</em>) – The validation target values. Required if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>random_state</strong> (<em>int</em><em>, </em><em>default=101</em>) – Controls the shuffling applied to the data before applying the split.</p></li>
<li><p><strong>batch_size</strong> (<em>int</em><em>, </em><em>default=64</em>) – Number of samples per gradient update.</p></li>
<li><p><strong>shuffle</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to shuffle the training data before each epoch.</p></li>
<li><p><strong>lr</strong> (<em>float</em><em>, </em><em>default=1e-3</em>) – Learning rate for the optimizer.</p></li>
<li><p><strong>lr_patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement on the validation loss to wait before reducing the learning rate.</p></li>
<li><p><strong>factor</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Factor by which the learning rate will be reduced.</p></li>
<li><p><strong>weight_decay</strong> (<em>float</em><em>, </em><em>default=0.025</em>) – Weight decay (L2 penalty) coefficient.</p></li>
<li><p><strong>dataloader_kwargs</strong> (<em>dict</em><em>, </em><em>default={}</em>) – The kwargs for the pytorch dataloader class.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – The built classifier.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.TabMClassifier.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.TabMClassifier.evaluate" title="Permalink to this definition">#</a></dt>
<dd><p>Evaluate the model on the given data using specified metrics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array-like</em><em> or </em><em>pd.DataFrame</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The input samples to predict.</p></li>
<li><p><strong>y_true</strong> (<em>array-like</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>)</em>) – The true class labels against which to evaluate the predictions.</p></li>
<li><p><strong>metrics</strong> (<em>dict</em>) – A dictionary where keys are metric names and values are tuples containing the metric function
and a boolean indicating whether the metric requires probability scores (True) or class labels (False).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>scores</strong> – A dictionary with metric names as keys and their corresponding scores as values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This method uses either the <code class="docutils literal notranslate"><span class="pre">predict</span></code> or <code class="docutils literal notranslate"><span class="pre">predict_proba</span></code> method depending on the metric requirements.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.TabMClassifier.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">101</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patience</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">15</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">monitor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'val_loss'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'min'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_patience</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_decay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checkpoint_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'model_checkpoints'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataloader_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rebuild</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">trainer_kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.TabMClassifier.fit" title="Permalink to this definition">#</a></dt>
<dd><p>Trains the classification model using the provided training data. Optionally, a separate validation set can be used.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The training input samples.</p></li>
<li><p><strong>y</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em>) – The target values (real numbers).</p></li>
<li><p><strong>val_size</strong> (<em>float</em><em>, </em><em>default=0.2</em>) – The proportion of the dataset to include in the validation split if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is None. Ignored if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>X_val</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em><em>, </em><em>optional</em>) – The validation input samples. If provided, <code class="docutils literal notranslate"><span class="pre">X</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> are not split and this data is used for validation.</p></li>
<li><p><strong>y_val</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em><em>, </em><em>optional</em>) – The validation target values. Required if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>max_epochs</strong> (<em>int</em><em>, </em><em>default=100</em>) – Maximum number of epochs for training.</p></li>
<li><p><strong>random_state</strong> (<em>int</em><em>, </em><em>default=101</em>) – Controls the shuffling applied to the data before applying the split.</p></li>
<li><p><strong>batch_size</strong> (<em>int</em><em>, </em><em>default=64</em>) – Number of samples per gradient update.</p></li>
<li><p><strong>shuffle</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to shuffle the training data before each epoch.</p></li>
<li><p><strong>patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement on the validation loss to wait before early stopping.</p></li>
<li><p><strong>monitor</strong> (<em>str</em><em>, </em><em>default=&quot;val_loss&quot;</em>) – The metric to monitor for early stopping.</p></li>
<li><p><strong>mode</strong> (<em>str</em><em>, </em><em>default=&quot;min&quot;</em>) – Whether the monitored metric should be minimized (<code class="docutils literal notranslate"><span class="pre">min</span></code>) or maximized (<code class="docutils literal notranslate"><span class="pre">max</span></code>).</p></li>
<li><p><strong>lr</strong> (<em>float</em><em>, </em><em>default=1e-3</em>) – Learning rate for the optimizer.</p></li>
<li><p><strong>lr_patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement on the validation loss to wait before reducing the learning rate.</p></li>
<li><p><strong>factor</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Factor by which the learning rate will be reduced.</p></li>
<li><p><strong>weight_decay</strong> (<em>float</em><em>, </em><em>default=0.025</em>) – Weight decay (L2 penalty) coefficient.</p></li>
<li><p><strong>checkpoint_path</strong> (<em>str</em><em>, </em><em>default=&quot;model_checkpoints&quot;</em>) – Path where the checkpoints are being saved.</p></li>
<li><p><strong>dataloader_kwargs</strong> (<em>dict</em><em>, </em><em>default={}</em>) – The kwargs for the pytorch dataloader class.</p></li>
<li><p><strong>rebuild</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to rebuild the model when it already was built.</p></li>
<li><p><strong>**trainer_kwargs</strong> (<em>Additional keyword arguments for PyTorch Lightning's Trainer class.</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – The fitted classifier.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.TabMClassifier.get_number_of_params">
<span class="sig-name descname"><span class="pre">get_number_of_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">requires_grad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.TabMClassifier.get_number_of_params" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate the number of parameters in the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>requires_grad</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, only count the parameters that require gradients (trainable parameters).
If False, count all parameters. Default is True.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The total number of parameters in the model.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the model has not been built prior to calling this method.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.TabMClassifier.get_params">
<span class="sig-name descname"><span class="pre">get_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">deep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.TabMClassifier.get_params" title="Permalink to this definition">#</a></dt>
<dd><p>Get parameters for this estimator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>deep</strong> (<em>bool</em><em>, </em><em>default=True</em>) – If True, will return the parameters for this estimator and contained subobjects that are estimators.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>params</strong> – Parameter names mapped to their values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.TabMClassifier.optimize_hparams">
<span class="sig-name descname"><span class="pre">optimize_hparams</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prune_by_epoch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prune_epoch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fixed_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'cat_encoding':</span> <span class="pre">'int',</span> <span class="pre">'head_layer_size_length':</span> <span class="pre">0,</span> <span class="pre">'head_skip_layer':</span> <span class="pre">False,</span> <span class="pre">'head_skip_layers':</span> <span class="pre">False,</span> <span class="pre">'pooling_method':</span> <span class="pre">'avg',</span> <span class="pre">'use_cls':</span> <span class="pre">False}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">custom_search_space</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">optimize_kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.TabMClassifier.optimize_hparams" title="Permalink to this definition">#</a></dt>
<dd><p>Optimizes hyperparameters using Bayesian optimization with optional pruning.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array-like</em>) – Training data.</p></li>
<li><p><strong>y</strong> (<em>array-like</em>) – Training labels.</p></li>
<li><p><strong>X_val</strong> (<em>array-like</em><em>, </em><em>optional</em>) – Validation data and labels.</p></li>
<li><p><strong>y_val</strong> (<em>array-like</em><em>, </em><em>optional</em>) – Validation data and labels.</p></li>
<li><p><strong>time</strong> (<em>int</em>) – The number of optimization trials to run.</p></li>
<li><p><strong>max_epochs</strong> (<em>int</em>) – Maximum number of epochs for training.</p></li>
<li><p><strong>prune_by_epoch</strong> (<em>bool</em>) – Whether to prune based on a specific epoch (True) or the best validation loss (False).</p></li>
<li><p><strong>prune_epoch</strong> (<em>int</em>) – The specific epoch to prune by when prune_by_epoch is True.</p></li>
<li><p><strong>**optimize_kwargs</strong> (<em>dict</em>) – Additional keyword arguments passed to the fit method.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>best_hparams</strong> – Best hyperparameters found during optimization.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.TabMClassifier.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.TabMClassifier.predict" title="Permalink to this definition">#</a></dt>
<dd><p>Predicts target values for the given input samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>X</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The input samples for which to predict target values.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>predictions</strong> – The predicted target values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray, shape (n_samples,) or (n_samples, n_outputs)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.TabMClassifier.predict_proba">
<span class="sig-name descname"><span class="pre">predict_proba</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.TabMClassifier.predict_proba" title="Permalink to this definition">#</a></dt>
<dd><p>Predict class probabilities for the given input samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>X</strong> (<em>array-like</em><em> or </em><em>pd.DataFrame</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The input samples for which to predict class probabilities.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The method preprocesses the input data using the same preprocessor used during training,
sets the model to evaluation mode, and then performs inference to predict the class probabilities.
Softmax is applied to the logits to obtain probabilities, which are then converted from a PyTorch tensor
to a NumPy array before being returned.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">accuracy_score</span><span class="p">,</span> <span class="n">precision_score</span><span class="p">,</span> <span class="n">f1_score</span><span class="p">,</span> <span class="n">roc_auc_score</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Define the metrics you want to evaluate</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">metrics</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">... </span>    <span class="s1">&#39;Accuracy&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">accuracy_score</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
<span class="gp">... </span>    <span class="s1">&#39;Precision&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">precision_score</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
<span class="gp">... </span>    <span class="s1">&#39;F1 Score&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">f1_score</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
<span class="gp">... </span>    <span class="s1">&#39;AUC Score&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">roc_auc_score</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
<span class="gp">... </span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Assuming &#39;X_test&#39; and &#39;y_test&#39; are your test dataset and labels</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Evaluate using the specified metrics</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results</span> <span class="o">=</span> <span class="n">classifier</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="n">metrics</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>probabilities</strong> – Predicted class probabilities for each input sample.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>ndarray of shape (n_samples, n_classes)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.TabMClassifier.score">
<span class="sig-name descname"><span class="pre">score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(sklearn.metrics.log_loss,</span> <span class="pre">True)</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.TabMClassifier.score" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate the score of the model using the specified metric.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array-like</em><em> or </em><em>pd.DataFrame</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The input samples to predict.</p></li>
<li><p><strong>y</strong> (<em>array-like</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>)</em>) – The true class labels against which to evaluate the predictions.</p></li>
<li><p><strong>metric</strong> (<em>tuple</em><em>, </em><em>default=</em><em>(</em><em>log_loss</em><em>, </em><em>True</em><em>)</em>) – A tuple containing the metric function and a boolean indicating whether the metric requires probability scores (True) or class labels (False).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>score</strong> – The score calculated using the specified metric.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.TabMClassifier.set_params">
<span class="sig-name descname"><span class="pre">set_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">parameters</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.TabMClassifier.set_params" title="Permalink to this definition">#</a></dt>
<dd><p>Set the parameters of this estimator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>**parameters</strong> (<em>dict</em>) – Estimator parameters.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – Estimator instance.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mambular.models.TabMRegressor">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mambular.models.</span></span><span class="sig-name descname"><span class="pre">TabMRegressor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/mambular/models/tabm.html#TabMRegressor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mambular.models.TabMRegressor" title="Permalink to this definition">#</a></dt>
<dd><dl class="simple">
<dt>TabM regressor. This class extends the SklearnBaseRegressor class and uses the TabM model</dt><dd><p>with the default TabM configuration.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The parameters for this class include the attributes from the config
dataclass as well as preprocessing arguments handled by the base class.</p>
<p>Configuration class for the TabM model with batch ensembling and predefined hyperparameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lr</strong> (<em>float</em><em>, </em><em>default=1e-04</em>) – Learning rate for the optimizer.</p></li>
<li><p><strong>lr_patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement after which the learning rate will be reduced.</p></li>
<li><p><strong>weight_decay</strong> (<em>float</em><em>, </em><em>default=1e-06</em>) – Weight decay (L2 penalty) for the optimizer.</p></li>
<li><p><strong>lr_factor</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Factor by which the learning rate is reduced when there is no improvement.</p></li>
<li><p><strong>layer_sizes</strong> (<em>list</em><em>, </em><em>default=</em><em>(</em><em>512</em><em>, </em><em>512</em><em>, </em><em>128</em><em>)</em>) – Sizes of the layers in the model.</p></li>
<li><p><strong>activation</strong> (<em>callable</em><em>, </em><em>default=nn.ReLU</em><em>(</em><em>)</em>) – Activation function for the model layers.</p></li>
<li><p><strong>dropout</strong> (<em>float</em><em>, </em><em>default=0.3</em>) – Dropout rate for regularization.</p></li>
<li><p><strong>norm</strong> (<em>str</em><em>, </em><em>default=None</em>) – Normalization method to be used, if any.</p></li>
<li><p><strong>use_glu</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use Gated Linear Units (GLU) in the model.</p></li>
<li><p><strong>batch_norm</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use batch normalization in the model layers.</p></li>
<li><p><strong>layer_norm</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use layer normalization in the model layers.</p></li>
<li><p><strong>layer_norm_eps</strong> (<em>float</em><em>, </em><em>default=1e-05</em>) – Epsilon value for layer normalization.</p></li>
<li><p><strong>use_embeddings</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to use embedding layers for all features.</p></li>
<li><p><strong>embedding_type</strong> (<em>str</em><em>, </em><em>default=&quot;plr&quot;</em>) – Type of embedding to use (‘plr’, etc.).</p></li>
<li><p><strong>embedding_bias</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use bias in the embedding layers.</p></li>
<li><p><strong>plr_lite</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use a lightweight version of Piecewise Linear Regression (PLR).</p></li>
<li><p><strong>n_frequencies</strong> (<em>int</em><em>, </em><em>default=48</em>) – Number of frequencies for PLR embeddings.</p></li>
<li><p><strong>frequencies_init_scale</strong> (<em>float</em><em>, </em><em>default=0.01</em>) – Initial scale for frequency parameters in embeddings.</p></li>
<li><p><strong>average_embeddings</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to average embeddings during the forward pass.</p></li>
<li><p><strong>embedding_activation</strong> (<em>callable</em><em>, </em><em>default=nn.ReLU</em><em>(</em><em>)</em>) – Activation function for embeddings.</p></li>
<li><p><strong>layer_norm_after_embedding</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to apply layer normalization after embedding layers.</p></li>
<li><p><strong>d_model</strong> (<em>int</em><em>, </em><em>default=64</em>) – Dimensionality of the embeddings.</p></li>
<li><p><strong>ensemble_size</strong> (<em>int</em><em>, </em><em>default=32</em>) – Number of ensemble members for batch ensembling.</p></li>
<li><p><strong>ensemble_scaling_in</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to use input scaling for each ensemble member.</p></li>
<li><p><strong>ensemble_scaling_out</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to use output scaling for each ensemble member.</p></li>
<li><p><strong>ensemble_bias</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to use a unique bias term for each ensemble member.</p></li>
<li><p><strong>scaling_init</strong> (<em>{&quot;ones&quot;</em><em>, </em><em>&quot;random-signs&quot;</em><em>, </em><em>&quot;normal&quot;}</em><em>, </em><em>default=&quot;normal&quot;</em>) – Initialization method for scaling weights.</p></li>
<li><p><strong>average_ensembles</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to average the outputs of the ensembles.</p></li>
<li><p><strong>model_type</strong> (<em>{&quot;mini&quot;</em><em>, </em><em>&quot;full&quot;}</em><em>, </em><em>default=&quot;mini&quot;</em>) – Model type to use (‘mini’ for reduced version, ‘full’ for complete model).</p></li>
<li><p><strong>n_bins</strong> (<em>int</em><em>, </em><em>default=50</em>) – The number of bins to use for numerical feature binning. This parameter is relevant
only if <code class="docutils literal notranslate"><span class="pre">numerical_preprocessing</span></code> is set to ‘binning’, ‘ple’ or ‘one-hot’.</p></li>
<li><p><strong>numerical_preprocessing</strong> (<em>str</em><em>, </em><em>default=&quot;ple&quot;</em>) – The preprocessing strategy for numerical features. Valid options are
‘ple’, ‘binning’, ‘one-hot’, ‘standardization’, ‘min-max’, ‘quantile’, ‘polynomial’,
‘splines’, ‘box-cox’, ‘yeo-johnson’ and None</p></li>
<li><p><strong>categorical_preprocessing</strong> (<em>str</em><em>, </em><em>default=&quot;int&quot;</em>) – The preprocessing strategy for categorical features. Valid options are
‘int’, ‘one-hot’, None</p></li>
<li><p><strong>use_decision_tree_bins</strong> (<em>bool</em><em>, </em><em>default=False</em>) – If True, uses decision tree regression/classification to determine
optimal bin edges for numerical feature binning. This parameter is
relevant only if <code class="docutils literal notranslate"><span class="pre">numerical_preprocessing</span></code> is set to ‘binning’ or ‘one-hot’.</p></li>
<li><p><strong>binning_strategy</strong> (<em>str</em><em>, </em><em>default=&quot;uniform&quot;</em>) – Defines the strategy for binning numerical features. Options include ‘uniform’,
‘quantile’, or other sklearn-compatible strategies.</p></li>
<li><p><strong>task</strong> (<em>str</em><em>, </em><em>default=&quot;regression&quot;</em>) – Indicates the type of machine learning task (‘regression’ or ‘classification’). This can
influence certain preprocessing behaviors, especially when using decision tree-based binning.</p></li>
<li><p><strong>cat_cutoff</strong> (<em>float</em><em> or </em><em>int</em><em>, </em><em>default=0.03</em>) – Indicates the cutoff after which integer values are treated as categorical.
If float, it’s treated as a percentage. If int, it’s the maximum number of
unique values for a column to be considered categorical.</p></li>
<li><p><strong>treat_all_integers_as_numerical</strong> (<em>bool</em><em>, </em><em>default=False</em>) – If True, all integer columns will be treated as numerical, regardless
of their unique value count or proportion.</p></li>
<li><p><strong>degree</strong> (<em>int</em><em>, </em><em>default=3</em>) – The degree of the polynomial features to be used in preprocessing.</p></li>
<li><p><strong>knots</strong> (<em>int</em><em>, </em><em>default=12</em>) – The number of knots to be used in spline transformations.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mambular.models</span> <span class="kn">import</span> <span class="n">TabMRegressor</span>
<span class="go">    &gt;&gt;&gt; model = TabMRegressor(ensemble_size=32, model_type=&#39;full&#39;)</span>
<span class="go">    &gt;&gt;&gt; model.fit(X_train, y_train)</span>
<span class="go">    &gt;&gt;&gt; preds = model.predict(X_test)</span>
<span class="go">    &gt;&gt;&gt; model.evaluate(X_test, y_test)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.TabMRegressor.build_model">
<span class="sig-name descname"><span class="pre">build_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">101</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_patience</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_decay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataloader_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.TabMRegressor.build_model" title="Permalink to this definition">#</a></dt>
<dd><p>Builds the model using the provided training data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The training input samples.</p></li>
<li><p><strong>y</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em>) – The target values (real numbers).</p></li>
<li><p><strong>val_size</strong> (<em>float</em><em>, </em><em>default=0.2</em>) – The proportion of the dataset to include in the validation split if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is None. Ignored if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>X_val</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em><em>, </em><em>optional</em>) – The validation input samples. If provided, <code class="docutils literal notranslate"><span class="pre">X</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> are not split and this data is used for validation.</p></li>
<li><p><strong>y_val</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em><em>, </em><em>optional</em>) – The validation target values. Required if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>random_state</strong> (<em>int</em><em>, </em><em>default=101</em>) – Controls the shuffling applied to the data before applying the split.</p></li>
<li><p><strong>batch_size</strong> (<em>int</em><em>, </em><em>default=64</em>) – Number of samples per gradient update.</p></li>
<li><p><strong>shuffle</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to shuffle the training data before each epoch.</p></li>
<li><p><strong>lr</strong> (<em>float</em><em>, </em><em>default=1e-3</em>) – Learning rate for the optimizer.</p></li>
<li><p><strong>lr_patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement on the validation loss to wait before reducing the learning rate.</p></li>
<li><p><strong>factor</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Factor by which the learning rate will be reduced.</p></li>
<li><p><strong>weight_decay</strong> (<em>float</em><em>, </em><em>default=0.025</em>) – Weight decay (L2 penalty) coefficient.</p></li>
<li><p><strong>dataloader_kwargs</strong> (<em>dict</em><em>, </em><em>default={}</em>) – The kwargs for the pytorch dataloader class.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – The built regressor.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.TabMRegressor.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.TabMRegressor.evaluate" title="Permalink to this definition">#</a></dt>
<dd><p>Evaluate the model on the given data using specified metrics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array-like</em><em> or </em><em>pd.DataFrame</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The input samples to predict.</p></li>
<li><p><strong>y_true</strong> (<em>array-like</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_outputs</em><em>)</em>) – The true target values against which to evaluate the predictions.</p></li>
<li><p><strong>metrics</strong> (<em>dict</em>) – A dictionary where keys are metric names and values are the metric functions.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This method uses the <code class="docutils literal notranslate"><span class="pre">predict</span></code> method to generate predictions and computes each metric.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_squared_error</span><span class="p">,</span> <span class="n">r2_score</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mambular.models</span> <span class="kn">import</span> <span class="n">MambularRegressor</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">metrics</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">... </span>    <span class="s1">&#39;Mean Squared Error&#39;</span><span class="p">:</span> <span class="n">mean_squared_error</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s1">&#39;R2 Score&#39;</span><span class="p">:</span> <span class="n">r2_score</span>
<span class="gp">... </span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Assuming &#39;X_test&#39; and &#39;y_test&#39; are your test dataset and labels</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Evaluate using the specified metrics</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results</span> <span class="o">=</span> <span class="n">regressor</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="n">metrics</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>scores</strong> – A dictionary with metric names as keys and their corresponding scores as values.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.TabMRegressor.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">101</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patience</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">15</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">monitor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'val_loss'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'min'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_patience</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_decay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checkpoint_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'model_checkpoints'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataloader_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rebuild</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">trainer_kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.TabMRegressor.fit" title="Permalink to this definition">#</a></dt>
<dd><p>Trains the regression model using the provided training data. Optionally, a separate validation set can be used.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The training input samples.</p></li>
<li><p><strong>y</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em>) – The target values (real numbers).</p></li>
<li><p><strong>val_size</strong> (<em>float</em><em>, </em><em>default=0.2</em>) – The proportion of the dataset to include in the validation split if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is None. Ignored if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>X_val</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em><em>, </em><em>optional</em>) – The validation input samples. If provided, <code class="docutils literal notranslate"><span class="pre">X</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> are not split and this data is used for validation.</p></li>
<li><p><strong>y_val</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em><em>, </em><em>optional</em>) – The validation target values. Required if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>max_epochs</strong> (<em>int</em><em>, </em><em>default=100</em>) – Maximum number of epochs for training.</p></li>
<li><p><strong>random_state</strong> (<em>int</em><em>, </em><em>default=101</em>) – Controls the shuffling applied to the data before applying the split.</p></li>
<li><p><strong>batch_size</strong> (<em>int</em><em>, </em><em>default=64</em>) – Number of samples per gradient update.</p></li>
<li><p><strong>shuffle</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to shuffle the training data before each epoch.</p></li>
<li><p><strong>patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement on the validation loss to wait before early stopping.</p></li>
<li><p><strong>monitor</strong> (<em>str</em><em>, </em><em>default=&quot;val_loss&quot;</em>) – The metric to monitor for early stopping.</p></li>
<li><p><strong>mode</strong> (<em>str</em><em>, </em><em>default=&quot;min&quot;</em>) – Whether the monitored metric should be minimized (<code class="docutils literal notranslate"><span class="pre">min</span></code>) or maximized (<code class="docutils literal notranslate"><span class="pre">max</span></code>).</p></li>
<li><p><strong>lr</strong> (<em>float</em><em>, </em><em>default=1e-3</em>) – Learning rate for the optimizer.</p></li>
<li><p><strong>lr_patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement on the validation loss to wait before reducing the learning rate.</p></li>
<li><p><strong>factor</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Factor by which the learning rate will be reduced.</p></li>
<li><p><strong>weight_decay</strong> (<em>float</em><em>, </em><em>default=0.025</em>) – Weight decay (L2 penalty) coefficient.</p></li>
<li><p><strong>checkpoint_path</strong> (<em>str</em><em>, </em><em>default=&quot;model_checkpoints&quot;</em>) – Path where the checkpoints are being saved.</p></li>
<li><p><strong>dataloader_kwargs</strong> (<em>dict</em><em>, </em><em>default={}</em>) – The kwargs for the pytorch dataloader class.</p></li>
<li><p><strong>**trainer_kwargs</strong> (<em>Additional keyword arguments for PyTorch Lightning's Trainer class.</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – The fitted regressor.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.TabMRegressor.get_number_of_params">
<span class="sig-name descname"><span class="pre">get_number_of_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">requires_grad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.TabMRegressor.get_number_of_params" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate the number of parameters in the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>requires_grad</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, only count the parameters that require gradients (trainable parameters).
If False, count all parameters. Default is True.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The total number of parameters in the model.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the model has not been built prior to calling this method.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.TabMRegressor.get_params">
<span class="sig-name descname"><span class="pre">get_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">deep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.TabMRegressor.get_params" title="Permalink to this definition">#</a></dt>
<dd><p>Get parameters for this estimator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>deep</strong> (<em>bool</em><em>, </em><em>default=True</em>) – If True, will return the parameters for this estimator and contained subobjects that are estimators.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>params</strong> – Parameter names mapped to their values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.TabMRegressor.optimize_hparams">
<span class="sig-name descname"><span class="pre">optimize_hparams</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prune_by_epoch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prune_epoch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fixed_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'cat_encoding':</span> <span class="pre">'int',</span> <span class="pre">'head_layer_size_length':</span> <span class="pre">0,</span> <span class="pre">'head_skip_layer':</span> <span class="pre">False,</span> <span class="pre">'head_skip_layers':</span> <span class="pre">False,</span> <span class="pre">'pooling_method':</span> <span class="pre">'avg',</span> <span class="pre">'use_cls':</span> <span class="pre">False}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">custom_search_space</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">optimize_kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.TabMRegressor.optimize_hparams" title="Permalink to this definition">#</a></dt>
<dd><p>Optimizes hyperparameters using Bayesian optimization with optional pruning.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array-like</em>) – Training data.</p></li>
<li><p><strong>y</strong> (<em>array-like</em>) – Training labels.</p></li>
<li><p><strong>X_val</strong> (<em>array-like</em><em>, </em><em>optional</em>) – Validation data and labels.</p></li>
<li><p><strong>y_val</strong> (<em>array-like</em><em>, </em><em>optional</em>) – Validation data and labels.</p></li>
<li><p><strong>time</strong> (<em>int</em>) – The number of optimization trials to run.</p></li>
<li><p><strong>max_epochs</strong> (<em>int</em>) – Maximum number of epochs for training.</p></li>
<li><p><strong>prune_by_epoch</strong> (<em>bool</em>) – Whether to prune based on a specific epoch (True) or the best validation loss (False).</p></li>
<li><p><strong>prune_epoch</strong> (<em>int</em>) – The specific epoch to prune by when prune_by_epoch is True.</p></li>
<li><p><strong>**optimize_kwargs</strong> (<em>dict</em>) – Additional keyword arguments passed to the fit method.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>best_hparams</strong> – Best hyperparameters found during optimization.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.TabMRegressor.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.TabMRegressor.predict" title="Permalink to this definition">#</a></dt>
<dd><p>Predicts target values for the given input samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>X</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The input samples for which to predict target values.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>predictions</strong> – The predicted target values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray, shape (n_samples,) or (n_samples, n_outputs)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.TabMRegressor.score">
<span class="sig-name descname"><span class="pre">score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">sklearn.metrics.mean_squared_error</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.TabMRegressor.score" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate the score of the model using the specified metric.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array-like</em><em> or </em><em>pd.DataFrame</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The input samples to predict.</p></li>
<li><p><strong>y</strong> (<em>array-like</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_outputs</em><em>)</em>) – The true target values against which to evaluate the predictions.</p></li>
<li><p><strong>metric</strong> (<em>callable</em><em>, </em><em>default=mean_squared_error</em>) – The metric function to use for evaluation. Must be a callable with the signature <code class="docutils literal notranslate"><span class="pre">metric(y_true,</span> <span class="pre">y_pred)</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>score</strong> – The score calculated using the specified metric.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.TabMRegressor.set_params">
<span class="sig-name descname"><span class="pre">set_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">parameters</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.TabMRegressor.set_params" title="Permalink to this definition">#</a></dt>
<dd><p>Set the parameters of this estimator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>**parameters</strong> (<em>dict</em>) – Estimator parameters.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – Estimator instance.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mambular.models.TabMLSS">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mambular.models.</span></span><span class="sig-name descname"><span class="pre">TabMLSS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/mambular/models/tabm.html#TabMLSS"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mambular.models.TabMLSS" title="Permalink to this definition">#</a></dt>
<dd><dl class="simple">
<dt>TabM for distributional regressoion. This class extends the SklearnBaseLSS class and uses the TabM model</dt><dd><p>with the default TabM configuration.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The parameters for this class include the attributes from the config
dataclass as well as preprocessing arguments handled by the base class.</p>
<p>Configuration class for the TabM model with batch ensembling and predefined hyperparameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lr</strong> (<em>float</em><em>, </em><em>default=1e-04</em>) – Learning rate for the optimizer.</p></li>
<li><p><strong>lr_patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement after which the learning rate will be reduced.</p></li>
<li><p><strong>weight_decay</strong> (<em>float</em><em>, </em><em>default=1e-06</em>) – Weight decay (L2 penalty) for the optimizer.</p></li>
<li><p><strong>lr_factor</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Factor by which the learning rate is reduced when there is no improvement.</p></li>
<li><p><strong>layer_sizes</strong> (<em>list</em><em>, </em><em>default=</em><em>(</em><em>512</em><em>, </em><em>512</em><em>, </em><em>128</em><em>)</em>) – Sizes of the layers in the model.</p></li>
<li><p><strong>activation</strong> (<em>callable</em><em>, </em><em>default=nn.ReLU</em><em>(</em><em>)</em>) – Activation function for the model layers.</p></li>
<li><p><strong>dropout</strong> (<em>float</em><em>, </em><em>default=0.3</em>) – Dropout rate for regularization.</p></li>
<li><p><strong>norm</strong> (<em>str</em><em>, </em><em>default=None</em>) – Normalization method to be used, if any.</p></li>
<li><p><strong>use_glu</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use Gated Linear Units (GLU) in the model.</p></li>
<li><p><strong>batch_norm</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use batch normalization in the model layers.</p></li>
<li><p><strong>layer_norm</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use layer normalization in the model layers.</p></li>
<li><p><strong>layer_norm_eps</strong> (<em>float</em><em>, </em><em>default=1e-05</em>) – Epsilon value for layer normalization.</p></li>
<li><p><strong>use_embeddings</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to use embedding layers for all features.</p></li>
<li><p><strong>embedding_type</strong> (<em>str</em><em>, </em><em>default=&quot;plr&quot;</em>) – Type of embedding to use (‘plr’, etc.).</p></li>
<li><p><strong>embedding_bias</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use bias in the embedding layers.</p></li>
<li><p><strong>plr_lite</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use a lightweight version of Piecewise Linear Regression (PLR).</p></li>
<li><p><strong>n_frequencies</strong> (<em>int</em><em>, </em><em>default=48</em>) – Number of frequencies for PLR embeddings.</p></li>
<li><p><strong>frequencies_init_scale</strong> (<em>float</em><em>, </em><em>default=0.01</em>) – Initial scale for frequency parameters in embeddings.</p></li>
<li><p><strong>average_embeddings</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to average embeddings during the forward pass.</p></li>
<li><p><strong>embedding_activation</strong> (<em>callable</em><em>, </em><em>default=nn.ReLU</em><em>(</em><em>)</em>) – Activation function for embeddings.</p></li>
<li><p><strong>layer_norm_after_embedding</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to apply layer normalization after embedding layers.</p></li>
<li><p><strong>d_model</strong> (<em>int</em><em>, </em><em>default=64</em>) – Dimensionality of the embeddings.</p></li>
<li><p><strong>ensemble_size</strong> (<em>int</em><em>, </em><em>default=32</em>) – Number of ensemble members for batch ensembling.</p></li>
<li><p><strong>ensemble_scaling_in</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to use input scaling for each ensemble member.</p></li>
<li><p><strong>ensemble_scaling_out</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to use output scaling for each ensemble member.</p></li>
<li><p><strong>ensemble_bias</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to use a unique bias term for each ensemble member.</p></li>
<li><p><strong>scaling_init</strong> (<em>{&quot;ones&quot;</em><em>, </em><em>&quot;random-signs&quot;</em><em>, </em><em>&quot;normal&quot;}</em><em>, </em><em>default=&quot;normal&quot;</em>) – Initialization method for scaling weights.</p></li>
<li><p><strong>average_ensembles</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to average the outputs of the ensembles.</p></li>
<li><p><strong>model_type</strong> (<em>{&quot;mini&quot;</em><em>, </em><em>&quot;full&quot;}</em><em>, </em><em>default=&quot;mini&quot;</em>) – Model type to use (‘mini’ for reduced version, ‘full’ for complete model).</p></li>
<li><p><strong>n_bins</strong> (<em>int</em><em>, </em><em>default=50</em>) – The number of bins to use for numerical feature binning. This parameter is relevant
only if <code class="docutils literal notranslate"><span class="pre">numerical_preprocessing</span></code> is set to ‘binning’, ‘ple’ or ‘one-hot’.</p></li>
<li><p><strong>numerical_preprocessing</strong> (<em>str</em><em>, </em><em>default=&quot;ple&quot;</em>) – The preprocessing strategy for numerical features. Valid options are
‘ple’, ‘binning’, ‘one-hot’, ‘standardization’, ‘min-max’, ‘quantile’, ‘polynomial’,
‘splines’, ‘box-cox’, ‘yeo-johnson’ and None</p></li>
<li><p><strong>categorical_preprocessing</strong> (<em>str</em><em>, </em><em>default=&quot;int&quot;</em>) – The preprocessing strategy for categorical features. Valid options are
‘int’, ‘one-hot’, None</p></li>
<li><p><strong>use_decision_tree_bins</strong> (<em>bool</em><em>, </em><em>default=False</em>) – If True, uses decision tree regression/classification to determine
optimal bin edges for numerical feature binning. This parameter is
relevant only if <code class="docutils literal notranslate"><span class="pre">numerical_preprocessing</span></code> is set to ‘binning’ or ‘one-hot’.</p></li>
<li><p><strong>binning_strategy</strong> (<em>str</em><em>, </em><em>default=&quot;uniform&quot;</em>) – Defines the strategy for binning numerical features. Options include ‘uniform’,
‘quantile’, or other sklearn-compatible strategies.</p></li>
<li><p><strong>task</strong> (<em>str</em><em>, </em><em>default=&quot;regression&quot;</em>) – Indicates the type of machine learning task (‘regression’ or ‘classification’). This can
influence certain preprocessing behaviors, especially when using decision tree-based binning.</p></li>
<li><p><strong>cat_cutoff</strong> (<em>float</em><em> or </em><em>int</em><em>, </em><em>default=0.03</em>) – Indicates the cutoff after which integer values are treated as categorical.
If float, it’s treated as a percentage. If int, it’s the maximum number of
unique values for a column to be considered categorical.</p></li>
<li><p><strong>treat_all_integers_as_numerical</strong> (<em>bool</em><em>, </em><em>default=False</em>) – If True, all integer columns will be treated as numerical, regardless
of their unique value count or proportion.</p></li>
<li><p><strong>degree</strong> (<em>int</em><em>, </em><em>default=3</em>) – The degree of the polynomial features to be used in preprocessing.</p></li>
<li><p><strong>knots</strong> (<em>int</em><em>, </em><em>default=12</em>) – The number of knots to be used in spline transformations.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mambular.models</span> <span class="kn">import</span> <span class="n">TabMLSS</span>
<span class="go">    &gt;&gt;&gt; model = TabMLSS(ensemble_size=32, model_type=&#39;full&#39;)</span>
<span class="go">    &gt;&gt;&gt; model.fit(X_train, y_train, family=&#39;normal&#39;)</span>
<span class="go">    &gt;&gt;&gt; preds = model.predict(X_test)</span>
<span class="go">    &gt;&gt;&gt; model.evaluate(X_test, y_test)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.TabMLSS.build_model">
<span class="sig-name descname"><span class="pre">build_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">101</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_patience</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_decay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataloader_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.TabMLSS.build_model" title="Permalink to this definition">#</a></dt>
<dd><p>Builds the model using the provided training data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The training input samples.</p></li>
<li><p><strong>y</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em>) – The target values (real numbers).</p></li>
<li><p><strong>val_size</strong> (<em>float</em><em>, </em><em>default=0.2</em>) – The proportion of the dataset to include in the validation split if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is None. Ignored if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>X_val</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em><em>, </em><em>optional</em>) – The validation input samples. If provided, <code class="docutils literal notranslate"><span class="pre">X</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> are not split and this data is used for validation.</p></li>
<li><p><strong>y_val</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em><em>, </em><em>optional</em>) – The validation target values. Required if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>random_state</strong> (<em>int</em><em>, </em><em>default=101</em>) – Controls the shuffling applied to the data before applying the split.</p></li>
<li><p><strong>batch_size</strong> (<em>int</em><em>, </em><em>default=64</em>) – Number of samples per gradient update.</p></li>
<li><p><strong>shuffle</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to shuffle the training data before each epoch.</p></li>
<li><p><strong>lr</strong> (<em>float</em><em>, </em><em>default=1e-3</em>) – Learning rate for the optimizer.</p></li>
<li><p><strong>lr_patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement on the validation loss to wait before reducing the learning rate.</p></li>
<li><p><strong>factor</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Factor by which the learning rate will be reduced.</p></li>
<li><p><strong>weight_decay</strong> (<em>float</em><em>, </em><em>default=0.025</em>) – Weight decay (L2 penalty) coefficient.</p></li>
<li><p><strong>dataloader_kwargs</strong> (<em>dict</em><em>, </em><em>default={}</em>) – The kwargs for the pytorch dataloader class.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – The built distributional regressor.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.TabMLSS.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distribution_family</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.TabMLSS.evaluate" title="Permalink to this definition">#</a></dt>
<dd><p>Evaluate the model on the given data using specified metrics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array-like</em><em> or </em><em>pd.DataFrame</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The input samples to predict.</p></li>
<li><p><strong>y_true</strong> (<em>array-like</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>)</em>) – The true class labels against which to evaluate the predictions.</p></li>
<li><p><strong>metrics</strong> (<em>dict</em>) – A dictionary where keys are metric names and values are tuples containing the metric function
and a boolean indicating whether the metric requires probability scores (True) or class labels (False).</p></li>
<li><p><strong>distribution_family</strong> (<em>str</em><em>, </em><em>optional</em>) – Specifies the distribution family the model is predicting for. If None, it will attempt to infer based
on the model’s settings.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>scores</strong> – A dictionary with metric names as keys and their corresponding scores as values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This method uses either the <code class="docutils literal notranslate"><span class="pre">predict</span></code> or <code class="docutils literal notranslate"><span class="pre">predict_proba</span></code> method depending on the metric requirements.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.TabMLSS.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">family</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">101</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patience</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">15</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">monitor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'val_loss'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'min'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_patience</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_decay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checkpoint_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'model_checkpoints'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distributional_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataloader_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rebuild</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">trainer_kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.TabMLSS.fit" title="Permalink to this definition">#</a></dt>
<dd><p>Trains the regression model using the provided training data. Optionally, a separate validation set can be used.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The training input samples.</p></li>
<li><p><strong>y</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em>) – The target values (real numbers).</p></li>
<li><p><strong>family</strong> (<em>str</em>) – The name of the distribution family to use for the loss function. Examples include ‘normal’ for regression tasks.</p></li>
<li><p><strong>val_size</strong> (<em>float</em><em>, </em><em>default=0.2</em>) – The proportion of the dataset to include in the validation split if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is None. Ignored if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>X_val</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em><em>, </em><em>optional</em>) – The validation input samples. If provided, <code class="docutils literal notranslate"><span class="pre">X</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> are not split and this data is used for validation.</p></li>
<li><p><strong>y_val</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em><em>, </em><em>optional</em>) – The validation target values. Required if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>max_epochs</strong> (<em>int</em><em>, </em><em>default=100</em>) – Maximum number of epochs for training.</p></li>
<li><p><strong>random_state</strong> (<em>int</em><em>, </em><em>default=101</em>) – Controls the shuffling applied to the data before applying the split.</p></li>
<li><p><strong>batch_size</strong> (<em>int</em><em>, </em><em>default=64</em>) – Number of samples per gradient update.</p></li>
<li><p><strong>shuffle</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to shuffle the training data before each epoch.</p></li>
<li><p><strong>patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement on the validation loss to wait before early stopping.</p></li>
<li><p><strong>monitor</strong> (<em>str</em><em>, </em><em>default=&quot;val_loss&quot;</em>) – The metric to monitor for early stopping.</p></li>
<li><p><strong>mode</strong> (<em>str</em><em>, </em><em>default=&quot;min&quot;</em>) – Whether the monitored metric should be minimized (<code class="docutils literal notranslate"><span class="pre">min</span></code>) or maximized (<code class="docutils literal notranslate"><span class="pre">max</span></code>).</p></li>
<li><p><strong>lr</strong> (<em>float</em><em>, </em><em>default=1e-3</em>) – Learning rate for the optimizer.</p></li>
<li><p><strong>lr_patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement on the validation loss to wait before reducing the learning rate.</p></li>
<li><p><strong>factor</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Factor by which the learning rate will be reduced.</p></li>
<li><p><strong>weight_decay</strong> (<em>float</em><em>, </em><em>default=0.025</em>) – Weight decay (L2 penalty) coefficient.</p></li>
<li><p><strong>distributional_kwargs</strong> (<em>dict</em><em>, </em><em>default=None</em>) – any arguments taht are specific for a certain distribution.</p></li>
<li><p><strong>checkpoint_path</strong> (<em>str</em><em>, </em><em>default=&quot;model_checkpoints&quot;</em>) – Path where the checkpoints are being saved.</p></li>
<li><p><strong>dataloader_kwargs</strong> (<em>dict</em><em>, </em><em>default={}</em>) – The kwargs for the pytorch dataloader class.</p></li>
<li><p><strong>**trainer_kwargs</strong> (<em>Additional keyword arguments for PyTorch Lightning's Trainer class.</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – The fitted regressor.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.TabMLSS.get_default_metrics">
<span class="sig-name descname"><span class="pre">get_default_metrics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">distribution_family</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.TabMLSS.get_default_metrics" title="Permalink to this definition">#</a></dt>
<dd><p>Provides default metrics based on the distribution family.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>distribution_family</strong> (<em>str</em>) – The distribution family for which to provide default metrics.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>metrics</strong> – A dictionary of default metric functions.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.TabMLSS.get_number_of_params">
<span class="sig-name descname"><span class="pre">get_number_of_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">requires_grad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.TabMLSS.get_number_of_params" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate the number of parameters in the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>requires_grad</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, only count the parameters that require gradients (trainable parameters).
If False, count all parameters. Default is True.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The total number of parameters in the model.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the model has not been built prior to calling this method.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.TabMLSS.get_params">
<span class="sig-name descname"><span class="pre">get_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">deep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.TabMLSS.get_params" title="Permalink to this definition">#</a></dt>
<dd><p>Get parameters for this estimator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>deep</strong> (<em>bool</em><em>, </em><em>default=True</em>) – If True, will return the parameters for this estimator and contained subobjects that are estimators.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>params</strong> – Parameter names mapped to their values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.TabMLSS.optimize_hparams">
<span class="sig-name descname"><span class="pre">optimize_hparams</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prune_by_epoch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prune_epoch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fixed_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'cat_encoding':</span> <span class="pre">'int',</span> <span class="pre">'head_layer_size_length':</span> <span class="pre">0,</span> <span class="pre">'head_skip_layer':</span> <span class="pre">False,</span> <span class="pre">'head_skip_layers':</span> <span class="pre">False,</span> <span class="pre">'pooling_method':</span> <span class="pre">'avg',</span> <span class="pre">'use_cls':</span> <span class="pre">False}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">custom_search_space</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">optimize_kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.TabMLSS.optimize_hparams" title="Permalink to this definition">#</a></dt>
<dd><p>Optimizes hyperparameters using Bayesian optimization with optional pruning.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array-like</em>) – Training data.</p></li>
<li><p><strong>y</strong> (<em>array-like</em>) – Training labels.</p></li>
<li><p><strong>X_val</strong> (<em>array-like</em><em>, </em><em>optional</em>) – Validation data and labels.</p></li>
<li><p><strong>y_val</strong> (<em>array-like</em><em>, </em><em>optional</em>) – Validation data and labels.</p></li>
<li><p><strong>time</strong> (<em>int</em>) – The number of optimization trials to run.</p></li>
<li><p><strong>max_epochs</strong> (<em>int</em>) – Maximum number of epochs for training.</p></li>
<li><p><strong>prune_by_epoch</strong> (<em>bool</em>) – Whether to prune based on a specific epoch (True) or the best validation loss (False).</p></li>
<li><p><strong>prune_epoch</strong> (<em>int</em>) – The specific epoch to prune by when prune_by_epoch is True.</p></li>
<li><p><strong>**optimize_kwargs</strong> (<em>dict</em>) – Additional keyword arguments passed to the fit method.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>best_hparams</strong> – Best hyperparameters found during optimization.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.TabMLSS.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">raw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.TabMLSS.predict" title="Permalink to this definition">#</a></dt>
<dd><p>Predicts target values for the given input samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>X</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The input samples for which to predict target values.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>predictions</strong> – The predicted target values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray, shape (n_samples,) or (n_samples, n_outputs)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.TabMLSS.score">
<span class="sig-name descname"><span class="pre">score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'NLL'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.TabMLSS.score" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate the score of the model using the specified metric.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array-like</em><em> or </em><em>pd.DataFrame</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The input samples to predict.</p></li>
<li><p><strong>y</strong> (<em>array-like</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_outputs</em><em>)</em>) – The true target values against which to evaluate the predictions.</p></li>
<li><p><strong>metric</strong> (<em>str</em><em>, </em><em>default=&quot;NLL&quot;</em>) – So far, only negative log-likelihood is supported</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>score</strong> – The score calculated using the specified metric.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.TabMLSS.set_params">
<span class="sig-name descname"><span class="pre">set_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">parameters</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.TabMLSS.set_params" title="Permalink to this definition">#</a></dt>
<dd><p>Set the parameters of this estimator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>**parameters</strong> (<em>dict</em>) – Estimator parameters.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – Estimator instance.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mambular.models.NODEClassifier">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mambular.models.</span></span><span class="sig-name descname"><span class="pre">NODEClassifier</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/mambular/models/node.html#NODEClassifier"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mambular.models.NODEClassifier" title="Permalink to this definition">#</a></dt>
<dd><dl class="simple">
<dt>Neural Oblivious Decision Ensemble (NODE) Classifier. Slightly different with a MLP as a tabular task specific head.</dt><dd><p>This class extends the SklearnBaseClassifier class and uses the NODE model
with the default NODE configuration.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The parameters for this class include the attributes from the config
dataclass as well as preprocessing arguments handled by the base class.</p>
<p>Configuration class for the Neural Oblivious Decision Ensemble (NODE) model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lr</strong> (<em>float</em><em>, </em><em>default=1e-03</em>) – Learning rate for the optimizer.</p></li>
<li><p><strong>lr_patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs without improvement after which the learning rate will be reduced.</p></li>
<li><p><strong>weight_decay</strong> (<em>float</em><em>, </em><em>default=1e-06</em>) – Weight decay (L2 regularization penalty) applied by the optimizer.</p></li>
<li><p><strong>lr_factor</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Factor by which the learning rate is reduced when there is no improvement.</p></li>
<li><p><strong>num_layers</strong> (<em>int</em><em>, </em><em>default=4</em>) – Number of dense layers in the model.</p></li>
<li><p><strong>layer_dim</strong> (<em>int</em><em>, </em><em>default=128</em>) – Dimensionality of each dense layer.</p></li>
<li><p><strong>tree_dim</strong> (<em>int</em><em>, </em><em>default=1</em>) – Dimensionality of the output from each tree leaf.</p></li>
<li><p><strong>depth</strong> (<em>int</em><em>, </em><em>default=6</em>) – Depth of each decision tree in the ensemble.</p></li>
<li><p><strong>norm</strong> (<em>str</em><em>, </em><em>default=None</em>) – Type of normalization to use in the model.</p></li>
<li><p><strong>use_embeddings</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use embedding layers for categorical features.</p></li>
<li><p><strong>embedding_activation</strong> (<em>callable</em><em>, </em><em>default=nn.Identity</em><em>(</em><em>)</em>) – Activation function to apply to embeddings.</p></li>
<li><p><strong>embedding_type</strong> (<em>str</em><em>, </em><em>default=&quot;linear&quot;</em>) – Type of embedding to use (‘linear’, etc.).</p></li>
<li><p><strong>embedding_bias</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use bias in the embedding layers.</p></li>
<li><p><strong>layer_norm_after_embedding</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to apply layer normalization after embedding layers.</p></li>
<li><p><strong>d_model</strong> (<em>int</em><em>, </em><em>default=32</em>) – Dimensionality of the embedding space.</p></li>
<li><p><strong>plr_lite</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use a lightweight version of Piecewise Linear Regression (PLR).</p></li>
<li><p><strong>n_frequencies</strong> (<em>int</em><em>, </em><em>default=48</em>) – Number of frequencies for PLR embeddings.</p></li>
<li><p><strong>frequencies_init_scale</strong> (<em>float</em><em>, </em><em>default=0.01</em>) – Initial scale for frequency parameters in embeddings.</p></li>
<li><p><strong>head_layer_sizes</strong> (<em>list</em><em>, </em><em>default=</em><em>(</em><em>)</em>) – Sizes of the layers in the model’s head.</p></li>
<li><p><strong>head_dropout</strong> (<em>float</em><em>, </em><em>default=0.5</em>) – Dropout rate for the head layers.</p></li>
<li><p><strong>head_skip_layers</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to skip layers in the head.</p></li>
<li><p><strong>head_activation</strong> (<em>callable</em><em>, </em><em>default=nn.SELU</em><em>(</em><em>)</em>) – Activation function for the head layers.</p></li>
<li><p><strong>head_use_batch_norm</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use batch normalization in the head layers.</p></li>
<li><p><strong>n_bins</strong> (<em>int</em><em>, </em><em>default=50</em>) – The number of bins to use for numerical feature binning. This parameter is relevant
only if <code class="docutils literal notranslate"><span class="pre">numerical_preprocessing</span></code> is set to ‘binning’, ‘ple’ or ‘one-hot’.</p></li>
<li><p><strong>numerical_preprocessing</strong> (<em>str</em><em>, </em><em>default=&quot;ple&quot;</em>) – The preprocessing strategy for numerical features. Valid options are
‘ple’, ‘binning’, ‘one-hot’, ‘standardization’, ‘min-max’, ‘quantile’, ‘polynomial’,
‘splines’, ‘box-cox’, ‘yeo-johnson’ and None</p></li>
<li><p><strong>categorical_preprocessing</strong> (<em>str</em><em>, </em><em>default=&quot;int&quot;</em>) – The preprocessing strategy for categorical features. Valid options are
‘int’, ‘one-hot’, None</p></li>
<li><p><strong>use_decision_tree_bins</strong> (<em>bool</em><em>, </em><em>default=False</em>) – If True, uses decision tree regression/classification to determine
optimal bin edges for numerical feature binning. This parameter is
relevant only if <code class="docutils literal notranslate"><span class="pre">numerical_preprocessing</span></code> is set to ‘binning’ or ‘one-hot’.</p></li>
<li><p><strong>binning_strategy</strong> (<em>str</em><em>, </em><em>default=&quot;uniform&quot;</em>) – Defines the strategy for binning numerical features. Options include ‘uniform’,
‘quantile’, or other sklearn-compatible strategies.</p></li>
<li><p><strong>task</strong> (<em>str</em><em>, </em><em>default=&quot;regression&quot;</em>) – Indicates the type of machine learning task (‘regression’ or ‘classification’). This can
influence certain preprocessing behaviors, especially when using decision tree-based binning.</p></li>
<li><p><strong>cat_cutoff</strong> (<em>float</em><em> or </em><em>int</em><em>, </em><em>default=0.03</em>) – Indicates the cutoff after which integer values are treated as categorical.
If float, it’s treated as a percentage. If int, it’s the maximum number of
unique values for a column to be considered categorical.</p></li>
<li><p><strong>treat_all_integers_as_numerical</strong> (<em>bool</em><em>, </em><em>default=False</em>) – If True, all integer columns will be treated as numerical, regardless
of their unique value count or proportion.</p></li>
<li><p><strong>degree</strong> (<em>int</em><em>, </em><em>default=3</em>) – The degree of the polynomial features to be used in preprocessing.</p></li>
<li><p><strong>knots</strong> (<em>int</em><em>, </em><em>default=12</em>) – The number of knots to be used in spline transformations.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mambular.models</span> <span class="kn">import</span> <span class="n">NODEClassifier</span>
<span class="go">    &gt;&gt;&gt; model = NODEClassifier()</span>
<span class="go">    &gt;&gt;&gt; model.fit(X_train, y_train)</span>
<span class="go">    &gt;&gt;&gt; preds = model.predict(X_test)</span>
<span class="go">    &gt;&gt;&gt; model.evaluate(X_test, y_test)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.NODEClassifier.build_model">
<span class="sig-name descname"><span class="pre">build_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">101</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_patience</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_decay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataloader_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.NODEClassifier.build_model" title="Permalink to this definition">#</a></dt>
<dd><p>Builds the model using the provided training data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The training input samples.</p></li>
<li><p><strong>y</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em>) – The target values (real numbers).</p></li>
<li><p><strong>val_size</strong> (<em>float</em><em>, </em><em>default=0.2</em>) – The proportion of the dataset to include in the validation split if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is None. Ignored if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>X_val</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em><em>, </em><em>optional</em>) – The validation input samples. If provided, <code class="docutils literal notranslate"><span class="pre">X</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> are not split and this data is used for validation.</p></li>
<li><p><strong>y_val</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em><em>, </em><em>optional</em>) – The validation target values. Required if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>random_state</strong> (<em>int</em><em>, </em><em>default=101</em>) – Controls the shuffling applied to the data before applying the split.</p></li>
<li><p><strong>batch_size</strong> (<em>int</em><em>, </em><em>default=64</em>) – Number of samples per gradient update.</p></li>
<li><p><strong>shuffle</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to shuffle the training data before each epoch.</p></li>
<li><p><strong>lr</strong> (<em>float</em><em>, </em><em>default=1e-3</em>) – Learning rate for the optimizer.</p></li>
<li><p><strong>lr_patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement on the validation loss to wait before reducing the learning rate.</p></li>
<li><p><strong>factor</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Factor by which the learning rate will be reduced.</p></li>
<li><p><strong>weight_decay</strong> (<em>float</em><em>, </em><em>default=0.025</em>) – Weight decay (L2 penalty) coefficient.</p></li>
<li><p><strong>dataloader_kwargs</strong> (<em>dict</em><em>, </em><em>default={}</em>) – The kwargs for the pytorch dataloader class.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – The built classifier.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.NODEClassifier.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.NODEClassifier.evaluate" title="Permalink to this definition">#</a></dt>
<dd><p>Evaluate the model on the given data using specified metrics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array-like</em><em> or </em><em>pd.DataFrame</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The input samples to predict.</p></li>
<li><p><strong>y_true</strong> (<em>array-like</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>)</em>) – The true class labels against which to evaluate the predictions.</p></li>
<li><p><strong>metrics</strong> (<em>dict</em>) – A dictionary where keys are metric names and values are tuples containing the metric function
and a boolean indicating whether the metric requires probability scores (True) or class labels (False).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>scores</strong> – A dictionary with metric names as keys and their corresponding scores as values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This method uses either the <code class="docutils literal notranslate"><span class="pre">predict</span></code> or <code class="docutils literal notranslate"><span class="pre">predict_proba</span></code> method depending on the metric requirements.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.NODEClassifier.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">101</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patience</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">15</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">monitor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'val_loss'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'min'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_patience</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_decay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checkpoint_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'model_checkpoints'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataloader_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rebuild</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">trainer_kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.NODEClassifier.fit" title="Permalink to this definition">#</a></dt>
<dd><p>Trains the classification model using the provided training data. Optionally, a separate validation set can be used.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The training input samples.</p></li>
<li><p><strong>y</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em>) – The target values (real numbers).</p></li>
<li><p><strong>val_size</strong> (<em>float</em><em>, </em><em>default=0.2</em>) – The proportion of the dataset to include in the validation split if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is None. Ignored if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>X_val</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em><em>, </em><em>optional</em>) – The validation input samples. If provided, <code class="docutils literal notranslate"><span class="pre">X</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> are not split and this data is used for validation.</p></li>
<li><p><strong>y_val</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em><em>, </em><em>optional</em>) – The validation target values. Required if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>max_epochs</strong> (<em>int</em><em>, </em><em>default=100</em>) – Maximum number of epochs for training.</p></li>
<li><p><strong>random_state</strong> (<em>int</em><em>, </em><em>default=101</em>) – Controls the shuffling applied to the data before applying the split.</p></li>
<li><p><strong>batch_size</strong> (<em>int</em><em>, </em><em>default=64</em>) – Number of samples per gradient update.</p></li>
<li><p><strong>shuffle</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to shuffle the training data before each epoch.</p></li>
<li><p><strong>patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement on the validation loss to wait before early stopping.</p></li>
<li><p><strong>monitor</strong> (<em>str</em><em>, </em><em>default=&quot;val_loss&quot;</em>) – The metric to monitor for early stopping.</p></li>
<li><p><strong>mode</strong> (<em>str</em><em>, </em><em>default=&quot;min&quot;</em>) – Whether the monitored metric should be minimized (<code class="docutils literal notranslate"><span class="pre">min</span></code>) or maximized (<code class="docutils literal notranslate"><span class="pre">max</span></code>).</p></li>
<li><p><strong>lr</strong> (<em>float</em><em>, </em><em>default=1e-3</em>) – Learning rate for the optimizer.</p></li>
<li><p><strong>lr_patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement on the validation loss to wait before reducing the learning rate.</p></li>
<li><p><strong>factor</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Factor by which the learning rate will be reduced.</p></li>
<li><p><strong>weight_decay</strong> (<em>float</em><em>, </em><em>default=0.025</em>) – Weight decay (L2 penalty) coefficient.</p></li>
<li><p><strong>checkpoint_path</strong> (<em>str</em><em>, </em><em>default=&quot;model_checkpoints&quot;</em>) – Path where the checkpoints are being saved.</p></li>
<li><p><strong>dataloader_kwargs</strong> (<em>dict</em><em>, </em><em>default={}</em>) – The kwargs for the pytorch dataloader class.</p></li>
<li><p><strong>rebuild</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to rebuild the model when it already was built.</p></li>
<li><p><strong>**trainer_kwargs</strong> (<em>Additional keyword arguments for PyTorch Lightning's Trainer class.</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – The fitted classifier.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.NODEClassifier.get_number_of_params">
<span class="sig-name descname"><span class="pre">get_number_of_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">requires_grad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.NODEClassifier.get_number_of_params" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate the number of parameters in the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>requires_grad</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, only count the parameters that require gradients (trainable parameters).
If False, count all parameters. Default is True.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The total number of parameters in the model.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the model has not been built prior to calling this method.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.NODEClassifier.get_params">
<span class="sig-name descname"><span class="pre">get_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">deep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.NODEClassifier.get_params" title="Permalink to this definition">#</a></dt>
<dd><p>Get parameters for this estimator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>deep</strong> (<em>bool</em><em>, </em><em>default=True</em>) – If True, will return the parameters for this estimator and contained subobjects that are estimators.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>params</strong> – Parameter names mapped to their values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.NODEClassifier.optimize_hparams">
<span class="sig-name descname"><span class="pre">optimize_hparams</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prune_by_epoch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prune_epoch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fixed_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'cat_encoding':</span> <span class="pre">'int',</span> <span class="pre">'head_layer_size_length':</span> <span class="pre">0,</span> <span class="pre">'head_skip_layer':</span> <span class="pre">False,</span> <span class="pre">'head_skip_layers':</span> <span class="pre">False,</span> <span class="pre">'pooling_method':</span> <span class="pre">'avg',</span> <span class="pre">'use_cls':</span> <span class="pre">False}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">custom_search_space</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">optimize_kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.NODEClassifier.optimize_hparams" title="Permalink to this definition">#</a></dt>
<dd><p>Optimizes hyperparameters using Bayesian optimization with optional pruning.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array-like</em>) – Training data.</p></li>
<li><p><strong>y</strong> (<em>array-like</em>) – Training labels.</p></li>
<li><p><strong>X_val</strong> (<em>array-like</em><em>, </em><em>optional</em>) – Validation data and labels.</p></li>
<li><p><strong>y_val</strong> (<em>array-like</em><em>, </em><em>optional</em>) – Validation data and labels.</p></li>
<li><p><strong>time</strong> (<em>int</em>) – The number of optimization trials to run.</p></li>
<li><p><strong>max_epochs</strong> (<em>int</em>) – Maximum number of epochs for training.</p></li>
<li><p><strong>prune_by_epoch</strong> (<em>bool</em>) – Whether to prune based on a specific epoch (True) or the best validation loss (False).</p></li>
<li><p><strong>prune_epoch</strong> (<em>int</em>) – The specific epoch to prune by when prune_by_epoch is True.</p></li>
<li><p><strong>**optimize_kwargs</strong> (<em>dict</em>) – Additional keyword arguments passed to the fit method.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>best_hparams</strong> – Best hyperparameters found during optimization.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.NODEClassifier.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.NODEClassifier.predict" title="Permalink to this definition">#</a></dt>
<dd><p>Predicts target values for the given input samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>X</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The input samples for which to predict target values.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>predictions</strong> – The predicted target values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray, shape (n_samples,) or (n_samples, n_outputs)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.NODEClassifier.predict_proba">
<span class="sig-name descname"><span class="pre">predict_proba</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.NODEClassifier.predict_proba" title="Permalink to this definition">#</a></dt>
<dd><p>Predict class probabilities for the given input samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>X</strong> (<em>array-like</em><em> or </em><em>pd.DataFrame</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The input samples for which to predict class probabilities.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The method preprocesses the input data using the same preprocessor used during training,
sets the model to evaluation mode, and then performs inference to predict the class probabilities.
Softmax is applied to the logits to obtain probabilities, which are then converted from a PyTorch tensor
to a NumPy array before being returned.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">accuracy_score</span><span class="p">,</span> <span class="n">precision_score</span><span class="p">,</span> <span class="n">f1_score</span><span class="p">,</span> <span class="n">roc_auc_score</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Define the metrics you want to evaluate</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">metrics</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">... </span>    <span class="s1">&#39;Accuracy&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">accuracy_score</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
<span class="gp">... </span>    <span class="s1">&#39;Precision&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">precision_score</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
<span class="gp">... </span>    <span class="s1">&#39;F1 Score&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">f1_score</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
<span class="gp">... </span>    <span class="s1">&#39;AUC Score&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">roc_auc_score</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
<span class="gp">... </span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Assuming &#39;X_test&#39; and &#39;y_test&#39; are your test dataset and labels</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Evaluate using the specified metrics</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results</span> <span class="o">=</span> <span class="n">classifier</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="n">metrics</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>probabilities</strong> – Predicted class probabilities for each input sample.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>ndarray of shape (n_samples, n_classes)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.NODEClassifier.score">
<span class="sig-name descname"><span class="pre">score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(sklearn.metrics.log_loss,</span> <span class="pre">True)</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.NODEClassifier.score" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate the score of the model using the specified metric.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array-like</em><em> or </em><em>pd.DataFrame</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The input samples to predict.</p></li>
<li><p><strong>y</strong> (<em>array-like</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>)</em>) – The true class labels against which to evaluate the predictions.</p></li>
<li><p><strong>metric</strong> (<em>tuple</em><em>, </em><em>default=</em><em>(</em><em>log_loss</em><em>, </em><em>True</em><em>)</em>) – A tuple containing the metric function and a boolean indicating whether the metric requires probability scores (True) or class labels (False).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>score</strong> – The score calculated using the specified metric.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.NODEClassifier.set_params">
<span class="sig-name descname"><span class="pre">set_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">parameters</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.NODEClassifier.set_params" title="Permalink to this definition">#</a></dt>
<dd><p>Set the parameters of this estimator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>**parameters</strong> (<em>dict</em>) – Estimator parameters.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – Estimator instance.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mambular.models.NODERegressor">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mambular.models.</span></span><span class="sig-name descname"><span class="pre">NODERegressor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/mambular/models/node.html#NODERegressor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mambular.models.NODERegressor" title="Permalink to this definition">#</a></dt>
<dd><dl class="simple">
<dt>Neural Oblivious Decision Ensemble (NODE) Regressor. Slightly different with a MLP as a tabular task specific head. This class extends the SklearnBaseRegressor class and uses the NODE model</dt><dd><p>with the default NODE configuration.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The parameters for this class include the attributes from the config
dataclass as well as preprocessing arguments handled by the base class.</p>
<p>Configuration class for the Neural Oblivious Decision Ensemble (NODE) model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lr</strong> (<em>float</em><em>, </em><em>default=1e-03</em>) – Learning rate for the optimizer.</p></li>
<li><p><strong>lr_patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs without improvement after which the learning rate will be reduced.</p></li>
<li><p><strong>weight_decay</strong> (<em>float</em><em>, </em><em>default=1e-06</em>) – Weight decay (L2 regularization penalty) applied by the optimizer.</p></li>
<li><p><strong>lr_factor</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Factor by which the learning rate is reduced when there is no improvement.</p></li>
<li><p><strong>num_layers</strong> (<em>int</em><em>, </em><em>default=4</em>) – Number of dense layers in the model.</p></li>
<li><p><strong>layer_dim</strong> (<em>int</em><em>, </em><em>default=128</em>) – Dimensionality of each dense layer.</p></li>
<li><p><strong>tree_dim</strong> (<em>int</em><em>, </em><em>default=1</em>) – Dimensionality of the output from each tree leaf.</p></li>
<li><p><strong>depth</strong> (<em>int</em><em>, </em><em>default=6</em>) – Depth of each decision tree in the ensemble.</p></li>
<li><p><strong>norm</strong> (<em>str</em><em>, </em><em>default=None</em>) – Type of normalization to use in the model.</p></li>
<li><p><strong>use_embeddings</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use embedding layers for categorical features.</p></li>
<li><p><strong>embedding_activation</strong> (<em>callable</em><em>, </em><em>default=nn.Identity</em><em>(</em><em>)</em>) – Activation function to apply to embeddings.</p></li>
<li><p><strong>embedding_type</strong> (<em>str</em><em>, </em><em>default=&quot;linear&quot;</em>) – Type of embedding to use (‘linear’, etc.).</p></li>
<li><p><strong>embedding_bias</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use bias in the embedding layers.</p></li>
<li><p><strong>layer_norm_after_embedding</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to apply layer normalization after embedding layers.</p></li>
<li><p><strong>d_model</strong> (<em>int</em><em>, </em><em>default=32</em>) – Dimensionality of the embedding space.</p></li>
<li><p><strong>plr_lite</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use a lightweight version of Piecewise Linear Regression (PLR).</p></li>
<li><p><strong>n_frequencies</strong> (<em>int</em><em>, </em><em>default=48</em>) – Number of frequencies for PLR embeddings.</p></li>
<li><p><strong>frequencies_init_scale</strong> (<em>float</em><em>, </em><em>default=0.01</em>) – Initial scale for frequency parameters in embeddings.</p></li>
<li><p><strong>head_layer_sizes</strong> (<em>list</em><em>, </em><em>default=</em><em>(</em><em>)</em>) – Sizes of the layers in the model’s head.</p></li>
<li><p><strong>head_dropout</strong> (<em>float</em><em>, </em><em>default=0.5</em>) – Dropout rate for the head layers.</p></li>
<li><p><strong>head_skip_layers</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to skip layers in the head.</p></li>
<li><p><strong>head_activation</strong> (<em>callable</em><em>, </em><em>default=nn.SELU</em><em>(</em><em>)</em>) – Activation function for the head layers.</p></li>
<li><p><strong>head_use_batch_norm</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use batch normalization in the head layers.</p></li>
<li><p><strong>n_bins</strong> (<em>int</em><em>, </em><em>default=50</em>) – The number of bins to use for numerical feature binning. This parameter is relevant
only if <code class="docutils literal notranslate"><span class="pre">numerical_preprocessing</span></code> is set to ‘binning’, ‘ple’ or ‘one-hot’.</p></li>
<li><p><strong>numerical_preprocessing</strong> (<em>str</em><em>, </em><em>default=&quot;ple&quot;</em>) – The preprocessing strategy for numerical features. Valid options are
‘ple’, ‘binning’, ‘one-hot’, ‘standardization’, ‘min-max’, ‘quantile’, ‘polynomial’,
‘splines’, ‘box-cox’, ‘yeo-johnson’ and None</p></li>
<li><p><strong>categorical_preprocessing</strong> (<em>str</em><em>, </em><em>default=&quot;int&quot;</em>) – The preprocessing strategy for categorical features. Valid options are
‘int’, ‘one-hot’, None</p></li>
<li><p><strong>use_decision_tree_bins</strong> (<em>bool</em><em>, </em><em>default=False</em>) – If True, uses decision tree regression/classification to determine
optimal bin edges for numerical feature binning. This parameter is
relevant only if <code class="docutils literal notranslate"><span class="pre">numerical_preprocessing</span></code> is set to ‘binning’ or ‘one-hot’.</p></li>
<li><p><strong>binning_strategy</strong> (<em>str</em><em>, </em><em>default=&quot;uniform&quot;</em>) – Defines the strategy for binning numerical features. Options include ‘uniform’,
‘quantile’, or other sklearn-compatible strategies.</p></li>
<li><p><strong>task</strong> (<em>str</em><em>, </em><em>default=&quot;regression&quot;</em>) – Indicates the type of machine learning task (‘regression’ or ‘classification’). This can
influence certain preprocessing behaviors, especially when using decision tree-based binning.</p></li>
<li><p><strong>cat_cutoff</strong> (<em>float</em><em> or </em><em>int</em><em>, </em><em>default=0.03</em>) – Indicates the cutoff after which integer values are treated as categorical.
If float, it’s treated as a percentage. If int, it’s the maximum number of
unique values for a column to be considered categorical.</p></li>
<li><p><strong>treat_all_integers_as_numerical</strong> (<em>bool</em><em>, </em><em>default=False</em>) – If True, all integer columns will be treated as numerical, regardless
of their unique value count or proportion.</p></li>
<li><p><strong>degree</strong> (<em>int</em><em>, </em><em>default=3</em>) – The degree of the polynomial features to be used in preprocessing.</p></li>
<li><p><strong>knots</strong> (<em>int</em><em>, </em><em>default=12</em>) – The number of knots to be used in spline transformations.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mambular.models</span> <span class="kn">import</span> <span class="n">NODERegressor</span>
<span class="go">    &gt;&gt;&gt; model = NODERegressor()</span>
<span class="go">    &gt;&gt;&gt; model.fit(X_train, y_train)</span>
<span class="go">    &gt;&gt;&gt; preds = model.predict(X_test)</span>
<span class="go">    &gt;&gt;&gt; model.evaluate(X_test, y_test)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.NODERegressor.build_model">
<span class="sig-name descname"><span class="pre">build_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">101</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_patience</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_decay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataloader_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.NODERegressor.build_model" title="Permalink to this definition">#</a></dt>
<dd><p>Builds the model using the provided training data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The training input samples.</p></li>
<li><p><strong>y</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em>) – The target values (real numbers).</p></li>
<li><p><strong>val_size</strong> (<em>float</em><em>, </em><em>default=0.2</em>) – The proportion of the dataset to include in the validation split if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is None. Ignored if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>X_val</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em><em>, </em><em>optional</em>) – The validation input samples. If provided, <code class="docutils literal notranslate"><span class="pre">X</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> are not split and this data is used for validation.</p></li>
<li><p><strong>y_val</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em><em>, </em><em>optional</em>) – The validation target values. Required if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>random_state</strong> (<em>int</em><em>, </em><em>default=101</em>) – Controls the shuffling applied to the data before applying the split.</p></li>
<li><p><strong>batch_size</strong> (<em>int</em><em>, </em><em>default=64</em>) – Number of samples per gradient update.</p></li>
<li><p><strong>shuffle</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to shuffle the training data before each epoch.</p></li>
<li><p><strong>lr</strong> (<em>float</em><em>, </em><em>default=1e-3</em>) – Learning rate for the optimizer.</p></li>
<li><p><strong>lr_patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement on the validation loss to wait before reducing the learning rate.</p></li>
<li><p><strong>factor</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Factor by which the learning rate will be reduced.</p></li>
<li><p><strong>weight_decay</strong> (<em>float</em><em>, </em><em>default=0.025</em>) – Weight decay (L2 penalty) coefficient.</p></li>
<li><p><strong>dataloader_kwargs</strong> (<em>dict</em><em>, </em><em>default={}</em>) – The kwargs for the pytorch dataloader class.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – The built regressor.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.NODERegressor.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.NODERegressor.evaluate" title="Permalink to this definition">#</a></dt>
<dd><p>Evaluate the model on the given data using specified metrics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array-like</em><em> or </em><em>pd.DataFrame</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The input samples to predict.</p></li>
<li><p><strong>y_true</strong> (<em>array-like</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_outputs</em><em>)</em>) – The true target values against which to evaluate the predictions.</p></li>
<li><p><strong>metrics</strong> (<em>dict</em>) – A dictionary where keys are metric names and values are the metric functions.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This method uses the <code class="docutils literal notranslate"><span class="pre">predict</span></code> method to generate predictions and computes each metric.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_squared_error</span><span class="p">,</span> <span class="n">r2_score</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mambular.models</span> <span class="kn">import</span> <span class="n">MambularRegressor</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">metrics</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">... </span>    <span class="s1">&#39;Mean Squared Error&#39;</span><span class="p">:</span> <span class="n">mean_squared_error</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s1">&#39;R2 Score&#39;</span><span class="p">:</span> <span class="n">r2_score</span>
<span class="gp">... </span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Assuming &#39;X_test&#39; and &#39;y_test&#39; are your test dataset and labels</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Evaluate using the specified metrics</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results</span> <span class="o">=</span> <span class="n">regressor</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="n">metrics</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>scores</strong> – A dictionary with metric names as keys and their corresponding scores as values.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.NODERegressor.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">101</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patience</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">15</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">monitor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'val_loss'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'min'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_patience</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_decay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checkpoint_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'model_checkpoints'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataloader_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rebuild</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">trainer_kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.NODERegressor.fit" title="Permalink to this definition">#</a></dt>
<dd><p>Trains the regression model using the provided training data. Optionally, a separate validation set can be used.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The training input samples.</p></li>
<li><p><strong>y</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em>) – The target values (real numbers).</p></li>
<li><p><strong>val_size</strong> (<em>float</em><em>, </em><em>default=0.2</em>) – The proportion of the dataset to include in the validation split if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is None. Ignored if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>X_val</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em><em>, </em><em>optional</em>) – The validation input samples. If provided, <code class="docutils literal notranslate"><span class="pre">X</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> are not split and this data is used for validation.</p></li>
<li><p><strong>y_val</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em><em>, </em><em>optional</em>) – The validation target values. Required if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>max_epochs</strong> (<em>int</em><em>, </em><em>default=100</em>) – Maximum number of epochs for training.</p></li>
<li><p><strong>random_state</strong> (<em>int</em><em>, </em><em>default=101</em>) – Controls the shuffling applied to the data before applying the split.</p></li>
<li><p><strong>batch_size</strong> (<em>int</em><em>, </em><em>default=64</em>) – Number of samples per gradient update.</p></li>
<li><p><strong>shuffle</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to shuffle the training data before each epoch.</p></li>
<li><p><strong>patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement on the validation loss to wait before early stopping.</p></li>
<li><p><strong>monitor</strong> (<em>str</em><em>, </em><em>default=&quot;val_loss&quot;</em>) – The metric to monitor for early stopping.</p></li>
<li><p><strong>mode</strong> (<em>str</em><em>, </em><em>default=&quot;min&quot;</em>) – Whether the monitored metric should be minimized (<code class="docutils literal notranslate"><span class="pre">min</span></code>) or maximized (<code class="docutils literal notranslate"><span class="pre">max</span></code>).</p></li>
<li><p><strong>lr</strong> (<em>float</em><em>, </em><em>default=1e-3</em>) – Learning rate for the optimizer.</p></li>
<li><p><strong>lr_patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement on the validation loss to wait before reducing the learning rate.</p></li>
<li><p><strong>factor</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Factor by which the learning rate will be reduced.</p></li>
<li><p><strong>weight_decay</strong> (<em>float</em><em>, </em><em>default=0.025</em>) – Weight decay (L2 penalty) coefficient.</p></li>
<li><p><strong>checkpoint_path</strong> (<em>str</em><em>, </em><em>default=&quot;model_checkpoints&quot;</em>) – Path where the checkpoints are being saved.</p></li>
<li><p><strong>dataloader_kwargs</strong> (<em>dict</em><em>, </em><em>default={}</em>) – The kwargs for the pytorch dataloader class.</p></li>
<li><p><strong>**trainer_kwargs</strong> (<em>Additional keyword arguments for PyTorch Lightning's Trainer class.</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – The fitted regressor.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.NODERegressor.get_number_of_params">
<span class="sig-name descname"><span class="pre">get_number_of_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">requires_grad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.NODERegressor.get_number_of_params" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate the number of parameters in the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>requires_grad</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, only count the parameters that require gradients (trainable parameters).
If False, count all parameters. Default is True.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The total number of parameters in the model.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the model has not been built prior to calling this method.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.NODERegressor.get_params">
<span class="sig-name descname"><span class="pre">get_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">deep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.NODERegressor.get_params" title="Permalink to this definition">#</a></dt>
<dd><p>Get parameters for this estimator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>deep</strong> (<em>bool</em><em>, </em><em>default=True</em>) – If True, will return the parameters for this estimator and contained subobjects that are estimators.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>params</strong> – Parameter names mapped to their values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.NODERegressor.optimize_hparams">
<span class="sig-name descname"><span class="pre">optimize_hparams</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prune_by_epoch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prune_epoch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fixed_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'cat_encoding':</span> <span class="pre">'int',</span> <span class="pre">'head_layer_size_length':</span> <span class="pre">0,</span> <span class="pre">'head_skip_layer':</span> <span class="pre">False,</span> <span class="pre">'head_skip_layers':</span> <span class="pre">False,</span> <span class="pre">'pooling_method':</span> <span class="pre">'avg',</span> <span class="pre">'use_cls':</span> <span class="pre">False}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">custom_search_space</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">optimize_kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.NODERegressor.optimize_hparams" title="Permalink to this definition">#</a></dt>
<dd><p>Optimizes hyperparameters using Bayesian optimization with optional pruning.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array-like</em>) – Training data.</p></li>
<li><p><strong>y</strong> (<em>array-like</em>) – Training labels.</p></li>
<li><p><strong>X_val</strong> (<em>array-like</em><em>, </em><em>optional</em>) – Validation data and labels.</p></li>
<li><p><strong>y_val</strong> (<em>array-like</em><em>, </em><em>optional</em>) – Validation data and labels.</p></li>
<li><p><strong>time</strong> (<em>int</em>) – The number of optimization trials to run.</p></li>
<li><p><strong>max_epochs</strong> (<em>int</em>) – Maximum number of epochs for training.</p></li>
<li><p><strong>prune_by_epoch</strong> (<em>bool</em>) – Whether to prune based on a specific epoch (True) or the best validation loss (False).</p></li>
<li><p><strong>prune_epoch</strong> (<em>int</em>) – The specific epoch to prune by when prune_by_epoch is True.</p></li>
<li><p><strong>**optimize_kwargs</strong> (<em>dict</em>) – Additional keyword arguments passed to the fit method.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>best_hparams</strong> – Best hyperparameters found during optimization.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.NODERegressor.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.NODERegressor.predict" title="Permalink to this definition">#</a></dt>
<dd><p>Predicts target values for the given input samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>X</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The input samples for which to predict target values.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>predictions</strong> – The predicted target values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray, shape (n_samples,) or (n_samples, n_outputs)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.NODERegressor.score">
<span class="sig-name descname"><span class="pre">score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">sklearn.metrics.mean_squared_error</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.NODERegressor.score" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate the score of the model using the specified metric.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array-like</em><em> or </em><em>pd.DataFrame</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The input samples to predict.</p></li>
<li><p><strong>y</strong> (<em>array-like</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_outputs</em><em>)</em>) – The true target values against which to evaluate the predictions.</p></li>
<li><p><strong>metric</strong> (<em>callable</em><em>, </em><em>default=mean_squared_error</em>) – The metric function to use for evaluation. Must be a callable with the signature <code class="docutils literal notranslate"><span class="pre">metric(y_true,</span> <span class="pre">y_pred)</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>score</strong> – The score calculated using the specified metric.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.NODERegressor.set_params">
<span class="sig-name descname"><span class="pre">set_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">parameters</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.NODERegressor.set_params" title="Permalink to this definition">#</a></dt>
<dd><p>Set the parameters of this estimator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>**parameters</strong> (<em>dict</em>) – Estimator parameters.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – Estimator instance.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mambular.models.NODELSS">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mambular.models.</span></span><span class="sig-name descname"><span class="pre">NODELSS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/mambular/models/node.html#NODELSS"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mambular.models.NODELSS" title="Permalink to this definition">#</a></dt>
<dd><dl class="simple">
<dt>Neural Oblivious Decision Ensemble (NODE) for distributional regression. Slightly different with a MLP as a tabular task specific head.</dt><dd><p>This class extends the SklearnBaseLSS class and uses the NODE model
with the default NODE configuration.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The parameters for this class include the attributes from the config
dataclass as well as preprocessing arguments handled by the base class.</p>
<p>Configuration class for the Neural Oblivious Decision Ensemble (NODE) model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lr</strong> (<em>float</em><em>, </em><em>default=1e-03</em>) – Learning rate for the optimizer.</p></li>
<li><p><strong>lr_patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs without improvement after which the learning rate will be reduced.</p></li>
<li><p><strong>weight_decay</strong> (<em>float</em><em>, </em><em>default=1e-06</em>) – Weight decay (L2 regularization penalty) applied by the optimizer.</p></li>
<li><p><strong>lr_factor</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Factor by which the learning rate is reduced when there is no improvement.</p></li>
<li><p><strong>num_layers</strong> (<em>int</em><em>, </em><em>default=4</em>) – Number of dense layers in the model.</p></li>
<li><p><strong>layer_dim</strong> (<em>int</em><em>, </em><em>default=128</em>) – Dimensionality of each dense layer.</p></li>
<li><p><strong>tree_dim</strong> (<em>int</em><em>, </em><em>default=1</em>) – Dimensionality of the output from each tree leaf.</p></li>
<li><p><strong>depth</strong> (<em>int</em><em>, </em><em>default=6</em>) – Depth of each decision tree in the ensemble.</p></li>
<li><p><strong>norm</strong> (<em>str</em><em>, </em><em>default=None</em>) – Type of normalization to use in the model.</p></li>
<li><p><strong>use_embeddings</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use embedding layers for categorical features.</p></li>
<li><p><strong>embedding_activation</strong> (<em>callable</em><em>, </em><em>default=nn.Identity</em><em>(</em><em>)</em>) – Activation function to apply to embeddings.</p></li>
<li><p><strong>embedding_type</strong> (<em>str</em><em>, </em><em>default=&quot;linear&quot;</em>) – Type of embedding to use (‘linear’, etc.).</p></li>
<li><p><strong>embedding_bias</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use bias in the embedding layers.</p></li>
<li><p><strong>layer_norm_after_embedding</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to apply layer normalization after embedding layers.</p></li>
<li><p><strong>d_model</strong> (<em>int</em><em>, </em><em>default=32</em>) – Dimensionality of the embedding space.</p></li>
<li><p><strong>plr_lite</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use a lightweight version of Piecewise Linear Regression (PLR).</p></li>
<li><p><strong>n_frequencies</strong> (<em>int</em><em>, </em><em>default=48</em>) – Number of frequencies for PLR embeddings.</p></li>
<li><p><strong>frequencies_init_scale</strong> (<em>float</em><em>, </em><em>default=0.01</em>) – Initial scale for frequency parameters in embeddings.</p></li>
<li><p><strong>head_layer_sizes</strong> (<em>list</em><em>, </em><em>default=</em><em>(</em><em>)</em>) – Sizes of the layers in the model’s head.</p></li>
<li><p><strong>head_dropout</strong> (<em>float</em><em>, </em><em>default=0.5</em>) – Dropout rate for the head layers.</p></li>
<li><p><strong>head_skip_layers</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to skip layers in the head.</p></li>
<li><p><strong>head_activation</strong> (<em>callable</em><em>, </em><em>default=nn.SELU</em><em>(</em><em>)</em>) – Activation function for the head layers.</p></li>
<li><p><strong>head_use_batch_norm</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to use batch normalization in the head layers.</p></li>
<li><p><strong>n_bins</strong> (<em>int</em><em>, </em><em>default=50</em>) – The number of bins to use for numerical feature binning. This parameter is relevant
only if <code class="docutils literal notranslate"><span class="pre">numerical_preprocessing</span></code> is set to ‘binning’, ‘ple’ or ‘one-hot’.</p></li>
<li><p><strong>numerical_preprocessing</strong> (<em>str</em><em>, </em><em>default=&quot;ple&quot;</em>) – The preprocessing strategy for numerical features. Valid options are
‘ple’, ‘binning’, ‘one-hot’, ‘standardization’, ‘min-max’, ‘quantile’, ‘polynomial’,
‘splines’, ‘box-cox’, ‘yeo-johnson’ and None</p></li>
<li><p><strong>categorical_preprocessing</strong> (<em>str</em><em>, </em><em>default=&quot;int&quot;</em>) – The preprocessing strategy for categorical features. Valid options are
‘int’, ‘one-hot’, None</p></li>
<li><p><strong>use_decision_tree_bins</strong> (<em>bool</em><em>, </em><em>default=False</em>) – If True, uses decision tree regression/classification to determine
optimal bin edges for numerical feature binning. This parameter is
relevant only if <code class="docutils literal notranslate"><span class="pre">numerical_preprocessing</span></code> is set to ‘binning’ or ‘one-hot’.</p></li>
<li><p><strong>binning_strategy</strong> (<em>str</em><em>, </em><em>default=&quot;uniform&quot;</em>) – Defines the strategy for binning numerical features. Options include ‘uniform’,
‘quantile’, or other sklearn-compatible strategies.</p></li>
<li><p><strong>task</strong> (<em>str</em><em>, </em><em>default=&quot;regression&quot;</em>) – Indicates the type of machine learning task (‘regression’ or ‘classification’). This can
influence certain preprocessing behaviors, especially when using decision tree-based binning.</p></li>
<li><p><strong>cat_cutoff</strong> (<em>float</em><em> or </em><em>int</em><em>, </em><em>default=0.03</em>) – Indicates the cutoff after which integer values are treated as categorical.
If float, it’s treated as a percentage. If int, it’s the maximum number of
unique values for a column to be considered categorical.</p></li>
<li><p><strong>treat_all_integers_as_numerical</strong> (<em>bool</em><em>, </em><em>default=False</em>) – If True, all integer columns will be treated as numerical, regardless
of their unique value count or proportion.</p></li>
<li><p><strong>degree</strong> (<em>int</em><em>, </em><em>default=3</em>) – The degree of the polynomial features to be used in preprocessing.</p></li>
<li><p><strong>knots</strong> (<em>int</em><em>, </em><em>default=12</em>) – The number of knots to be used in spline transformations.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mambular.models</span> <span class="kn">import</span> <span class="n">NODELSS</span>
<span class="go">    &gt;&gt;&gt; model = NODELSS()</span>
<span class="go">    &gt;&gt;&gt; model.fit(X_train, y_train, family=&#39;normal&#39;)</span>
<span class="go">    &gt;&gt;&gt; preds = model.predict(X_test)</span>
<span class="go">    &gt;&gt;&gt; model.evaluate(X_test, y_test)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.NODELSS.build_model">
<span class="sig-name descname"><span class="pre">build_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">101</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_patience</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_decay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataloader_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.NODELSS.build_model" title="Permalink to this definition">#</a></dt>
<dd><p>Builds the model using the provided training data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The training input samples.</p></li>
<li><p><strong>y</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em>) – The target values (real numbers).</p></li>
<li><p><strong>val_size</strong> (<em>float</em><em>, </em><em>default=0.2</em>) – The proportion of the dataset to include in the validation split if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is None. Ignored if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>X_val</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em><em>, </em><em>optional</em>) – The validation input samples. If provided, <code class="docutils literal notranslate"><span class="pre">X</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> are not split and this data is used for validation.</p></li>
<li><p><strong>y_val</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em><em>, </em><em>optional</em>) – The validation target values. Required if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>random_state</strong> (<em>int</em><em>, </em><em>default=101</em>) – Controls the shuffling applied to the data before applying the split.</p></li>
<li><p><strong>batch_size</strong> (<em>int</em><em>, </em><em>default=64</em>) – Number of samples per gradient update.</p></li>
<li><p><strong>shuffle</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to shuffle the training data before each epoch.</p></li>
<li><p><strong>lr</strong> (<em>float</em><em>, </em><em>default=1e-3</em>) – Learning rate for the optimizer.</p></li>
<li><p><strong>lr_patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement on the validation loss to wait before reducing the learning rate.</p></li>
<li><p><strong>factor</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Factor by which the learning rate will be reduced.</p></li>
<li><p><strong>weight_decay</strong> (<em>float</em><em>, </em><em>default=0.025</em>) – Weight decay (L2 penalty) coefficient.</p></li>
<li><p><strong>dataloader_kwargs</strong> (<em>dict</em><em>, </em><em>default={}</em>) – The kwargs for the pytorch dataloader class.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – The built distributional regressor.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.NODELSS.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distribution_family</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.NODELSS.evaluate" title="Permalink to this definition">#</a></dt>
<dd><p>Evaluate the model on the given data using specified metrics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array-like</em><em> or </em><em>pd.DataFrame</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The input samples to predict.</p></li>
<li><p><strong>y_true</strong> (<em>array-like</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>)</em>) – The true class labels against which to evaluate the predictions.</p></li>
<li><p><strong>metrics</strong> (<em>dict</em>) – A dictionary where keys are metric names and values are tuples containing the metric function
and a boolean indicating whether the metric requires probability scores (True) or class labels (False).</p></li>
<li><p><strong>distribution_family</strong> (<em>str</em><em>, </em><em>optional</em>) – Specifies the distribution family the model is predicting for. If None, it will attempt to infer based
on the model’s settings.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>scores</strong> – A dictionary with metric names as keys and their corresponding scores as values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This method uses either the <code class="docutils literal notranslate"><span class="pre">predict</span></code> or <code class="docutils literal notranslate"><span class="pre">predict_proba</span></code> method depending on the metric requirements.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.NODELSS.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">family</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">101</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patience</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">15</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">monitor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'val_loss'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'min'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_patience</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_decay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checkpoint_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'model_checkpoints'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distributional_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataloader_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rebuild</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">trainer_kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.NODELSS.fit" title="Permalink to this definition">#</a></dt>
<dd><p>Trains the regression model using the provided training data. Optionally, a separate validation set can be used.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The training input samples.</p></li>
<li><p><strong>y</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em>) – The target values (real numbers).</p></li>
<li><p><strong>family</strong> (<em>str</em>) – The name of the distribution family to use for the loss function. Examples include ‘normal’ for regression tasks.</p></li>
<li><p><strong>val_size</strong> (<em>float</em><em>, </em><em>default=0.2</em>) – The proportion of the dataset to include in the validation split if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is None. Ignored if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>X_val</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em><em>, </em><em>optional</em>) – The validation input samples. If provided, <code class="docutils literal notranslate"><span class="pre">X</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> are not split and this data is used for validation.</p></li>
<li><p><strong>y_val</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em><em>, </em><em>optional</em>) – The validation target values. Required if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>max_epochs</strong> (<em>int</em><em>, </em><em>default=100</em>) – Maximum number of epochs for training.</p></li>
<li><p><strong>random_state</strong> (<em>int</em><em>, </em><em>default=101</em>) – Controls the shuffling applied to the data before applying the split.</p></li>
<li><p><strong>batch_size</strong> (<em>int</em><em>, </em><em>default=64</em>) – Number of samples per gradient update.</p></li>
<li><p><strong>shuffle</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to shuffle the training data before each epoch.</p></li>
<li><p><strong>patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement on the validation loss to wait before early stopping.</p></li>
<li><p><strong>monitor</strong> (<em>str</em><em>, </em><em>default=&quot;val_loss&quot;</em>) – The metric to monitor for early stopping.</p></li>
<li><p><strong>mode</strong> (<em>str</em><em>, </em><em>default=&quot;min&quot;</em>) – Whether the monitored metric should be minimized (<code class="docutils literal notranslate"><span class="pre">min</span></code>) or maximized (<code class="docutils literal notranslate"><span class="pre">max</span></code>).</p></li>
<li><p><strong>lr</strong> (<em>float</em><em>, </em><em>default=1e-3</em>) – Learning rate for the optimizer.</p></li>
<li><p><strong>lr_patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement on the validation loss to wait before reducing the learning rate.</p></li>
<li><p><strong>factor</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Factor by which the learning rate will be reduced.</p></li>
<li><p><strong>weight_decay</strong> (<em>float</em><em>, </em><em>default=0.025</em>) – Weight decay (L2 penalty) coefficient.</p></li>
<li><p><strong>distributional_kwargs</strong> (<em>dict</em><em>, </em><em>default=None</em>) – any arguments taht are specific for a certain distribution.</p></li>
<li><p><strong>checkpoint_path</strong> (<em>str</em><em>, </em><em>default=&quot;model_checkpoints&quot;</em>) – Path where the checkpoints are being saved.</p></li>
<li><p><strong>dataloader_kwargs</strong> (<em>dict</em><em>, </em><em>default={}</em>) – The kwargs for the pytorch dataloader class.</p></li>
<li><p><strong>**trainer_kwargs</strong> (<em>Additional keyword arguments for PyTorch Lightning's Trainer class.</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – The fitted regressor.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.NODELSS.get_default_metrics">
<span class="sig-name descname"><span class="pre">get_default_metrics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">distribution_family</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.NODELSS.get_default_metrics" title="Permalink to this definition">#</a></dt>
<dd><p>Provides default metrics based on the distribution family.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>distribution_family</strong> (<em>str</em>) – The distribution family for which to provide default metrics.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>metrics</strong> – A dictionary of default metric functions.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.NODELSS.get_number_of_params">
<span class="sig-name descname"><span class="pre">get_number_of_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">requires_grad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.NODELSS.get_number_of_params" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate the number of parameters in the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>requires_grad</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, only count the parameters that require gradients (trainable parameters).
If False, count all parameters. Default is True.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The total number of parameters in the model.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the model has not been built prior to calling this method.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.NODELSS.get_params">
<span class="sig-name descname"><span class="pre">get_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">deep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.NODELSS.get_params" title="Permalink to this definition">#</a></dt>
<dd><p>Get parameters for this estimator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>deep</strong> (<em>bool</em><em>, </em><em>default=True</em>) – If True, will return the parameters for this estimator and contained subobjects that are estimators.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>params</strong> – Parameter names mapped to their values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.NODELSS.optimize_hparams">
<span class="sig-name descname"><span class="pre">optimize_hparams</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prune_by_epoch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prune_epoch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fixed_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'cat_encoding':</span> <span class="pre">'int',</span> <span class="pre">'head_layer_size_length':</span> <span class="pre">0,</span> <span class="pre">'head_skip_layer':</span> <span class="pre">False,</span> <span class="pre">'head_skip_layers':</span> <span class="pre">False,</span> <span class="pre">'pooling_method':</span> <span class="pre">'avg',</span> <span class="pre">'use_cls':</span> <span class="pre">False}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">custom_search_space</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">optimize_kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.NODELSS.optimize_hparams" title="Permalink to this definition">#</a></dt>
<dd><p>Optimizes hyperparameters using Bayesian optimization with optional pruning.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array-like</em>) – Training data.</p></li>
<li><p><strong>y</strong> (<em>array-like</em>) – Training labels.</p></li>
<li><p><strong>X_val</strong> (<em>array-like</em><em>, </em><em>optional</em>) – Validation data and labels.</p></li>
<li><p><strong>y_val</strong> (<em>array-like</em><em>, </em><em>optional</em>) – Validation data and labels.</p></li>
<li><p><strong>time</strong> (<em>int</em>) – The number of optimization trials to run.</p></li>
<li><p><strong>max_epochs</strong> (<em>int</em>) – Maximum number of epochs for training.</p></li>
<li><p><strong>prune_by_epoch</strong> (<em>bool</em>) – Whether to prune based on a specific epoch (True) or the best validation loss (False).</p></li>
<li><p><strong>prune_epoch</strong> (<em>int</em>) – The specific epoch to prune by when prune_by_epoch is True.</p></li>
<li><p><strong>**optimize_kwargs</strong> (<em>dict</em>) – Additional keyword arguments passed to the fit method.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>best_hparams</strong> – Best hyperparameters found during optimization.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.NODELSS.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">raw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.NODELSS.predict" title="Permalink to this definition">#</a></dt>
<dd><p>Predicts target values for the given input samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>X</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The input samples for which to predict target values.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>predictions</strong> – The predicted target values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray, shape (n_samples,) or (n_samples, n_outputs)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.NODELSS.score">
<span class="sig-name descname"><span class="pre">score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'NLL'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.NODELSS.score" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate the score of the model using the specified metric.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array-like</em><em> or </em><em>pd.DataFrame</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The input samples to predict.</p></li>
<li><p><strong>y</strong> (<em>array-like</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_outputs</em><em>)</em>) – The true target values against which to evaluate the predictions.</p></li>
<li><p><strong>metric</strong> (<em>str</em><em>, </em><em>default=&quot;NLL&quot;</em>) – So far, only negative log-likelihood is supported</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>score</strong> – The score calculated using the specified metric.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.NODELSS.set_params">
<span class="sig-name descname"><span class="pre">set_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">parameters</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.NODELSS.set_params" title="Permalink to this definition">#</a></dt>
<dd><p>Set the parameters of this estimator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>**parameters</strong> (<em>dict</em>) – Estimator parameters.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – Estimator instance.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mambular.models.NDTFClassifier">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mambular.models.</span></span><span class="sig-name descname"><span class="pre">NDTFClassifier</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/mambular/models/ndtf.html#NDTFClassifier"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mambular.models.NDTFClassifier" title="Permalink to this definition">#</a></dt>
<dd><dl class="simple">
<dt>Neural Decision Forest classifier. This class extends the SklearnBasClassifier class and uses the NDTF model</dt><dd><p>with the default NDTF configuration.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The parameters for this class include the attributes from the config
dataclass as well as preprocessing arguments handled by the base class.</p>
<p>Configuration class for the default Neural Decision Tree Forest (NDTF) model with predefined hyperparameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lr</strong> (<em>float</em><em>, </em><em>default=1e-04</em>) – Learning rate for the optimizer.</p></li>
<li><p><strong>lr_patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement after which the learning rate will be reduced.</p></li>
<li><p><strong>weight_decay</strong> (<em>float</em><em>, </em><em>default=1e-06</em>) – Weight decay (L2 penalty) applied to the model’s weights during optimization.</p></li>
<li><p><strong>lr_factor</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Factor by which the learning rate will be reduced when a plateau is reached.</p></li>
<li><p><strong>min_depth</strong> (<em>int</em><em>, </em><em>default=2</em>) – Minimum depth of trees in the forest. Controls the simplest model structure.</p></li>
<li><p><strong>max_depth</strong> (<em>int</em><em>, </em><em>default=10</em>) – Maximum depth of trees in the forest. Controls the maximum complexity of the trees.</p></li>
<li><p><strong>temperature</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Temperature parameter for softening the node decisions during path probability calculation.</p></li>
<li><p><strong>node_sampling</strong> (<em>float</em><em>, </em><em>default=0.3</em>) – Fraction of nodes sampled for regularization penalty calculation. Reduces computation by focusing on a subset of nodes.</p></li>
<li><p><strong>lamda</strong> (<em>float</em><em>, </em><em>default=0.3</em>) – Regularization parameter to control the complexity of the paths, penalizing overconfident or imbalanced paths.</p></li>
<li><p><strong>n_ensembles</strong> (<em>int</em><em>, </em><em>default=12</em>) – Number of trees in the forest</p></li>
<li><p><strong>penalty_factor</strong> (<em>float</em><em>, </em><em>default=0.01</em>) – Factor with which the penalty is multiplied</p></li>
<li><p><strong>n_bins</strong> (<em>int</em><em>, </em><em>default=50</em>) – The number of bins to use for numerical feature binning. This parameter is relevant
only if <code class="docutils literal notranslate"><span class="pre">numerical_preprocessing</span></code> is set to ‘binning’, ‘ple’ or ‘one-hot’.</p></li>
<li><p><strong>numerical_preprocessing</strong> (<em>str</em><em>, </em><em>default=&quot;ple&quot;</em>) – The preprocessing strategy for numerical features. Valid options are
‘ple’, ‘binning’, ‘one-hot’, ‘standardization’, ‘min-max’, ‘quantile’, ‘polynomial’,
‘splines’, ‘box-cox’, ‘yeo-johnson’ and None</p></li>
<li><p><strong>categorical_preprocessing</strong> (<em>str</em><em>, </em><em>default=&quot;int&quot;</em>) – The preprocessing strategy for categorical features. Valid options are
‘int’, ‘one-hot’, None</p></li>
<li><p><strong>use_decision_tree_bins</strong> (<em>bool</em><em>, </em><em>default=False</em>) – If True, uses decision tree regression/classification to determine
optimal bin edges for numerical feature binning. This parameter is
relevant only if <code class="docutils literal notranslate"><span class="pre">numerical_preprocessing</span></code> is set to ‘binning’ or ‘one-hot’.</p></li>
<li><p><strong>binning_strategy</strong> (<em>str</em><em>, </em><em>default=&quot;uniform&quot;</em>) – Defines the strategy for binning numerical features. Options include ‘uniform’,
‘quantile’, or other sklearn-compatible strategies.</p></li>
<li><p><strong>task</strong> (<em>str</em><em>, </em><em>default=&quot;regression&quot;</em>) – Indicates the type of machine learning task (‘regression’ or ‘classification’). This can
influence certain preprocessing behaviors, especially when using decision tree-based binning.</p></li>
<li><p><strong>cat_cutoff</strong> (<em>float</em><em> or </em><em>int</em><em>, </em><em>default=0.03</em>) – Indicates the cutoff after which integer values are treated as categorical.
If float, it’s treated as a percentage. If int, it’s the maximum number of
unique values for a column to be considered categorical.</p></li>
<li><p><strong>treat_all_integers_as_numerical</strong> (<em>bool</em><em>, </em><em>default=False</em>) – If True, all integer columns will be treated as numerical, regardless
of their unique value count or proportion.</p></li>
<li><p><strong>degree</strong> (<em>int</em><em>, </em><em>default=3</em>) – The degree of the polynomial features to be used in preprocessing.</p></li>
<li><p><strong>knots</strong> (<em>int</em><em>, </em><em>default=12</em>) – The number of knots to be used in spline transformations.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.NDTFClassifier.build_model">
<span class="sig-name descname"><span class="pre">build_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">101</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_patience</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_decay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataloader_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.NDTFClassifier.build_model" title="Permalink to this definition">#</a></dt>
<dd><p>Builds the model using the provided training data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The training input samples.</p></li>
<li><p><strong>y</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em>) – The target values (real numbers).</p></li>
<li><p><strong>val_size</strong> (<em>float</em><em>, </em><em>default=0.2</em>) – The proportion of the dataset to include in the validation split if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is None. Ignored if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>X_val</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em><em>, </em><em>optional</em>) – The validation input samples. If provided, <code class="docutils literal notranslate"><span class="pre">X</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> are not split and this data is used for validation.</p></li>
<li><p><strong>y_val</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em><em>, </em><em>optional</em>) – The validation target values. Required if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>random_state</strong> (<em>int</em><em>, </em><em>default=101</em>) – Controls the shuffling applied to the data before applying the split.</p></li>
<li><p><strong>batch_size</strong> (<em>int</em><em>, </em><em>default=64</em>) – Number of samples per gradient update.</p></li>
<li><p><strong>shuffle</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to shuffle the training data before each epoch.</p></li>
<li><p><strong>lr</strong> (<em>float</em><em>, </em><em>default=1e-3</em>) – Learning rate for the optimizer.</p></li>
<li><p><strong>lr_patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement on the validation loss to wait before reducing the learning rate.</p></li>
<li><p><strong>factor</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Factor by which the learning rate will be reduced.</p></li>
<li><p><strong>weight_decay</strong> (<em>float</em><em>, </em><em>default=0.025</em>) – Weight decay (L2 penalty) coefficient.</p></li>
<li><p><strong>dataloader_kwargs</strong> (<em>dict</em><em>, </em><em>default={}</em>) – The kwargs for the pytorch dataloader class.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – The built classifier.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.NDTFClassifier.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.NDTFClassifier.evaluate" title="Permalink to this definition">#</a></dt>
<dd><p>Evaluate the model on the given data using specified metrics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array-like</em><em> or </em><em>pd.DataFrame</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The input samples to predict.</p></li>
<li><p><strong>y_true</strong> (<em>array-like</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>)</em>) – The true class labels against which to evaluate the predictions.</p></li>
<li><p><strong>metrics</strong> (<em>dict</em>) – A dictionary where keys are metric names and values are tuples containing the metric function
and a boolean indicating whether the metric requires probability scores (True) or class labels (False).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>scores</strong> – A dictionary with metric names as keys and their corresponding scores as values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This method uses either the <code class="docutils literal notranslate"><span class="pre">predict</span></code> or <code class="docutils literal notranslate"><span class="pre">predict_proba</span></code> method depending on the metric requirements.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.NDTFClassifier.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">101</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patience</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">15</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">monitor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'val_loss'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'min'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_patience</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_decay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checkpoint_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'model_checkpoints'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataloader_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rebuild</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">trainer_kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.NDTFClassifier.fit" title="Permalink to this definition">#</a></dt>
<dd><p>Trains the classification model using the provided training data. Optionally, a separate validation set can be used.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The training input samples.</p></li>
<li><p><strong>y</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em>) – The target values (real numbers).</p></li>
<li><p><strong>val_size</strong> (<em>float</em><em>, </em><em>default=0.2</em>) – The proportion of the dataset to include in the validation split if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is None. Ignored if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>X_val</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em><em>, </em><em>optional</em>) – The validation input samples. If provided, <code class="docutils literal notranslate"><span class="pre">X</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> are not split and this data is used for validation.</p></li>
<li><p><strong>y_val</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em><em>, </em><em>optional</em>) – The validation target values. Required if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>max_epochs</strong> (<em>int</em><em>, </em><em>default=100</em>) – Maximum number of epochs for training.</p></li>
<li><p><strong>random_state</strong> (<em>int</em><em>, </em><em>default=101</em>) – Controls the shuffling applied to the data before applying the split.</p></li>
<li><p><strong>batch_size</strong> (<em>int</em><em>, </em><em>default=64</em>) – Number of samples per gradient update.</p></li>
<li><p><strong>shuffle</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to shuffle the training data before each epoch.</p></li>
<li><p><strong>patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement on the validation loss to wait before early stopping.</p></li>
<li><p><strong>monitor</strong> (<em>str</em><em>, </em><em>default=&quot;val_loss&quot;</em>) – The metric to monitor for early stopping.</p></li>
<li><p><strong>mode</strong> (<em>str</em><em>, </em><em>default=&quot;min&quot;</em>) – Whether the monitored metric should be minimized (<code class="docutils literal notranslate"><span class="pre">min</span></code>) or maximized (<code class="docutils literal notranslate"><span class="pre">max</span></code>).</p></li>
<li><p><strong>lr</strong> (<em>float</em><em>, </em><em>default=1e-3</em>) – Learning rate for the optimizer.</p></li>
<li><p><strong>lr_patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement on the validation loss to wait before reducing the learning rate.</p></li>
<li><p><strong>factor</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Factor by which the learning rate will be reduced.</p></li>
<li><p><strong>weight_decay</strong> (<em>float</em><em>, </em><em>default=0.025</em>) – Weight decay (L2 penalty) coefficient.</p></li>
<li><p><strong>checkpoint_path</strong> (<em>str</em><em>, </em><em>default=&quot;model_checkpoints&quot;</em>) – Path where the checkpoints are being saved.</p></li>
<li><p><strong>dataloader_kwargs</strong> (<em>dict</em><em>, </em><em>default={}</em>) – The kwargs for the pytorch dataloader class.</p></li>
<li><p><strong>rebuild</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to rebuild the model when it already was built.</p></li>
<li><p><strong>**trainer_kwargs</strong> (<em>Additional keyword arguments for PyTorch Lightning's Trainer class.</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – The fitted classifier.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.NDTFClassifier.get_number_of_params">
<span class="sig-name descname"><span class="pre">get_number_of_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">requires_grad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.NDTFClassifier.get_number_of_params" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate the number of parameters in the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>requires_grad</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, only count the parameters that require gradients (trainable parameters).
If False, count all parameters. Default is True.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The total number of parameters in the model.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the model has not been built prior to calling this method.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.NDTFClassifier.get_params">
<span class="sig-name descname"><span class="pre">get_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">deep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.NDTFClassifier.get_params" title="Permalink to this definition">#</a></dt>
<dd><p>Get parameters for this estimator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>deep</strong> (<em>bool</em><em>, </em><em>default=True</em>) – If True, will return the parameters for this estimator and contained subobjects that are estimators.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>params</strong> – Parameter names mapped to their values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.NDTFClassifier.optimize_hparams">
<span class="sig-name descname"><span class="pre">optimize_hparams</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prune_by_epoch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prune_epoch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fixed_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'cat_encoding':</span> <span class="pre">'int',</span> <span class="pre">'head_layer_size_length':</span> <span class="pre">0,</span> <span class="pre">'head_skip_layer':</span> <span class="pre">False,</span> <span class="pre">'head_skip_layers':</span> <span class="pre">False,</span> <span class="pre">'pooling_method':</span> <span class="pre">'avg',</span> <span class="pre">'use_cls':</span> <span class="pre">False}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">custom_search_space</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">optimize_kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.NDTFClassifier.optimize_hparams" title="Permalink to this definition">#</a></dt>
<dd><p>Optimizes hyperparameters using Bayesian optimization with optional pruning.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array-like</em>) – Training data.</p></li>
<li><p><strong>y</strong> (<em>array-like</em>) – Training labels.</p></li>
<li><p><strong>X_val</strong> (<em>array-like</em><em>, </em><em>optional</em>) – Validation data and labels.</p></li>
<li><p><strong>y_val</strong> (<em>array-like</em><em>, </em><em>optional</em>) – Validation data and labels.</p></li>
<li><p><strong>time</strong> (<em>int</em>) – The number of optimization trials to run.</p></li>
<li><p><strong>max_epochs</strong> (<em>int</em>) – Maximum number of epochs for training.</p></li>
<li><p><strong>prune_by_epoch</strong> (<em>bool</em>) – Whether to prune based on a specific epoch (True) or the best validation loss (False).</p></li>
<li><p><strong>prune_epoch</strong> (<em>int</em>) – The specific epoch to prune by when prune_by_epoch is True.</p></li>
<li><p><strong>**optimize_kwargs</strong> (<em>dict</em>) – Additional keyword arguments passed to the fit method.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>best_hparams</strong> – Best hyperparameters found during optimization.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.NDTFClassifier.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.NDTFClassifier.predict" title="Permalink to this definition">#</a></dt>
<dd><p>Predicts target values for the given input samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>X</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The input samples for which to predict target values.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>predictions</strong> – The predicted target values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray, shape (n_samples,) or (n_samples, n_outputs)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.NDTFClassifier.predict_proba">
<span class="sig-name descname"><span class="pre">predict_proba</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.NDTFClassifier.predict_proba" title="Permalink to this definition">#</a></dt>
<dd><p>Predict class probabilities for the given input samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>X</strong> (<em>array-like</em><em> or </em><em>pd.DataFrame</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The input samples for which to predict class probabilities.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The method preprocesses the input data using the same preprocessor used during training,
sets the model to evaluation mode, and then performs inference to predict the class probabilities.
Softmax is applied to the logits to obtain probabilities, which are then converted from a PyTorch tensor
to a NumPy array before being returned.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">accuracy_score</span><span class="p">,</span> <span class="n">precision_score</span><span class="p">,</span> <span class="n">f1_score</span><span class="p">,</span> <span class="n">roc_auc_score</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Define the metrics you want to evaluate</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">metrics</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">... </span>    <span class="s1">&#39;Accuracy&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">accuracy_score</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
<span class="gp">... </span>    <span class="s1">&#39;Precision&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">precision_score</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
<span class="gp">... </span>    <span class="s1">&#39;F1 Score&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">f1_score</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
<span class="gp">... </span>    <span class="s1">&#39;AUC Score&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">roc_auc_score</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
<span class="gp">... </span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Assuming &#39;X_test&#39; and &#39;y_test&#39; are your test dataset and labels</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Evaluate using the specified metrics</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results</span> <span class="o">=</span> <span class="n">classifier</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="n">metrics</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>probabilities</strong> – Predicted class probabilities for each input sample.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>ndarray of shape (n_samples, n_classes)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.NDTFClassifier.score">
<span class="sig-name descname"><span class="pre">score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(sklearn.metrics.log_loss,</span> <span class="pre">True)</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.NDTFClassifier.score" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate the score of the model using the specified metric.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array-like</em><em> or </em><em>pd.DataFrame</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The input samples to predict.</p></li>
<li><p><strong>y</strong> (<em>array-like</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>)</em>) – The true class labels against which to evaluate the predictions.</p></li>
<li><p><strong>metric</strong> (<em>tuple</em><em>, </em><em>default=</em><em>(</em><em>log_loss</em><em>, </em><em>True</em><em>)</em>) – A tuple containing the metric function and a boolean indicating whether the metric requires probability scores (True) or class labels (False).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>score</strong> – The score calculated using the specified metric.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.NDTFClassifier.set_params">
<span class="sig-name descname"><span class="pre">set_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">parameters</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.NDTFClassifier.set_params" title="Permalink to this definition">#</a></dt>
<dd><p>Set the parameters of this estimator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>**parameters</strong> (<em>dict</em>) – Estimator parameters.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – Estimator instance.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mambular.models.NDTFRegressor">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mambular.models.</span></span><span class="sig-name descname"><span class="pre">NDTFRegressor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/mambular/models/ndtf.html#NDTFRegressor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mambular.models.NDTFRegressor" title="Permalink to this definition">#</a></dt>
<dd><dl class="simple">
<dt>Neural Decision Forest regressor. This class extends the SklearnBaseRegressor class and uses the NDTF model</dt><dd><p>with the default NDTF configuration.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The parameters for this class include the attributes from the config
dataclass as well as preprocessing arguments handled by the base class.</p>
<p>Configuration class for the default Neural Decision Tree Forest (NDTF) model with predefined hyperparameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lr</strong> (<em>float</em><em>, </em><em>default=1e-04</em>) – Learning rate for the optimizer.</p></li>
<li><p><strong>lr_patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement after which the learning rate will be reduced.</p></li>
<li><p><strong>weight_decay</strong> (<em>float</em><em>, </em><em>default=1e-06</em>) – Weight decay (L2 penalty) applied to the model’s weights during optimization.</p></li>
<li><p><strong>lr_factor</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Factor by which the learning rate will be reduced when a plateau is reached.</p></li>
<li><p><strong>min_depth</strong> (<em>int</em><em>, </em><em>default=2</em>) – Minimum depth of trees in the forest. Controls the simplest model structure.</p></li>
<li><p><strong>max_depth</strong> (<em>int</em><em>, </em><em>default=10</em>) – Maximum depth of trees in the forest. Controls the maximum complexity of the trees.</p></li>
<li><p><strong>temperature</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Temperature parameter for softening the node decisions during path probability calculation.</p></li>
<li><p><strong>node_sampling</strong> (<em>float</em><em>, </em><em>default=0.3</em>) – Fraction of nodes sampled for regularization penalty calculation. Reduces computation by focusing on a subset of nodes.</p></li>
<li><p><strong>lamda</strong> (<em>float</em><em>, </em><em>default=0.3</em>) – Regularization parameter to control the complexity of the paths, penalizing overconfident or imbalanced paths.</p></li>
<li><p><strong>n_ensembles</strong> (<em>int</em><em>, </em><em>default=12</em>) – Number of trees in the forest</p></li>
<li><p><strong>penalty_factor</strong> (<em>float</em><em>, </em><em>default=0.01</em>) – Factor with which the penalty is multiplied</p></li>
<li><p><strong>n_bins</strong> (<em>int</em><em>, </em><em>default=50</em>) – The number of bins to use for numerical feature binning. This parameter is relevant
only if <code class="docutils literal notranslate"><span class="pre">numerical_preprocessing</span></code> is set to ‘binning’, ‘ple’ or ‘one-hot’.</p></li>
<li><p><strong>numerical_preprocessing</strong> (<em>str</em><em>, </em><em>default=&quot;ple&quot;</em>) – The preprocessing strategy for numerical features. Valid options are
‘ple’, ‘binning’, ‘one-hot’, ‘standardization’, ‘min-max’, ‘quantile’, ‘polynomial’,
‘splines’, ‘box-cox’, ‘yeo-johnson’ and None</p></li>
<li><p><strong>categorical_preprocessing</strong> (<em>str</em><em>, </em><em>default=&quot;int&quot;</em>) – The preprocessing strategy for categorical features. Valid options are
‘int’, ‘one-hot’, None</p></li>
<li><p><strong>use_decision_tree_bins</strong> (<em>bool</em><em>, </em><em>default=False</em>) – If True, uses decision tree regression/classification to determine
optimal bin edges for numerical feature binning. This parameter is
relevant only if <code class="docutils literal notranslate"><span class="pre">numerical_preprocessing</span></code> is set to ‘binning’ or ‘one-hot’.</p></li>
<li><p><strong>binning_strategy</strong> (<em>str</em><em>, </em><em>default=&quot;uniform&quot;</em>) – Defines the strategy for binning numerical features. Options include ‘uniform’,
‘quantile’, or other sklearn-compatible strategies.</p></li>
<li><p><strong>task</strong> (<em>str</em><em>, </em><em>default=&quot;regression&quot;</em>) – Indicates the type of machine learning task (‘regression’ or ‘classification’). This can
influence certain preprocessing behaviors, especially when using decision tree-based binning.</p></li>
<li><p><strong>cat_cutoff</strong> (<em>float</em><em> or </em><em>int</em><em>, </em><em>default=0.03</em>) – Indicates the cutoff after which integer values are treated as categorical.
If float, it’s treated as a percentage. If int, it’s the maximum number of
unique values for a column to be considered categorical.</p></li>
<li><p><strong>treat_all_integers_as_numerical</strong> (<em>bool</em><em>, </em><em>default=False</em>) – If True, all integer columns will be treated as numerical, regardless
of their unique value count or proportion.</p></li>
<li><p><strong>degree</strong> (<em>int</em><em>, </em><em>default=3</em>) – The degree of the polynomial features to be used in preprocessing.</p></li>
<li><p><strong>knots</strong> (<em>int</em><em>, </em><em>default=12</em>) – The number of knots to be used in spline transformations.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.NDTFRegressor.build_model">
<span class="sig-name descname"><span class="pre">build_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">101</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_patience</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_decay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataloader_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.NDTFRegressor.build_model" title="Permalink to this definition">#</a></dt>
<dd><p>Builds the model using the provided training data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The training input samples.</p></li>
<li><p><strong>y</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em>) – The target values (real numbers).</p></li>
<li><p><strong>val_size</strong> (<em>float</em><em>, </em><em>default=0.2</em>) – The proportion of the dataset to include in the validation split if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is None. Ignored if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>X_val</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em><em>, </em><em>optional</em>) – The validation input samples. If provided, <code class="docutils literal notranslate"><span class="pre">X</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> are not split and this data is used for validation.</p></li>
<li><p><strong>y_val</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em><em>, </em><em>optional</em>) – The validation target values. Required if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>random_state</strong> (<em>int</em><em>, </em><em>default=101</em>) – Controls the shuffling applied to the data before applying the split.</p></li>
<li><p><strong>batch_size</strong> (<em>int</em><em>, </em><em>default=64</em>) – Number of samples per gradient update.</p></li>
<li><p><strong>shuffle</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to shuffle the training data before each epoch.</p></li>
<li><p><strong>lr</strong> (<em>float</em><em>, </em><em>default=1e-3</em>) – Learning rate for the optimizer.</p></li>
<li><p><strong>lr_patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement on the validation loss to wait before reducing the learning rate.</p></li>
<li><p><strong>factor</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Factor by which the learning rate will be reduced.</p></li>
<li><p><strong>weight_decay</strong> (<em>float</em><em>, </em><em>default=0.025</em>) – Weight decay (L2 penalty) coefficient.</p></li>
<li><p><strong>dataloader_kwargs</strong> (<em>dict</em><em>, </em><em>default={}</em>) – The kwargs for the pytorch dataloader class.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – The built regressor.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.NDTFRegressor.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.NDTFRegressor.evaluate" title="Permalink to this definition">#</a></dt>
<dd><p>Evaluate the model on the given data using specified metrics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array-like</em><em> or </em><em>pd.DataFrame</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The input samples to predict.</p></li>
<li><p><strong>y_true</strong> (<em>array-like</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_outputs</em><em>)</em>) – The true target values against which to evaluate the predictions.</p></li>
<li><p><strong>metrics</strong> (<em>dict</em>) – A dictionary where keys are metric names and values are the metric functions.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This method uses the <code class="docutils literal notranslate"><span class="pre">predict</span></code> method to generate predictions and computes each metric.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_squared_error</span><span class="p">,</span> <span class="n">r2_score</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mambular.models</span> <span class="kn">import</span> <span class="n">MambularRegressor</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">metrics</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">... </span>    <span class="s1">&#39;Mean Squared Error&#39;</span><span class="p">:</span> <span class="n">mean_squared_error</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s1">&#39;R2 Score&#39;</span><span class="p">:</span> <span class="n">r2_score</span>
<span class="gp">... </span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Assuming &#39;X_test&#39; and &#39;y_test&#39; are your test dataset and labels</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Evaluate using the specified metrics</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results</span> <span class="o">=</span> <span class="n">regressor</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="n">metrics</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>scores</strong> – A dictionary with metric names as keys and their corresponding scores as values.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.NDTFRegressor.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">101</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patience</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">15</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">monitor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'val_loss'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'min'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_patience</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_decay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checkpoint_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'model_checkpoints'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataloader_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rebuild</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">trainer_kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.NDTFRegressor.fit" title="Permalink to this definition">#</a></dt>
<dd><p>Trains the regression model using the provided training data. Optionally, a separate validation set can be used.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The training input samples.</p></li>
<li><p><strong>y</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em>) – The target values (real numbers).</p></li>
<li><p><strong>val_size</strong> (<em>float</em><em>, </em><em>default=0.2</em>) – The proportion of the dataset to include in the validation split if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is None. Ignored if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>X_val</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em><em>, </em><em>optional</em>) – The validation input samples. If provided, <code class="docutils literal notranslate"><span class="pre">X</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> are not split and this data is used for validation.</p></li>
<li><p><strong>y_val</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em><em>, </em><em>optional</em>) – The validation target values. Required if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>max_epochs</strong> (<em>int</em><em>, </em><em>default=100</em>) – Maximum number of epochs for training.</p></li>
<li><p><strong>random_state</strong> (<em>int</em><em>, </em><em>default=101</em>) – Controls the shuffling applied to the data before applying the split.</p></li>
<li><p><strong>batch_size</strong> (<em>int</em><em>, </em><em>default=64</em>) – Number of samples per gradient update.</p></li>
<li><p><strong>shuffle</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to shuffle the training data before each epoch.</p></li>
<li><p><strong>patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement on the validation loss to wait before early stopping.</p></li>
<li><p><strong>monitor</strong> (<em>str</em><em>, </em><em>default=&quot;val_loss&quot;</em>) – The metric to monitor for early stopping.</p></li>
<li><p><strong>mode</strong> (<em>str</em><em>, </em><em>default=&quot;min&quot;</em>) – Whether the monitored metric should be minimized (<code class="docutils literal notranslate"><span class="pre">min</span></code>) or maximized (<code class="docutils literal notranslate"><span class="pre">max</span></code>).</p></li>
<li><p><strong>lr</strong> (<em>float</em><em>, </em><em>default=1e-3</em>) – Learning rate for the optimizer.</p></li>
<li><p><strong>lr_patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement on the validation loss to wait before reducing the learning rate.</p></li>
<li><p><strong>factor</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Factor by which the learning rate will be reduced.</p></li>
<li><p><strong>weight_decay</strong> (<em>float</em><em>, </em><em>default=0.025</em>) – Weight decay (L2 penalty) coefficient.</p></li>
<li><p><strong>checkpoint_path</strong> (<em>str</em><em>, </em><em>default=&quot;model_checkpoints&quot;</em>) – Path where the checkpoints are being saved.</p></li>
<li><p><strong>dataloader_kwargs</strong> (<em>dict</em><em>, </em><em>default={}</em>) – The kwargs for the pytorch dataloader class.</p></li>
<li><p><strong>**trainer_kwargs</strong> (<em>Additional keyword arguments for PyTorch Lightning's Trainer class.</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – The fitted regressor.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.NDTFRegressor.get_number_of_params">
<span class="sig-name descname"><span class="pre">get_number_of_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">requires_grad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.NDTFRegressor.get_number_of_params" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate the number of parameters in the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>requires_grad</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, only count the parameters that require gradients (trainable parameters).
If False, count all parameters. Default is True.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The total number of parameters in the model.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the model has not been built prior to calling this method.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.NDTFRegressor.get_params">
<span class="sig-name descname"><span class="pre">get_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">deep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.NDTFRegressor.get_params" title="Permalink to this definition">#</a></dt>
<dd><p>Get parameters for this estimator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>deep</strong> (<em>bool</em><em>, </em><em>default=True</em>) – If True, will return the parameters for this estimator and contained subobjects that are estimators.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>params</strong> – Parameter names mapped to their values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.NDTFRegressor.optimize_hparams">
<span class="sig-name descname"><span class="pre">optimize_hparams</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prune_by_epoch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prune_epoch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fixed_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'cat_encoding':</span> <span class="pre">'int',</span> <span class="pre">'head_layer_size_length':</span> <span class="pre">0,</span> <span class="pre">'head_skip_layer':</span> <span class="pre">False,</span> <span class="pre">'head_skip_layers':</span> <span class="pre">False,</span> <span class="pre">'pooling_method':</span> <span class="pre">'avg',</span> <span class="pre">'use_cls':</span> <span class="pre">False}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">custom_search_space</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">optimize_kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.NDTFRegressor.optimize_hparams" title="Permalink to this definition">#</a></dt>
<dd><p>Optimizes hyperparameters using Bayesian optimization with optional pruning.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array-like</em>) – Training data.</p></li>
<li><p><strong>y</strong> (<em>array-like</em>) – Training labels.</p></li>
<li><p><strong>X_val</strong> (<em>array-like</em><em>, </em><em>optional</em>) – Validation data and labels.</p></li>
<li><p><strong>y_val</strong> (<em>array-like</em><em>, </em><em>optional</em>) – Validation data and labels.</p></li>
<li><p><strong>time</strong> (<em>int</em>) – The number of optimization trials to run.</p></li>
<li><p><strong>max_epochs</strong> (<em>int</em>) – Maximum number of epochs for training.</p></li>
<li><p><strong>prune_by_epoch</strong> (<em>bool</em>) – Whether to prune based on a specific epoch (True) or the best validation loss (False).</p></li>
<li><p><strong>prune_epoch</strong> (<em>int</em>) – The specific epoch to prune by when prune_by_epoch is True.</p></li>
<li><p><strong>**optimize_kwargs</strong> (<em>dict</em>) – Additional keyword arguments passed to the fit method.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>best_hparams</strong> – Best hyperparameters found during optimization.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.NDTFRegressor.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.NDTFRegressor.predict" title="Permalink to this definition">#</a></dt>
<dd><p>Predicts target values for the given input samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>X</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The input samples for which to predict target values.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>predictions</strong> – The predicted target values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray, shape (n_samples,) or (n_samples, n_outputs)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.NDTFRegressor.score">
<span class="sig-name descname"><span class="pre">score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">sklearn.metrics.mean_squared_error</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.NDTFRegressor.score" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate the score of the model using the specified metric.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array-like</em><em> or </em><em>pd.DataFrame</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The input samples to predict.</p></li>
<li><p><strong>y</strong> (<em>array-like</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_outputs</em><em>)</em>) – The true target values against which to evaluate the predictions.</p></li>
<li><p><strong>metric</strong> (<em>callable</em><em>, </em><em>default=mean_squared_error</em>) – The metric function to use for evaluation. Must be a callable with the signature <code class="docutils literal notranslate"><span class="pre">metric(y_true,</span> <span class="pre">y_pred)</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>score</strong> – The score calculated using the specified metric.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.NDTFRegressor.set_params">
<span class="sig-name descname"><span class="pre">set_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">parameters</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.NDTFRegressor.set_params" title="Permalink to this definition">#</a></dt>
<dd><p>Set the parameters of this estimator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>**parameters</strong> (<em>dict</em>) – Estimator parameters.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – Estimator instance.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mambular.models.NDTFLSS">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mambular.models.</span></span><span class="sig-name descname"><span class="pre">NDTFLSS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/mambular/models/ndtf.html#NDTFLSS"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mambular.models.NDTFLSS" title="Permalink to this definition">#</a></dt>
<dd><dl class="simple">
<dt>Neural Decision Forest for distributional regressor. This class extends the SklearnBaseLSS class and uses the NDTF model</dt><dd><p>with the default NDTF configuration.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The parameters for this class include the attributes from the config
dataclass as well as preprocessing arguments handled by the base class.</p>
<p>Configuration class for the default Neural Decision Tree Forest (NDTF) model with predefined hyperparameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lr</strong> (<em>float</em><em>, </em><em>default=1e-04</em>) – Learning rate for the optimizer.</p></li>
<li><p><strong>lr_patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement after which the learning rate will be reduced.</p></li>
<li><p><strong>weight_decay</strong> (<em>float</em><em>, </em><em>default=1e-06</em>) – Weight decay (L2 penalty) applied to the model’s weights during optimization.</p></li>
<li><p><strong>lr_factor</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Factor by which the learning rate will be reduced when a plateau is reached.</p></li>
<li><p><strong>min_depth</strong> (<em>int</em><em>, </em><em>default=2</em>) – Minimum depth of trees in the forest. Controls the simplest model structure.</p></li>
<li><p><strong>max_depth</strong> (<em>int</em><em>, </em><em>default=10</em>) – Maximum depth of trees in the forest. Controls the maximum complexity of the trees.</p></li>
<li><p><strong>temperature</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Temperature parameter for softening the node decisions during path probability calculation.</p></li>
<li><p><strong>node_sampling</strong> (<em>float</em><em>, </em><em>default=0.3</em>) – Fraction of nodes sampled for regularization penalty calculation. Reduces computation by focusing on a subset of nodes.</p></li>
<li><p><strong>lamda</strong> (<em>float</em><em>, </em><em>default=0.3</em>) – Regularization parameter to control the complexity of the paths, penalizing overconfident or imbalanced paths.</p></li>
<li><p><strong>n_ensembles</strong> (<em>int</em><em>, </em><em>default=12</em>) – Number of trees in the forest</p></li>
<li><p><strong>penalty_factor</strong> (<em>float</em><em>, </em><em>default=0.01</em>) – Factor with which the penalty is multiplied</p></li>
<li><p><strong>n_bins</strong> (<em>int</em><em>, </em><em>default=50</em>) – The number of bins to use for numerical feature binning. This parameter is relevant
only if <code class="docutils literal notranslate"><span class="pre">numerical_preprocessing</span></code> is set to ‘binning’, ‘ple’ or ‘one-hot’.</p></li>
<li><p><strong>numerical_preprocessing</strong> (<em>str</em><em>, </em><em>default=&quot;ple&quot;</em>) – The preprocessing strategy for numerical features. Valid options are
‘ple’, ‘binning’, ‘one-hot’, ‘standardization’, ‘min-max’, ‘quantile’, ‘polynomial’,
‘splines’, ‘box-cox’, ‘yeo-johnson’ and None</p></li>
<li><p><strong>categorical_preprocessing</strong> (<em>str</em><em>, </em><em>default=&quot;int&quot;</em>) – The preprocessing strategy for categorical features. Valid options are
‘int’, ‘one-hot’, None</p></li>
<li><p><strong>use_decision_tree_bins</strong> (<em>bool</em><em>, </em><em>default=False</em>) – If True, uses decision tree regression/classification to determine
optimal bin edges for numerical feature binning. This parameter is
relevant only if <code class="docutils literal notranslate"><span class="pre">numerical_preprocessing</span></code> is set to ‘binning’ or ‘one-hot’.</p></li>
<li><p><strong>binning_strategy</strong> (<em>str</em><em>, </em><em>default=&quot;uniform&quot;</em>) – Defines the strategy for binning numerical features. Options include ‘uniform’,
‘quantile’, or other sklearn-compatible strategies.</p></li>
<li><p><strong>task</strong> (<em>str</em><em>, </em><em>default=&quot;regression&quot;</em>) – Indicates the type of machine learning task (‘regression’ or ‘classification’). This can
influence certain preprocessing behaviors, especially when using decision tree-based binning.</p></li>
<li><p><strong>cat_cutoff</strong> (<em>float</em><em> or </em><em>int</em><em>, </em><em>default=0.03</em>) – Indicates the cutoff after which integer values are treated as categorical.
If float, it’s treated as a percentage. If int, it’s the maximum number of
unique values for a column to be considered categorical.</p></li>
<li><p><strong>treat_all_integers_as_numerical</strong> (<em>bool</em><em>, </em><em>default=False</em>) – If True, all integer columns will be treated as numerical, regardless
of their unique value count or proportion.</p></li>
<li><p><strong>degree</strong> (<em>int</em><em>, </em><em>default=3</em>) – The degree of the polynomial features to be used in preprocessing.</p></li>
<li><p><strong>knots</strong> (<em>int</em><em>, </em><em>default=12</em>) – The number of knots to be used in spline transformations.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.NDTFLSS.build_model">
<span class="sig-name descname"><span class="pre">build_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">101</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_patience</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_decay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataloader_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.NDTFLSS.build_model" title="Permalink to this definition">#</a></dt>
<dd><p>Builds the model using the provided training data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The training input samples.</p></li>
<li><p><strong>y</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em>) – The target values (real numbers).</p></li>
<li><p><strong>val_size</strong> (<em>float</em><em>, </em><em>default=0.2</em>) – The proportion of the dataset to include in the validation split if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is None. Ignored if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>X_val</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em><em>, </em><em>optional</em>) – The validation input samples. If provided, <code class="docutils literal notranslate"><span class="pre">X</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> are not split and this data is used for validation.</p></li>
<li><p><strong>y_val</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em><em>, </em><em>optional</em>) – The validation target values. Required if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>random_state</strong> (<em>int</em><em>, </em><em>default=101</em>) – Controls the shuffling applied to the data before applying the split.</p></li>
<li><p><strong>batch_size</strong> (<em>int</em><em>, </em><em>default=64</em>) – Number of samples per gradient update.</p></li>
<li><p><strong>shuffle</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to shuffle the training data before each epoch.</p></li>
<li><p><strong>lr</strong> (<em>float</em><em>, </em><em>default=1e-3</em>) – Learning rate for the optimizer.</p></li>
<li><p><strong>lr_patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement on the validation loss to wait before reducing the learning rate.</p></li>
<li><p><strong>factor</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Factor by which the learning rate will be reduced.</p></li>
<li><p><strong>weight_decay</strong> (<em>float</em><em>, </em><em>default=0.025</em>) – Weight decay (L2 penalty) coefficient.</p></li>
<li><p><strong>dataloader_kwargs</strong> (<em>dict</em><em>, </em><em>default={}</em>) – The kwargs for the pytorch dataloader class.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – The built distributional regressor.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.NDTFLSS.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distribution_family</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.NDTFLSS.evaluate" title="Permalink to this definition">#</a></dt>
<dd><p>Evaluate the model on the given data using specified metrics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array-like</em><em> or </em><em>pd.DataFrame</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The input samples to predict.</p></li>
<li><p><strong>y_true</strong> (<em>array-like</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>)</em>) – The true class labels against which to evaluate the predictions.</p></li>
<li><p><strong>metrics</strong> (<em>dict</em>) – A dictionary where keys are metric names and values are tuples containing the metric function
and a boolean indicating whether the metric requires probability scores (True) or class labels (False).</p></li>
<li><p><strong>distribution_family</strong> (<em>str</em><em>, </em><em>optional</em>) – Specifies the distribution family the model is predicting for. If None, it will attempt to infer based
on the model’s settings.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>scores</strong> – A dictionary with metric names as keys and their corresponding scores as values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This method uses either the <code class="docutils literal notranslate"><span class="pre">predict</span></code> or <code class="docutils literal notranslate"><span class="pre">predict_proba</span></code> method depending on the metric requirements.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.NDTFLSS.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">family</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">101</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patience</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">15</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">monitor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'val_loss'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'min'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_patience</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_decay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checkpoint_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'model_checkpoints'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distributional_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataloader_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rebuild</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">trainer_kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.NDTFLSS.fit" title="Permalink to this definition">#</a></dt>
<dd><p>Trains the regression model using the provided training data. Optionally, a separate validation set can be used.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The training input samples.</p></li>
<li><p><strong>y</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em>) – The target values (real numbers).</p></li>
<li><p><strong>family</strong> (<em>str</em>) – The name of the distribution family to use for the loss function. Examples include ‘normal’ for regression tasks.</p></li>
<li><p><strong>val_size</strong> (<em>float</em><em>, </em><em>default=0.2</em>) – The proportion of the dataset to include in the validation split if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is None. Ignored if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>X_val</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em><em>, </em><em>optional</em>) – The validation input samples. If provided, <code class="docutils literal notranslate"><span class="pre">X</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> are not split and this data is used for validation.</p></li>
<li><p><strong>y_val</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em><em>, </em><em>optional</em>) – The validation target values. Required if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>max_epochs</strong> (<em>int</em><em>, </em><em>default=100</em>) – Maximum number of epochs for training.</p></li>
<li><p><strong>random_state</strong> (<em>int</em><em>, </em><em>default=101</em>) – Controls the shuffling applied to the data before applying the split.</p></li>
<li><p><strong>batch_size</strong> (<em>int</em><em>, </em><em>default=64</em>) – Number of samples per gradient update.</p></li>
<li><p><strong>shuffle</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to shuffle the training data before each epoch.</p></li>
<li><p><strong>patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement on the validation loss to wait before early stopping.</p></li>
<li><p><strong>monitor</strong> (<em>str</em><em>, </em><em>default=&quot;val_loss&quot;</em>) – The metric to monitor for early stopping.</p></li>
<li><p><strong>mode</strong> (<em>str</em><em>, </em><em>default=&quot;min&quot;</em>) – Whether the monitored metric should be minimized (<code class="docutils literal notranslate"><span class="pre">min</span></code>) or maximized (<code class="docutils literal notranslate"><span class="pre">max</span></code>).</p></li>
<li><p><strong>lr</strong> (<em>float</em><em>, </em><em>default=1e-3</em>) – Learning rate for the optimizer.</p></li>
<li><p><strong>lr_patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement on the validation loss to wait before reducing the learning rate.</p></li>
<li><p><strong>factor</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Factor by which the learning rate will be reduced.</p></li>
<li><p><strong>weight_decay</strong> (<em>float</em><em>, </em><em>default=0.025</em>) – Weight decay (L2 penalty) coefficient.</p></li>
<li><p><strong>distributional_kwargs</strong> (<em>dict</em><em>, </em><em>default=None</em>) – any arguments taht are specific for a certain distribution.</p></li>
<li><p><strong>checkpoint_path</strong> (<em>str</em><em>, </em><em>default=&quot;model_checkpoints&quot;</em>) – Path where the checkpoints are being saved.</p></li>
<li><p><strong>dataloader_kwargs</strong> (<em>dict</em><em>, </em><em>default={}</em>) – The kwargs for the pytorch dataloader class.</p></li>
<li><p><strong>**trainer_kwargs</strong> (<em>Additional keyword arguments for PyTorch Lightning's Trainer class.</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – The fitted regressor.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.NDTFLSS.get_default_metrics">
<span class="sig-name descname"><span class="pre">get_default_metrics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">distribution_family</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.NDTFLSS.get_default_metrics" title="Permalink to this definition">#</a></dt>
<dd><p>Provides default metrics based on the distribution family.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>distribution_family</strong> (<em>str</em>) – The distribution family for which to provide default metrics.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>metrics</strong> – A dictionary of default metric functions.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.NDTFLSS.get_number_of_params">
<span class="sig-name descname"><span class="pre">get_number_of_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">requires_grad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.NDTFLSS.get_number_of_params" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate the number of parameters in the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>requires_grad</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, only count the parameters that require gradients (trainable parameters).
If False, count all parameters. Default is True.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The total number of parameters in the model.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the model has not been built prior to calling this method.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.NDTFLSS.get_params">
<span class="sig-name descname"><span class="pre">get_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">deep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.NDTFLSS.get_params" title="Permalink to this definition">#</a></dt>
<dd><p>Get parameters for this estimator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>deep</strong> (<em>bool</em><em>, </em><em>default=True</em>) – If True, will return the parameters for this estimator and contained subobjects that are estimators.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>params</strong> – Parameter names mapped to their values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.NDTFLSS.optimize_hparams">
<span class="sig-name descname"><span class="pre">optimize_hparams</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prune_by_epoch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prune_epoch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fixed_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'cat_encoding':</span> <span class="pre">'int',</span> <span class="pre">'head_layer_size_length':</span> <span class="pre">0,</span> <span class="pre">'head_skip_layer':</span> <span class="pre">False,</span> <span class="pre">'head_skip_layers':</span> <span class="pre">False,</span> <span class="pre">'pooling_method':</span> <span class="pre">'avg',</span> <span class="pre">'use_cls':</span> <span class="pre">False}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">custom_search_space</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">optimize_kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.NDTFLSS.optimize_hparams" title="Permalink to this definition">#</a></dt>
<dd><p>Optimizes hyperparameters using Bayesian optimization with optional pruning.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array-like</em>) – Training data.</p></li>
<li><p><strong>y</strong> (<em>array-like</em>) – Training labels.</p></li>
<li><p><strong>X_val</strong> (<em>array-like</em><em>, </em><em>optional</em>) – Validation data and labels.</p></li>
<li><p><strong>y_val</strong> (<em>array-like</em><em>, </em><em>optional</em>) – Validation data and labels.</p></li>
<li><p><strong>time</strong> (<em>int</em>) – The number of optimization trials to run.</p></li>
<li><p><strong>max_epochs</strong> (<em>int</em>) – Maximum number of epochs for training.</p></li>
<li><p><strong>prune_by_epoch</strong> (<em>bool</em>) – Whether to prune based on a specific epoch (True) or the best validation loss (False).</p></li>
<li><p><strong>prune_epoch</strong> (<em>int</em>) – The specific epoch to prune by when prune_by_epoch is True.</p></li>
<li><p><strong>**optimize_kwargs</strong> (<em>dict</em>) – Additional keyword arguments passed to the fit method.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>best_hparams</strong> – Best hyperparameters found during optimization.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.NDTFLSS.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">raw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.NDTFLSS.predict" title="Permalink to this definition">#</a></dt>
<dd><p>Predicts target values for the given input samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>X</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The input samples for which to predict target values.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>predictions</strong> – The predicted target values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray, shape (n_samples,) or (n_samples, n_outputs)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.NDTFLSS.score">
<span class="sig-name descname"><span class="pre">score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'NLL'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.NDTFLSS.score" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate the score of the model using the specified metric.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array-like</em><em> or </em><em>pd.DataFrame</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The input samples to predict.</p></li>
<li><p><strong>y</strong> (<em>array-like</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_outputs</em><em>)</em>) – The true target values against which to evaluate the predictions.</p></li>
<li><p><strong>metric</strong> (<em>str</em><em>, </em><em>default=&quot;NLL&quot;</em>) – So far, only negative log-likelihood is supported</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>score</strong> – The score calculated using the specified metric.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.NDTFLSS.set_params">
<span class="sig-name descname"><span class="pre">set_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">parameters</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mambular.models.NDTFLSS.set_params" title="Permalink to this definition">#</a></dt>
<dd><p>Set the parameters of this estimator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>**parameters</strong> (<em>dict</em>) – Estimator parameters.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – Estimator instance.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mambular.models.SklearnBaseClassifier">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mambular.models.</span></span><span class="sig-name descname"><span class="pre">SklearnBaseClassifier</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/mambular/models/sklearn_base_classifier.html#SklearnBaseClassifier"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mambular.models.SklearnBaseClassifier" title="Permalink to this definition">#</a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="mambular.models.SklearnBaseClassifier.build_model">
<span class="sig-name descname"><span class="pre">build_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">101</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_patience</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_decay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataloader_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/mambular/models/sklearn_base_classifier.html#SklearnBaseClassifier.build_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mambular.models.SklearnBaseClassifier.build_model" title="Permalink to this definition">#</a></dt>
<dd><p>Builds the model using the provided training data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The training input samples.</p></li>
<li><p><strong>y</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em>) – The target values (real numbers).</p></li>
<li><p><strong>val_size</strong> (<em>float</em><em>, </em><em>default=0.2</em>) – The proportion of the dataset to include in the validation split if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is None. Ignored if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>X_val</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em><em>, </em><em>optional</em>) – The validation input samples. If provided, <code class="docutils literal notranslate"><span class="pre">X</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> are not split and this data is used for validation.</p></li>
<li><p><strong>y_val</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em><em>, </em><em>optional</em>) – The validation target values. Required if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>random_state</strong> (<em>int</em><em>, </em><em>default=101</em>) – Controls the shuffling applied to the data before applying the split.</p></li>
<li><p><strong>batch_size</strong> (<em>int</em><em>, </em><em>default=64</em>) – Number of samples per gradient update.</p></li>
<li><p><strong>shuffle</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to shuffle the training data before each epoch.</p></li>
<li><p><strong>lr</strong> (<em>float</em><em>, </em><em>default=1e-3</em>) – Learning rate for the optimizer.</p></li>
<li><p><strong>lr_patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement on the validation loss to wait before reducing the learning rate.</p></li>
<li><p><strong>factor</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Factor by which the learning rate will be reduced.</p></li>
<li><p><strong>weight_decay</strong> (<em>float</em><em>, </em><em>default=0.025</em>) – Weight decay (L2 penalty) coefficient.</p></li>
<li><p><strong>dataloader_kwargs</strong> (<em>dict</em><em>, </em><em>default={}</em>) – The kwargs for the pytorch dataloader class.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – The built classifier.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.SklearnBaseClassifier.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/mambular/models/sklearn_base_classifier.html#SklearnBaseClassifier.evaluate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mambular.models.SklearnBaseClassifier.evaluate" title="Permalink to this definition">#</a></dt>
<dd><p>Evaluate the model on the given data using specified metrics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array-like</em><em> or </em><em>pd.DataFrame</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The input samples to predict.</p></li>
<li><p><strong>y_true</strong> (<em>array-like</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>)</em>) – The true class labels against which to evaluate the predictions.</p></li>
<li><p><strong>metrics</strong> (<em>dict</em>) – A dictionary where keys are metric names and values are tuples containing the metric function
and a boolean indicating whether the metric requires probability scores (True) or class labels (False).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>scores</strong> – A dictionary with metric names as keys and their corresponding scores as values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This method uses either the <code class="docutils literal notranslate"><span class="pre">predict</span></code> or <code class="docutils literal notranslate"><span class="pre">predict_proba</span></code> method depending on the metric requirements.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.SklearnBaseClassifier.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">101</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patience</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">15</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">monitor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'val_loss'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'min'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_patience</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_decay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checkpoint_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'model_checkpoints'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataloader_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rebuild</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">trainer_kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/mambular/models/sklearn_base_classifier.html#SklearnBaseClassifier.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mambular.models.SklearnBaseClassifier.fit" title="Permalink to this definition">#</a></dt>
<dd><p>Trains the classification model using the provided training data. Optionally, a separate validation set can be used.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The training input samples.</p></li>
<li><p><strong>y</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em>) – The target values (real numbers).</p></li>
<li><p><strong>val_size</strong> (<em>float</em><em>, </em><em>default=0.2</em>) – The proportion of the dataset to include in the validation split if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is None. Ignored if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>X_val</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em><em>, </em><em>optional</em>) – The validation input samples. If provided, <code class="docutils literal notranslate"><span class="pre">X</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> are not split and this data is used for validation.</p></li>
<li><p><strong>y_val</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em><em>, </em><em>optional</em>) – The validation target values. Required if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>max_epochs</strong> (<em>int</em><em>, </em><em>default=100</em>) – Maximum number of epochs for training.</p></li>
<li><p><strong>random_state</strong> (<em>int</em><em>, </em><em>default=101</em>) – Controls the shuffling applied to the data before applying the split.</p></li>
<li><p><strong>batch_size</strong> (<em>int</em><em>, </em><em>default=64</em>) – Number of samples per gradient update.</p></li>
<li><p><strong>shuffle</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to shuffle the training data before each epoch.</p></li>
<li><p><strong>patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement on the validation loss to wait before early stopping.</p></li>
<li><p><strong>monitor</strong> (<em>str</em><em>, </em><em>default=&quot;val_loss&quot;</em>) – The metric to monitor for early stopping.</p></li>
<li><p><strong>mode</strong> (<em>str</em><em>, </em><em>default=&quot;min&quot;</em>) – Whether the monitored metric should be minimized (<code class="docutils literal notranslate"><span class="pre">min</span></code>) or maximized (<code class="docutils literal notranslate"><span class="pre">max</span></code>).</p></li>
<li><p><strong>lr</strong> (<em>float</em><em>, </em><em>default=1e-3</em>) – Learning rate for the optimizer.</p></li>
<li><p><strong>lr_patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement on the validation loss to wait before reducing the learning rate.</p></li>
<li><p><strong>factor</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Factor by which the learning rate will be reduced.</p></li>
<li><p><strong>weight_decay</strong> (<em>float</em><em>, </em><em>default=0.025</em>) – Weight decay (L2 penalty) coefficient.</p></li>
<li><p><strong>checkpoint_path</strong> (<em>str</em><em>, </em><em>default=&quot;model_checkpoints&quot;</em>) – Path where the checkpoints are being saved.</p></li>
<li><p><strong>dataloader_kwargs</strong> (<em>dict</em><em>, </em><em>default={}</em>) – The kwargs for the pytorch dataloader class.</p></li>
<li><p><strong>rebuild</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to rebuild the model when it already was built.</p></li>
<li><p><strong>**trainer_kwargs</strong> (<em>Additional keyword arguments for PyTorch Lightning's Trainer class.</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – The fitted classifier.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.SklearnBaseClassifier.get_number_of_params">
<span class="sig-name descname"><span class="pre">get_number_of_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">requires_grad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/mambular/models/sklearn_base_classifier.html#SklearnBaseClassifier.get_number_of_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mambular.models.SklearnBaseClassifier.get_number_of_params" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate the number of parameters in the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>requires_grad</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, only count the parameters that require gradients (trainable parameters).
If False, count all parameters. Default is True.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The total number of parameters in the model.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the model has not been built prior to calling this method.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.SklearnBaseClassifier.get_params">
<span class="sig-name descname"><span class="pre">get_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">deep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/mambular/models/sklearn_base_classifier.html#SklearnBaseClassifier.get_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mambular.models.SklearnBaseClassifier.get_params" title="Permalink to this definition">#</a></dt>
<dd><p>Get parameters for this estimator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>deep</strong> (<em>bool</em><em>, </em><em>default=True</em>) – If True, will return the parameters for this estimator and contained subobjects that are estimators.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>params</strong> – Parameter names mapped to their values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.SklearnBaseClassifier.optimize_hparams">
<span class="sig-name descname"><span class="pre">optimize_hparams</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prune_by_epoch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prune_epoch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fixed_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'cat_encoding':</span> <span class="pre">'int',</span> <span class="pre">'head_layer_size_length':</span> <span class="pre">0,</span> <span class="pre">'head_skip_layer':</span> <span class="pre">False,</span> <span class="pre">'head_skip_layers':</span> <span class="pre">False,</span> <span class="pre">'pooling_method':</span> <span class="pre">'avg',</span> <span class="pre">'use_cls':</span> <span class="pre">False}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">custom_search_space</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">optimize_kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/mambular/models/sklearn_base_classifier.html#SklearnBaseClassifier.optimize_hparams"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mambular.models.SklearnBaseClassifier.optimize_hparams" title="Permalink to this definition">#</a></dt>
<dd><p>Optimizes hyperparameters using Bayesian optimization with optional pruning.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array-like</em>) – Training data.</p></li>
<li><p><strong>y</strong> (<em>array-like</em>) – Training labels.</p></li>
<li><p><strong>X_val</strong> (<em>array-like</em><em>, </em><em>optional</em>) – Validation data and labels.</p></li>
<li><p><strong>y_val</strong> (<em>array-like</em><em>, </em><em>optional</em>) – Validation data and labels.</p></li>
<li><p><strong>time</strong> (<em>int</em>) – The number of optimization trials to run.</p></li>
<li><p><strong>max_epochs</strong> (<em>int</em>) – Maximum number of epochs for training.</p></li>
<li><p><strong>prune_by_epoch</strong> (<em>bool</em>) – Whether to prune based on a specific epoch (True) or the best validation loss (False).</p></li>
<li><p><strong>prune_epoch</strong> (<em>int</em>) – The specific epoch to prune by when prune_by_epoch is True.</p></li>
<li><p><strong>**optimize_kwargs</strong> (<em>dict</em>) – Additional keyword arguments passed to the fit method.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>best_hparams</strong> – Best hyperparameters found during optimization.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.SklearnBaseClassifier.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/mambular/models/sklearn_base_classifier.html#SklearnBaseClassifier.predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mambular.models.SklearnBaseClassifier.predict" title="Permalink to this definition">#</a></dt>
<dd><p>Predicts target values for the given input samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>X</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The input samples for which to predict target values.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>predictions</strong> – The predicted target values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray, shape (n_samples,) or (n_samples, n_outputs)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.SklearnBaseClassifier.predict_proba">
<span class="sig-name descname"><span class="pre">predict_proba</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/mambular/models/sklearn_base_classifier.html#SklearnBaseClassifier.predict_proba"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mambular.models.SklearnBaseClassifier.predict_proba" title="Permalink to this definition">#</a></dt>
<dd><p>Predict class probabilities for the given input samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>X</strong> (<em>array-like</em><em> or </em><em>pd.DataFrame</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The input samples for which to predict class probabilities.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The method preprocesses the input data using the same preprocessor used during training,
sets the model to evaluation mode, and then performs inference to predict the class probabilities.
Softmax is applied to the logits to obtain probabilities, which are then converted from a PyTorch tensor
to a NumPy array before being returned.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">accuracy_score</span><span class="p">,</span> <span class="n">precision_score</span><span class="p">,</span> <span class="n">f1_score</span><span class="p">,</span> <span class="n">roc_auc_score</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Define the metrics you want to evaluate</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">metrics</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">... </span>    <span class="s1">&#39;Accuracy&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">accuracy_score</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
<span class="gp">... </span>    <span class="s1">&#39;Precision&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">precision_score</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
<span class="gp">... </span>    <span class="s1">&#39;F1 Score&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">f1_score</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
<span class="gp">... </span>    <span class="s1">&#39;AUC Score&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">roc_auc_score</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
<span class="gp">... </span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Assuming &#39;X_test&#39; and &#39;y_test&#39; are your test dataset and labels</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Evaluate using the specified metrics</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results</span> <span class="o">=</span> <span class="n">classifier</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="n">metrics</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>probabilities</strong> – Predicted class probabilities for each input sample.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>ndarray of shape (n_samples, n_classes)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.SklearnBaseClassifier.score">
<span class="sig-name descname"><span class="pre">score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(sklearn.metrics.log_loss,</span> <span class="pre">True)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/mambular/models/sklearn_base_classifier.html#SklearnBaseClassifier.score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mambular.models.SklearnBaseClassifier.score" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate the score of the model using the specified metric.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array-like</em><em> or </em><em>pd.DataFrame</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The input samples to predict.</p></li>
<li><p><strong>y</strong> (<em>array-like</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>)</em>) – The true class labels against which to evaluate the predictions.</p></li>
<li><p><strong>metric</strong> (<em>tuple</em><em>, </em><em>default=</em><em>(</em><em>log_loss</em><em>, </em><em>True</em><em>)</em>) – A tuple containing the metric function and a boolean indicating whether the metric requires probability scores (True) or class labels (False).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>score</strong> – The score calculated using the specified metric.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.SklearnBaseClassifier.set_params">
<span class="sig-name descname"><span class="pre">set_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">parameters</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/mambular/models/sklearn_base_classifier.html#SklearnBaseClassifier.set_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mambular.models.SklearnBaseClassifier.set_params" title="Permalink to this definition">#</a></dt>
<dd><p>Set the parameters of this estimator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>**parameters</strong> (<em>dict</em>) – Estimator parameters.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – Estimator instance.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mambular.models.SklearnBaseLSS">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mambular.models.</span></span><span class="sig-name descname"><span class="pre">SklearnBaseLSS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/mambular/models/sklearn_base_lss.html#SklearnBaseLSS"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mambular.models.SklearnBaseLSS" title="Permalink to this definition">#</a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="mambular.models.SklearnBaseLSS.build_model">
<span class="sig-name descname"><span class="pre">build_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">101</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_patience</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_decay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataloader_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/mambular/models/sklearn_base_lss.html#SklearnBaseLSS.build_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mambular.models.SklearnBaseLSS.build_model" title="Permalink to this definition">#</a></dt>
<dd><p>Builds the model using the provided training data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The training input samples.</p></li>
<li><p><strong>y</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em>) – The target values (real numbers).</p></li>
<li><p><strong>val_size</strong> (<em>float</em><em>, </em><em>default=0.2</em>) – The proportion of the dataset to include in the validation split if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is None. Ignored if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>X_val</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em><em>, </em><em>optional</em>) – The validation input samples. If provided, <code class="docutils literal notranslate"><span class="pre">X</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> are not split and this data is used for validation.</p></li>
<li><p><strong>y_val</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em><em>, </em><em>optional</em>) – The validation target values. Required if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>random_state</strong> (<em>int</em><em>, </em><em>default=101</em>) – Controls the shuffling applied to the data before applying the split.</p></li>
<li><p><strong>batch_size</strong> (<em>int</em><em>, </em><em>default=64</em>) – Number of samples per gradient update.</p></li>
<li><p><strong>shuffle</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to shuffle the training data before each epoch.</p></li>
<li><p><strong>lr</strong> (<em>float</em><em>, </em><em>default=1e-3</em>) – Learning rate for the optimizer.</p></li>
<li><p><strong>lr_patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement on the validation loss to wait before reducing the learning rate.</p></li>
<li><p><strong>factor</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Factor by which the learning rate will be reduced.</p></li>
<li><p><strong>weight_decay</strong> (<em>float</em><em>, </em><em>default=0.025</em>) – Weight decay (L2 penalty) coefficient.</p></li>
<li><p><strong>dataloader_kwargs</strong> (<em>dict</em><em>, </em><em>default={}</em>) – The kwargs for the pytorch dataloader class.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – The built distributional regressor.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.SklearnBaseLSS.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distribution_family</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/mambular/models/sklearn_base_lss.html#SklearnBaseLSS.evaluate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mambular.models.SklearnBaseLSS.evaluate" title="Permalink to this definition">#</a></dt>
<dd><p>Evaluate the model on the given data using specified metrics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array-like</em><em> or </em><em>pd.DataFrame</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The input samples to predict.</p></li>
<li><p><strong>y_true</strong> (<em>array-like</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>)</em>) – The true class labels against which to evaluate the predictions.</p></li>
<li><p><strong>metrics</strong> (<em>dict</em>) – A dictionary where keys are metric names and values are tuples containing the metric function
and a boolean indicating whether the metric requires probability scores (True) or class labels (False).</p></li>
<li><p><strong>distribution_family</strong> (<em>str</em><em>, </em><em>optional</em>) – Specifies the distribution family the model is predicting for. If None, it will attempt to infer based
on the model’s settings.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>scores</strong> – A dictionary with metric names as keys and their corresponding scores as values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This method uses either the <code class="docutils literal notranslate"><span class="pre">predict</span></code> or <code class="docutils literal notranslate"><span class="pre">predict_proba</span></code> method depending on the metric requirements.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.SklearnBaseLSS.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">family</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">101</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patience</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">15</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">monitor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'val_loss'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'min'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_patience</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_decay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checkpoint_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'model_checkpoints'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distributional_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataloader_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rebuild</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">trainer_kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/mambular/models/sklearn_base_lss.html#SklearnBaseLSS.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mambular.models.SklearnBaseLSS.fit" title="Permalink to this definition">#</a></dt>
<dd><p>Trains the regression model using the provided training data. Optionally, a separate validation set can be used.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The training input samples.</p></li>
<li><p><strong>y</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em>) – The target values (real numbers).</p></li>
<li><p><strong>family</strong> (<em>str</em>) – The name of the distribution family to use for the loss function. Examples include ‘normal’ for regression tasks.</p></li>
<li><p><strong>val_size</strong> (<em>float</em><em>, </em><em>default=0.2</em>) – The proportion of the dataset to include in the validation split if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is None. Ignored if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>X_val</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em><em>, </em><em>optional</em>) – The validation input samples. If provided, <code class="docutils literal notranslate"><span class="pre">X</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> are not split and this data is used for validation.</p></li>
<li><p><strong>y_val</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em><em>, </em><em>optional</em>) – The validation target values. Required if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>max_epochs</strong> (<em>int</em><em>, </em><em>default=100</em>) – Maximum number of epochs for training.</p></li>
<li><p><strong>random_state</strong> (<em>int</em><em>, </em><em>default=101</em>) – Controls the shuffling applied to the data before applying the split.</p></li>
<li><p><strong>batch_size</strong> (<em>int</em><em>, </em><em>default=64</em>) – Number of samples per gradient update.</p></li>
<li><p><strong>shuffle</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to shuffle the training data before each epoch.</p></li>
<li><p><strong>patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement on the validation loss to wait before early stopping.</p></li>
<li><p><strong>monitor</strong> (<em>str</em><em>, </em><em>default=&quot;val_loss&quot;</em>) – The metric to monitor for early stopping.</p></li>
<li><p><strong>mode</strong> (<em>str</em><em>, </em><em>default=&quot;min&quot;</em>) – Whether the monitored metric should be minimized (<code class="docutils literal notranslate"><span class="pre">min</span></code>) or maximized (<code class="docutils literal notranslate"><span class="pre">max</span></code>).</p></li>
<li><p><strong>lr</strong> (<em>float</em><em>, </em><em>default=1e-3</em>) – Learning rate for the optimizer.</p></li>
<li><p><strong>lr_patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement on the validation loss to wait before reducing the learning rate.</p></li>
<li><p><strong>factor</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Factor by which the learning rate will be reduced.</p></li>
<li><p><strong>weight_decay</strong> (<em>float</em><em>, </em><em>default=0.025</em>) – Weight decay (L2 penalty) coefficient.</p></li>
<li><p><strong>distributional_kwargs</strong> (<em>dict</em><em>, </em><em>default=None</em>) – any arguments taht are specific for a certain distribution.</p></li>
<li><p><strong>checkpoint_path</strong> (<em>str</em><em>, </em><em>default=&quot;model_checkpoints&quot;</em>) – Path where the checkpoints are being saved.</p></li>
<li><p><strong>dataloader_kwargs</strong> (<em>dict</em><em>, </em><em>default={}</em>) – The kwargs for the pytorch dataloader class.</p></li>
<li><p><strong>**trainer_kwargs</strong> (<em>Additional keyword arguments for PyTorch Lightning's Trainer class.</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – The fitted regressor.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.SklearnBaseLSS.get_default_metrics">
<span class="sig-name descname"><span class="pre">get_default_metrics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">distribution_family</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/mambular/models/sklearn_base_lss.html#SklearnBaseLSS.get_default_metrics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mambular.models.SklearnBaseLSS.get_default_metrics" title="Permalink to this definition">#</a></dt>
<dd><p>Provides default metrics based on the distribution family.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>distribution_family</strong> (<em>str</em>) – The distribution family for which to provide default metrics.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>metrics</strong> – A dictionary of default metric functions.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.SklearnBaseLSS.get_number_of_params">
<span class="sig-name descname"><span class="pre">get_number_of_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">requires_grad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/mambular/models/sklearn_base_lss.html#SklearnBaseLSS.get_number_of_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mambular.models.SklearnBaseLSS.get_number_of_params" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate the number of parameters in the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>requires_grad</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, only count the parameters that require gradients (trainable parameters).
If False, count all parameters. Default is True.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The total number of parameters in the model.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the model has not been built prior to calling this method.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.SklearnBaseLSS.get_params">
<span class="sig-name descname"><span class="pre">get_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">deep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/mambular/models/sklearn_base_lss.html#SklearnBaseLSS.get_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mambular.models.SklearnBaseLSS.get_params" title="Permalink to this definition">#</a></dt>
<dd><p>Get parameters for this estimator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>deep</strong> (<em>bool</em><em>, </em><em>default=True</em>) – If True, will return the parameters for this estimator and contained subobjects that are estimators.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>params</strong> – Parameter names mapped to their values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.SklearnBaseLSS.optimize_hparams">
<span class="sig-name descname"><span class="pre">optimize_hparams</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prune_by_epoch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prune_epoch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fixed_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'cat_encoding':</span> <span class="pre">'int',</span> <span class="pre">'head_layer_size_length':</span> <span class="pre">0,</span> <span class="pre">'head_skip_layer':</span> <span class="pre">False,</span> <span class="pre">'head_skip_layers':</span> <span class="pre">False,</span> <span class="pre">'pooling_method':</span> <span class="pre">'avg',</span> <span class="pre">'use_cls':</span> <span class="pre">False}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">custom_search_space</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">optimize_kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/mambular/models/sklearn_base_lss.html#SklearnBaseLSS.optimize_hparams"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mambular.models.SklearnBaseLSS.optimize_hparams" title="Permalink to this definition">#</a></dt>
<dd><p>Optimizes hyperparameters using Bayesian optimization with optional pruning.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array-like</em>) – Training data.</p></li>
<li><p><strong>y</strong> (<em>array-like</em>) – Training labels.</p></li>
<li><p><strong>X_val</strong> (<em>array-like</em><em>, </em><em>optional</em>) – Validation data and labels.</p></li>
<li><p><strong>y_val</strong> (<em>array-like</em><em>, </em><em>optional</em>) – Validation data and labels.</p></li>
<li><p><strong>time</strong> (<em>int</em>) – The number of optimization trials to run.</p></li>
<li><p><strong>max_epochs</strong> (<em>int</em>) – Maximum number of epochs for training.</p></li>
<li><p><strong>prune_by_epoch</strong> (<em>bool</em>) – Whether to prune based on a specific epoch (True) or the best validation loss (False).</p></li>
<li><p><strong>prune_epoch</strong> (<em>int</em>) – The specific epoch to prune by when prune_by_epoch is True.</p></li>
<li><p><strong>**optimize_kwargs</strong> (<em>dict</em>) – Additional keyword arguments passed to the fit method.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>best_hparams</strong> – Best hyperparameters found during optimization.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.SklearnBaseLSS.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">raw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/mambular/models/sklearn_base_lss.html#SklearnBaseLSS.predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mambular.models.SklearnBaseLSS.predict" title="Permalink to this definition">#</a></dt>
<dd><p>Predicts target values for the given input samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>X</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The input samples for which to predict target values.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>predictions</strong> – The predicted target values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray, shape (n_samples,) or (n_samples, n_outputs)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.SklearnBaseLSS.score">
<span class="sig-name descname"><span class="pre">score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'NLL'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/mambular/models/sklearn_base_lss.html#SklearnBaseLSS.score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mambular.models.SklearnBaseLSS.score" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate the score of the model using the specified metric.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array-like</em><em> or </em><em>pd.DataFrame</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The input samples to predict.</p></li>
<li><p><strong>y</strong> (<em>array-like</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_outputs</em><em>)</em>) – The true target values against which to evaluate the predictions.</p></li>
<li><p><strong>metric</strong> (<em>str</em><em>, </em><em>default=&quot;NLL&quot;</em>) – So far, only negative log-likelihood is supported</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>score</strong> – The score calculated using the specified metric.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.SklearnBaseLSS.set_params">
<span class="sig-name descname"><span class="pre">set_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">parameters</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/mambular/models/sklearn_base_lss.html#SklearnBaseLSS.set_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mambular.models.SklearnBaseLSS.set_params" title="Permalink to this definition">#</a></dt>
<dd><p>Set the parameters of this estimator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>**parameters</strong> (<em>dict</em>) – Estimator parameters.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – Estimator instance.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mambular.models.SklearnBaseRegressor">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mambular.models.</span></span><span class="sig-name descname"><span class="pre">SklearnBaseRegressor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/mambular/models/sklearn_base_regressor.html#SklearnBaseRegressor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mambular.models.SklearnBaseRegressor" title="Permalink to this definition">#</a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="mambular.models.SklearnBaseRegressor.build_model">
<span class="sig-name descname"><span class="pre">build_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">101</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_patience</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_decay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataloader_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/mambular/models/sklearn_base_regressor.html#SklearnBaseRegressor.build_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mambular.models.SklearnBaseRegressor.build_model" title="Permalink to this definition">#</a></dt>
<dd><p>Builds the model using the provided training data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The training input samples.</p></li>
<li><p><strong>y</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em>) – The target values (real numbers).</p></li>
<li><p><strong>val_size</strong> (<em>float</em><em>, </em><em>default=0.2</em>) – The proportion of the dataset to include in the validation split if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is None. Ignored if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>X_val</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em><em>, </em><em>optional</em>) – The validation input samples. If provided, <code class="docutils literal notranslate"><span class="pre">X</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> are not split and this data is used for validation.</p></li>
<li><p><strong>y_val</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em><em>, </em><em>optional</em>) – The validation target values. Required if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>random_state</strong> (<em>int</em><em>, </em><em>default=101</em>) – Controls the shuffling applied to the data before applying the split.</p></li>
<li><p><strong>batch_size</strong> (<em>int</em><em>, </em><em>default=64</em>) – Number of samples per gradient update.</p></li>
<li><p><strong>shuffle</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to shuffle the training data before each epoch.</p></li>
<li><p><strong>lr</strong> (<em>float</em><em>, </em><em>default=1e-3</em>) – Learning rate for the optimizer.</p></li>
<li><p><strong>lr_patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement on the validation loss to wait before reducing the learning rate.</p></li>
<li><p><strong>factor</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Factor by which the learning rate will be reduced.</p></li>
<li><p><strong>weight_decay</strong> (<em>float</em><em>, </em><em>default=0.025</em>) – Weight decay (L2 penalty) coefficient.</p></li>
<li><p><strong>dataloader_kwargs</strong> (<em>dict</em><em>, </em><em>default={}</em>) – The kwargs for the pytorch dataloader class.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – The built regressor.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.SklearnBaseRegressor.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/mambular/models/sklearn_base_regressor.html#SklearnBaseRegressor.evaluate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mambular.models.SklearnBaseRegressor.evaluate" title="Permalink to this definition">#</a></dt>
<dd><p>Evaluate the model on the given data using specified metrics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array-like</em><em> or </em><em>pd.DataFrame</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The input samples to predict.</p></li>
<li><p><strong>y_true</strong> (<em>array-like</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_outputs</em><em>)</em>) – The true target values against which to evaluate the predictions.</p></li>
<li><p><strong>metrics</strong> (<em>dict</em>) – A dictionary where keys are metric names and values are the metric functions.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This method uses the <code class="docutils literal notranslate"><span class="pre">predict</span></code> method to generate predictions and computes each metric.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_squared_error</span><span class="p">,</span> <span class="n">r2_score</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mambular.models</span> <span class="kn">import</span> <span class="n">MambularRegressor</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">metrics</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">... </span>    <span class="s1">&#39;Mean Squared Error&#39;</span><span class="p">:</span> <span class="n">mean_squared_error</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s1">&#39;R2 Score&#39;</span><span class="p">:</span> <span class="n">r2_score</span>
<span class="gp">... </span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Assuming &#39;X_test&#39; and &#39;y_test&#39; are your test dataset and labels</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Evaluate using the specified metrics</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results</span> <span class="o">=</span> <span class="n">regressor</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="n">metrics</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>scores</strong> – A dictionary with metric names as keys and their corresponding scores as values.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.SklearnBaseRegressor.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">101</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patience</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">15</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">monitor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'val_loss'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'min'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_patience</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_decay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checkpoint_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'model_checkpoints'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataloader_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rebuild</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">trainer_kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/mambular/models/sklearn_base_regressor.html#SklearnBaseRegressor.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mambular.models.SklearnBaseRegressor.fit" title="Permalink to this definition">#</a></dt>
<dd><p>Trains the regression model using the provided training data. Optionally, a separate validation set can be used.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The training input samples.</p></li>
<li><p><strong>y</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em>) – The target values (real numbers).</p></li>
<li><p><strong>val_size</strong> (<em>float</em><em>, </em><em>default=0.2</em>) – The proportion of the dataset to include in the validation split if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is None. Ignored if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>X_val</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em><em>, </em><em>optional</em>) – The validation input samples. If provided, <code class="docutils literal notranslate"><span class="pre">X</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> are not split and this data is used for validation.</p></li>
<li><p><strong>y_val</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_targets</em><em>)</em><em>, </em><em>optional</em>) – The validation target values. Required if <code class="docutils literal notranslate"><span class="pre">X_val</span></code> is provided.</p></li>
<li><p><strong>max_epochs</strong> (<em>int</em><em>, </em><em>default=100</em>) – Maximum number of epochs for training.</p></li>
<li><p><strong>random_state</strong> (<em>int</em><em>, </em><em>default=101</em>) – Controls the shuffling applied to the data before applying the split.</p></li>
<li><p><strong>batch_size</strong> (<em>int</em><em>, </em><em>default=64</em>) – Number of samples per gradient update.</p></li>
<li><p><strong>shuffle</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to shuffle the training data before each epoch.</p></li>
<li><p><strong>patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement on the validation loss to wait before early stopping.</p></li>
<li><p><strong>monitor</strong> (<em>str</em><em>, </em><em>default=&quot;val_loss&quot;</em>) – The metric to monitor for early stopping.</p></li>
<li><p><strong>mode</strong> (<em>str</em><em>, </em><em>default=&quot;min&quot;</em>) – Whether the monitored metric should be minimized (<code class="docutils literal notranslate"><span class="pre">min</span></code>) or maximized (<code class="docutils literal notranslate"><span class="pre">max</span></code>).</p></li>
<li><p><strong>lr</strong> (<em>float</em><em>, </em><em>default=1e-3</em>) – Learning rate for the optimizer.</p></li>
<li><p><strong>lr_patience</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of epochs with no improvement on the validation loss to wait before reducing the learning rate.</p></li>
<li><p><strong>factor</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Factor by which the learning rate will be reduced.</p></li>
<li><p><strong>weight_decay</strong> (<em>float</em><em>, </em><em>default=0.025</em>) – Weight decay (L2 penalty) coefficient.</p></li>
<li><p><strong>checkpoint_path</strong> (<em>str</em><em>, </em><em>default=&quot;model_checkpoints&quot;</em>) – Path where the checkpoints are being saved.</p></li>
<li><p><strong>dataloader_kwargs</strong> (<em>dict</em><em>, </em><em>default={}</em>) – The kwargs for the pytorch dataloader class.</p></li>
<li><p><strong>**trainer_kwargs</strong> (<em>Additional keyword arguments for PyTorch Lightning's Trainer class.</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – The fitted regressor.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.SklearnBaseRegressor.get_number_of_params">
<span class="sig-name descname"><span class="pre">get_number_of_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">requires_grad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/mambular/models/sklearn_base_regressor.html#SklearnBaseRegressor.get_number_of_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mambular.models.SklearnBaseRegressor.get_number_of_params" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate the number of parameters in the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>requires_grad</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, only count the parameters that require gradients (trainable parameters).
If False, count all parameters. Default is True.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The total number of parameters in the model.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the model has not been built prior to calling this method.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.SklearnBaseRegressor.get_params">
<span class="sig-name descname"><span class="pre">get_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">deep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/mambular/models/sklearn_base_regressor.html#SklearnBaseRegressor.get_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mambular.models.SklearnBaseRegressor.get_params" title="Permalink to this definition">#</a></dt>
<dd><p>Get parameters for this estimator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>deep</strong> (<em>bool</em><em>, </em><em>default=True</em>) – If True, will return the parameters for this estimator and contained subobjects that are estimators.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>params</strong> – Parameter names mapped to their values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.SklearnBaseRegressor.optimize_hparams">
<span class="sig-name descname"><span class="pre">optimize_hparams</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prune_by_epoch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prune_epoch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fixed_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'cat_encoding':</span> <span class="pre">'int',</span> <span class="pre">'head_layer_size_length':</span> <span class="pre">0,</span> <span class="pre">'head_skip_layer':</span> <span class="pre">False,</span> <span class="pre">'head_skip_layers':</span> <span class="pre">False,</span> <span class="pre">'pooling_method':</span> <span class="pre">'avg',</span> <span class="pre">'use_cls':</span> <span class="pre">False}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">custom_search_space</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">optimize_kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/mambular/models/sklearn_base_regressor.html#SklearnBaseRegressor.optimize_hparams"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mambular.models.SklearnBaseRegressor.optimize_hparams" title="Permalink to this definition">#</a></dt>
<dd><p>Optimizes hyperparameters using Bayesian optimization with optional pruning.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array-like</em>) – Training data.</p></li>
<li><p><strong>y</strong> (<em>array-like</em>) – Training labels.</p></li>
<li><p><strong>X_val</strong> (<em>array-like</em><em>, </em><em>optional</em>) – Validation data and labels.</p></li>
<li><p><strong>y_val</strong> (<em>array-like</em><em>, </em><em>optional</em>) – Validation data and labels.</p></li>
<li><p><strong>time</strong> (<em>int</em>) – The number of optimization trials to run.</p></li>
<li><p><strong>max_epochs</strong> (<em>int</em>) – Maximum number of epochs for training.</p></li>
<li><p><strong>prune_by_epoch</strong> (<em>bool</em>) – Whether to prune based on a specific epoch (True) or the best validation loss (False).</p></li>
<li><p><strong>prune_epoch</strong> (<em>int</em>) – The specific epoch to prune by when prune_by_epoch is True.</p></li>
<li><p><strong>**optimize_kwargs</strong> (<em>dict</em>) – Additional keyword arguments passed to the fit method.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>best_hparams</strong> – Best hyperparameters found during optimization.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.SklearnBaseRegressor.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/mambular/models/sklearn_base_regressor.html#SklearnBaseRegressor.predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mambular.models.SklearnBaseRegressor.predict" title="Permalink to this definition">#</a></dt>
<dd><p>Predicts target values for the given input samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>X</strong> (<em>DataFrame</em><em> or </em><em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The input samples for which to predict target values.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>predictions</strong> – The predicted target values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray, shape (n_samples,) or (n_samples, n_outputs)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.SklearnBaseRegressor.score">
<span class="sig-name descname"><span class="pre">score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">sklearn.metrics.mean_squared_error</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/mambular/models/sklearn_base_regressor.html#SklearnBaseRegressor.score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mambular.models.SklearnBaseRegressor.score" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate the score of the model using the specified metric.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array-like</em><em> or </em><em>pd.DataFrame</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The input samples to predict.</p></li>
<li><p><strong>y</strong> (<em>array-like</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>) or </em><em>(</em><em>n_samples</em><em>, </em><em>n_outputs</em><em>)</em>) – The true target values against which to evaluate the predictions.</p></li>
<li><p><strong>metric</strong> (<em>callable</em><em>, </em><em>default=mean_squared_error</em>) – The metric function to use for evaluation. Must be a callable with the signature <code class="docutils literal notranslate"><span class="pre">metric(y_true,</span> <span class="pre">y_pred)</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>score</strong> – The score calculated using the specified metric.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mambular.models.SklearnBaseRegressor.set_params">
<span class="sig-name descname"><span class="pre">set_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">parameters</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/mambular/models/sklearn_base_regressor.html#SklearnBaseRegressor.set_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mambular.models.SklearnBaseRegressor.set_params" title="Permalink to this definition">#</a></dt>
<dd><p>Set the parameters of this estimator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>**parameters</strong> (<em>dict</em>) – Estimator parameters.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – Estimator instance.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="index.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Models</p>
      </div>
    </a>
    <a class="right-next"
       href="../base_models/index.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">BaseModels</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambularClassifier"><code class="docutils literal notranslate"><span class="pre">MambularClassifier</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambularClassifier.build_model"><code class="docutils literal notranslate"><span class="pre">MambularClassifier.build_model()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambularClassifier.evaluate"><code class="docutils literal notranslate"><span class="pre">MambularClassifier.evaluate()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambularClassifier.fit"><code class="docutils literal notranslate"><span class="pre">MambularClassifier.fit()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambularClassifier.get_number_of_params"><code class="docutils literal notranslate"><span class="pre">MambularClassifier.get_number_of_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambularClassifier.get_params"><code class="docutils literal notranslate"><span class="pre">MambularClassifier.get_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambularClassifier.optimize_hparams"><code class="docutils literal notranslate"><span class="pre">MambularClassifier.optimize_hparams()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambularClassifier.predict"><code class="docutils literal notranslate"><span class="pre">MambularClassifier.predict()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambularClassifier.predict_proba"><code class="docutils literal notranslate"><span class="pre">MambularClassifier.predict_proba()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambularClassifier.score"><code class="docutils literal notranslate"><span class="pre">MambularClassifier.score()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambularClassifier.set_params"><code class="docutils literal notranslate"><span class="pre">MambularClassifier.set_params()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambularRegressor"><code class="docutils literal notranslate"><span class="pre">MambularRegressor</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambularRegressor.build_model"><code class="docutils literal notranslate"><span class="pre">MambularRegressor.build_model()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambularRegressor.evaluate"><code class="docutils literal notranslate"><span class="pre">MambularRegressor.evaluate()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambularRegressor.fit"><code class="docutils literal notranslate"><span class="pre">MambularRegressor.fit()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambularRegressor.get_number_of_params"><code class="docutils literal notranslate"><span class="pre">MambularRegressor.get_number_of_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambularRegressor.get_params"><code class="docutils literal notranslate"><span class="pre">MambularRegressor.get_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambularRegressor.optimize_hparams"><code class="docutils literal notranslate"><span class="pre">MambularRegressor.optimize_hparams()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambularRegressor.predict"><code class="docutils literal notranslate"><span class="pre">MambularRegressor.predict()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambularRegressor.score"><code class="docutils literal notranslate"><span class="pre">MambularRegressor.score()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambularRegressor.set_params"><code class="docutils literal notranslate"><span class="pre">MambularRegressor.set_params()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambularLSS"><code class="docutils literal notranslate"><span class="pre">MambularLSS</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambularLSS.build_model"><code class="docutils literal notranslate"><span class="pre">MambularLSS.build_model()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambularLSS.evaluate"><code class="docutils literal notranslate"><span class="pre">MambularLSS.evaluate()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambularLSS.fit"><code class="docutils literal notranslate"><span class="pre">MambularLSS.fit()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambularLSS.get_default_metrics"><code class="docutils literal notranslate"><span class="pre">MambularLSS.get_default_metrics()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambularLSS.get_number_of_params"><code class="docutils literal notranslate"><span class="pre">MambularLSS.get_number_of_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambularLSS.get_params"><code class="docutils literal notranslate"><span class="pre">MambularLSS.get_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambularLSS.optimize_hparams"><code class="docutils literal notranslate"><span class="pre">MambularLSS.optimize_hparams()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambularLSS.predict"><code class="docutils literal notranslate"><span class="pre">MambularLSS.predict()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambularLSS.score"><code class="docutils literal notranslate"><span class="pre">MambularLSS.score()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambularLSS.set_params"><code class="docutils literal notranslate"><span class="pre">MambularLSS.set_params()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.FTTransformerClassifier"><code class="docutils literal notranslate"><span class="pre">FTTransformerClassifier</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.FTTransformerClassifier.build_model"><code class="docutils literal notranslate"><span class="pre">FTTransformerClassifier.build_model()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.FTTransformerClassifier.evaluate"><code class="docutils literal notranslate"><span class="pre">FTTransformerClassifier.evaluate()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.FTTransformerClassifier.fit"><code class="docutils literal notranslate"><span class="pre">FTTransformerClassifier.fit()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.FTTransformerClassifier.get_number_of_params"><code class="docutils literal notranslate"><span class="pre">FTTransformerClassifier.get_number_of_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.FTTransformerClassifier.get_params"><code class="docutils literal notranslate"><span class="pre">FTTransformerClassifier.get_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.FTTransformerClassifier.optimize_hparams"><code class="docutils literal notranslate"><span class="pre">FTTransformerClassifier.optimize_hparams()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.FTTransformerClassifier.predict"><code class="docutils literal notranslate"><span class="pre">FTTransformerClassifier.predict()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.FTTransformerClassifier.predict_proba"><code class="docutils literal notranslate"><span class="pre">FTTransformerClassifier.predict_proba()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.FTTransformerClassifier.score"><code class="docutils literal notranslate"><span class="pre">FTTransformerClassifier.score()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.FTTransformerClassifier.set_params"><code class="docutils literal notranslate"><span class="pre">FTTransformerClassifier.set_params()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.FTTransformerRegressor"><code class="docutils literal notranslate"><span class="pre">FTTransformerRegressor</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.FTTransformerRegressor.build_model"><code class="docutils literal notranslate"><span class="pre">FTTransformerRegressor.build_model()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.FTTransformerRegressor.evaluate"><code class="docutils literal notranslate"><span class="pre">FTTransformerRegressor.evaluate()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.FTTransformerRegressor.fit"><code class="docutils literal notranslate"><span class="pre">FTTransformerRegressor.fit()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.FTTransformerRegressor.get_number_of_params"><code class="docutils literal notranslate"><span class="pre">FTTransformerRegressor.get_number_of_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.FTTransformerRegressor.get_params"><code class="docutils literal notranslate"><span class="pre">FTTransformerRegressor.get_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.FTTransformerRegressor.optimize_hparams"><code class="docutils literal notranslate"><span class="pre">FTTransformerRegressor.optimize_hparams()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.FTTransformerRegressor.predict"><code class="docutils literal notranslate"><span class="pre">FTTransformerRegressor.predict()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.FTTransformerRegressor.score"><code class="docutils literal notranslate"><span class="pre">FTTransformerRegressor.score()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.FTTransformerRegressor.set_params"><code class="docutils literal notranslate"><span class="pre">FTTransformerRegressor.set_params()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.FTTransformerLSS"><code class="docutils literal notranslate"><span class="pre">FTTransformerLSS</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.FTTransformerLSS.build_model"><code class="docutils literal notranslate"><span class="pre">FTTransformerLSS.build_model()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.FTTransformerLSS.evaluate"><code class="docutils literal notranslate"><span class="pre">FTTransformerLSS.evaluate()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.FTTransformerLSS.fit"><code class="docutils literal notranslate"><span class="pre">FTTransformerLSS.fit()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.FTTransformerLSS.get_default_metrics"><code class="docutils literal notranslate"><span class="pre">FTTransformerLSS.get_default_metrics()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.FTTransformerLSS.get_number_of_params"><code class="docutils literal notranslate"><span class="pre">FTTransformerLSS.get_number_of_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.FTTransformerLSS.get_params"><code class="docutils literal notranslate"><span class="pre">FTTransformerLSS.get_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.FTTransformerLSS.optimize_hparams"><code class="docutils literal notranslate"><span class="pre">FTTransformerLSS.optimize_hparams()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.FTTransformerLSS.predict"><code class="docutils literal notranslate"><span class="pre">FTTransformerLSS.predict()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.FTTransformerLSS.score"><code class="docutils literal notranslate"><span class="pre">FTTransformerLSS.score()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.FTTransformerLSS.set_params"><code class="docutils literal notranslate"><span class="pre">FTTransformerLSS.set_params()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MLPClassifier"><code class="docutils literal notranslate"><span class="pre">MLPClassifier</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MLPClassifier.build_model"><code class="docutils literal notranslate"><span class="pre">MLPClassifier.build_model()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MLPClassifier.evaluate"><code class="docutils literal notranslate"><span class="pre">MLPClassifier.evaluate()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MLPClassifier.fit"><code class="docutils literal notranslate"><span class="pre">MLPClassifier.fit()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MLPClassifier.get_number_of_params"><code class="docutils literal notranslate"><span class="pre">MLPClassifier.get_number_of_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MLPClassifier.get_params"><code class="docutils literal notranslate"><span class="pre">MLPClassifier.get_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MLPClassifier.optimize_hparams"><code class="docutils literal notranslate"><span class="pre">MLPClassifier.optimize_hparams()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MLPClassifier.predict"><code class="docutils literal notranslate"><span class="pre">MLPClassifier.predict()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MLPClassifier.predict_proba"><code class="docutils literal notranslate"><span class="pre">MLPClassifier.predict_proba()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MLPClassifier.score"><code class="docutils literal notranslate"><span class="pre">MLPClassifier.score()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MLPClassifier.set_params"><code class="docutils literal notranslate"><span class="pre">MLPClassifier.set_params()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MLPRegressor"><code class="docutils literal notranslate"><span class="pre">MLPRegressor</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MLPRegressor.build_model"><code class="docutils literal notranslate"><span class="pre">MLPRegressor.build_model()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MLPRegressor.evaluate"><code class="docutils literal notranslate"><span class="pre">MLPRegressor.evaluate()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MLPRegressor.fit"><code class="docutils literal notranslate"><span class="pre">MLPRegressor.fit()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MLPRegressor.get_number_of_params"><code class="docutils literal notranslate"><span class="pre">MLPRegressor.get_number_of_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MLPRegressor.get_params"><code class="docutils literal notranslate"><span class="pre">MLPRegressor.get_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MLPRegressor.optimize_hparams"><code class="docutils literal notranslate"><span class="pre">MLPRegressor.optimize_hparams()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MLPRegressor.predict"><code class="docutils literal notranslate"><span class="pre">MLPRegressor.predict()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MLPRegressor.score"><code class="docutils literal notranslate"><span class="pre">MLPRegressor.score()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MLPRegressor.set_params"><code class="docutils literal notranslate"><span class="pre">MLPRegressor.set_params()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MLPLSS"><code class="docutils literal notranslate"><span class="pre">MLPLSS</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MLPLSS.build_model"><code class="docutils literal notranslate"><span class="pre">MLPLSS.build_model()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MLPLSS.evaluate"><code class="docutils literal notranslate"><span class="pre">MLPLSS.evaluate()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MLPLSS.fit"><code class="docutils literal notranslate"><span class="pre">MLPLSS.fit()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MLPLSS.get_default_metrics"><code class="docutils literal notranslate"><span class="pre">MLPLSS.get_default_metrics()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MLPLSS.get_number_of_params"><code class="docutils literal notranslate"><span class="pre">MLPLSS.get_number_of_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MLPLSS.get_params"><code class="docutils literal notranslate"><span class="pre">MLPLSS.get_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MLPLSS.optimize_hparams"><code class="docutils literal notranslate"><span class="pre">MLPLSS.optimize_hparams()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MLPLSS.predict"><code class="docutils literal notranslate"><span class="pre">MLPLSS.predict()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MLPLSS.score"><code class="docutils literal notranslate"><span class="pre">MLPLSS.score()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MLPLSS.set_params"><code class="docutils literal notranslate"><span class="pre">MLPLSS.set_params()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabTransformerClassifier"><code class="docutils literal notranslate"><span class="pre">TabTransformerClassifier</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabTransformerClassifier.build_model"><code class="docutils literal notranslate"><span class="pre">TabTransformerClassifier.build_model()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabTransformerClassifier.evaluate"><code class="docutils literal notranslate"><span class="pre">TabTransformerClassifier.evaluate()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabTransformerClassifier.fit"><code class="docutils literal notranslate"><span class="pre">TabTransformerClassifier.fit()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabTransformerClassifier.get_number_of_params"><code class="docutils literal notranslate"><span class="pre">TabTransformerClassifier.get_number_of_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabTransformerClassifier.get_params"><code class="docutils literal notranslate"><span class="pre">TabTransformerClassifier.get_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabTransformerClassifier.optimize_hparams"><code class="docutils literal notranslate"><span class="pre">TabTransformerClassifier.optimize_hparams()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabTransformerClassifier.predict"><code class="docutils literal notranslate"><span class="pre">TabTransformerClassifier.predict()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabTransformerClassifier.predict_proba"><code class="docutils literal notranslate"><span class="pre">TabTransformerClassifier.predict_proba()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabTransformerClassifier.score"><code class="docutils literal notranslate"><span class="pre">TabTransformerClassifier.score()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabTransformerClassifier.set_params"><code class="docutils literal notranslate"><span class="pre">TabTransformerClassifier.set_params()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabTransformerRegressor"><code class="docutils literal notranslate"><span class="pre">TabTransformerRegressor</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabTransformerRegressor.build_model"><code class="docutils literal notranslate"><span class="pre">TabTransformerRegressor.build_model()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabTransformerRegressor.evaluate"><code class="docutils literal notranslate"><span class="pre">TabTransformerRegressor.evaluate()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabTransformerRegressor.fit"><code class="docutils literal notranslate"><span class="pre">TabTransformerRegressor.fit()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabTransformerRegressor.get_number_of_params"><code class="docutils literal notranslate"><span class="pre">TabTransformerRegressor.get_number_of_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabTransformerRegressor.get_params"><code class="docutils literal notranslate"><span class="pre">TabTransformerRegressor.get_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabTransformerRegressor.optimize_hparams"><code class="docutils literal notranslate"><span class="pre">TabTransformerRegressor.optimize_hparams()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabTransformerRegressor.predict"><code class="docutils literal notranslate"><span class="pre">TabTransformerRegressor.predict()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabTransformerRegressor.score"><code class="docutils literal notranslate"><span class="pre">TabTransformerRegressor.score()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabTransformerRegressor.set_params"><code class="docutils literal notranslate"><span class="pre">TabTransformerRegressor.set_params()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabTransformerLSS"><code class="docutils literal notranslate"><span class="pre">TabTransformerLSS</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabTransformerLSS.build_model"><code class="docutils literal notranslate"><span class="pre">TabTransformerLSS.build_model()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabTransformerLSS.evaluate"><code class="docutils literal notranslate"><span class="pre">TabTransformerLSS.evaluate()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabTransformerLSS.fit"><code class="docutils literal notranslate"><span class="pre">TabTransformerLSS.fit()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabTransformerLSS.get_default_metrics"><code class="docutils literal notranslate"><span class="pre">TabTransformerLSS.get_default_metrics()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabTransformerLSS.get_number_of_params"><code class="docutils literal notranslate"><span class="pre">TabTransformerLSS.get_number_of_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabTransformerLSS.get_params"><code class="docutils literal notranslate"><span class="pre">TabTransformerLSS.get_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabTransformerLSS.optimize_hparams"><code class="docutils literal notranslate"><span class="pre">TabTransformerLSS.optimize_hparams()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabTransformerLSS.predict"><code class="docutils literal notranslate"><span class="pre">TabTransformerLSS.predict()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabTransformerLSS.score"><code class="docutils literal notranslate"><span class="pre">TabTransformerLSS.score()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabTransformerLSS.set_params"><code class="docutils literal notranslate"><span class="pre">TabTransformerLSS.set_params()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.ResNetClassifier"><code class="docutils literal notranslate"><span class="pre">ResNetClassifier</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.ResNetClassifier.build_model"><code class="docutils literal notranslate"><span class="pre">ResNetClassifier.build_model()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.ResNetClassifier.evaluate"><code class="docutils literal notranslate"><span class="pre">ResNetClassifier.evaluate()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.ResNetClassifier.fit"><code class="docutils literal notranslate"><span class="pre">ResNetClassifier.fit()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.ResNetClassifier.get_number_of_params"><code class="docutils literal notranslate"><span class="pre">ResNetClassifier.get_number_of_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.ResNetClassifier.get_params"><code class="docutils literal notranslate"><span class="pre">ResNetClassifier.get_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.ResNetClassifier.optimize_hparams"><code class="docutils literal notranslate"><span class="pre">ResNetClassifier.optimize_hparams()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.ResNetClassifier.predict"><code class="docutils literal notranslate"><span class="pre">ResNetClassifier.predict()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.ResNetClassifier.predict_proba"><code class="docutils literal notranslate"><span class="pre">ResNetClassifier.predict_proba()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.ResNetClassifier.score"><code class="docutils literal notranslate"><span class="pre">ResNetClassifier.score()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.ResNetClassifier.set_params"><code class="docutils literal notranslate"><span class="pre">ResNetClassifier.set_params()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.ResNetRegressor"><code class="docutils literal notranslate"><span class="pre">ResNetRegressor</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.ResNetRegressor.build_model"><code class="docutils literal notranslate"><span class="pre">ResNetRegressor.build_model()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.ResNetRegressor.evaluate"><code class="docutils literal notranslate"><span class="pre">ResNetRegressor.evaluate()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.ResNetRegressor.fit"><code class="docutils literal notranslate"><span class="pre">ResNetRegressor.fit()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.ResNetRegressor.get_number_of_params"><code class="docutils literal notranslate"><span class="pre">ResNetRegressor.get_number_of_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.ResNetRegressor.get_params"><code class="docutils literal notranslate"><span class="pre">ResNetRegressor.get_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.ResNetRegressor.optimize_hparams"><code class="docutils literal notranslate"><span class="pre">ResNetRegressor.optimize_hparams()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.ResNetRegressor.predict"><code class="docutils literal notranslate"><span class="pre">ResNetRegressor.predict()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.ResNetRegressor.score"><code class="docutils literal notranslate"><span class="pre">ResNetRegressor.score()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.ResNetRegressor.set_params"><code class="docutils literal notranslate"><span class="pre">ResNetRegressor.set_params()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.ResNetLSS"><code class="docutils literal notranslate"><span class="pre">ResNetLSS</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.ResNetLSS.build_model"><code class="docutils literal notranslate"><span class="pre">ResNetLSS.build_model()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.ResNetLSS.evaluate"><code class="docutils literal notranslate"><span class="pre">ResNetLSS.evaluate()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.ResNetLSS.fit"><code class="docutils literal notranslate"><span class="pre">ResNetLSS.fit()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.ResNetLSS.get_default_metrics"><code class="docutils literal notranslate"><span class="pre">ResNetLSS.get_default_metrics()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.ResNetLSS.get_number_of_params"><code class="docutils literal notranslate"><span class="pre">ResNetLSS.get_number_of_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.ResNetLSS.get_params"><code class="docutils literal notranslate"><span class="pre">ResNetLSS.get_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.ResNetLSS.optimize_hparams"><code class="docutils literal notranslate"><span class="pre">ResNetLSS.optimize_hparams()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.ResNetLSS.predict"><code class="docutils literal notranslate"><span class="pre">ResNetLSS.predict()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.ResNetLSS.score"><code class="docutils literal notranslate"><span class="pre">ResNetLSS.score()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.ResNetLSS.set_params"><code class="docutils literal notranslate"><span class="pre">ResNetLSS.set_params()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambaTabClassifier"><code class="docutils literal notranslate"><span class="pre">MambaTabClassifier</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambaTabClassifier.build_model"><code class="docutils literal notranslate"><span class="pre">MambaTabClassifier.build_model()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambaTabClassifier.evaluate"><code class="docutils literal notranslate"><span class="pre">MambaTabClassifier.evaluate()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambaTabClassifier.fit"><code class="docutils literal notranslate"><span class="pre">MambaTabClassifier.fit()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambaTabClassifier.get_number_of_params"><code class="docutils literal notranslate"><span class="pre">MambaTabClassifier.get_number_of_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambaTabClassifier.get_params"><code class="docutils literal notranslate"><span class="pre">MambaTabClassifier.get_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambaTabClassifier.optimize_hparams"><code class="docutils literal notranslate"><span class="pre">MambaTabClassifier.optimize_hparams()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambaTabClassifier.predict"><code class="docutils literal notranslate"><span class="pre">MambaTabClassifier.predict()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambaTabClassifier.predict_proba"><code class="docutils literal notranslate"><span class="pre">MambaTabClassifier.predict_proba()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambaTabClassifier.score"><code class="docutils literal notranslate"><span class="pre">MambaTabClassifier.score()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambaTabClassifier.set_params"><code class="docutils literal notranslate"><span class="pre">MambaTabClassifier.set_params()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambaTabRegressor"><code class="docutils literal notranslate"><span class="pre">MambaTabRegressor</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambaTabRegressor.build_model"><code class="docutils literal notranslate"><span class="pre">MambaTabRegressor.build_model()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambaTabRegressor.evaluate"><code class="docutils literal notranslate"><span class="pre">MambaTabRegressor.evaluate()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambaTabRegressor.fit"><code class="docutils literal notranslate"><span class="pre">MambaTabRegressor.fit()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambaTabRegressor.get_number_of_params"><code class="docutils literal notranslate"><span class="pre">MambaTabRegressor.get_number_of_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambaTabRegressor.get_params"><code class="docutils literal notranslate"><span class="pre">MambaTabRegressor.get_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambaTabRegressor.optimize_hparams"><code class="docutils literal notranslate"><span class="pre">MambaTabRegressor.optimize_hparams()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambaTabRegressor.predict"><code class="docutils literal notranslate"><span class="pre">MambaTabRegressor.predict()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambaTabRegressor.score"><code class="docutils literal notranslate"><span class="pre">MambaTabRegressor.score()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambaTabRegressor.set_params"><code class="docutils literal notranslate"><span class="pre">MambaTabRegressor.set_params()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambaTabLSS"><code class="docutils literal notranslate"><span class="pre">MambaTabLSS</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambaTabLSS.build_model"><code class="docutils literal notranslate"><span class="pre">MambaTabLSS.build_model()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambaTabLSS.evaluate"><code class="docutils literal notranslate"><span class="pre">MambaTabLSS.evaluate()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambaTabLSS.fit"><code class="docutils literal notranslate"><span class="pre">MambaTabLSS.fit()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambaTabLSS.get_default_metrics"><code class="docutils literal notranslate"><span class="pre">MambaTabLSS.get_default_metrics()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambaTabLSS.get_number_of_params"><code class="docutils literal notranslate"><span class="pre">MambaTabLSS.get_number_of_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambaTabLSS.get_params"><code class="docutils literal notranslate"><span class="pre">MambaTabLSS.get_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambaTabLSS.optimize_hparams"><code class="docutils literal notranslate"><span class="pre">MambaTabLSS.optimize_hparams()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambaTabLSS.predict"><code class="docutils literal notranslate"><span class="pre">MambaTabLSS.predict()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambaTabLSS.score"><code class="docutils literal notranslate"><span class="pre">MambaTabLSS.score()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambaTabLSS.set_params"><code class="docutils literal notranslate"><span class="pre">MambaTabLSS.set_params()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambAttentionClassifier"><code class="docutils literal notranslate"><span class="pre">MambAttentionClassifier</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambAttentionClassifier.build_model"><code class="docutils literal notranslate"><span class="pre">MambAttentionClassifier.build_model()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambAttentionClassifier.evaluate"><code class="docutils literal notranslate"><span class="pre">MambAttentionClassifier.evaluate()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambAttentionClassifier.fit"><code class="docutils literal notranslate"><span class="pre">MambAttentionClassifier.fit()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambAttentionClassifier.get_number_of_params"><code class="docutils literal notranslate"><span class="pre">MambAttentionClassifier.get_number_of_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambAttentionClassifier.get_params"><code class="docutils literal notranslate"><span class="pre">MambAttentionClassifier.get_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambAttentionClassifier.optimize_hparams"><code class="docutils literal notranslate"><span class="pre">MambAttentionClassifier.optimize_hparams()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambAttentionClassifier.predict"><code class="docutils literal notranslate"><span class="pre">MambAttentionClassifier.predict()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambAttentionClassifier.predict_proba"><code class="docutils literal notranslate"><span class="pre">MambAttentionClassifier.predict_proba()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambAttentionClassifier.score"><code class="docutils literal notranslate"><span class="pre">MambAttentionClassifier.score()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambAttentionClassifier.set_params"><code class="docutils literal notranslate"><span class="pre">MambAttentionClassifier.set_params()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambAttentionRegressor"><code class="docutils literal notranslate"><span class="pre">MambAttentionRegressor</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambAttentionRegressor.build_model"><code class="docutils literal notranslate"><span class="pre">MambAttentionRegressor.build_model()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambAttentionRegressor.evaluate"><code class="docutils literal notranslate"><span class="pre">MambAttentionRegressor.evaluate()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambAttentionRegressor.fit"><code class="docutils literal notranslate"><span class="pre">MambAttentionRegressor.fit()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambAttentionRegressor.get_number_of_params"><code class="docutils literal notranslate"><span class="pre">MambAttentionRegressor.get_number_of_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambAttentionRegressor.get_params"><code class="docutils literal notranslate"><span class="pre">MambAttentionRegressor.get_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambAttentionRegressor.optimize_hparams"><code class="docutils literal notranslate"><span class="pre">MambAttentionRegressor.optimize_hparams()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambAttentionRegressor.predict"><code class="docutils literal notranslate"><span class="pre">MambAttentionRegressor.predict()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambAttentionRegressor.score"><code class="docutils literal notranslate"><span class="pre">MambAttentionRegressor.score()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambAttentionRegressor.set_params"><code class="docutils literal notranslate"><span class="pre">MambAttentionRegressor.set_params()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambAttentionLSS"><code class="docutils literal notranslate"><span class="pre">MambAttentionLSS</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambAttentionLSS.build_model"><code class="docutils literal notranslate"><span class="pre">MambAttentionLSS.build_model()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambAttentionLSS.evaluate"><code class="docutils literal notranslate"><span class="pre">MambAttentionLSS.evaluate()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambAttentionLSS.fit"><code class="docutils literal notranslate"><span class="pre">MambAttentionLSS.fit()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambAttentionLSS.get_default_metrics"><code class="docutils literal notranslate"><span class="pre">MambAttentionLSS.get_default_metrics()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambAttentionLSS.get_number_of_params"><code class="docutils literal notranslate"><span class="pre">MambAttentionLSS.get_number_of_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambAttentionLSS.get_params"><code class="docutils literal notranslate"><span class="pre">MambAttentionLSS.get_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambAttentionLSS.optimize_hparams"><code class="docutils literal notranslate"><span class="pre">MambAttentionLSS.optimize_hparams()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambAttentionLSS.predict"><code class="docutils literal notranslate"><span class="pre">MambAttentionLSS.predict()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambAttentionLSS.score"><code class="docutils literal notranslate"><span class="pre">MambAttentionLSS.score()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.MambAttentionLSS.set_params"><code class="docutils literal notranslate"><span class="pre">MambAttentionLSS.set_params()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabulaRNNClassifier"><code class="docutils literal notranslate"><span class="pre">TabulaRNNClassifier</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabulaRNNClassifier.build_model"><code class="docutils literal notranslate"><span class="pre">TabulaRNNClassifier.build_model()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabulaRNNClassifier.evaluate"><code class="docutils literal notranslate"><span class="pre">TabulaRNNClassifier.evaluate()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabulaRNNClassifier.fit"><code class="docutils literal notranslate"><span class="pre">TabulaRNNClassifier.fit()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabulaRNNClassifier.get_number_of_params"><code class="docutils literal notranslate"><span class="pre">TabulaRNNClassifier.get_number_of_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabulaRNNClassifier.get_params"><code class="docutils literal notranslate"><span class="pre">TabulaRNNClassifier.get_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabulaRNNClassifier.optimize_hparams"><code class="docutils literal notranslate"><span class="pre">TabulaRNNClassifier.optimize_hparams()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabulaRNNClassifier.predict"><code class="docutils literal notranslate"><span class="pre">TabulaRNNClassifier.predict()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabulaRNNClassifier.predict_proba"><code class="docutils literal notranslate"><span class="pre">TabulaRNNClassifier.predict_proba()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabulaRNNClassifier.score"><code class="docutils literal notranslate"><span class="pre">TabulaRNNClassifier.score()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabulaRNNClassifier.set_params"><code class="docutils literal notranslate"><span class="pre">TabulaRNNClassifier.set_params()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabulaRNNRegressor"><code class="docutils literal notranslate"><span class="pre">TabulaRNNRegressor</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabulaRNNRegressor.build_model"><code class="docutils literal notranslate"><span class="pre">TabulaRNNRegressor.build_model()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabulaRNNRegressor.evaluate"><code class="docutils literal notranslate"><span class="pre">TabulaRNNRegressor.evaluate()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabulaRNNRegressor.fit"><code class="docutils literal notranslate"><span class="pre">TabulaRNNRegressor.fit()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabulaRNNRegressor.get_number_of_params"><code class="docutils literal notranslate"><span class="pre">TabulaRNNRegressor.get_number_of_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabulaRNNRegressor.get_params"><code class="docutils literal notranslate"><span class="pre">TabulaRNNRegressor.get_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabulaRNNRegressor.optimize_hparams"><code class="docutils literal notranslate"><span class="pre">TabulaRNNRegressor.optimize_hparams()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabulaRNNRegressor.predict"><code class="docutils literal notranslate"><span class="pre">TabulaRNNRegressor.predict()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabulaRNNRegressor.score"><code class="docutils literal notranslate"><span class="pre">TabulaRNNRegressor.score()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabulaRNNRegressor.set_params"><code class="docutils literal notranslate"><span class="pre">TabulaRNNRegressor.set_params()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabulaRNNLSS"><code class="docutils literal notranslate"><span class="pre">TabulaRNNLSS</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabulaRNNLSS.build_model"><code class="docutils literal notranslate"><span class="pre">TabulaRNNLSS.build_model()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabulaRNNLSS.evaluate"><code class="docutils literal notranslate"><span class="pre">TabulaRNNLSS.evaluate()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabulaRNNLSS.fit"><code class="docutils literal notranslate"><span class="pre">TabulaRNNLSS.fit()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabulaRNNLSS.get_default_metrics"><code class="docutils literal notranslate"><span class="pre">TabulaRNNLSS.get_default_metrics()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabulaRNNLSS.get_number_of_params"><code class="docutils literal notranslate"><span class="pre">TabulaRNNLSS.get_number_of_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabulaRNNLSS.get_params"><code class="docutils literal notranslate"><span class="pre">TabulaRNNLSS.get_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabulaRNNLSS.optimize_hparams"><code class="docutils literal notranslate"><span class="pre">TabulaRNNLSS.optimize_hparams()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabulaRNNLSS.predict"><code class="docutils literal notranslate"><span class="pre">TabulaRNNLSS.predict()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabulaRNNLSS.score"><code class="docutils literal notranslate"><span class="pre">TabulaRNNLSS.score()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabulaRNNLSS.set_params"><code class="docutils literal notranslate"><span class="pre">TabulaRNNLSS.set_params()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabMClassifier"><code class="docutils literal notranslate"><span class="pre">TabMClassifier</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabMClassifier.build_model"><code class="docutils literal notranslate"><span class="pre">TabMClassifier.build_model()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabMClassifier.evaluate"><code class="docutils literal notranslate"><span class="pre">TabMClassifier.evaluate()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabMClassifier.fit"><code class="docutils literal notranslate"><span class="pre">TabMClassifier.fit()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabMClassifier.get_number_of_params"><code class="docutils literal notranslate"><span class="pre">TabMClassifier.get_number_of_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabMClassifier.get_params"><code class="docutils literal notranslate"><span class="pre">TabMClassifier.get_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabMClassifier.optimize_hparams"><code class="docutils literal notranslate"><span class="pre">TabMClassifier.optimize_hparams()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabMClassifier.predict"><code class="docutils literal notranslate"><span class="pre">TabMClassifier.predict()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabMClassifier.predict_proba"><code class="docutils literal notranslate"><span class="pre">TabMClassifier.predict_proba()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabMClassifier.score"><code class="docutils literal notranslate"><span class="pre">TabMClassifier.score()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabMClassifier.set_params"><code class="docutils literal notranslate"><span class="pre">TabMClassifier.set_params()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabMRegressor"><code class="docutils literal notranslate"><span class="pre">TabMRegressor</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabMRegressor.build_model"><code class="docutils literal notranslate"><span class="pre">TabMRegressor.build_model()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabMRegressor.evaluate"><code class="docutils literal notranslate"><span class="pre">TabMRegressor.evaluate()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabMRegressor.fit"><code class="docutils literal notranslate"><span class="pre">TabMRegressor.fit()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabMRegressor.get_number_of_params"><code class="docutils literal notranslate"><span class="pre">TabMRegressor.get_number_of_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabMRegressor.get_params"><code class="docutils literal notranslate"><span class="pre">TabMRegressor.get_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabMRegressor.optimize_hparams"><code class="docutils literal notranslate"><span class="pre">TabMRegressor.optimize_hparams()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabMRegressor.predict"><code class="docutils literal notranslate"><span class="pre">TabMRegressor.predict()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabMRegressor.score"><code class="docutils literal notranslate"><span class="pre">TabMRegressor.score()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabMRegressor.set_params"><code class="docutils literal notranslate"><span class="pre">TabMRegressor.set_params()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabMLSS"><code class="docutils literal notranslate"><span class="pre">TabMLSS</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabMLSS.build_model"><code class="docutils literal notranslate"><span class="pre">TabMLSS.build_model()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabMLSS.evaluate"><code class="docutils literal notranslate"><span class="pre">TabMLSS.evaluate()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabMLSS.fit"><code class="docutils literal notranslate"><span class="pre">TabMLSS.fit()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabMLSS.get_default_metrics"><code class="docutils literal notranslate"><span class="pre">TabMLSS.get_default_metrics()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabMLSS.get_number_of_params"><code class="docutils literal notranslate"><span class="pre">TabMLSS.get_number_of_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabMLSS.get_params"><code class="docutils literal notranslate"><span class="pre">TabMLSS.get_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabMLSS.optimize_hparams"><code class="docutils literal notranslate"><span class="pre">TabMLSS.optimize_hparams()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabMLSS.predict"><code class="docutils literal notranslate"><span class="pre">TabMLSS.predict()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabMLSS.score"><code class="docutils literal notranslate"><span class="pre">TabMLSS.score()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.TabMLSS.set_params"><code class="docutils literal notranslate"><span class="pre">TabMLSS.set_params()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NODEClassifier"><code class="docutils literal notranslate"><span class="pre">NODEClassifier</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NODEClassifier.build_model"><code class="docutils literal notranslate"><span class="pre">NODEClassifier.build_model()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NODEClassifier.evaluate"><code class="docutils literal notranslate"><span class="pre">NODEClassifier.evaluate()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NODEClassifier.fit"><code class="docutils literal notranslate"><span class="pre">NODEClassifier.fit()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NODEClassifier.get_number_of_params"><code class="docutils literal notranslate"><span class="pre">NODEClassifier.get_number_of_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NODEClassifier.get_params"><code class="docutils literal notranslate"><span class="pre">NODEClassifier.get_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NODEClassifier.optimize_hparams"><code class="docutils literal notranslate"><span class="pre">NODEClassifier.optimize_hparams()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NODEClassifier.predict"><code class="docutils literal notranslate"><span class="pre">NODEClassifier.predict()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NODEClassifier.predict_proba"><code class="docutils literal notranslate"><span class="pre">NODEClassifier.predict_proba()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NODEClassifier.score"><code class="docutils literal notranslate"><span class="pre">NODEClassifier.score()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NODEClassifier.set_params"><code class="docutils literal notranslate"><span class="pre">NODEClassifier.set_params()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NODERegressor"><code class="docutils literal notranslate"><span class="pre">NODERegressor</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NODERegressor.build_model"><code class="docutils literal notranslate"><span class="pre">NODERegressor.build_model()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NODERegressor.evaluate"><code class="docutils literal notranslate"><span class="pre">NODERegressor.evaluate()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NODERegressor.fit"><code class="docutils literal notranslate"><span class="pre">NODERegressor.fit()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NODERegressor.get_number_of_params"><code class="docutils literal notranslate"><span class="pre">NODERegressor.get_number_of_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NODERegressor.get_params"><code class="docutils literal notranslate"><span class="pre">NODERegressor.get_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NODERegressor.optimize_hparams"><code class="docutils literal notranslate"><span class="pre">NODERegressor.optimize_hparams()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NODERegressor.predict"><code class="docutils literal notranslate"><span class="pre">NODERegressor.predict()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NODERegressor.score"><code class="docutils literal notranslate"><span class="pre">NODERegressor.score()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NODERegressor.set_params"><code class="docutils literal notranslate"><span class="pre">NODERegressor.set_params()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NODELSS"><code class="docutils literal notranslate"><span class="pre">NODELSS</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NODELSS.build_model"><code class="docutils literal notranslate"><span class="pre">NODELSS.build_model()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NODELSS.evaluate"><code class="docutils literal notranslate"><span class="pre">NODELSS.evaluate()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NODELSS.fit"><code class="docutils literal notranslate"><span class="pre">NODELSS.fit()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NODELSS.get_default_metrics"><code class="docutils literal notranslate"><span class="pre">NODELSS.get_default_metrics()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NODELSS.get_number_of_params"><code class="docutils literal notranslate"><span class="pre">NODELSS.get_number_of_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NODELSS.get_params"><code class="docutils literal notranslate"><span class="pre">NODELSS.get_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NODELSS.optimize_hparams"><code class="docutils literal notranslate"><span class="pre">NODELSS.optimize_hparams()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NODELSS.predict"><code class="docutils literal notranslate"><span class="pre">NODELSS.predict()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NODELSS.score"><code class="docutils literal notranslate"><span class="pre">NODELSS.score()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NODELSS.set_params"><code class="docutils literal notranslate"><span class="pre">NODELSS.set_params()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NDTFClassifier"><code class="docutils literal notranslate"><span class="pre">NDTFClassifier</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NDTFClassifier.build_model"><code class="docutils literal notranslate"><span class="pre">NDTFClassifier.build_model()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NDTFClassifier.evaluate"><code class="docutils literal notranslate"><span class="pre">NDTFClassifier.evaluate()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NDTFClassifier.fit"><code class="docutils literal notranslate"><span class="pre">NDTFClassifier.fit()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NDTFClassifier.get_number_of_params"><code class="docutils literal notranslate"><span class="pre">NDTFClassifier.get_number_of_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NDTFClassifier.get_params"><code class="docutils literal notranslate"><span class="pre">NDTFClassifier.get_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NDTFClassifier.optimize_hparams"><code class="docutils literal notranslate"><span class="pre">NDTFClassifier.optimize_hparams()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NDTFClassifier.predict"><code class="docutils literal notranslate"><span class="pre">NDTFClassifier.predict()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NDTFClassifier.predict_proba"><code class="docutils literal notranslate"><span class="pre">NDTFClassifier.predict_proba()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NDTFClassifier.score"><code class="docutils literal notranslate"><span class="pre">NDTFClassifier.score()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NDTFClassifier.set_params"><code class="docutils literal notranslate"><span class="pre">NDTFClassifier.set_params()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NDTFRegressor"><code class="docutils literal notranslate"><span class="pre">NDTFRegressor</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NDTFRegressor.build_model"><code class="docutils literal notranslate"><span class="pre">NDTFRegressor.build_model()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NDTFRegressor.evaluate"><code class="docutils literal notranslate"><span class="pre">NDTFRegressor.evaluate()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NDTFRegressor.fit"><code class="docutils literal notranslate"><span class="pre">NDTFRegressor.fit()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NDTFRegressor.get_number_of_params"><code class="docutils literal notranslate"><span class="pre">NDTFRegressor.get_number_of_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NDTFRegressor.get_params"><code class="docutils literal notranslate"><span class="pre">NDTFRegressor.get_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NDTFRegressor.optimize_hparams"><code class="docutils literal notranslate"><span class="pre">NDTFRegressor.optimize_hparams()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NDTFRegressor.predict"><code class="docutils literal notranslate"><span class="pre">NDTFRegressor.predict()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NDTFRegressor.score"><code class="docutils literal notranslate"><span class="pre">NDTFRegressor.score()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NDTFRegressor.set_params"><code class="docutils literal notranslate"><span class="pre">NDTFRegressor.set_params()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NDTFLSS"><code class="docutils literal notranslate"><span class="pre">NDTFLSS</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NDTFLSS.build_model"><code class="docutils literal notranslate"><span class="pre">NDTFLSS.build_model()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NDTFLSS.evaluate"><code class="docutils literal notranslate"><span class="pre">NDTFLSS.evaluate()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NDTFLSS.fit"><code class="docutils literal notranslate"><span class="pre">NDTFLSS.fit()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NDTFLSS.get_default_metrics"><code class="docutils literal notranslate"><span class="pre">NDTFLSS.get_default_metrics()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NDTFLSS.get_number_of_params"><code class="docutils literal notranslate"><span class="pre">NDTFLSS.get_number_of_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NDTFLSS.get_params"><code class="docutils literal notranslate"><span class="pre">NDTFLSS.get_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NDTFLSS.optimize_hparams"><code class="docutils literal notranslate"><span class="pre">NDTFLSS.optimize_hparams()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NDTFLSS.predict"><code class="docutils literal notranslate"><span class="pre">NDTFLSS.predict()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NDTFLSS.score"><code class="docutils literal notranslate"><span class="pre">NDTFLSS.score()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.NDTFLSS.set_params"><code class="docutils literal notranslate"><span class="pre">NDTFLSS.set_params()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.SklearnBaseClassifier"><code class="docutils literal notranslate"><span class="pre">SklearnBaseClassifier</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.SklearnBaseClassifier.build_model"><code class="docutils literal notranslate"><span class="pre">SklearnBaseClassifier.build_model()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.SklearnBaseClassifier.evaluate"><code class="docutils literal notranslate"><span class="pre">SklearnBaseClassifier.evaluate()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.SklearnBaseClassifier.fit"><code class="docutils literal notranslate"><span class="pre">SklearnBaseClassifier.fit()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.SklearnBaseClassifier.get_number_of_params"><code class="docutils literal notranslate"><span class="pre">SklearnBaseClassifier.get_number_of_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.SklearnBaseClassifier.get_params"><code class="docutils literal notranslate"><span class="pre">SklearnBaseClassifier.get_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.SklearnBaseClassifier.optimize_hparams"><code class="docutils literal notranslate"><span class="pre">SklearnBaseClassifier.optimize_hparams()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.SklearnBaseClassifier.predict"><code class="docutils literal notranslate"><span class="pre">SklearnBaseClassifier.predict()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.SklearnBaseClassifier.predict_proba"><code class="docutils literal notranslate"><span class="pre">SklearnBaseClassifier.predict_proba()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.SklearnBaseClassifier.score"><code class="docutils literal notranslate"><span class="pre">SklearnBaseClassifier.score()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.SklearnBaseClassifier.set_params"><code class="docutils literal notranslate"><span class="pre">SklearnBaseClassifier.set_params()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.SklearnBaseLSS"><code class="docutils literal notranslate"><span class="pre">SklearnBaseLSS</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.SklearnBaseLSS.build_model"><code class="docutils literal notranslate"><span class="pre">SklearnBaseLSS.build_model()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.SklearnBaseLSS.evaluate"><code class="docutils literal notranslate"><span class="pre">SklearnBaseLSS.evaluate()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.SklearnBaseLSS.fit"><code class="docutils literal notranslate"><span class="pre">SklearnBaseLSS.fit()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.SklearnBaseLSS.get_default_metrics"><code class="docutils literal notranslate"><span class="pre">SklearnBaseLSS.get_default_metrics()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.SklearnBaseLSS.get_number_of_params"><code class="docutils literal notranslate"><span class="pre">SklearnBaseLSS.get_number_of_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.SklearnBaseLSS.get_params"><code class="docutils literal notranslate"><span class="pre">SklearnBaseLSS.get_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.SklearnBaseLSS.optimize_hparams"><code class="docutils literal notranslate"><span class="pre">SklearnBaseLSS.optimize_hparams()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.SklearnBaseLSS.predict"><code class="docutils literal notranslate"><span class="pre">SklearnBaseLSS.predict()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.SklearnBaseLSS.score"><code class="docutils literal notranslate"><span class="pre">SklearnBaseLSS.score()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.SklearnBaseLSS.set_params"><code class="docutils literal notranslate"><span class="pre">SklearnBaseLSS.set_params()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.SklearnBaseRegressor"><code class="docutils literal notranslate"><span class="pre">SklearnBaseRegressor</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.SklearnBaseRegressor.build_model"><code class="docutils literal notranslate"><span class="pre">SklearnBaseRegressor.build_model()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.SklearnBaseRegressor.evaluate"><code class="docutils literal notranslate"><span class="pre">SklearnBaseRegressor.evaluate()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.SklearnBaseRegressor.fit"><code class="docutils literal notranslate"><span class="pre">SklearnBaseRegressor.fit()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.SklearnBaseRegressor.get_number_of_params"><code class="docutils literal notranslate"><span class="pre">SklearnBaseRegressor.get_number_of_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.SklearnBaseRegressor.get_params"><code class="docutils literal notranslate"><span class="pre">SklearnBaseRegressor.get_params()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.SklearnBaseRegressor.optimize_hparams"><code class="docutils literal notranslate"><span class="pre">SklearnBaseRegressor.optimize_hparams()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.SklearnBaseRegressor.predict"><code class="docutils literal notranslate"><span class="pre">SklearnBaseRegressor.predict()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.SklearnBaseRegressor.score"><code class="docutils literal notranslate"><span class="pre">SklearnBaseRegressor.score()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mambular.models.SklearnBaseRegressor.set_params"><code class="docutils literal notranslate"><span class="pre">SklearnBaseRegressor.set_params()</span></code></a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Anton Frederik Thielmann, Manish Kumar, Christoph Weisser, Benjamin Saefken, Soheila Samiee
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024, BASF SE.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    <p class="last-updated">
  Last updated on 2024-12-07.
  <br/>
</p>
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>